Summary,Issue key,Issue id,Issue Type,Status,Project key,Project name,Project type,Project lead,Project lead id,Project description,Project url,Priority,Resolution,Assignee,Assignee Id,Reporter,Reporter Id,Creator,Creator Id,Created,Updated,Last Viewed,Resolved,Fix versions,Fix versions,Fix versions,Fix versions,Fix versions,Fix versions,Fix versions,Fix versions,Fix versions,Fix versions,Fix versions,Components,Components,Components,Components,Components,Components,Components,Components,Components,Components,Due date,Votes,Labels,Labels,Labels,Labels,Description,Environment,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Original estimate,Remaining Estimate,Time Spent,Work Ratio,Σ Original Estimate,Σ Remaining Estimate,Σ Time Spent,Security Level,Inward issue link (Blocks),Inward issue link (Blocks),Inward issue link (Blocks),Outward issue link (Blocks),Outward issue link (Blocks),Inward issue link (Cloners),Inward issue link (Cloners),Inward issue link (Cloners),Outward issue link (Cloners),Inward issue link (Duplicate),Outward issue link (Duplicate),Inward issue link (Polaris datapoint work item link),Outward issue link (Polaris datapoint work item link),Inward issue link (Polaris work item link),Outward issue link (Polaris work item link),Inward issue link (Problem/Incident),Outward issue link (Problem/Incident),Inward issue link (Relates),Inward issue link (Relates),Inward issue link (Relates),Outward issue link (Relates),Outward issue link (Relates),Outward issue link (Relates),Outward issue link (Relates),Outward issue link (Relates),Inward issue link (Test),Inward issue link (Work item split),Outward issue link (Work item split),Outward issue link (Work item split),Outward issue link (Work item split),Outward issue link (Work item split),Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Custom field (API Impact),Custom field (Action Needed),Custom field (Action visibility),Custom field (Actual Completion Date),Custom field (Actual Downtime (end)),Custom field (Actual Downtime (minutes)),Custom field (Actual Downtime (start)),Custom field (Actual Risktime (minutes)),Custom field (Actual end),Custom field (Actual start),Custom field (Advanced Support Team Assignment),Custom field (Affected Digitalisation Service),Custom field (Affected Scheme),Custom field (Affected hardware),Custom field (Affected services),Custom field (All Actions Completed),Custom field (Analysis Effort (elapsed time)),Custom field (Approvals),Custom field (Approved Reason),Custom field (Automation Status),Custom field (Backout plan),Custom field (Blocker),Custom field (Business Value),Custom field (CA Actual Completion Date),Custom field (CA Owner Team),Custom field (CA Status),Custom field (CA Type),Custom field (CA Visibility),Custom field (Can this be re-used by other clients? ),Custom field (Category),Custom field (Cause Code),Custom field (Cause Code),Custom field (Change Implemented By),Custom field (Change Management Approval),Custom field (Change Management Approval)Id,Custom field (Change Request Type),Custom field (Change Rollback Plan),Custom field (Change Target Type),Custom field (Change reason),Custom field (Change risk),Custom field (Change risk score),Custom field (Change type),Custom field (Checklist Completed),Custom field (Checklist Content YAML),Custom field (Checklist Progress),Custom field (Checklist Progress %),Custom field (Checklist Text),Custom field (Checklist Text (view-only)),Custom field (Client),Custom field (Client),Custom field (Client),Custom field (Client),Custom field (Client),Custom field (Client),Custom field (Client),Custom field (Client Environment),Custom field (Client Environment),Custom field (Client Environment),Custom field (Client Impact),Custom field (Client Informed),Custom field (Client Name [ZD]),Custom field (Client Region),Custom field (Client Region [ZD]),Custom field (Client Sign-off),Custom field (Client name),Custom field (Client region),Custom field (Client tier),Custom field (Connection Details),Custom field (Connection Issue),Custom field (Contributing Factors),Custom field (Customer Request Type),Custom field (Customer Tier),Custom field (Data source),Custom field (Decision),Custom field (Decline Reason),Custom field (Delivery Manager),Custom field (Dependent Components),Custom field (Dependent Components),Custom field (Dependent Components),Custom field (Dependent Components),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Deployment),Custom field (Desired Outcome [ZD]),Custom field (Desired outcome),Custom field (Detailed RCA Narrative (internal)),Custom field (Detected),Custom field (Detection Method),Custom field (Development),Custom field (Digitalisation Error),Custom field (Digitalisation Impact ),Custom field (Digitalisation Services Impacted),Custom field (Downtime (minutes)),Custom field (Duration of Impact (minutes)),Custom field (End Date),Custom field (Environment),Custom field (Environment Cascading),Custom field (Environment Name),Custom field (Environment Type),Custom field (Epic Color),Custom field (Epic Name),Custom field (Epic Status),Custom field (Error Code),Custom field (Escalated to MIM),Custom field (Estimated Downtime (minutes)),Custom field (Expected Compliance Date),Custom field (Expected Compliance State),Custom field (External issue ID),Custom field (Finding Category ),Custom field (Focus Areas),Custom field (Format),Custom field (Goals),Custom field (How should this work? ),"Custom field (If you have selected ""VoucherEngine"" in the previous question, please specify the offering)",Custom field (Impact),Custom field (Impact Mitigated),Custom field (Impact Start),Custom field (Impact Summary (client-facing)),Custom field (Impacted API (BL) ),Custom field (Impacted API (VE)),Custom field (Impacted Report),Custom field (Implementation plan),Custom field (Implemented Date),Custom field (Incident & Triggering Context),Custom field (Incident (#)),Custom field (Incident End Date),Custom field (Incident Severity (highest linked)),Custom field (Incident Source),Custom field (Incident Start Date),Custom field (Incident Submission Status),Custom field (Initiative (proposal)),Custom field (Initiative Sponsor),Custom field (Investigation reason),Custom field (Issue color),Custom field (Link to ZenDesk),Custom field (Locked forms),Custom field (Major incident),Custom field (Manual Provisioning Working),Custom field (NEXT STEPS),Custom field (Network Variant),Custom field (Network Variant),Custom field (Open forms),Custom field (Operational categorization),Custom field (Overall Corrective Action Status),Custom field (Paymentology Platform [ZD]),Custom field (Paymentology Product Plan),Custom field (Paymentology Product Type [ZD]),Custom field (Paymentology platform),Custom field (Pending reason),Custom field (Planned end),Custom field (Planned start),Custom field (Platform),Custom field (Platform),Custom field (Platform Impact),Custom field (Post Implementation Review),Custom field (Pre-Installer),Custom field (Proactive (Client feedback / Observation / Trend)),Custom field (Proactive PM Trigger Source),Custom field (Problem / Opportunity),Custom field (Problem / Opportunity [ZD]),Custom field (Problem Closure Notes),Custom field (Problem Status),Custom field (Problem/Opportunity),Custom field (Processed Reason),Custom field (Product),Custom field (Product Description),Custom field (Product Request Type [ZD]),Custom field (Product categorization),Custom field (Product component - Other),Custom field (Product request type),Custom field (Project overview key),Custom field (Project overview status),Custom field (RCA Elapsed Days),Custom field (RCA Issued Date),Custom field (RCA Report Status),Custom field (RCA SLA),Custom field (RCAR Actual Completion Date),Custom field (RCAR Link),Custom field (RCAR Target Completion Date),Custom field (Raised By Customer),Custom field (Rank),Custom field (Reason Processed),Custom field (Reason of assigning to IMPS),Custom field (Recurring Issue Indicator),Custom field (Related to Incident),Custom field (Release Note),Custom field (Report Date / Time (UTC)),Custom field (Request language),Custom field (Request participants),Custom field (Requester),Custom field (Requester),Custom field (Requires Documentation update),Custom field (Responders),Custom field (Resuability of this Solution [ZD]),Custom field (Reusability of this solution),Custom field (Reusability of this solution (Description)),Custom field (Reusability of this solution (Description) [ZD]),Custom field (Revision),Custom field (Risk time (minutes)),Custom field (Rollback Plan),Custom field (Root Cause Analysis Status),Custom field (Root Cause Analysis status),Custom field (Root Cause Summary),Custom field (Root Cause Summary (client-safe)),Custom field (Root cause),Custom field (Rough quantification of monthly transactions impacted),Custom field (Rough quantification of monthly transactions impacted (Please enter an approximate estimation) ),Custom field (Rough quantification of monthly transactions impacted [ZD]),Satisfaction rating,Custom field (Satisfaction date),Custom field (Scope of User Story (test - do not use)),Custom field (Security Status),Custom field (Security bulletin),Custom field (Sentiment),Custom field (Service Area),Custom field (Service at Risk?),Custom field (Severity),Custom field (Severity),Custom field (Source),Sprint,Sprint,Sprint,Sprint,Sprint,Sprint,Sprint,Sprint,Sprint,Sprint,Sprint,Sprint,Sprint,Sprint,Custom field (Start date),Custom field (Story Points),Custom field (Story point estimate),Custom field (Submitted forms),Custom field (T-shirt size),Custom field (TL/EM Approval),Custom field (TL/EM Change Approver),Custom field (TL/EM Change Approver)Id,Custom field (Tag),Custom field (Target Completion Date),Custom field (Target State),Custom field (Target end),Custom field (Target start),Team Id,Team Name,Custom field (Test Evidence),Custom field (Test plan),Custom field (Third Party),Custom field (Third Party Dependency),Custom field (Third Party Dependency),Custom field (Third Party Name(s)),Custom field (Time to close after resolution),Custom field (Time to first response),Custom field (Time to resolution),Custom field (Time to review normal change),Custom field (Total forms),Custom field (Trace ID(s)),Custom field (Transaction ID(s)),Custom field (Transaction Impact),Custom field (Trigger Type),Custom field (Type of Client [ZD]),Custom field (Type of client),Custom field (Urgency),Custom field (Validated By),Custom field (Vendor Involved in Root Cause),Custom field (Vulnerability),Custom field (Was this a Known Error?),Custom field (What alternative options or workarounds are available if this request is not processed),Custom field (What alternative options or workarounds are available if this request is not processed?),Custom field (What client is this for),Custom field (What happens if we cannot make this work? ),Custom field (What problem are we trying to fix? ),Custom field (What problem are we trying to fix? ),Custom field (What would be the impact if we do NOT process this request? ),Custom field (What would be the impact if we do NOT process this request? [ZD]),Custom field (Work Category),Custom field (Work category),Custom field (Workaround),Custom field (Zendesk Ticket ID),Custom field ([CHART] Date of First Response),Custom field ([CHART] Time in Status),Custom field (productboard URL),Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Parent,Parent key,Parent summary,Status Category,Status Category Changed
[DE Rollout] Mettle,TECH-834,184957,Technology Initiative,Proposal,TECH,Technology Highlevel Plan,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,,,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,11/Nov/25 6:29 PM,10/Dec/25 10:19 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,TECH-900,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3640940e,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06xec:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,184953,TECH-832,Decision Engine Customers Roll out,To Do,11/Nov/25 6:29 PM
Dockerization - BL Legacy Environment,TECH-117,126062,Technology Initiative,In Progress,TECH,Technology Highlevel Plan,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,Bilal Hashmi,60fedcdc627b5600689cd1a0,Bilal Hashmi,60fedcdc627b5600689cd1a0,Bilal Hashmi,60fedcdc627b5600689cd1a0,29/Apr/24 1:18 PM,05/Mar/25 1:53 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Efforts for each environment 


|Dockerization|Note:These efforts are estimated for 1 environment| | | | | |
| |Item|Owner| | |Dedicated Efforts|Remarks|
|1|Docker Software Installation|Infra| | | | |
|2|Docker POC on reduntant service|SD| | |1 - day effort| |
|3|Review and Detailing Configuration (Keys, URL , Permissions etc)|SD| | |2 - day effort| |
|4|Branch Configuration|SD| | |1 - day effort| |
|5|Planning and Scheduling|SD| | |0.5 - day effort| |
|6|Deployment Execution|SD| | |0.5 - day effort| |


Legacy environments



|Non-Dockerized Environments|Name|Cloud|Product|Type|Remarks|
|METTLE|METTLE|Azure|Enterprise Light|Production| |
|Derayah - Production|Derayah|OCI|Enterprise|Production| |
|TWQ - Prod|Tweeq|OCI|Enterprise|Production| |
|MOX|MOX|Azure|Enterprise Light|Production|Risk - JETCO PR/PP single interface|
|Shared03|Test Env|Azure|NA|Test|Low priority - Move to it to BAU tasks|
|Shared04|Test Env|Azure|NA|Test|Low priority - Move to it to BAU tasks|
|ADQ|ADQ/WIO|Azure|Enterprise Light|Production|CBUAE - Do we have redundancy ?|
|UAT - Derayah|Derayah|OCI|Enterprise|UAT| |
|UAT - TWQ|Tweeq|OCI|Enterprise|UAT| |
|MOX DR|MOX|Azure|Enterprise Light|DR| |
|METTLE DR|METTLE|Azure|Enterprise Light|DR| |",,Adnan Ali,Automation for Jira,Bilal Hashmi,James Evans,Salik.hashmi,Stephen Kerin,Vijay Sridhar,,,,,60fc636052162b00681d341b,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,60fedcdc627b5600689cd1a0,61dc367f7aa7ac00707aefc5,611a52967b538a006964a439,62c5616bb6357aecd7c70e56,60fedd468c15ca006ffc3ef1,,,,,,,,,,,,,,,,TECH-251,TECH-405,,,,,,,,,,,,,OPS-15971,,,LMTRCE-2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@7c6f7705,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzxtgf:r,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-05-07 14:06:04.954,,,"07/May/24 4:06 PM;611a52967b538a006964a439;This Project blocked due to below 2 tickets:

https://paymentology.atlassian.net/browse/OPS-15971
https://paymentology.atlassian.net/browse/OPS-16034

CC: [~accountid:60fedcdc627b5600689cd1a0][~accountid:62b2cab1cebad33432f75d77][~accountid:712020:08e51fce-9993-4928-8457-b3ad41356803][~accountid:61dc367f7aa7ac00707aefc5]",21/May/24 4:28 PM;61dc367f7aa7ac00707aefc5;is this still blocked? [~accountid:611a52967b538a006964a439]  [~accountid:60fedcdc627b5600689cd1a0] ,"21/May/24 4:32 PM;611a52967b538a006964a439;[~accountid:60fedd468c15ca006ffc3ef1] [~accountid:60fc636052162b00681d341b] please confirm if both tickets are completed ? 

[https://paymentology.atlassian.net/browse/OPS-15971|https://paymentology.atlassian.net/browse/OPS-15971|smart-link] 
[https://paymentology.atlassian.net/browse/OPS-16034|https://paymentology.atlassian.net/browse/OPS-16034|smart-link] ",21/May/24 4:33 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - OPS-15971 has got status Done,21/May/24 4:35 PM;60fedd468c15ca006ffc3ef1;Both are done [~accountid:611a52967b538a006964a439] ,22/May/24 10:31 AM;60fc636052162b00681d341b;[~accountid:611a52967b538a006964a439] Yes all required connections in the ticket are allowed please let us know if anything getting blocked.,21/Jan/25 7:17 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - LMTRCE-2 has got status Rejected,"23/Jan/25 4:54 PM;61dc367f7aa7ac00707aefc5;[~accountid:611a52967b538a006964a439] [~accountid:61f80302845d670071f2138e] [~accountid:624730348678e900705bddcd]  could you please provide a summary of the tickets above that aren’t done?

having these environments dockerised is a pre-req for the Rocky linux/CentOS EoL project

thanks !



cc [~accountid:60fedcdc627b5600689cd1a0] ",05/Mar/25 1:51 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - LMTRCE-2 has got status Rejected,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,128243,TECH-175,IT Service Management - Projects,In Progress,07/May/24 4:06 PM
Natwest Boxed - Pin Block Flow Opt Out,PR-2074,147726,Task,Backlog,PR,Product Request ,business,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,,,Normal,,Shoaib Iqbal,6297155ee76a9c00705e2b50,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,21/Jan/25 4:19 PM,06/Mar/25 1:03 PM,,,,,,,,,,,,,,,,,,,,,,,,30/Jan/25 12:00 AM,0,business-form,jira_automation_tag,jira_escalated,jira-zd-escalation,"----------------------------------------------

Michael Ellery, Jan 21, 2025, 16:19

Can apply to all clients",,Christien Ackroyd,Paymentology,Shoaib Iqbal,William Dunne,,,,,,,,60fedcf83900e60070792cfe,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,6297155ee76a9c00705e2b50,557058:5363d7a1-da13-4012-8609-f44e54c1d062,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,04/Feb/25 4:53 PM;ug:027c8281-f39f-45b1-a4f8-b37558383b01;image-20250204-145322.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104923,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@49732bf4,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,Natwest Boxed/Mettle,Europe,,,,,,,,,,,,,,,,,,,,,,,,,,,,,We provide clients with an opt out option for this flow,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Enterprise,,Banking.live,,,,,,,,,,,Paymentology currently blocks Natwest Boxed/Mettle cardholders on behalf of them with the status going to 'Inactive - PIN Blocked' - by PTY making this decision without notifying them or giving Natwest the option to opt out of us doing this for them it leaves their customer ops in the dark. Natwest does not use PTY rules engine as they want to have this control,,,,,,,,,,,Enhancement,,,,,,,,,,,1|i02wr4:,,,,,,,,,,Michael Ellery,,,,Generic,"----------------------------------------------

Michael Ellery, Jan 21, 2025, 16:19

Can apply to all clients",,,,,,,,,,Up to 2.000.000 transactions / month,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Existing,,,,,,,not sure,,,,,Natwest do not have visibility on when we do this and this results in a negative experience with the client and their cardholders,,,,,905580.0,2025-02-04 14:53:38.176,,,"04/Feb/25 4:53 PM;60fedcf83900e60070792cfe;[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] where would this request sit? And would this need to the Demand Approval Forum after being endorsed by Anna?

fyi [~accountid:623b163c50bb2b0070b636ea] [~accountid:6273fc10807e0000691d5dee] 



!image-20250204-145322.png|width=1455,height=822,alt=""image-20250204-145322.png""!",04/Feb/25 11:15 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Authorisations [~accountid:60fedcf83900e60070792cfe] - believe so yes,"06/Mar/25 1:03 PM;6297155ee76a9c00705e2b50;[~accountid:6273fc10807e0000691d5dee] 

I believe this change involves adding a feature flag to manage invalid PIN retries. If the new flag *Stop_PIN_Counter* is enabled, the system will no longer track invalid PIN attempts or block the card due to exceeded retries.

Alternatively, this can be achieved by setting an extremely high retry limit in the product settings (e.g., *999999*), effectively eliminating the risk of blocking the card due to invalid PIN attempts.

CC [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] [~accountid:60fedcf83900e60070792cfe] [~accountid:623b163c50bb2b0070b636ea] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,21/Jan/25 4:19 PM
Mettle: Create reason codes for transactions declined by RuleEngine DOS Mechanism,PR-1994,135732,Task,Declined,PR,Product Request ,business,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,,,Normal,,,,William Dunne,557058:5363d7a1-da13-4012-8609-f44e54c1d062,William Dunne,557058:5363d7a1-da13-4012-8609-f44e54c1d062,09/Sep/24 9:37 AM,09/Sep/24 9:38 AM,,,,,,,,,,,,,,,,,,,,,,,,18/Sep/24 12:00 AM,0,,,,,,,William Dunne,,,,,,,,,,,557058:5363d7a1-da13-4012-8609-f44e54c1d062,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@39400ca3,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,Mettle,Europe,"Tier 1 : A Tier 1 Client generate $100 000 per annum or more in Revenue. Our most strategically important tier in terms of value, volume, scale and potential. Receives Tier 1 priority servicing. We currently have 16 clients in this tier. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,Processor reason code in FAST ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Enterprise,,Banking.live,,,,,,,,,,,"Currently when the RuleEngine declines payments because of the DOS mechanism, there is no dedicated processor reason code - in fact we send “000” success while declining the payment.

We should find a way to report this, and provide an adequate code, so that customers understand the root cause of the decline. This was requested by Mettle (Elite)",,,,,,,,,,,Enhancement,,,,,,,,,,,1|i01brd:,,,,,,,,,,Mettle,,,,Generic,"Most of our clients don’t look at these things as carefully as Mettle, though it would be “reused” by all clients",,,,,,,,,,Up to 10.000 transactions / month,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Existing,,,,,,,Sending Wil an email and asking why a payment declined,,,,,Customers are unable to understand the cause of their failures,,,,,,,,,09/Sep/24 9:38 AM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Duplicate,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,09/Sep/24 9:37 AM
Mettle - Declined Advices Counting Towards Limits,PR-1953,132436,Task,Declined,PR,Product Request ,business,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,,,Normal,,Sean Routledge,557058:4f540850-1319-42e3-9630-bc67cd95e8c2,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,30/Jul/24 11:47 AM,04/Dec/24 3:08 PM,,,,,,,,,,,,,,,,,,,,,,,,08/Aug/24 12:00 AM,0,business-form,jira_automation_tag,jira_escalated,jira-zd-escalation,"----------------------------------------------

Michael Ellery, Jul 30, 2024, 11:47

Applies to all clients",,Automation for Jira,Christien Ackroyd,michael.ellery,Paymentology,Sean Routledge,,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,60fedcf83900e60070792cfe,6273fc10807e0000691d5dee,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,557058:4f540850-1319-42e3-9630-bc67cd95e8c2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEFECT-399,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@546673b9,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,Mettle,Europe,,,,,,,,,,,,,,,,,,,,,,,,,,,,,The code accepts a change to avoid declined advices being counted towards their limits,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Enterprise,,Banking.live,,,,,,,,,,,"Mettle have noticed that declined Advices are calculated in their limits. These transactions are not supposed to be deducted from limit.

As per this ticket https://paymentology.atlassian.net/browse/DEFECT-399 - the current code does not support amending this behaviour and this needs to be changed",,,,,,,,,,,Enhancement,,,,,,,,,,,1|i00xgp:,,,,,,,,,,Michael Ellery,,,,Generic,"h1. Rewriting of the issue by Wil

h2. Issue #1:

We receive advices from card schemes (Mada, Mastercard, Visa), that may have been approved or declined. Our, and our customers opinion about whether or not these should be approved or declined is no longer relevant and will not be considered by scheme. Moreover it introduces risk in particular with STIP approvals. If Mastercard approves a payment for $100 in STIP, and our rule engine decides for whatever reason it should have been declined and sets a “no limits remaining” response code, we will forward this to the customer via FAST, and they may not post this to the customers account.

h3. Questions:

* Is it currently possible to create a rule that does not run for MTIs for advices (120, 420, Mada equivalents etc)?
** {color:#4c9aff}*_Sean - Yes. we can specify which MTI’s a rule should/not apply to_*{color}
*** {color:#4c9aff} _c_MTID_PATTERN_STR=> - current{color}
*** {color:#4c9aff}_h_MTID_PATTERN_STR=> - historic{color}
* If a rule does not run on a given advice, can it still be included in the limits for a given payment? (See issue #2)
** {color:#4c9aff}*-Sean - Yes. If we specified _c_DE39_PATTERN_STR=>'IN;00,10,87',  in the rule-* {color}{color:#4c9aff}-then the limit will be applied to only approved transaction. And if we don't specify it, it will take all MTIs and transaction approved/declined into account.-{color}
** {color:#4c9aff}Sean - final_total_debit should be used{color}

h2. Issue #2:

For the purposes of calculating limits, only approved advices should be taken into account. If a customer has a $500 monthly ATM limit, and Mastercard approves a $100 ATM payment in STIP, this should obviously be deducted from their monthly limit (even though _don’t_ want to decline the advice if they had already run out of limits). However, if Mastercard _declines_ a $100 ATM transaction (be it for STIP or other reasons such as downtime), this should not be taken into account for limits

h3. Questions:

* Is it possible to look at DE-39 when calculating what percentage of limits was consumed?
** {color:#4c9aff}*_Sean - I don’t understand the use case here?_*{color}
** If not, how much work is it?
* Is it possible to create a rule that does _not_ run against an advice (i.e won’t decline an advice because of rule) but will take it into account for sake of limits, as described
** {color:#4c9aff}*_Sean - Seems to be the same question from Issue #1?_*{color}
*** {color:#4c9aff}*-If we specified _c_DE39_PATTERN_STR=>'IN;00,10,87',  in the rule-* {color}{color:#4c9aff}-then the limit will be applied to only approved transaction. And if we don't specify it, it will take all MTIs and transaction approved/declined into account.-{color}
*** {color:#4c9aff}final_total_debit should be used{color}

h2. Issue #3:

There are a number of weird cases of advice, such as the completion advices. The way they work is:

* We receive an authorisation for $100
* We receive a completion advice for $80
* $20 is returned to the cardholder

Currently, as I understand it, we are currently in this case debiting $180 from the limits of the cardholder.

There are additional cases, such as receiving an approval advice for a transaction which we believe we already approved, but where the response timed out.

h3. Questions:

* How can we resolve this? Does RuleEngine have enough context to do something like disconsider the $100 authorisation when we receive the $80 completion advice
** {color:#4c9aff}*_Sean - We have final_total_debit available to the rule._*{color}{color:#4c9aff} If this is used we should have no issues. Please can you point me to a DEFECT so we can investigate this.{color}",,,,,,,,,,Up to 1.000.000 transactions / month,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Existing,,,,,,,none,,,,,The current behaviour which is impacting cardholder limits incorrectly continues,,,,,795001.0,2024-07-30 14:55:01.784,,,"30/Jul/24 4:55 PM;557058:4f540850-1319-42e3-9630-bc67cd95e8c2;Hi [~accountid:6273fc10807e0000691d5dee] 

Was the f[eedback from engineering|https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=199875] taken into consideration and relayed back to Mettle?
Because if we were to proceed with a change like this, from my understanding it would require a rearchitecting of the rules engine. ",30/Jul/24 5:34 PM;6273fc10807e0000691d5dee;Will double check with them and come back ,20/Aug/24 4:18 PM;6273fc10807e0000691d5dee;Mettle are happy to leave this as is - can be closed,21/Aug/24 11:09 AM;557058:4f540850-1319-42e3-9630-bc67cd95e8c2;Thank you [~accountid:6273fc10807e0000691d5dee] ,13/Sep/24 3:18 PM;60fedcf83900e60070792cfe;[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] [~accountid:557058:4f540850-1319-42e3-9630-bc67cd95e8c2] any update on this ticket? It is now for D360 as well,"19/Sep/24 2:20 PM;557058:4f540850-1319-42e3-9630-bc67cd95e8c2;Hey [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] 

Please see my feedback in {color:#4c9aff}blue{color}",01/Oct/24 12:57 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - DEFECT-399 has got status Done,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,30/Jul/24 11:47 AM
Card Status - Mastercard 05 Override,PR-1836,124881,Task,Declined,PR,Product Request ,business,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,,,Normal,,,,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,10/Apr/24 12:34 PM,11/Apr/24 2:21 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,business-form,jira_automation_tag,jira_escalated,jira-zd-escalation,"----------------------------------------------

Michael Ellery, Apr 10, 2024, 12:34

Applies to all Mastercard clients",,Christien Ackroyd,Paymentology,,,,,,,,,,60fedcf83900e60070792cfe,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@454b19db,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,Mettle,Europe,,,,,,,,,,,,,,,,,,,,,,,,,,,,,This is provided for Mastercard clients also,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Enterprise,,Banking.live,,,,,,,,,,,"We have released a solution for Visa only, Mettle a Mastercard client would like this incorporated for Mastercard also as it is driving up their Do Not Honour numbers which is a mandate on Mastercard and not Visa.

Specifically, the 2 statuses were introduced in the recent version 7.x. The reason for this is to reduce the number of “05” responses to the Scheme. They are optional.

1007 -> Processor reason code will be 414 (Nwk_status override : Inactive card - formal decline)
1009 -> Processor reason code will be reason code 415 (Nwk_status override : Void card - formal decline)
 
Cards with status 1007 should return DE39=14 to the scheme.
Cards with status 1009 will return DE39=62 to the scheme.

Unless overridden by client response.
 
Cards in statuses 1005 and 1199 returns 05 to the scheme unless overridden by the client response.",,,,,,,,,,,Enhancement,,,,,,,,,,,1|hzzshr:,,,,,,,,,,Michael Ellery,,,,Generic,"----------------------------------------------

Michael Ellery, Apr 10, 2024, 12:34

Applies to all Mastercard clients",,,,,,,,,,Up to 2.000.000 transactions / month,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Existing,,,,,,,there is none,,,,,Do not honour declines increase and could result in penalties by Mastercard,,,,,728125.0,2024-04-11 12:21:35.847,,,"11/Apr/24 2:21 PM;60fedcf83900e60070792cfe;Hi [~accountid:6273fc10807e0000691d5dee] 

This functionality is already for available MasterCard and VISA, only for clients on a dedicated envt, and considering that Mettle are in a dedicated environment, it would need to be deployed in their environment. Declining this request as functionality only needs to be deployed

It should be in BL v2.9, perhaps the deployment team could confirm when this would be deployed to the Mettle envt - [~accountid:63c148ea94d18cbf6773411b]  

[https://paymentology.atlassian.net/browse/AUTH-353|https://paymentology.atlassian.net/browse/AUTH-353|smart-link] 

[https://paymentology.atlassian.net/browse/AUTH-168|https://paymentology.atlassian.net/browse/AUTH-168|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,10/Apr/24 12:34 PM
Mettle - Fast Message Request,PR-1575,111292,Task,Declined,PR,Product Request ,business,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,,,Normal,,William Dunne,557058:5363d7a1-da13-4012-8609-f44e54c1d062,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,06/Sep/23 2:47 PM,13/Oct/23 6:01 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,business-form,jira_automation_tag,jira_escalated,jira-zd-escalation,"----------------------------------------------

Michael Ellery, Sep 6, 2023, 14:47 (private)

Applies to all clients receiving fast",,Paymentology,Rohith Rajan,William Dunne,,,,,,,,,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,5abca82e3cde3440ff0056b1,557058:5363d7a1-da13-4012-8609-f44e54c1d062,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@39b6f173,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,Mettle,Europe,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"Given the difficulties this pushes to all Paymentology clients to implement parsing logic to obtain single pieces of information e.g. merchant name, could Paymentology look to provide this information in a format that better reflects the original ISO construct?

There is a scheme mandate coming into effect on 14th October 2023 which requires issuers to show enhanced merchant information to customers in their banking app/portal. The inputs for most 3rd party suppliers offering solutions is the ISO construct of these fields, therefore this update would also better ensure your clients for readiness towards this mandate.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Enterprise,,Banking.live,,,,,,,,,,,"In the FAST message from Paymentology for authorisations, Mettle receive merchant information as a single set of data in DE43.

In the ISO specification, we know that the schemes provide this as a series of sub-fields within DE43 e.g. DE43 SF1 = merchant name.

On Mettle side they have to use parsing logic on DE43 to try break it back into the component parts from the ISO message so that we can show a clean ""merchant name"" for example to our customers without the rest of the details.

The format used in DE43 in the FAST from Paymentology doesn't appear to uphold the DE43 ISO field lengths and format so we can't even reliably use parsing logic.

Also they are one client taking on this burden of effort for anything we may want to do with this information e.g. show customer a merchant name, share details to internal transaction monitoring tool, share details with 3rd party solution for enhanced merchant data. That means all Paymentology clients are having to handle this within their own domains rather than Paymentology address the issue on their platform which would serve multiple use cases. Always easier to merge multiple fields together than to try use parsing logic on a variable format.",,,,,,,,,,,Enhancement,,,,,,,,,,,1|hzxqof:,,,,,,,,,,Michael Ellery,,,,Generic,"----------------------------------------------

Michael Ellery, Sep 6, 2023, 14:47 (private)

Applies to all clients receiving fast",,,,,,,,,,Up to 1.000.000 transactions / month,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Existing,,,,,,,Client implements this on their side,,,,,Helps client avoid building parsing logic,,,,,603299.0,2023-09-07 08:59:48.597,,,"07/Sep/23 10:59 AM;5abca82e3cde3440ff0056b1;-- This notification was sent from JIRA PR-1575 to Zendesk Support ticket #603299 by Rohith Rajan. --

could you please give more details on the existing problems with DE 43 field 
""The format used in DE43 in the FAST from Paymentology doesn't appear to uphold the DE43 ISO field lengths and format so we can't even reliably use parsing logic.""

","07/Sep/23 11:03 AM;5abca82e3cde3440ff0056b1;[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] am not sure about the claim if we are actually changing the DE 43 values on our side but looking at the fst schema, we are splitting few other DE fields like DE3,DE55, 48 etc which has sub fields so they might be expecting the same on DE 43 as well ? 

{
  ""MESSAGE_TYPE"" : {
    ""Message_Type"" : ""0100"",
    ""Message_Desc"" : ""Authorisation Request""
  },
  ""SUMMARY"" : {
    ""TID"" : ""2237374892345000118"",
    ""RID"" : ""2317153"",
    ""PID"" : ""1069"",
    ""Client_Id"" : ""654321"",
    ""Transaction_Date_Time"" : ""16-02-2023 10:24:50"",
    ""Network"" : ""MC"",
    ""Spend_Type"" : ""ATM - Withdrawal"",
    ""Spend_Location"" : ""Business name  \\Address Line1  \\Address Line2\\CITY  \\COUNTRY"",
    ""Transaction_Amount"" : ""1"",
    ""Transaction_Currency"" : ""ISK"",
    ""Billing_Amount"" : ""1"",
    ""Billing_Currency"" : ""ISK"",
    ""Card_Use_Type"" : ""Chip"",
    ""Customer_Validation"" : ""Online Pin + ARQC "",
    ""Processor_Decision_Code"" : ""00"",
    ""Processor_Reason_Code"" : ""000"",
    ""Processor_Decision_Desc"" : ""Approve"",
    ""Merchant_Category"" : ""6011 - Financial Institutions--Automated Cash Disbursements "",
    ""Account_Id"" : ""999654321"",
    ""Customer_Ac"" : ""050126101010"",
    ""Total_Fee_Bill"" : ""0.0""
  },
  ""PROCESSOR_VALIDATIONS"" : {
    ""Pan_Check"" : ""PASS"",
    ""Pin_Check"" : ""PASS"",
    ""Expiry_Check"" : ""PASS"",
    ""Track_Check"" : ""PASS"",
    ""CVV_Type"" : ""4"",
    ""CVV_Check"" : ""BYPASS"",
    ""ARQC_Check"" : ""PASS"",
    ""3DS_Check"" : ""NA"",
    ""Test_Matrix"" : ""2447425042760480187"",
    ""Test_Results"" : ""45035996273704960"",
    ""Rules_Checked"" : """",
    ""Rules_Triggered"" : """",
    ""Rules_Decision"" : ""00""
  },
  ""ISO_MSG"" : {
    ""DE2"" : ""818654321"",
    ""DE3_1"" : ""01"",
    ""DE3_2"" : ""00"",
    ""DE3_3"" : ""00"",
    ""DE4"" : ""000000000100"",
    ""DE6"" : ""000000000100"",
    ""DE7"" : ""0216102449"",
    ""DE10"" : ""61000000"",
    ""DE11"" : ""000118"",
    ""DE12"" : ""102419"",
    ""DE13"" : ""0216"",
    ""DE14"" : ""2802"",
    ""DE15"" : ""0612"",
    ""DE16"" : ""0612"",
    ""DE18"" : ""6011"",
    ""DE22"" : ""051"",
    ""DE23"" : ""000"",
    ""DE26"" : ""04"",
    ""DE32"" : ""012345"",
    ""DE35"" : ""457710516D2802221000000***"",
    ""DE37"" : ""085000100001"",
    ""DE38"" : ""105887"",
    ""DE41"" : ""12345678"",
    ""DE42"" : ""123456789123456"",
    ""DE43"" : ""Business name  \\Address Line1  \\Address Line2\\CITY  \\COUNTRY"",
    ""DE48"" : {
      ""1"" : ""Z"",
      ""80"" : ""TV""
    },
    ""DE49"" : ""352"",
    ""DE51"" : ""352"",
    ""DE55"" : {
      ""82"" : ""5800"",
      ""95"" : ""0000040000"",
      ""9F10"" : ""010103250300DAC1"",
      ""9F27"" : ""80"",
      ""9F36"" : ""0007"",
      ""9F34"" : ""420100"",
      ""9F33"" : ""604020""
    },
    ""DE61"" : ""0000000000500826902101234"",
    ""DE63"" : ""MCC0110QH""
  },
  ""RULES"" : [ ]
}
","07/Sep/23 12:32 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Difficult to make any sort of assessment without real examples for the client, find it hard to believe we are seriously malforming DE-43 though the sample message you posted isn’t helpful in that it’s not respecting the format ",07/Sep/23 12:32 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:5abca82e3cde3440ff0056b1] ,13/Oct/23 6:01 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;No action required,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,06/Sep/23 2:47 PM
Re: 05 Do Not Honour Declines,PR-1550,110772,Task,Declined,PR,Product Request ,business,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,,,Normal,,William Dunne,557058:5363d7a1-da13-4012-8609-f44e54c1d062,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,29/Aug/23 10:41 AM,29/Aug/23 11:45 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,business-form,jira_automation_tag,jira_escalated,jira-zd-escalation,"----------------------------------------------

William Dunne, Aug 29, 2023, 10:41 (private)

@Michael for Mettle, and for the PIN retry 05 response code, enable_pin_retries_new_status_nwk flag should be enabled. It will start moving their cards over to using nwk_status 1006 instead of 1005, which will respond with the appropriate code",,Paymentology,,,,,,,,,,,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PR-1493,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@26dae7e8,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,Utility Warehouse,Europe,,,,,,,,,,,,,,,,,,,,,,,,,,,,,05 declines reduce because we have sent specific decline reasons,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Pro,,Banking.live,,,,,,,,,,,"05 declines are increasing rapidly for Utility Warehouse. Previously understood that this was a result of UW asking us to block all transactions on the card through force decline or void card general decline. However, in this ticket they have found the below examples where we have looked into it and found that there are specific decline reasons and the client would like these to be used rather than 05 https://paymentology.zendesk.com/agent/tickets/576068

2390635742216061029 -> Issuer not available
2392221795803227837 -> Postal code not matched
2392296321319632599 -> 3DS check failed due to which transaction got failed
2390742473445388545 -> Issuer not available
2391349445804698896 -> 3DS check failed due to which transaction got failed
2389665302216529454 -> Card status is inactive due to incorrect pin tries",,,,,,,,,,,Enhancement,,,,,,,,,,,1|hzxkb3:,,,,,,,,,,Michael Ellery,,,,Generic,"----------------------------------------------

William Dunne, Aug 29, 2023, 10:41 (private)

@Michael for Mettle, and for the PIN retry 05 response code, enable_pin_retries_new_status_nwk flag should be enabled. It will start moving their cards over to using nwk_status 1006 instead of 1005, which will respond with the appropriate code",,,,,,,,,,Up to 100.000 transactions / month,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Existing,,,,,,,We come up with any other reason than 05,,,,,Mastercard fines for excessive use of 05 declines and also clients do not have a view on what to advise their customers when it is a generic decline with no specific reason,,,,,598171.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,29/Aug/23 10:41 AM
Mettle - Advice Message in STIP,PR-1422,107313,Task,Declined,PR,Product Request ,business,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,,,High,,Dmitrijs,6271f38aa1de4100684fcf72,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,Paymentology,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,03/Jul/23 12:17 PM,24/Aug/23 5:47 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,business-form,jira_automation_tag,jira_escalated,jira-zd-escalation,"----------------------------------------------

Michael Ellery, 21 Jun 2023, 10:40 (private)

Would benefit all clients",,Christien Ackroyd,Dmitrijs,Paymentology,,,,,,,,,60fedcf83900e60070792cfe,6271f38aa1de4100684fcf72,557058:036a93c3-10c4-42a6-b60d-fd93a28c71f5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@a54fbab,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,Mettle,Europe,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Include all STIP outcomes in advice messages,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Enterprise,,Banking.live,,,,,,,,,,,"For some STIP events such as when Mettle's response is slow Paymentology provides an advice message (message type 0120) on the fast endpoint, however, for some STIP messages when there is a disconnection between us and the client the Fast Message isn't saved and we do not send an advice message. This makes it impossible for Mettle to manage this situation and know what is going on",,,,,,,,,,,Enhancement,,,,,,,,,,,1|hzx4in:,,,,,,,,,,Michael Ellery,,,,Generic,"----------------------------------------------

Michael Ellery, 21 Jun 2023, 10:40 (private)

Would benefit all clients",,,,,,,,,,Up to 100.000 transactions / month,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Existing,,,,,,,Mettle has to manually check on paycontrol,,,,,"Mettle are unaware of what is going on and customer agents are in the dark, manually checking on paycontrol is not a scalable solution",,,,,555632.0,2023-07-05 09:13:00.319,,,"05/Jul/23 11:13 AM;60fedcf83900e60070792cfe;[~accountid:6271f38aa1de4100684fcf72] likely for Clearing team, not sure if this is a bug or a potential enhancement. Please review and process or decline unless additional info is required from [~accountid:6273fc10807e0000691d5dee] ",24/Aug/23 5:47 PM;6271f38aa1de4100684fcf72;Let’s return to this question if this type of issue will be frequent and/or on regular basis. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,03/Jul/23 12:17 PM
BL : New Decline Response Code for Garbage Transactions,PMGMT-988,136130,Task,Backlog,PMGMT,Product - Product Mgmt Team,software,Rohith Rajan,5abca82e3cde3440ff0056b1,,,High,,,,Shehroz Ahmed Siddiqui,632872d207a27ebeff12903b,Shehroz Ahmed Siddiqui,632872d207a27ebeff12903b,10/Sep/24 11:10 PM,10/Sep/24 11:15 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"*Message from Mettle:* 
When I review our performance using Mastercard data which monitors that our usage of DE39 = 05 for authorisations remains below 5%, I am able to look at samples of issuer responses where 05 was used as a decline code in the response. I looked at 7 examples and for 6 of these, they were 'garbage' product transactions i.e. payment attempts using a PAN that belongs to our BIN, but doesn't map to a valid card. In these cases, Paymentology declines using DE39 = 05 These are still within the compliance threshold, but if we had a sustained BIN attack, we could easily breach the compliance target. I would like to suggest to Paymentology that for 'garbage' product transactions, Paymentology explore using an alternative decline response code.

*What to do:*
Change response code for garbage transaction to : 

14 = Invalid card number",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,AUTH-844,,,,,,,PR-1966,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3908c21d,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i01e0x:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,10/Sep/24 11:10 PM
[PT Internal] PayScheduler task encountered error com.sun.mail.smtp.SMTPSendFailedException: 432 4.3.2 Concurrent connections limit exceeded when sending email,PMGMT-165,97150,Task,Backlog,PMGMT,Product - Product Mgmt Team,software,Rohith Rajan,5abca82e3cde3440ff0056b1,,,Normal,,Rohith Rajan,5abca82e3cde3440ff0056b1,Dominic Wee,629a26eb2eafc9006eeddba3,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,01/Dec/22 3:32 AM,24/Apr/24 4:34 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"As per checking, task had completed successfully but failed during sending email notification.
This had occurred for *PROD Mettle* environment.
Below exception found in log.

2022-11-28 00:00:01.155 [Scheduler_Worker-10] ERROR ProcessSettlementMC - error while checking files processed in the day..com.sun.mail.smtp.SMTPSendFailedException: 432 4.3.2 Concurrent connections limit exceeded. Visit [https://aka.ms/concurrent_sending|https://aka.ms/concurrent_sending] for more information. [Hostname=LO2P123MB7019.GBRP123.PROD.OUTLOOK.COM] at com.sun.mail.smtp.SMTPTransport.issueSendCommand(SMTPTransport.java:2358) at com.sun.mail.smtp.SMTPTransport.finishData(SMTPTransport.java:2110) at com.sun.mail.smtp.SMTPTransport.sendMessage(SMTPTransport.java:1316) at javax.mail.Transport.send0(Transport.java:255) at javax.mail.Transport.send(Transport.java:124) at com.paymentology.payscheduler.modules.monitoring.Utility.sendEmail(Utility.java:450) at com.paymentology.payscheduler.modules.monitoring.Utility.sendEmail(Utility.java:454) at com.paymentology.payscheduler.modules.clearing.mastercard.ProcessSettlementMC.notifyIfNoFilesInADay(ProcessSettlementMC.java:299) at com.paymentology.payscheduler.modules.clearing.mastercard.ProcessSettlementMC.ClearPayInitial(ProcessSettlementMC.java:130) at com.paymentology.payscheduler.schedulerjobs.JobProcessSettlementMC.execute(JobProcessSettlementMC.java:53) at org.quartz.core.JobRunShell.run(JobRunShell.java:202) at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)

* Please see Zendesk Support tab for further comments and attachments.

Slack thread: [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1669593744631019|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1669593744631019|smart-link]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@1eef2262,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvme7:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2022-12-15 00:18:14.737,,,"01/Dec/22 3:35 AM;629a26eb2eafc9006eeddba3;The same exception had occurred in DC environment during GenerateManagementReport task on 1/12/2022.
See [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1669856382367039|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1669856382367039|smart-link]","01/Dec/22 3:52 AM;629a26eb2eafc9006eeddba3;For the GenerateManagementReport task in DC environment, reports were generated during the scheduled run but failed to send.
So I had rerun the job to regenerate the reports and email sent out successfully.","15/Dec/22 2:18 AM;61d7273c125b120071fe08fa;[~accountid:60fedcdc75ad960069b85175] [~accountid:5abca82e3cde3440ff0056b1] [~accountid:60efedaa4257a90070c63774] We have encountered the same error on DC PS for job ProcessSettlementMC.

[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1671062881082869|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1671062881082869|smart-link]","22/Dec/22 2:07 AM;61d7273c125b120071fe08fa;[~accountid:60fedcdc75ad960069b85175] [~accountid:5abca82e3cde3440ff0056b1] [~accountid:60efedaa4257a90070c63774] We have encountered the same error on Payscheduler for below jobs.

SHARED02: *ProcessSettlementVISA*

[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1671667266339679|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1671667266339679|smart-link]

DC: *ProcessSettlementMC*
[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1671667732723969|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1671667732723969|smart-link]",17/Jan/23 2:07 AM;61d7273c125b120071fe08fa;Hi [~accountid:60fedcdc75ad960069b85175] [~accountid:5abca82e3cde3440ff0056b1] do we have updates on this?,"30/Jan/23 7:30 AM;5abca82e3cde3440ff0056b1;[~accountid:61d7273c125b120071fe08fa]  working with the implementation team to verify if we can switch our email SMTP provider 
[https://paymentology.slack.com/archives/G03SNMMV4/p1669873829672799|https://paymentology.slack.com/archives/G03SNMMV4/p1669873829672799|smart-link] ",30/Jan/23 7:32 AM;61d7273c125b120071fe08fa;Thanks [~accountid:5abca82e3cde3440ff0056b1] . Please keep us posted on the Jira ticket.,19/May/23 3:00 AM;629a26eb2eafc9006eeddba3;Hi [~accountid:5abca82e3cde3440ff0056b1] Could you share any update on this please ?,"22/May/23 8:36 AM;5abca82e3cde3440ff0056b1;this is  a config change and it has to be done by teams responsible for UAT environment and then production environments  [~accountid:629a26eb2eafc9006eeddba3] 

this is not a dev related task, I personally reached out to the SD team leads and few other people from infra and no one responding. So to summarize 

1. we have SMTp config settings in paycontrol / payscheduler config files 
2. Find out the sendgrid config settings ( this should be with Ops/Infra  team
3. first we have to test in UAT, so change the relevant settingsin UAT 

4. test this for sometime and confirm it is working fine

5. replicate the settings to other production environments ",24/Apr/24 4:34 PM;60fedcf83900e60070792cfe;[~accountid:5abca82e3cde3440ff0056b1] kindly advise if this ticket is still relevant,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,01/Dec/22 3:32 AM
BL: 3DS Enrolment for BaaS,PMGMT-83,109413,Sub-task,On Hold,PMGMT,Product - Product Mgmt Team,software,Rohith Rajan,5abca82e3cde3440ff0056b1,,,Normal,,Desiree Chow,6127cacc3ef46a007079f2b3,Desiree Chow,6127cacc3ef46a007079f2b3,Desiree Chow,6127cacc3ef46a007079f2b3,08/Aug/23 4:03 AM,13/Mar/24 3:29 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,business-form,jira_automation_tag,jira_escalated,jira-zd-escalation,"Michael Ellery, Jul 12, 2023, 14:31 (private)

Applies to all clients enrolling cards through 3DS via Paymentology, for BaaS clients this is a must
Problem / Opportunity

In the enrolment API https://developer.paymentology.com/reference/pws_enable_card_3ds it doesn't support the client being able to specify the Financial Institute that a card should be enrolled under. On a call with Apata, Apata made clear that this information had to be provided to understand which configuration should be used from the Apata side re rules, UI etc.

I can see the field is returned in the responses from Apata. 

Mettle are offering a BaaS product in the next few months and having this available is a deal breaker to them using Apata or not
What would be the impact if we do NOT process this request?


Mettle doesn't use Apata and future BaaS clients will request the same as a condition
Desired outcome


Paymentology enrolment API supports the currently being able to specify the FI that a card should be enrolled under.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PR-1463,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5f5e5cfc,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Implement and enhance Apata (ACS) integration,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzxg6f:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-12-08 10:37:08.524,,,08/Dec/23 12:37 PM;60fedcf83900e60070792cfe;[~accountid:6127cacc3ef46a007079f2b3] is this Jira still valid? Presume that the client would be able to set up different Financial Institutions and segregate at a product level and also configure customisations at this level on the Apata platform,"11/Dec/23 2:40 AM;6127cacc3ef46a007079f2b3;heya [~accountid:60fedcf83900e60070792cfe] indeed - this is something we rejected the PR and backlogged the story as client ideas. so no client is waiting for it, will be good to study the use cases of our clients and see if this is something that will benefit more of them. or reject this story but note it somewhere so we can revisit this “client ideas”.  ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,123081,PMGMT-387,3DSecure API Enhancements,In Progress,11/Jan/24 9:23 AM
All Locations Scan Q1 2026 Mettle Servers OS Patching,PLTI-5772,192251,Task,Backlog,PLTI,PLT - Infra Ops,software,Faizan.Qureshi,601a574f332cbe007013fb6c,Project for Platform Engineering - Infra Teams,,Normal,,Thamsanqa Qofela,557058:02ca33b7-4178-4972-b264-fbfc803b29aa,Tamer Soliman,712020:1dd21fc5-5f79-48c3-9dc9-52aa64b3c218,Thamsanqa Qofela,557058:02ca33b7-4178-4972-b264-fbfc803b29aa,08/Jan/26 4:27 PM,09/Jan/26 2:12 PM,,,,,,,,,,,,,,,,,,,,,,,,20/Feb/26 12:00 AM,0,infra2025,PLT2025,,,"Hi [~accountid:601a574f332cbe007013fb6c] kindly for Approval for Q4 OS Patching, will present in CCM

*Activity detail*
Change Plan : *Q4 2025 Mettle Servers OS Patching*
Change on Device/System: *Mettle*
Environment : *Prod*
Impact Client/Service: *yes*
Configuration tested in any environment : *yes*
Rollback : *restore the old repo*
Risktime: *2h*
Downtime: *15m*


[~accountid:60fedd468c15ca006ffc3ef1] [~accountid:557058:02ca33b7-4178-4972-b264-fbfc803b29aa]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-1804,,,,,,,,PLTI-4584,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@7306fef3,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07kxg:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25/Nov/25 12:00 AM,,,,,,,,,,,,,5e4c3dc7-6b4a-4186-916f-cdc504c06e16,PLT - SysOps,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,192225,PLTI-5746,Q1-2026_OS Quarterly Patching for Banking.live internal Infra.,To Do,08/Jan/26 4:27 PM
Mettle DR OS Patching,PLTI-5764,192243,Sub-task,Backlog,PLTI,PLT - Infra Ops,software,Faizan.Qureshi,601a574f332cbe007013fb6c,Project for Platform Engineering - Infra Teams,,Normal,,Thamsanqa Qofela,557058:02ca33b7-4178-4972-b264-fbfc803b29aa,Tamer Soliman,712020:1dd21fc5-5f79-48c3-9dc9-52aa64b3c218,Thamsanqa Qofela,557058:02ca33b7-4178-4972-b264-fbfc803b29aa,08/Jan/26 4:27 PM,08/Jan/26 4:48 PM,,,,,,,,,,,,,,,,,,,,,,,,31/Oct/25 12:00 AM,0,infra2025,,,,"OS Patching

{noformat}pt-mettle-dr-lb01.paymentology.org
pt-mettle-dr-payapi01.paymentology.org
pt-mettle-dr-paycore-db01.paymentology.org
pt-mettle-dr-paykey-db01.paymentology.org
pt-mettle-dr-paylog-db01.paymentology.org
pt-mettle-dr-paytok-db01.paymentology.org
pt-mettle-dr-pctrl01.paymentology.org
pt-mettle-dr-pks01.paymentology.org
pt-mettle-dr-ppwr01.paymentology.org
pt-mettle-dr-proute1.paymentology.org
pt-mettle-dr-psch01.paymentology.org
pt-mettle-dr-sftp01.paymentology.org
pt-borgun-dr-sftp01.paymentology.org{noformat}

[~accountid:60fedd468c15ca006ffc3ef1] [~accountid:557058:02ca33b7-4178-4972-b264-fbfc803b29aa] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PLTI-4899,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@41f49c0d,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07kvo:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,29/Oct/25 12:00 AM,,,,,,,,,,,,,5e4c3dc7-6b4a-4186-916f-cdc504c06e16,PLT - SysOps,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,192241,PLTI-5762,"All Locations Scan Q1 2026  AZ DR -  MOX, METTLE, Borgun, SH02Servers OS Patching",To Do,08/Jan/26 4:27 PM
"All Locations Scan Q1 2026  AZ DR -  MOX, METTLE, Borgun, SH02Servers OS Patching",PLTI-5762,192241,Task,Backlog,PLTI,PLT - Infra Ops,software,Faizan.Qureshi,601a574f332cbe007013fb6c,Project for Platform Engineering - Infra Teams,,Normal,,Thamsanqa Qofela,557058:02ca33b7-4178-4972-b264-fbfc803b29aa,Tamer Soliman,712020:1dd21fc5-5f79-48c3-9dc9-52aa64b3c218,Thamsanqa Qofela,557058:02ca33b7-4178-4972-b264-fbfc803b29aa,08/Jan/26 4:27 PM,09/Jan/26 2:12 PM,,,,,,,,,,,,,,,,,,,,,,,,20/Feb/26 12:00 AM,0,infra2025,PLT2025,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PLTI-4578,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6a49bc97,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07kv8:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,27/Oct/25 12:00 AM,,,,,,,,,,,,,5e4c3dc7-6b4a-4186-916f-cdc504c06e16,PLT - SysOps,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,192225,PLTI-5746,Q1-2026_OS Quarterly Patching for Banking.live internal Infra.,To Do,08/Jan/26 4:27 PM
METTLE AZURE DR CLIENT CATALOGUE,PLTI-3258,166585,Sub-task,Backlog,PLTI,PLT - Infra Ops,software,Faizan.Qureshi,601a574f332cbe007013fb6c,Project for Platform Engineering - Infra Teams,,Normal,,,,Adnan Ali,60fc636052162b00681d341b,Adnan Ali,60fc636052162b00681d341b,14/Jul/25 12:02 PM,14/Nov/25 7:27 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@75f1b399,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i05b3k:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,NW-24-FEB-10-MAR,NW-10-MAR-24-MAR,,,,,,,,,,,,,,,,,,,,,,,,,,49167870-fbd1-4337-b708-c191282fb937,PLT - Network Ops,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,137126,PLTI-218,CLIENTS CATALOGUE,To Do,14/Jul/25 12:02 PM
Network Accessto Mettle PROD instance for Migrations team,PLTI-398,129577,Task,In Progress,PLTI,PLT - Infra Ops,software,Faizan.Qureshi,601a574f332cbe007013fb6c,Project for Platform Engineering - Infra Teams,,Normal,,Olufemi.Adetiwa,61e885fc9d17400069e6d5e8,Olufemi.Adetiwa,61e885fc9d17400069e6d5e8,Olufemi.Adetiwa,61e885fc9d17400069e6d5e8,24/Jun/24 5:31 PM,04/Apr/25 3:25 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Hello Team,

Kindly support with access to Mettle Production via the Jump host, and the access to Paycontrol for the migrations team below.

* Server Access
* PayControl access

See email below.

[linh@paymentology.com|mailto:linh@paymentology.com]
[kit@paymentology.com|mailto:kit@paymentology.com]

[https://paymentology.atlassian.net/browse/OPS-16515|https://paymentology.atlassian.net/browse/OPS-16515|smart-link] 

[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] [~accountid:6328729388ed2ebef978552f] [~accountid:60fc636052162b00681d341b]  [~accountid:61d7273d7c6f98007065e9d7] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,OPS-16515,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@ccec3b,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i00i2z:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,5e4c3dc7-6b4a-4186-916f-cdc504c06e16,PLT - SysOps,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-06-25 14:59:57.532,,,25/Jun/24 4:59 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - OPS-16515 has got status Done,"25/Jun/24 5:34 PM;61e885fc9d17400069e6d5e8;Hello [~accountid:60fedd468c15ca006ffc3ef1] 

Possible to please support with this request for the migrations team","25/Jun/24 6:29 PM;60fedd468c15ca006ffc3ef1;HI [~accountid:61e885fc9d17400069e6d5e8] ,

both users have access to Azure PROD  [~accountid:61d7273d7c6f98007065e9d7] [~accountid:61aa36d8b0b630006a46628e] 

username are linh.nguyen & kit.yeung

. they access the oaycontrol once logged in

[~accountid:712020:1dd21fc5-5f79-48c3-9dc9-52aa64b3c218] [~accountid:557058:02ca33b7-4178-4972-b264-fbfc803b29aa] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,97140,PLTI-726,[BAU] Infra - Banking.live Operation tasks which are not related to any Project.,In Progress,25/Jun/24 6:26 PM
Defining and validating certificates for PostgreSQL standby servers,PLTDBA-1062,177712,Task,On Hold,PLTDBA,PLT - DBA Ops,software,banu.akkus,632872d27f85f167779c13ed,,,Normal,,naveen.mallela,712020:acd921e1-3afc-4c58-802a-1b1e0077d97c,banu.akkus,632872d27f85f167779c13ed,banu.akkus,632872d27f85f167779c13ed,29/Sep/25 1:56 PM,02/Feb/26 10:46 AM,,,,,,,,,,,,,,,,,,,,,,,,28/Feb/26 12:00 AM,0,,,,,"*Non-prod envs:*

* OM uat
* ISB uat
* Azure shared UAT
* AWS uat
* OCI - D360 UAT

 

*Prod envs:*

* ADQ
* BAE
* -BOJ-
* -ISB-
* METTLE
* MOX
* SH02
* AZURE UAE
* TWEEQ
* DERAYAH
* -OM-
* TYME
* SHEU
* SH01",,banu.akkus,Mathieu Cornille,naveen.mallela,,,,,,,,,632872d27f85f167779c13ed,557058:bc4cfaff-acbf-41af-be56-a436f655647d,712020:acd921e1-3afc-4c58-802a-1b1e0077d97c,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-1508,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@24458652,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i069wc:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,978465e5-b4b6-4d4b-8ca9-20bf44d754d5,PLT - DBA,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-10-01 05:14:47.334,,,"01/Oct/25 7:14 AM;712020:acd921e1-3afc-4c58-802a-1b1e0077d97c;ISB :
SSL certificates generated and shared with [~accountid:61f80302845d670071f2138e] . He is facing LDAP error while he was access DB with new certs. I have fixed now. It should work.","15/Oct/25 8:42 AM;712020:acd921e1-3afc-4c58-802a-1b1e0077d97c;SSL certificates generated for BOJ, OM Salve DBs and shared with [~accountid:61f80302845d670071f2138e] for verification.","17/Oct/25 11:31 AM;557058:bc4cfaff-acbf-41af-be56-a436f655647d;Roll-out Plan:

* OM implementation using SSL certs for week of Oct 27th
* If that goes well (ie stable after a week) , proceed with all PROD envs (either SSL certs or not) starting with lower volumes environments first.
* If it doesn’t go well, we will exclude SSL certs environments and only implement on PROD environments that do NOT implement SSL certs, starting with lower volumes environments first.

cc [~accountid:632872d27f85f167779c13ed] [~accountid:61f80302845d670071f2138e] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,165974,PEDA-246,BL - Tactical Reporting off PayCore DB - Foundation,In Progress,29/Sep/25 1:56 PM
Golden Datamodel deployment on legacy PayLog environments,PLTDBA-1041,166893,Task,Backlog,PLTDBA,PLT - DBA Ops,software,banu.akkus,632872d27f85f167779c13ed,,,Normal,,,,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,15/Jul/25 8:27 PM,01/Dec/25 12:05 PM,,,,,,,,,,,,,,,,,,,,,,,,31/Dec/25 12:00 AM,0,,,,,"Apply golden datamodel changes to all PROD BL PayLog instances. We should start with UAT environments, wait for a week and then move to deploying to the PROD environments. Mettle is the top client for which we need the changes applied, it is currently the migration to BL 3.0 hero client, ie the first client who will be migrated.

List of changes pulled from [https://github.com/Paymentology/paylogdb/pull/47/files|https://github.com/Paymentology/paylogdb/pull/47/files] -  [~accountid:60efedaa4257a90070c63774] please confirm before this is moved into ToDo/to the PLTDBA project.

* public.debug_log  - existing id column as primary key
* public.log_paykey_trace_old - existing pks_tr_log_id as primary key
* public.log_paypower_timings - new id column (type bigserial) as primary key
* public.log_paypower_timings_details - new id column (type bigserial) as primary key
* public.log_payroute_timings - new id column (type bigserial) as primary key
* public.log_payroute_timings_details - new id column (type bigserial) as primary key
* public.log_payscheduler_error - existing ps_er_log_id as primary key
* public.log_payscheduler_trace_json - new id column (type bigserial) as primary key
* public.logging_event_exception - new id column (type bigserial) as primary key
* public.logging_event_property - new id column (type bigserial) as primary key
* public.m_countries - new id column (type serial) as primary key
* public.p_clients - new id column (type serial) as primary key
* public.p_product  - new id column (type serial) as primary key
* public.postgres_log - new id column (type serial) as primary key
* public.rid_temp - new id column (type serial) as primary key
* public.roh_null_tran_time_out - existing id column as primary key
* public.roh_tt_pks_log_final - new id column (type serial) as primary key",,banu.akkus,Ewan Mackie,Mathieu Cornille,Rohit Thapa,,,,,,,,632872d27f85f167779c13ed,557058:afe3370e-7d7f-4272-9a06-c38b0253fa11,557058:bc4cfaff-acbf-41af-be56-a436f655647d,60efedaa4257a90070c63774,,,,,,,,,,,,,,,,PEDA-322,PEDA-431,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5a9980bb,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i0524q:zz1i,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,978465e5-b4b6-4d4b-8ca9-20bf44d754d5,PLT - DBA,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-09-18 13:26:51.265,,,"18/Sep/25 3:26 PM;60efedaa4257a90070c63774;Hi [~accountid:557058:bc4cfaff-acbf-41af-be56-a436f655647d], I can confirm the above provided list is correct.","19/Sep/25 12:00 PM;557058:bc4cfaff-acbf-41af-be56-a436f655647d;We identified there might be a problem adding the new column at the beginning of the table definitions as there is code relying on column order, we need to first update Liquibase to add those new columns at the end of the table definition.","23/Sep/25 11:24 AM;557058:afe3370e-7d7f-4272-9a06-c38b0253fa11;[~accountid:557058:bc4cfaff-acbf-41af-be56-a436f655647d] just to clarify, when and where does this need to roll out? To all environments, or Mettle. only? Before or after BL3.0?

cc: [~accountid:632872d27f85f167779c13ed] [~accountid:61f80302845d670071f2138e] ",23/Sep/25 12:41 PM;557058:bc4cfaff-acbf-41af-be56-a436f655647d;[~accountid:557058:afe3370e-7d7f-4272-9a06-c38b0253fa11] [~accountid:632872d27f85f167779c13ed] This needs to be rolled out to all legacy environments as primary keys on all tables is a pre-requisite to the data being able to be copied via DMS to AWS (either VM or RDS). I highlighted Mettle because it is the first client that is planned to be migrated.,"23/Sep/25 1:43 PM;632872d27f85f167779c13ed;Hi [~accountid:61f80302845d670071f2138e] , could you please help us for planning ? Thanks","20/Oct/25 11:13 AM;557058:bc4cfaff-acbf-41af-be56-a436f655647d;On hold until changes deployed and tested on BL 3.0 UAT environment first, then BL legacy UAT environments.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,179034,PLTDBA-1090,Golden Data Model Deployment on BL3.0 UAT Environment (Hero PalawanPay Client),To Do,01/Dec/25 12:05 PM
mettle - Archiving of t_fraud_rules_triggered_old ,PLTDBA-586,156452,Task,In Review,PLTDBA,PLT - DBA Ops,software,banu.akkus,632872d27f85f167779c13ed,,,Normal,,Julien Andonov,712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f,banu.akkus,632872d27f85f167779c13ed,banu.akkus,632872d27f85f167779c13ed,09/Apr/25 5:03 PM,02/Feb/26 11:36 PM,,,,,,,,,,,,,,,,,,,,,,,,28/Feb/26 12:00 AM,0,,,,,"In the subtasks under this epic, partitioning has been implemented for each environment (except BOJ, Marco Polo).
Data older than six months has been added as a separate partition {{t_fraud_rules_triggered_old}} , and future partitions have been created in the format {{t_fraud_rules_triggered_y2025m1}}, and so on.

The objective of this task is to ensure that partitions containing data older than six months are automatically archived.
Similar to the partitioning process, the archiving implementation will also start with non-production environments.

*Steps:*

* Detach the partition containing data older than six months
* Copy the partition to the bucket
* Truncate the corresponding partition
* Ensure that these operations run automatically each month",,banu.akkus,Julien Andonov,,,,,,,,,,632872d27f85f167779c13ed,712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f,,,,,,,,,,,,,,,,,,PLTI-5131,PLTI-5605,PLTI-6021,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5515cd64,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{pullrequest={dataType=pullrequest, state=DECLINED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2025-10-17T13:34:04.000+0200"",""stateCount"":1,""state"":""DECLINED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitHub"":{""count"":1,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i0479w:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,978465e5-b4b6-4d4b-8ca9-20bf44d754d5,PLT - DBA,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-09-25 11:17:46.161,,,"09/Apr/25 5:10 PM;632872d27f85f167779c13ed;Hi [~accountid:712020:3ac3e23f-a295-49fa-92c8-ccefbdd62c7f] Please create the necessary tickets for the system team to set up these buckets, and also open the subtickets to roll out the above operations across the environments, thanks. ","25/Sep/25 1:17 PM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Logic is ready, but cannot test it as I am busy (always) with other things.","22/Oct/25 1:42 PM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Restoring ISB in order to test a solution:


{noformat}ash-4.2$ time pgbackrest --stanza=isb_paycore --delta restore --log-level-console=info --archive-mode=off --pg1-path=/bldata/isb_paycore_datadir   --tablespace-map-all=/bldata/isb_paycore_tbs   --process-max=4
2025-10-22 11:40:18.350 P00   INFO: restore command begin 2.52.1: --archive-mode=off --delta --exec-id=26320-2f9333f4 --log-level-console=info --log-level-file=detail --pg1-path=/bldata/isb_paycore_datadir --process-max=4 --repo1-host=10.10.152.5 --spool-path=/bldata/spool --stanza=isb_paycore --tablespace-map-all=/bldata/isb_paycore_tbs
WARN: --delta or --force specified but unable to find 'PG_VERSION' or 'backup.manifest' in '/bldata/isb_paycore_datadir' to confirm that this is a valid $PGDATA directory. --delta and --force have been disabled and if any files exist in the destination directories the restore will be aborted.
2025-10-22 11:40:19.170 P00   INFO: repo1: restore backup set 20250803-182525F_20251021-182503I, recovery will start at 2025-10-21 18:25:03
2025-10-22 11:40:19.170 P00   INFO: remap data directory to '/bldata/isb_paycore_datadir'
2025-10-22 11:40:19.170 P00   INFO: map tablespace 'pg_tblspc/16400' to '/bldata/isb_paycore_tbs/bldata'
{noformat}","29/Oct/25 1:30 PM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Document created on:
[https://paymentology.atlassian.net/wiki/spaces/TS/pages/9119498258/Partition+Data+recycle|https://paymentology.atlassian.net/wiki/spaces/TS/pages/9119498258/Partition+Data+recycle|smart-link] ",29/Oct/25 1:31 PM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Submitted process for review before proceeding.,"07/Nov/25 5:19 PM;632872d27f85f167779c13ed;hi [~accountid:712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f] , your document looks good to me. Please proceed with non prod env and inform service delivery team before each env. ",17/Nov/25 10:46 PM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Blocked by: https://paymentology.atlassian.net/browse/PLTI-5131,"17/Nov/25 10:46 PM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;{noformat}#AZURE-UAT
pt-uat-db01.paymentology.pvt -> Done
pt-qa1-db01.paymentology.pvt -> Done
pt-borgun-uat-paycore-db01.paymentology.pvt - archive_created - (Connectivity issues) 172.18.120.10 <-> 172.24.4.68
PT-PERFT-DB01

#OCI
twq-stg-paycore-db01.paymentology.sys - archive_created - (Connectivity issues) - 172.24.2.9 <-> 10.18.18.4
dh-uat-paycore-db01.paymentology.sys - archive_created - (Connectivity issues) - 172.24.2.9 <-> 10.49.3.4

#AWS-UAT
sh-fk-pp-cdb1.paymentology.local - archive_created - (Connectivity issues) - 192.168.107.85 <-> 172.16.102.4
pft-db-vm-01.paymentology.local - archive_created - No backup server

om-sa-uat-pcore-db1.paymentology.local  - Not partitioned - No backup server
bl-aws-uat-pcore-db01.paymentology.local - Not partitioned - 192.168.122.58 <-> 172.16.102.4
bl-fk-dev1-db1.paymentology.local - No partitioned - No backup server
pty-dev.test1.paymentology.local - No _OLD partition - No backup server
pty-qa-db1.paymentology.local - No _OLD partition - No backup server
pt-poc-db01.paymentology.local - No DB
pt-poc-db02.paymentology.local - No DB
pt-poc-db03.paymentology.local - No DB
pt-poc-db04.paymentology.local - No DB
pro-fk-uat-cdb1.paymentology.local - No _OLD partition
pro-fk-uat-cdb2.paymentology.local - No _OLD partition
{noformat}","11/Dec/25 10:10 AM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Still waiting on [~accountid:712020:1dd21fc5-5f79-48c3-9dc9-52aa64b3c218] for the connection to be allowed. Last time I tried, port 5432 was not possible.",11/Dec/25 10:11 AM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Blocked by connection to the repo on port 5432,"13/Jan/26 10:06 AM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;{noformat}#AZURE-UAT
pt-uat-db01.paymentology.pvt -> Done
pt-qa1-db01.paymentology.pvt -> Done
pt-borgun-uat-paycore-db01.paymentology.pvt - Done

#OCI
twq-stg-paycore-db01.paymentology.sys - archive deleted - DONE
dh-uat-paycore-db01.paymentology.sys - archive deleted - DONE

#AWS-UAT
sh-fk-pp-cdb1.paymentology.local - archive_created - (Connectivity issues) - 192.168.107.85 <-> 172.16.102.4
pft-db-vm-01.paymentology.local - archive_created - No backup server{noformat}",14/Jan/26 5:48 AM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Mattle detachment performed,"28/Jan/26 1:57 PM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;As requested, we need to test the connection and time which will take for the transfer:
[https://paymentology.atlassian.net/browse/PLTI-6021|https://paymentology.atlassian.net/browse/PLTI-6021|smart-link] ","02/Feb/26 10:49 AM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;The detachment takes:


{noformat}aycore_shared02=# ALTER TABLE t_fraud_rules_triggered detach partition t_fraud_rules_triggered_old;
ALTER TABLE
Time: 139.340 ms
paycore_shared02=# ALTER TABLE t_fraud_rules_triggered_old rename to t_fraud_rules_triggered_archive;
ALTER TABLE
Time: 53.443 ms
{noformat}",02/Feb/26 10:50 AM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Currently exporting to pgbackrest server,"02/Feb/26 7:40 PM;712020:b53e5a94-8dec-497c-8f97-0d1b5b018e3f;Export completed after around 6 hours:


{noformat}bluser@pt-prod-db-backup02 Shared02_Backups]$ time pg_dump -U ""database_automation"" -h 10.22.6.4 -d paycore_shared02 -t t_fraud_rules_triggered_archive -Fc > /datadisk/Shared02_Backups/t_fraud_rules_triggered_archive_$(date +%F).dump
Password:


[remote detached from 24155.pts-3.pt-prod-db-backup02]
[bluser@pt-prod-db-backup02 Shared02_Backups]$
[bluser@pt-prod-db-backup02 Shared02_Backups]$ stat t_fraud_rules_triggered_archive_2026-02-02.dump
  File: ‘t_fraud_rules_triggered_archive_2026-02-02.dump’
  Size: 73184907268     Blocks: 142939296  IO Block: 4096   regular file
Device: fd00h/64768d    Inode: 31195143    Links: 1
Access: (0664/-rw-rw-r--)  Uid: ( 1001/  bluser)   Gid: ( 1001/  bluser)
Access: 2026-02-02 09:57:57.329706170 +0000
Modify: 2026-02-02 16:15:26.818477208 +0000
Change: 2026-02-02 16:15:26.818477208 +0000
 Birth: -
{noformat}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,141706,PLTDBA-121,Banking Live - Partition large tables to support to reduce impact Long Running Queries,In Progress,02/Feb/26 7:41 PM
Golden Datamodel deployment on legacy PayKey environments,PEDA-300,166892,Story,Backlog,PEDA,PE - Core - Data Architecture,software,Ewan Mackie,557058:afe3370e-7d7f-4272-9a06-c38b0253fa11,,,Normal,,,,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,15/Jul/25 8:26 PM,01/Dec/25 12:05 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Apply golden datamodel changes to all PROD BL PayKey instances. We should start with UAT environments, wait for a week and then move to deploying to the PROD environments. Mettle is the top client for which we need the changes applied, it is currently the migration to BL 3.0 hero client, ie the first client who will be migrated.

List of changes pulled from [https://github.com/Paymentology/paykeydb/pull/44|https://github.com/Paymentology/paykeydb/pull/44|smart-link]   -  [~accountid:60efedaa4257a90070c63774] please confirm in the comments before this is moved into ToDo/to the PLTDBA project.

* dbo.p_pk_salt, existing id column changed from integer to serial as primary key
* dbo.p_pk_temp, new id column of type serial as primary key
* dbo.p_pk_tempmek, new id column of type serial as primary key
* public.dbstats, existing id column as primary key
* public.p_audit_log, existing id column as primary key
* public.p_pk_salt, existing id column as primary key
* public.p_pk_temp, new id column of type serial as primary key
* public.p_pk_tempmek, new id column of type serial as primary key
* public.puser_id, new id column of type serial as primary key
* public.temp_pk_klist, new id column of type serial as primary key",,Mathieu Cornille,Rohit Thapa,,,,,,,,,,557058:bc4cfaff-acbf-41af-be56-a436f655647d,60efedaa4257a90070c63774,,,,,,,,,,,,,,,,,,PEDA-321,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@41fe8f18,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i0524q:zzj,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,978465e5-b4b6-4d4b-8ca9-20bf44d754d5,PLT - DBA,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,179034,PLTDBA-1090,Golden Data Model Deployment on BL3.0 UAT Environment (Hero PalawanPay Client),To Do,15/Jul/25 8:26 PM
Golden Datamodel deployment on legacy PayTok environments,PEDA-272,166724,Story,Backlog,PEDA,PE - Core - Data Architecture,software,Ewan Mackie,557058:afe3370e-7d7f-4272-9a06-c38b0253fa11,,,Normal,,,,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,Mathieu Cornille,557058:bc4cfaff-acbf-41af-be56-a436f655647d,15/Jul/25 10:17 AM,01/Dec/25 12:05 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Apply golden datamodel changes to all PROD BL PayTok instances. We should start with UAT environments, wait for a week and then move to deploying to the PROD environments. Mettle is the top client for which we need the changes applied, it is currently the migration to BL 3.0 hero client, ie the first client who will be migrated.

List of changes pulled from [https://github.com/Paymentology/paytokdb/pull/608/files|https://github.com/Paymentology/paytokdb/pull/608/files] - [~accountid:60efedaa4257a90070c63774] please confirm in the comment before this is moved into ToDo/to the PLTDBA project.

* public.m_field_definition_nwk, new id column of type serial as primary key
* public.client_manufacturer, new id column of type serial as primary key
* public.notify_card_status, existing id column as primary key
* public.outbound_files_record, existing file_id column as primary key
* public.p_acc_tok, new id column of type bigserial as primary key
* public.p_account_coln, new id column of type bigserial as primary key
* public.p_card_product, existing column crd_prdct_id as primary key
* public.p_card_virtual, existing column id as primary key
* public.p_client_acc, existing column id changed from int to serial as primary key
* public.p_client_bins, new ai_id column of type serial as primary key
* public.p_client_cust, existing column id as primary key
* public.p_clients, new id column of type serial as primary key
* public.p_cust, new id column of type serial as primary key
* public.p_customers_borgun, new id column of type serial as primary key
* public.p_manufacturer, new ai_id column of type serial as primary key
* public.p_on_behalf_details, existing column id as primary key
* public.p_on_behalf_value, new id column of type serial as primary key
* public.p_product_link, new id column of type serial as primary key
* public.p_pvv_history, new ai_id column of type serial as primary key
* public.p_sub_clients, new id column of type serial as primary key
* public.pans_detail, existing id column changed from integer to serial as primary key
* public.pin_data_borgun, existing id column as primary key
* public.t_dbkma_card, new id column of type serial as primary key
* public.t_dbkmb_card, new id column of type serial as primary key
* public.t_dbkmc_card, new id column of type serial as primary key
* public.t_ssn_names, new id column of type bigserial as primary key
* public.connect_count, new id column of type serial as primary key
* public.ppwr_function_logs, new id column of type bigserial as primary key

Remove sequences:

* public.p_acc_tok_seq
* public.p_client_acc_seq
* public.p_cust_seq",,Mathieu Cornille,Rohit Thapa,,,,,,,,,,557058:bc4cfaff-acbf-41af-be56-a436f655647d,60efedaa4257a90070c63774,,,,,,,,,,,,,,,,,,PEDA-268,PEDA-269,PEDA-267,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5a95c8e7,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i0524q:zza,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,978465e5-b4b6-4d4b-8ca9-20bf44d754d5,PLT - DBA,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,179034,PLTDBA-1090,Golden Data Model Deployment on BL3.0 UAT Environment (Hero PalawanPay Client),To Do,15/Jul/25 10:17 AM
Configuration to ignore card status for tokenized payments at product level,PECP-103,100270,Story,Released,PECP,PE - Core - Portals,software,Ewan Mackie,557058:afe3370e-7d7f-4272-9a06-c38b0253fa11,,,Normal,Done,Anita Adhikari,60fedcd90b454a00689c4243,Sari Salti,6317544c3310c2492b5b698a,Damilola Soladoye,60abad50ad76ea0070ae1aa7,17/Feb/23 3:40 PM,21/Apr/25 7:09 PM,,30/Jan/24 8:19 AM,,,,,,,,,,,,,,,,,,,,,,,0,Groomed,merged_in_master,,,"As part of [https://paymentology.atlassian.net/browse/DEV-11636502|https://paymentology.atlassian.net/browse/DEV-11636502|smart-link] we have implemented a new product level flag, which when enabled, will result in the network status being ignored for tokenized payments. So if a card is blocked for example, and an Apple Pay payment comes in, it will process as normal.

Per Febby it is being stored as such:

{{disable_nwk_status_force_decline}} both in PayTokDb {{p_product}} and PayCoreDb {{p_product}}.

Please can you make this available on the UI for Paycontrol at a product level

h2. Problem / Opportunity

Relates to Mettle’s interpretation of ApplePay requirements. Rather than forcing this new behaviour on everyone we wanted to make it an option.

h2. What would be the impact if we do NOT process this request?

It will have to be manually set in the DB

h2. Desired outcome

A little toggle switch in the product config

h2. Reusability of this solution (Description)

Reusable for all BL clients



*Dami’s notes*

!Image 2-17-23 at 2.32 PM (1).jpeg|width=2500,height=1574!

The toggle should be added to the above location. 

Toggle name - {{Ignore card status for tokenised payments}}

Value to be stored in {{disable_nwk_status_force_decline}} both in PayTokDb {{p_product}} and PayCoreDb {{p_product}}.

Environment -  all clients",,Anju Devkota,Bibek Ghale Pariyar,Damilola Soladoye,Rohith Rajan,William Dunne,,,,,,,60fedcda0b454a00689c424e,60efeafbf749c400680c06cb,60abad50ad76ea0070ae1aa7,5abca82e3cde3440ff0056b1,557058:5363d7a1-da13-4012-8609-f44e54c1d062,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEV-11644271,DEV-11636502,,,PR-1142,,,,,,,,,,,,,,17/Feb/23 3:40 PM;ug:09a91938-f212-480b-9cdd-2dfd468d475d;Image 2-17-23 at 2.32 PM (1).jpeg;https://paymentology.atlassian.net/rest/api/3/attachment/content/55373,12/Dec/23 12:24 PM;ug:616a1b4a-b122-4521-9c0e-b40b2f0d3ec7;image-20231212-102206.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73295,12/Dec/23 12:24 PM;ug:616a1b4a-b122-4521-9c0e-b40b2f0d3ec7;image-20231212-102233.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73294,12/Dec/23 12:24 PM;ug:616a1b4a-b122-4521-9c0e-b40b2f0d3ec7;image-20231212-102320.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73296,12/Dec/23 12:24 PM;ug:616a1b4a-b122-4521-9c0e-b40b2f0d3ec7;image-20231212-102341.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73297,12/Dec/23 12:32 PM;ug:616a1b4a-b122-4521-9c0e-b40b2f0d3ec7;image-20231212-103154.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73304,19/Dec/23 8:24 AM;ug:616a1b4a-b122-4521-9c0e-b40b2f0d3ec7;image-20231219-062203.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73739,19/Dec/23 8:24 AM;ug:616a1b4a-b122-4521-9c0e-b40b2f0d3ec7;image-20231219-062258.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73738,19/Dec/23 8:24 AM;ug:616a1b4a-b122-4521-9c0e-b40b2f0d3ec7;image-20231219-062324.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73740,19/Dec/23 8:24 AM;ug:616a1b4a-b122-4521-9c0e-b40b2f0d3ec7;image-20231219-062350.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73737,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6e6c3098,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=18, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":18,""lastUpdated"":""2023-12-13T09:53:52.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":18,""name"":""GitLab""},""GitHub"":{""count"":14,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzyilr:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,C/PRT - Sprint 11,C/PRT - Sprint 12,PECP Sprint 1,,,,,,,,,,,,,,,,S (1-2bd) ,,,,,,,,,b37a5c4c-e514-433c-b05b-898c22cbbfff,PE - Core - Portals,"New flag(Ignore card status for tokenized payments) is added in product level which will insert into both database paycore and paytok(p_product table, disable_nwk_status_force_decline column).when this flag is enabled, this will result in the network status being ignored for tokenized payments.

Tested in local environment:

!image-20231212-102206.png|width=100%!

!image-20231212-102233.png|width=100%!

!image-20231212-103154.png|width=100%!

!image-20231212-102320.png|width=100%!

!image-20231212-102341.png|width=100%!


Tested in QA Environment:

!image-20231219-062203.png|width=100%!

!image-20231219-062258.png|width=100%!

!image-20231219-062324.png|width=100%!

!image-20231219-062350.png|width=100%!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Enhancement,,,,2023-05-23 08:40:51.335,10205_*:*_2_*:*_581680189_*|*_10306_*:*_1_*:*_1251_*|*_3_*:*_1_*:*_590400220_*|*_10382_*:*_1_*:*_7925543_*|*_10000_*:*_1_*:*_874899180_*|*_10001_*:*_1_*:*_0_*|*_10367_*:*_1_*:*_1641701931_*|*_10345_*:*_1_*:*_3628494250_*|*_10204_*:*_1_*:*_102294932_*|*_10368_*:*_2_*:*_22526970952,,"23/May/23 10:40 AM;60abad50ad76ea0070ae1aa7;hi [~accountid:5abca82e3cde3440ff0056b1] , please can your team take this story?","29/May/23 11:05 AM;5abca82e3cde3440ff0056b1;[~accountid:60abad50ad76ea0070ae1aa7] Could yo please give more reason why it needs to be done by Rapid team? is this an urgent story ? 
looking at the story , seems the priority is normal. this looks like something good to have and there are not many clients in BL side and if anyone needs the flag, it can be anebled from Db side. Even if we take a little more time on our side, it should not e a problem. So not seeing any urgency needed on this. ","29/May/23 12:47 PM;60abad50ad76ea0070ae1aa7;Hi [~accountid:5abca82e3cde3440ff0056b1], 

Thanks for the feedback.

Yes, you are correct. There isn’t any pressing urgency. I spoke about this during my grooming session with the portals team, but we decided to make the request if your team could take it since its scope is small and looking at the backlog on the portal team it may take a while before this is done. 

There are no issues if this can’t be taken by the Rapid team.
",03/Jul/23 3:44 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6317544c3310c2492b5b698a] ,"20/Nov/23 1:35 PM;60fedcda0b454a00689c424e;As per my investigation:
*Update on paycontrol*

* On add/edit product modal, add toogle switch and set flag name *_Ignore card status for tokenised payments ._* We can see the screenshot in description for the placement in paycontrol UI.
* Value should set true when toogle is on and set false when off*.*

*Update on payapi*

* On ProductModel and ProductUpdateModel*,* add new param (like *_disableNwkStatusForceDecline )_*
* On dba class CreateProductTokDao and ProductUpdateDao, add param *_disableNwkStatusForceDecline_*  on {{SQL_CREATE_PRODUCT_TOK }}, {{SQL_CREATE_PRODUCT_CORE}}, {{SQL_UPDATE_PRODUCT_CORE}}and {{SQL_UPDATE_PRODUCT_TOK }} on select query*_._*

*Update on paytok database*

* From payapi we call  {{pcjs_product_create_v13 }}function  and {{pcjs_product_update_v13  }}function so update {{update }} statement on [*pcjs_product_update_v13*|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/merge_requests/972/diffs#diff-content-517e4ee556ba3c1ae9a1fa92a0a6b91f11eabb7c] function  and {{insert}}statement on  [*pcjs_product_create_v13*|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/merge_requests/972/diffs#diff-content-de2303f2dd2ff8b40950f6aeb9f51ca1ab81f11f]  function with param *_disableNwkStatusForceDecline_* *.*
* Update on  [+*pcjs_product_hierarchy_v2*+|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/merge_requests/972/diffs#diff-content-ed278bc835f40b0dbb9b0ba7bfad7d3aef3d54d6] function on select statement when  {{pprod_id}}*>*{{0}}.

*Update on paycore database*

* From payapi we call  {{pcjs_product_create_v7}} function  and {{pcjs_product_update_v6}} function so update {{update }} statement on [*pcjs_product_update_v6*|https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/merge_requests/1795/diffs#diff-content-ad29e286d232475fd52cbd45ded1fc05d12ebafd] function  and {{insert}}statement on  [*pcjs_product_create_v7*|https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/merge_requests/1795/diffs#diff-content-51bc07d4987913549a222301f95c36383e3ee94b] function with param *_disableNwkStatusForceDecline_* *.*",30/Jan/24 8:19 AM;60efeafbf749c400680c06cb;Deployed as part of BL release 2.5.0 so closing this ticket.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,126728,PECP-228,BL Enhancements - Portals,Done,30/Jan/24 8:19 AM
FR: Visa Flexible Credential,PECA-675,147271,Epic,Backlog,PECA,PE - Core - API,software,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,,,Normal,,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,Desiree Chow,6127cacc3ef46a007079f2b3,Desiree Chow,6127cacc3ef46a007079f2b3,16/Jan/25 6:05 AM,14/Apr/25 2:25 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,Client - Mettle,,Desiree Chow,,,,,,,,,,,6127cacc3ef46a007079f2b3,,,,,,,,,,,,,,,288000,288000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@60f2703b,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,ghx-label-6,,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,green,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i02ufk:,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,7b08db5f-ae7a-4912-8c53-a918d97163b3,PE - Core - API,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147222,TECH-498,Core - API/Card Lifecycle : Client Commitments & Feature Requests,To Do,16/Jan/25 6:05 AM
BL: Mettle's issues around getting renewed card's last 4 digit,PECA-591,139124,Spike,Released,PECA,PE - Core - API,software,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,,,Normal,Done,Samir Aghayarov,712020:4bb673e6-b220-422e-9aa9-53782ad29eb5,Desiree Chow,6127cacc3ef46a007079f2b3,Desiree Chow,6127cacc3ef46a007079f2b3,24/Oct/24 9:23 AM,21/Apr/25 7:07 PM,,21/Jan/25 7:55 AM,BL-2.22.0,BL-2.23.0,PA-2.78.0,,,,,,,,,,,,,,,,,,,,0,,,,,"Client: Mettle (Elite)

Inquiry: Based on email attached there are 2 issues raised

# last 4 digit of pan not present
# using [https://developer.paymentology.com/reference/v2_pws_card_renewal|https://developer.paymentology.com/reference/v2_pws_card_renewal|smart-link], missing fields  {{is_3ds_enrolled}} and {{3ds_enrollment_failure_reason}} 
#* [~accountid:6228aefd302c6b006af5cb0d] checked and response was – will be available if we enable the auto enrollment (in product level settings) for both V1 and V2.
#* Wil checked logs and yes, {{is_3ds_enrolled}} is present;
{{v2_pws_card_renewal response: {""header"":{""error_id"":0,""error_desc"":""success""},""body"":{""is_3ds_enrolled"":true,""cu_id"":440704,""cvv"":""***"",""epan"":""********************"",""emboss_name"":""KRISTOPHER SHEPPARD"",""expiry"":""10/29"",""cu_ref"":null,""entry_reason"":""L"",""token"":262783120}}}}
#* Dev Portal documentation is not updated with correct fields {{is_3ds_enrolled}} and {{3ds_enrollment_failure_reason}} – please can we add it [https://paymentology.atlassian.net/browse/PECA-592|https://paymentology.atlassian.net/browse/PECA-592|smart-link] 

!image-20241024-071620.png|width=1343,height=435,alt=""image-20241024-071620.png""!

----

Requirement of this ticket;

Please can you verify point 1 of issue. what are the detailed response body, is there missing field {{last_four_digit}} which is present in create card if yes, what are the alternatives of client knowing the PAN / last 4 digits. thanks.

Sample logs details of affected calls

Oct 23 11:20:34.501 (UTC)
apiUniqueIdentifier={{ed5c890e-1f12-47c1-aed8-d84d9b8b2c81}}Oct 23 10:51:29.636 (UTC)
apiUniqueIdentifier={{d923b475-6a5e-410f-9b62-92d6a4108c1b}}Oct 23 10:30:20.734 (UTC)
apiUniqueIdentifier={{2d0e20e4-b350-472a-a73e-8fd78a26afa6}}",,Automation for Jira,Cagdas Evren Gerede,Desiree Chow,,,,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,5a246636e7a1121a1ecce06d,6127cacc3ef46a007079f2b3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PECA-592,,,,,,,,,,,,,,24/Oct/24 9:23 AM;ug:805ebd7e-f8f1-405a-a633-caa75a81467e;image-20241024-071620.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/96882,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@65d3a7b1,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2024-12-09T11:14:47.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitHub"":{""count"":4,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzykhb:zlh,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-18,2025-01,,,,,,,,,,,,,,,,,,,,,,,,,,7b08db5f-ae7a-4912-8c53-a918d97163b3,PE - Core - API,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-10-25 07:08:27.189,10306_*:*_1_*:*_696910655_*|*_3_*:*_1_*:*_2729460055_*|*_10000_*:*_1_*:*_1838_*|*_10400_*:*_1_*:*_720134181_*|*_10345_*:*_1_*:*_0,,25/Oct/24 9:08 AM;5a246636e7a1121a1ecce06d;[~accountid:712020:4bb673e6-b220-422e-9aa9-53782ad29eb5] Please take a look.,14/Jan/25 9:05 AM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - PECA-592 has got status Done,16/Jan/25 4:17 AM;6127cacc3ef46a007079f2b3;hi [~accountid:712020:4bb673e6-b220-422e-9aa9-53782ad29eb5] can this ticket be closed please?,20/Feb/25 10:32 AM;6127cacc3ef46a007079f2b3;hi [~accountid:5f623946b9fcc1007734b378] actualy changes on this ticket [https://paymentology.atlassian.net/browse/PECA-592|https://paymentology.atlassian.net/browse/PECA-592|smart-link] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,148038,PECA-691,FR: Card Management,Done,21/Jan/25 7:55 AM
BL: Update APIs with New Status Network,PECA-240,120314,Story,Released,PECA,PE - Core - API,software,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,,,Normal,Done,Samir Aghayarov,712020:4bb673e6-b220-422e-9aa9-53782ad29eb5,Desiree Chow,6127cacc3ef46a007079f2b3,Desiree Chow,6127cacc3ef46a007079f2b3,02/Feb/24 3:45 AM,21/Apr/25 7:15 PM,,25/Jul/24 3:05 PM,BL-2.16.0,PA-2.40.0,,,,,,,,,,,,,,,,,,,,,0,,,,,"h2. Description

Auth team is working on adding new status code as per Visa specifications ([https://paymentology.atlassian.net/browse/AUTH-168|https://paymentology.atlassian.net/browse/AUTH-168|smart-link] ).

The new Visa statuses are

# Status = 1007, Reason Code = 414, Response Code = 12 = Inactive card - formal decline
# Status = 1009, Reason Code = 415, Response Code = 46 = Void card - formal decline

{quote}1007 (414) :=> 'Inactive card - formal decline'

1009 (415) :=> 'Void card - formal decline'{quote}

h2. Impact on API team - We need to ensure all client facing APIs that reflects card status is updated with the new statuses in order for our Visa clients to utilise them.

In our API specification, card status is field {{status_nwk}}.

Though applicable to only Visa for now, Auth team will (in the future) work on adding/mapping the MasterCard codes when ready; We need to document this well.

----

h2. *Behaviour of new card status*

_Note: 1007 behaves exactly as current “1005 : Decline all txns DE39=05”. 1009 behaves exactly as current “1199 : Void card - report DE39=05”_

|| ||*1007*||*1009*||
|Card Creation|upon card creation, clients currently can set card to inactive 1007|-|
|Card Management|* client can set card status
* transactions will be declined|* client can set card status
* this closes the account, action non reversible|
|Card Renewal|when card is in 1007, renewal can happen|when card is in 1009, renewal/replacement to be declined|
|Tokenization|* decline new digitisation
* suspend token|* decline new digitisation
* delete token|
|3DS|decline 3DS|* decline 3ds
* delete enrollment|

h2. *Use Cases*

# As Visa client/cardholder, I want to set a card status to 1007 ‘Inactive card - formal decline’ and/or 1009 ‘Void card - formal decline’
#* Create Card – introduce 1007
#* CreateBulkCard - introduce 1007
#* SetCardStatus - introduce 1007 and 1009 as client/cardholder should be able to change the status of their card
#* Card renewal V1 & V2 - decline renewal if card status is 1009
# As a client/cardholder, I need clear documentation on card status definition and appropriate usage for my implementation
#* Card Renew V1 & V2
#* Get Card Status V1
#* Get Card Details (in response)
#* Get Card List (in response)
#* PaySecure WS V2 - GetDetailedCardList and the 4 other endpoints - by token, customer, accountID
#* pls check all other endpoints that has field {{status_nwk}}
# As automated lifecycle management, ensure 1007 and 1009 is accounted for
#* MeaWallet OBO tokenization
#* MADA tokenization
#* VTS tokenization
#* 3DS Apata

h2. Important:

-this is a Visa status_nwk. please document it well to restrict its usage to VISA clients only-

*Update:* this is for both Visa and Mastercard

h2. Documentation

refer to page 231, Code 12 & page 232 Code 46

[^visanet-authorization-only-online-messages-technical-specifications_042023.pdf]

h2. Clients 

# -YoCrypto --- requestor // priority-
# *Mettle (MC) --- is requesting this soonest*
# ADQ/WIO
# BAE
# Derayah/D360
# Teya
# Xendit
# Rain
# MarcoPolo
# TymeBank
# Onmo",,Ahmed Tausif Raihan,Cagdas Evren Gerede,Desiree Chow,Muhammad Saad Raees,Samir Aghayarov,,,,,,,624730348678e900705bddcd,5a246636e7a1121a1ecce06d,6127cacc3ef46a007079f2b3,61f80302acd4cb0069cf18e5,712020:4bb673e6-b220-422e-9aa9-53782ad29eb5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PMGMT-223,PECA-599,,,,,,,,,,,,,,,,02/Feb/24 10:46 AM;ug:805ebd7e-f8f1-405a-a633-caa75a81467e;visanet-authorization-only-online-messages-technical-specifications_042023.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/76467,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5fa9166d,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=45, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":45,""lastUpdated"":""2024-07-26T09:57:42.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":45,""name"":""GitLab""},""GitHub"":{""count"":20,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzz3tj:,,,,,"h4. 1. Title

*Network Status Code Enhancement: Introduction of Status Codes 1007 and 1009*

h4. 2. Description

We have introduced two new network status codes, 1007 and 1009, and improved the way we manage network status codes by using dynamic configuration tables instead of hardcoded values. This change provides more flexibility and better maintenance.

h4. 3. Value for Client/Cardholder

This update allows for more flexible and maintainable handling of network status codes, improving the system's ability to adapt to future changes seamlessly.

h4. 4. Impact on Users

* *New Network Status Codes*: The system now supports the new status codes 1007 and 1009.
* *Improved Configuration Management*: The management of network status codes is now dynamic and centralized, leading to easier updates and better system clarity.

h4. 5. Additional Information

Clients should update their systems to recognize the new status codes 1007 and 1009. The improved configuration management ensures a more streamlined and maintainable system.

h4. 6. Reference Material/Links to Documentation",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,PECA Sprint 1,PECA Sprint 2,PECA Sprint 4,PECA Sprint 5,2024-07,2024-08,2024-09,2024-10,,,,,,,,13.0,,,XL (10-15bd),,,,,,,,,7b08db5f-ae7a-4912-8c53-a918d97163b3,PE - Core - API,"Test results can be found at this page:

[https://paymentology.atlassian.net/wiki/spaces/TS/pages/7942111323/PECA-240+Update+APIs+with+New+Status+Network#%5BhardBreak%5DTesting%5BhardBreak%5D%5BhardBreak%5D%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7942111323/PECA-240+Update+APIs+with+New+Status+Network#%5BhardBreak%5DTesting%5BhardBreak%5D%5BhardBreak%5D%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D-%5BmediaInline%5D|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-02-02 07:17:08.666,10205_*:*_1_*:*_2003700900_*|*_10306_*:*_1_*:*_19909900_*|*_3_*:*_1_*:*_6045972281_*|*_10000_*:*_1_*:*_7004801816_*|*_10001_*:*_1_*:*_0,,02/Feb/24 9:17 AM;5a246636e7a1121a1ecce06d;I will evaluate the story and then assign it to someone in the team early next week.,"02/Feb/24 9:21 AM;5a246636e7a1121a1ecce06d;[~accountid:6127cacc3ef46a007079f2b3] 

I need clarification on whether this is needd by any of the clients running BL1.5/BL1.6

{noformat}BOJ
ISB
TWQ
D360
MOX{noformat}



This will add to the patching effort and affect the tshirt size.



I also need the original visa document explaining what these new status code means. Please include that pdf in the Jira ticket.",02/Feb/24 10:48 AM;6127cacc3ef46a007079f2b3;hi [~accountid:5a246636e7a1121a1ecce06d] updated accordingly. let us know the t-shirt size once its assessed. thank you. ,"02/Apr/24 9:52 AM;5a246636e7a1121a1ecce06d;[~accountid:712020:4bb673e6-b220-422e-9aa9-53782ad29eb5] Please check this story in the current sprint (Sprint 4).

For this, please schedule a meeting with Florin to discuss the scope of this story. The changes are driven by the authorization team and let’s make sure the changes we are going to do align with authorization team.

Also we need to investigate if there are any side effects of the status code changes that we need to fix further in the api documentation or other api endpoint implementations.

As usual, please document your understanding on what authorization team is doing with this status codes and mappings, in addition to how we are handling the change on our side. I do not have much understanding myself on this and it will be really helpful for everyone in the team to have common understanding via your documentation.","18/Apr/24 9:27 AM;6127cacc3ef46a007079f2b3;hi [~accountid:712020:4bb673e6-b220-422e-9aa9-53782ad29eb5] & [~accountid:5a246636e7a1121a1ecce06d] - after reviewing the upcoming MC changes ([https://paymentology.atlassian.net/wiki/spaces/TS/pages/7627931745/Banking.Live+Card+Status+-+Dynamic+Reason+Response+Code+Mapping+on+Network+Level+New+reason+code+403+for+Card+Status+1062|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7627931745/Banking.Live+Card+Status+-+Dynamic+Reason+Response+Code+Mapping+on+Network+Level+New+reason+code+403+for+Card+Status+1062|smart-link] ), we would not need a new story for MC. 

What the auth team has done is dynamically map Visa and MC response codes to the 2 additional status

# 1007 (414) :=> 'Inactive card - formal decline'
# 1009 (415) :=> 'Void card - formal decline'

So instead of this being a “Visa only” status_nwk, this now scheme agnostic. 

Auth team stories

* [https://paymentology.atlassian.net/browse/AUTH-353|https://paymentology.atlassian.net/browse/AUTH-353|smart-link]
* [https://paymentology.atlassian.net/browse/AUTH-168|https://paymentology.atlassian.net/browse/AUTH-168|smart-link] ","14/May/24 11:14 AM;712020:4bb673e6-b220-422e-9aa9-53782ad29eb5;I had a meeting with authorizations team member - author of this change (as per Florin’s suggestion) , what authorizations team is done in the context of this change is that they have introduced 2 new network status code 1007 and 1009 and refactored a DB function {{ppwr_tok_pre_visa_v11}} (here is [link|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/merge_requests/1172/diffs#82d0d4677d6e3e4b6618b6cac4ee482eaeea786a_994_997]) .They removed hardcoded network status code definition and introduced three mapping tables to manage this logic dynamically (more flexible configuration, it wouldn’t work dynamically if the relation table {{nwk_reason_response_map}} doesn't have a record inserted for the certain network , i.e MC), a confluence page documented [here|https://paymentology.atlassian.net/wiki/x/YQCpxgE] for the same , this is more to manage the mapping between card/network status code , reason code , response code at their side. At payapi side we don’t deal with reason code, response code mapping we only check if a predefined network status code array contains input network status code field per service , i.e create card, card renewal . Each service has its own status code array so it is not clear what’s allowed what’s not until we go and check it for each endpoint , this configuration is hardcoded for each endpoint and it is not managed from single location. As a solution we could introduce new network status codes as documented in the story description and extract this configuration to common place to make it more maintainable and easier to understand. Also at the moment we consider that this codes are aligned with paytokDB as we are not verifying them (each time) from paytokDB.",02/Jul/24 9:35 AM;5a246636e7a1121a1ecce06d;[~accountid:712020:4bb673e6-b220-422e-9aa9-53782ad29eb5] What is the current status of this ticket?,"02/Jul/24 10:33 AM;712020:4bb673e6-b220-422e-9aa9-53782ad29eb5;The implementation and unit testing are finalized ,at the moment I am testing it at local env, it involves testing the different card APIs with existing and new status codes.","28/Oct/24 1:33 PM;6127cacc3ef46a007079f2b3;hi [~accountid:712020:4bb673e6-b220-422e-9aa9-53782ad29eb5] [~accountid:61f80302acd4cb0069cf18e5] will reach out, but just a headsup… this possibly needs to be deployed to D360 OCI UAT. thanks",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,126762,PECA-334,BL API Support Type work,Done,25/Jul/24 3:05 PM
BL > Address Vulnerability CVE-2023-20873 > Patch Mettle branch (release/2.9.7.2.Mettle-patch),PECA-140,103959,Sub-task,To Do,PECA,PE - Core - API,software,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,,,Normal,,Joshua Caponong,62b592a433a882e2be4b4280,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,04/May/23 12:08 PM,08/Jan/24 8:04 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"More details are in the parent ticket: [https://paymentology.atlassian.net/browse/DEV-11638874|https://paymentology.atlassian.net/browse/DEV-11638874|smart-link] 

It is fixing a vulnerability by upgrading a library.",,Cagdas Evren Gerede,,,,,,,,,,,5a246636e7a1121a1ecce06d,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@7bad170a,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=2, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":2,""lastUpdated"":""2023-05-05T10:10:59.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":2,""name"":""GitLab""},""GitHub"":{""count"":2,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzwmjb:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,7b08db5f-ae7a-4912-8c53-a918d97163b3,PE - Core - API,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,103956,PECA-67,BL > Address Vulnerability CVE-2023-20873,To Do,04/May/23 12:08 PM
BL > missing original PAN (BL token) to digitized token causes exception during token/update/account call,PECA-9,103212,Bug,Released,PECA,PE - Core - API,software,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,,,Normal,Done,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,18/Apr/23 12:05 PM,21/Apr/25 7:13 PM,,16/Jan/25 8:45 AM,,,,,,,,,,,,,,,,,,,,,,,0,bl-mea-life-cycle-management,,,,"[https://paymentology.slack.com/archives/C02CSC3K05R/p1681811947794739?thread_ts=1680787456.782259&cid=C02CSC3K05R|https://paymentology.slack.com/archives/C02CSC3K05R/p1681811947794739?thread_ts=1680787456.782259&cid=C02CSC3K05R|smart-link] 



Re-mentioning here the sequence of the events , when this API URL is called for Mettle scope : [https://uat.banking.live:55555/ppws/api/pws/customerservice/v3/token/update/account|https://uat.banking.live:55555/ppws/api/pws/customerservice/v3/token/update/account]



1- PayApi is processing the request

2- Calling the equivalent MeaWallet URL and send the request

3- MW send the request to MDES

4- MDES Replies back to MW

5- MW replies back to PTY by 200-status as an acknowledgment

6- PTY process the response and raises the db exception during the processingFull log is attached clarifies the above sequence.

Full log is attached clarifies the above sequence.

[^UAT - Mettle-TokenUpdateAccount Logs.txt]







Fix would be in this class

{{rest(""/pws/customerservice/v3/token/update/account"")}}

{{updateTokenAccountInternally(model, al, response, tokenConfigCurrentCard, tokenConfigNewCard);}}



{noformat}
   CardDb cardDb = new CardDb();
        if (model.getReasonCode().equals(ReasonCodeTokenAccountUpdate.R)) {
            if (tokenConfigNewCard != null && tokenConfigNewCard.size() > 0) {
                cardDb.updateTokenPayTok(model, (long) tokenConfigCurrentCard.get(""pr_tok""),
                        (long) tokenConfigNewCard.get(""pr_tok""));
                cardDb.updateTokenPayCore(model, (long) tokenConfigCurrentCard.get(""pr_tok""),
                        (long) tokenConfigNewCard.get(""pr_tok""));{noformat}



and inside, it is doing this call:



{noformat}PreparedStatement updatePCardWalletToken =
        con.prepareStatement(""update public.p_card_wallet_token set pr_tok = ? where pr_tok = ?"")) {{noformat}



same for paycore



{noformat}PreparedStatement updatePCardWalletToken =
        con.prepareStatement(""update public.p_card_wallet_token set pr_tok = ?, pb_tok = ? where pr_tok = ?"")) {{noformat}



These call fails since there is no entry to update. 



The correct behavior is to first verify that the entry exists in the database. If it does, then do an update. If the entry does not exist, then we should do an insert with the new pr_tok - pb_tok link and all the corresponding information needed by p_card_wallet_token.",,Cagdas Evren Gerede,Joshua Caponong,,,,,,,,,,5a246636e7a1121a1ecce06d,62b592a433a882e2be4b4280,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEV-10977,,,DEV-11638568,,,,,,PECA-196,,,,,18/Apr/23 12:05 PM;cagdas;UAT - Mettle-TokenUpdateAccount Logs.txt;https://paymentology.atlassian.net/rest/api/3/attachment/content/58391,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-140536.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58918,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-140657.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58920,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-140712.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58928,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-140746.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58923,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-140944.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58919,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-141002.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58924,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-141134.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58927,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-141209.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58921,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-141253.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58922,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-141417.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58926,02/May/23 4:17 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230502-141736.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58925,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6b5ec619,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=4}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":4,""lastUpdated"":""2023-09-04T12:33:30.121+0200"",""stateCount"":4,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitLab"":{""count"":4,""name"":""GitLab""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i02s3s:0hzi,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,7b08db5f-ae7a-4912-8c53-a918d97163b3,PE - Core - API,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-05-02 14:17:50.777,10306_*:*_1_*:*_1121_*|*_10000_*:*_1_*:*_858326171_*|*_10345_*:*_1_*:*_0,,"21/Apr/23 9:17 AM;5a246636e7a1121a1ecce06d;To explain, what was done for this:



The token used in testing in this context was created by Meawallet. In other words, actual provisioning was not done. Therefore, we are missing card - token link in our p_card_wallet_token table.

In production we should have not this problem because with the iso messages we receive TCN and we would insert that link already before any pan update call.



In order to alleviate the issue on UAT testing for Mettle, we are relaxing the exception handling. Also, this needs to be patched in production servers whereever this is deployed:

[https://paymentology.atlassian.net/browse/DEV-10977|https://paymentology.atlassian.net/browse/DEV-10977|smart-link] 

So we need to create a confluence page to track the deployment history for [https://paymentology.atlassian.net/browse/DEV-10977|https://paymentology.atlassian.net/browse/DEV-10977|smart-link] and add this ticket there as a bugfix and add to the list of bugfixes.

Also, I do not think if any of these are actually deployed to Mettle server. So they will not able to use it at the moment in production. We have to confirm what other APIs Mettle is needing to use in production and we need to deploy those in Mettle.



These are all the api endpoints Mettle would need in production. We need to file a ticket to get these LCM endpoints patched in Mettle server:

{noformat}
/pws/customerservice/v3/token/delete/
/pws/customerservice/v3/token/update/account
/pws/customerservice/v3/token/suspend/
/pws/customerservice/v3/token/unsuspend/
{noformat}

In other words:

{noformat}Token update account - https://developer.paymentology.com/reference/pws_mea_cs_pan_update
Token delete - https://developer.paymentology.com/reference/pws_mea_cs_token_delete
Token suspend - https://developer.paymentology.com/reference/pws_mea_cs_token_suspend
Token unsuspend - https://developer.paymentology.com/reference/pws_mea_cs_token_unsuspend{noformat}

UPDATE:

We patched those endpoints now in this ticket:  [https://paymentology.atlassian.net/browse/DEV-11638568|https://paymentology.atlassian.net/browse/DEV-11638568|smart-link] ",28/Apr/23 10:29 AM;5a246636e7a1121a1ecce06d;This is tested and ready to be deployed in the environments showed in  subtickets.,"02/May/23 4:17 PM;62b592a433a882e2be4b4280;Testing: 

# Token Account Update: 

pb_tok used: {{473563018}}

!image-20230502-140657.png|width=912,height=712!

!image-20230502-140536.png|width=938,height=440!

!image-20230502-140712.png|width=912,height=506!

No more tokens after replacement.

2. Token suspend:

pb_tok: {{473563018}}

TUR: {{DNITHEgx1ZI57H5eVHZpoFptyWpayv6}} 

!image-20230502-140746.png|width=1824,height=1424!

!image-20230502-140944.png|width=908,height=462!

!image-20230502-141002.png|width=931,height=597!

TUR is now suspended.

3. Token unsuspend:
pb_tok: {{473563018}}

TUR: {{DNITHEgx1ZI57H5eVHZpoFptyWpayv6}} 

!image-20230502-141134.png|width=917,height=417!

!image-20230502-141209.png|width=920,height=678!

TUR now back to active.

4. Token Delete: 

pb_tok: {{473563018}}

TUR: {{DNITHEgx1ZI57H5eVHZpoFptyWpayv4}} 

!image-20230502-141253.png|width=912,height=729!

!image-20230502-141417.png|width=940,height=448!

!image-20230502-141736.png|width=923,height=660!

TUR is now deactivated.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,94877,PECA-51,API Team > Admin API,Done,16/Jan/25 8:45 AM
BL | RCA: Transaction Processing Issue on several clients,OPS-17421,134577,Story,In Progress,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Major,,Juliano Polican Ciena,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,Juliano Polican Ciena,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,Juliano Polican Ciena,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,29/Aug/24 11:03 PM,24/Oct/24 1:49 PM,,,NW-02-Sept-24,NW-07-Oct-24,NW-21-Oct-24,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"Hello Network team, [~accountid:60fc636052162b00681d341b] [~accountid:61bcc3e58a146b00680af05b] , [~accountid:60fedd468c15ca006ffc3ef1]

Please help us to analyze from infra (server) and network perspective any issues observed on *Aug 27* between 20:30 *to 20:45 UTC*.

We had connection issues on all our Mastercard clients (except ISB) externally (with Mastercard) and internally too (PR & PPs) during this period.

 

Connection details:

{noformat}Shared02 (BB2)
Src: 216.119.220.146
Dest: 10.22.2.24
Port: 6500{noformat}

BOJ:

{noformat}Src: 216.119.220.135
Dest: 10.24.2.14
Port: 6500{noformat}

Mettle:

{noformat}Src: 216.119.220.135
Dest: 10.23.2.13
Port: 6500{noformat}

Marcopolo:

{noformat}Src: 10.100.155.5
Dest: 10.155.100.250
Port: 5559{noformat}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,23/Oct/24 4:55 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;813636 BAE Transaction Processing Issue (1).xlsx;https://paymentology.atlassian.net/rest/api/3/attachment/content/96820,03/Oct/24 3:29 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20241003-010910.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/95290,03/Oct/24 3:29 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20241003-012511.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/95289,03/Oct/24 3:29 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20241003-012559.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/95291,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@50ea68f7,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i0183l:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,87c04ed7-d42a-47ec-9df4-5c757db79ff9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-09-03 00:29:23.078,,,"29/Aug/24 11:16 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Hello Network team, [~accountid:60fc636052162b00681d341b] [~accountid:61bcc3e58a146b00680af05b] , [~accountid:60fedd468c15ca006ffc3ef1] 

Please help us to analyze from infra (server) and network perspective any issues observed on *Aug 27* between 20:30 *to 20:45 UTC*. 

We had connection issues on all our Mastercard clients (except ISB) externally (with Mastercard) and internally too (PR & PPs) during this period.



Connection details:

{noformat}Shared02 (BB2)
Src: 216.119.220.146
Dest: 10.22.2.24
Port: 6500{noformat}

BOJ:

{noformat}Src: 216.119.220.135
Dest: 10.24.2.14
Port: 6500{noformat}

Mettle:

{noformat}Src: 216.119.220.135
Dest: 10.23.2.13
Port: 6500{noformat}

Marcopolo:

{noformat}Src: 10.100.155.5
Dest: 10.155.100.250
Port: 5559{noformat}","02/Sep/24 11:04 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Hello Network team, [~accountid:60fc636052162b00681d341b] [~accountid:61bcc3e58a146b00680af05b] , [~accountid:60fedd468c15ca006ffc3ef1]
Warm reminder on this","03/Sep/24 2:29 AM;60fc636052162b00681d341b;Hi [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] ,

The given connection below seems incorrect. It should be the opposite. The source will be our application, and the destination will be Mastercard MIPS. Also, these are MC Cloud Mips, so traffic is directly sent from Azure to the Mastercard network.

1. Can you please check with the Mastercard team regarding this disconnection? If there is any scheduled activity on their end?

2. There are a total of 4 IPs, and I see disconnection only occurred on a single destination IP 216.119.220.146.","04/Sep/24 11:20 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Thank you [~accountid:60fc636052162b00681d341b] , Case # 05066453 raised to MC.","03/Oct/24 3:29 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:60fc636052162b00681d341b] , [~accountid:61bcc3e58a146b00680af05b] [~accountid:6228aefd6a4c4c0070b197d9] 

BAE is VISA only. They were also impacted on same time.

Please check if there was any network/connectivity issue on Aug 27 between 20:30 and 20:45 UTC for:

*PR and VISA*

Source: dc-prod-switch02 IP 10.155.100.249
Destination: Visa MPLS-EAS IP 10.100.155.5 port 5310

and 

*PP (FAST) to client*

Sources: 
bae-pr-pwr01 IP 10.10.161.5 
bae-pr-pwr02 IP 10.10.161.2

Destination:
[http://10.10.160.4:8010/api/1.6/paymentology/complex)|http://10.10.160.4:8010/api/1.6/paymentology/complex)]
!image-20241003-012511.png|width=91.66666666666666%,alt=""image-20241003-012511.png""!


I found some disconnection on PR by 20:42:

{{2024-08-27 20:42:01.489 [PayPower Reader] ERROR c.p.payroute.logics.PaySocket - Something wrong happened while waiting for message to read. }}

{{java.net.SocketException: Socket closed }}



But VISA stopped sending authorization between 20:35 and 20:41 UTC.

!image-20241003-010910.png|width=452,height=261,alt=""image-20241003-010910.png""!

No sure if related, I think client could not handle the amount of requests at same minute, there are some timeouts from client: {{FAST Active Response: FAILED. Client id= 647928(BAE FAST URL) .  No response received within the timeout period.  rid:15395922}}

TID 2795745152961573526

!image-20241003-012559.png|width=100%,alt=""image-20241003-012559.png""!","03/Oct/24 12:22 PM;60fc636052162b00681d341b;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] Can you please confirm what is the paypower IP for BAE 

and is there any connectivity between BAE Paypower to UK DC Payroute 10.155.100.249 10.155.100.250

if BAE is using the DC Payroute then please provide me port details for PP TO PR.","03/Oct/24 11:57 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Hi [~accountid:60fc636052162b00681d341b] , you can find server IPs in [AZURE BAE - Team Hubs - Confluence (atlassian.net)|https://paymentology.atlassian.net/wiki/spaces/TS/pages/6605701179/AZURE+BAE]

|5|BAE-PROD-PR-PWR02|10.10.161.12|APP|2|8|50 GB|Pay Power Secondary|
|16|BAE-PROD-PR-PWR01|10.10.161.5|App|2|8|50 GB|Pay Power Master|

Updated their IPs on my comment below.

BAE is using DC PR, but not sure about port. I checked the config.xml below, but it’s not clear to me

*config.xml *

[juliano.ciena@dc-prod-switch02 PayRoute_BAE_HSM_VISA_02]$ cat config.xml
<?xml version=""1.0"" encoding=""UTF-8""?>
<config>
    <appSettings>
        <add key=""destination_institution_id"" value=""000000"" />
        <add key=""source_institution_id"" value=""465310"" />
        <add key=""issuer_id"" value=""465310"" />
        <add key=""fwd_inst_id"" value="""" />
        <add key=""gsi_id"" value=""000000"" />
        <add key=""payroute_port"" value=""5559"" />
        <add key=""network_ip"" value=""10.100.155.5"" />
        <add key=""network_port"" value=""5310"" />
        <add key=""receive_buffer"" value=""1024"" />
        <add key=""send_buffer"" value=""1024"" />
        <add key=""no_delay"" value=""true"" />
        <add key=""tcp_keep_alive"" value=""1"" />
        <add key=""paykey_ip"" value=""10.155.100.10"" />
        <add key=""paykey_port"" value=""7776"" />
        <add key=""paykey_freq"" value=""60000"" />
        <add key=""startup"" value=""a"" />
        <add key=""endup"" value=""b"" />
        <add key=""execute_startup_immidiately"" value=""1"" />
        <add key=""conf_frequency"" value=""86400"" />
        <add key=""echo_frequency"" value=""300"" />
        <add key=""action_required"" value="""" />
        <add key=""network_msg_length_in"" value=""2"" />
        <add key=""network_msg_length_out"" value=""2"" />
        <add key=""paypower_msg_length_in"" value=""2"" />
        <add key=""paypower_msg_length_out"" value=""2"" />
        <add key=""nks_cert"" value=""1233211291"" />
        <add key=""pks_cert"" value=""1233211290"" />
        <add key=""pp_cert"" value=""1233211291"" />
        <add key=""nwk"" value=""v"" />
        <add key=""pp_options"" value=""SO53:9701100001000000;SO94:0I40000;SO96:00000000;ppcount:2782348623"" />
        <add key=""heartbeat_send_frequency"" value=""30"" />
        <add key=""enable_heart_beat_send"" value=""0"" />
{noformat}    <add key=""bl_tls_key_store_path"" value=""/bl/PayRoute_BAE_HSM_VISA_02/ssl/prks.jks"" />
    <add key=""bl_tls_keystore_password"" value=""04F655989AECE93B589A77F29B66369B234C47D684570C169DB9CB180BD0A6E2"" />

    <add key=""log_location"" value=""/bl/logs/PayRoute"" />

    <add key=""instance_id"" value=""19""/>
</appSettings>

<platforms>
    <platform>
        <add key=""platform_name"" value=""PayPower_BAE_VISA""/>
        <add key=""platform_id"" value=""465350""/>
        <add key=""instance_id"" value=""465310""/>
        <add key=""bin"" value=""454523,410896,405439,423113""/>
        <add key=""old_architecture"" value=""0"" />
        <add key=""pks_ip"" value=""10.155.100.18"" />
        <add key=""pks_port"" value=""7777"" />
    </platform>

    <platform>
        <add key=""platform_name"" value=""SH02_PP_VISA_5310_01""/>
        <add key=""platform_id"" value=""465310""/>
        <add key=""instance_id"" value=""465310""/>
        <add key=""bin"" value=""457656,434612,446210,456717,464666,466539,492992,468816,454988,462987,494319""/>
        <add key=""old_architecture"" value=""0"" />
        <add key=""pks_ip"" value=""10.155.100.17"" />
        <add key=""pks_port"" value=""7777"" />

    </platform>

    <!--
             <platform>
                <add key=""platform_name"" value=""PayPower_VISA_02""/>
                <add key=""platform_id"" value=""465320""/>
                <add key=""instance_id"" value=""465320""/>
                <add key=""bin"" value=""459665""/>
                <add key=""old_architecture"" value=""1"" />
                <add key=""pks_ip"" value=""10.155.100.18"" />
                <add key=""pks_port"" value=""7777"" />

            </platform>

    -->
    <platform>
        <add key=""platform_name"" value=""PayPower_ADQ_VISA""/>
        <add key=""platform_id"" value=""465360""/>
        <add key=""instance_id"" value=""465310""/>
        <add key=""bin"" value=""409887""/>
        <add key=""old_architecture"" value=""0"" />
        <add key=""pks_ip"" value=""10.155.100.22"" />
        <add key=""pks_port"" value=""7777"" />
    </platform>

    <!--
           <platform>
                <add key=""platform_name"" value=""PayPower_SH03_VISA02""/>
                <add key=""platform_id"" value=""465370""/>
                <add key=""instance_id"" value=""465370""/>
                <add key=""bin"" value=""456717""/>
                <add key=""old_architecture"" value=""0"" />
                <add key=""pks_ip"" value=""10.155.100.16"" />
                <add key=""pks_port"" value=""7778"" />
              </platform>
    -->

    <platform>
        <add key=""platform_name"" value=""PT_MP_PP_02""/>
        <add key=""platform_id"" value=""465330""/>
        <add key=""instance_id"" value=""465310""/>
        <add key=""bin"" value=""446257,455618""/>
        <add key=""old_architecture"" value=""0"" />
        <add key=""pks_ip"" value=""172.16.131.49"" />
        <add key=""pks_port"" value=""7777"" />
    </platform>


</platforms>{noformat}
</config>
[juliano.ciena@dc-prod-switch02 PayRoute_BAE_HSM_VISA_02]$ pwd
/bl/PayRoute_BAE_HSM_VISA_02

[~accountid:611a52967b538a006964a439]  [~accountid:624730348678e900705bddcd] [~accountid:61f80302845d670071f2138e] could you plesae advise on port details for BAE PP TO PR?",07/Oct/24 2:43 PM;60fc636052162b00681d341b;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] No disconnection was observed from the network side at the given date and time.,09/Oct/24 12:39 PM;60fc636052162b00681d341b;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] Can you please schedule a meeting to review the logs together from both the application and infrastructure,"18/Oct/24 12:17 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:60fc636052162b00681d341b] , sure, just check my availability on outlook and send an invite for next week.","21/Oct/24 1:11 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;I will be off Monday and Tuesday, please send an invite for Wednesday.",23/Oct/24 10:15 AM;60fc636052162b00681d341b;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] meeting invite sent for wed.,"23/Oct/24 4:55 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Uploading txns mentioned on that comment: 

[https://paymentology.atlassian.net/browse/OPS-17421?focusedCommentId=212293|https://paymentology.atlassian.net/browse/OPS-17421?focusedCommentId=212293]



[^813636 BAE Transaction Processing Issue (1).xlsx]

","24/Oct/24 1:49 PM;60fc636052162b00681d341b;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] Following our meeting, no issues have been observed on the network side.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,97140,PLTI-726,[BAU] Infra - Banking.live Operation tasks which are not related to any Project.,In Progress,24/Oct/24 1:49 PM
Mettle:  MC missing txns as many txns didnt reach Payroute,OPS-16513,129113,Story,In Progress,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,Rajesh.Subramanian,63c1496004b5f5c7b5ede6a7,Rajesh.Subramanian,63c1496004b5f5c7b5ede6a7,Rajesh.Subramanian,63c1496004b5f5c7b5ede6a7,17/Jun/24 11:30 AM,20/Jun/24 3:24 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Mettle:  MC missing txns as many txns didnt reach Payroute

Can you Please help to check if there is any issue at network side from MC to Mettle Payroute.

16-06-2024 12:05 am to 17-06-2024 7:36 AM

[https://app.datadoghq.eu/dashboard/y9a-rdg-gf4/bank-live-transaction-report?fromUser=true&refresh_mode=sliding&tpl_var_client[0]=mettle&view=spans&from_ts=1718527426298&to_ts=1718613826298&live=true|https://app.datadoghq.eu/dashboard/y9a-rdg-gf4/bank-live-transaction-report?fromUser=true&refresh_mode=sliding&tpl_var_client%5B0%5D=mettle&view=spans&from_ts=1718527426298&to_ts=1718613826298&live=true]

Payroute: 10.155.100.249 & 10.155.100.250

We didnt see any txns faliure between these above timings from MC. Client reported the issue.

After Payroute restart this morning at 7:36 AM, transactions went through.



!image-20240617-093133.png|width=1138,height=755,alt=""image-20240617-093133.png""!



[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1718610158899309?thread_ts=1718547188.026549&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1718610158899309?thread_ts=1718547188.026549&cid=C02CA1QPG5Q|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,17/Jun/24 11:33 AM;63c1496004b5f5c7b5ede6a7;image-20240617-093133.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/86536,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@842e4b7,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i00fkb:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-06-19 09:27:46.684,,,19/Jun/24 11:27 AM;60fc636052162b00681d341b;[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1718711222463969?thread_ts=1718547188.026549&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1718711222463969?thread_ts=1718547188.026549&cid=C02CA1QPG5Q],"20/Jun/24 3:23 PM;60fc636052162b00681d341b;As discussed in Meeting, No issue observed from network side and the session was active when the issue started.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,20/Jun/24 3:24 PM
Mettle Apata configuration in production for new BIN,OPS-16039,126496,Sub-task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,,,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,07/May/24 4:06 PM,07/May/24 4:06 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@388b92d9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i001x3:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,123197,OPS-15671,Mettle - Main ticket for: New BIN setup,To Do,07/May/24 4:06 PM
Mettle Apata configuration UAT,OPS-16038,126495,Sub-task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,,,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,07/May/24 4:05 PM,07/May/24 4:06 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"UAT setup completed 

API key shared with Shahroz.

!image-20240507-140540.png|width=640,height=796,alt=""image-20240507-140540.png""!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,07/May/24 4:06 PM;ug:3e4f5544-8421-4a2a-884b-4704ced3f3b6;image-20240507-140540.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83466,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3f80d714,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i001wv:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,123197,OPS-15671,Mettle - Main ticket for: New BIN setup,To Do,07/May/24 4:05 PM
Mettle Perso File,OPS-15801,124250,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,High,,Bilal Hashmi,60fedcdc627b5600689cd1a0,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,28/Mar/24 2:22 PM,03/Apr/24 10:48 AM,,,,,,,,,,,,,,Service Delivery. DO NOT USE. Team moved to ESRM Jira,,,,,,,,,,,0,,,,,"Hi

We require assistance please to retrieve the unencrypted Perso file for Mettle token → Token - 324073846



Please see attached email for confirmation from client to extract the file.



The purpose of this is we need to ensure no bespoke development was done for Mettle 3 years ago as they are now doing new dev work for their new BIN. 



CC: [~accountid:6328729388ed2ebef978552f] [~accountid:6273fc10807e0000691d5dee] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,28/Mar/24 2:21 PM;ug:3e4f5544-8421-4a2a-884b-4704ced3f3b6;Analysis into values used for Mettle card with perso file to IDEMIA.msg;https://paymentology.atlassian.net/rest/api/3/attachment/content/80725,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3a26b81b,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzzoxj:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,87c04ed7-d42a-47ec-9df4-5c757db79ff9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,03/Apr/24 10:48 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Hi [~accountid:60fedcdc627b5600689cd1a0] can someone please assist us with this request?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,28/Mar/24 2:22 PM
Mettle new BIN: Keys to be copied,OPS-15672,123198,Sub-task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,Bilal Hashmi,60fedcdc627b5600689cd1a0,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,13/Mar/24 2:32 PM,27/Mar/24 11:52 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,[~accountid:6228aefc8a4bb60068f5ab06] [~accountid:60fedcdc627b5600689cd1a0] we have engaged with Mastercard and Idemia. All keys for the existing BIN are to be copied to the new BIN.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@1bbe1da0,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzzizz:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"19/Mar/24 3:47 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;[~accountid:6228aefc8a4bb60068f5ab06]  please can you help providing KCVs for Mettle production keys?
We are copying all keys but need to confirm them first.



CC: [~accountid:6328729388ed2ebef978552f] ","27/Mar/24 11:43 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;The *BINs and key types* involved into this project are:

The source keys that we will copy are:

*BIN: 537312*

*CVK – KCV: 9A75B4*

*IMKac POS 5 & POS 7 – KCV: 5941CF*",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,123197,OPS-15671,Mettle - Main ticket for: New BIN setup,To Do,13/Mar/24 2:32 PM
BL | PROD | METTLE | ZD-640767 | Mastercard STIP for Rules engine failure ,OPS-14591,116083,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,Juliano Polican Ciena,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,Juliano Polican Ciena,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,15/Nov/23 5:50 PM,18/Dec/23 9:48 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,,,"Hi Service Delivery / DBA Team,

For solving issue reported under:
https://paymentology.zendesk.com/agent/tickets/640767

We need applying solution recommended here: https://paymentology.atlassian.net/browse/DEV-11645110?focusedCommentId=155251

For such, please execute query below in:
Region: PROD
Client: METTLE
DB: PayCore
SQL:

    update t_auth set de22 = public.f_prepare_de22(de22_1, de22_2, de61_6, network) where de22 = '';

~* Please see Zendesk Support tab for further comments and attachments.~",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@1534aa9a,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzygaf:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-12-18 07:48:21.846,,,"17/Nov/23 3:01 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;JFR, slack thread: [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1700063904420529?thread_ts=1697132886.183769&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1700063904420529?thread_ts=1697132886.183769&cid=C02CA1QPG5Q|smart-link] ",18/Dec/23 9:48 AM;611a52967b538a006964a439;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955]  Is it done or still required. Please advise and close ticket is the subjected task already completed. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,15/Nov/23 5:50 PM
Mettle- Test change to new FAST URLs in PRD,OPS-13973,113096,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,High,,Bilal Hashmi,60fedcdc627b5600689cd1a0,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,04/Oct/23 1:18 PM,06/Nov/23 12:17 PM,,,,,,,,,,,,,,Service Delivery. DO NOT USE. Team moved to ESRM Jira,,,,,,,,,,,0,,,,,"SD TEAM:
Is it possible to please test this URL out on a few transactions before doing complete switchover? 
UAT testing was done, but client still worried of issues.

*Internal:* This ticket has been escalated to the Advanced Support team for assistance. See the _Side Conversation_ associated with this request for more.

For more information on how tickets are escalated to the Advanced Support team, please see: Escalating tickets to the Advanced Support team

*❗Warning❗*

bq. Tickets not logged following the process risk the incorrect Priority or SLA being applied and the ticket may be rejected.

~* Please see Zendesk Support tab for further comments and attachments.~",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@72b02603,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzxzzj:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-11-06 10:17:54.278,,,"02/Nov/23 1:05 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Hi [~accountid:60fedcdc627b5600689cd1a0] please can this be assigned to someone in SD OR do we need other team from Infra to assist?
CC: [~accountid:6273fc10807e0000691d5dee] ",06/Nov/23 12:17 PM;60fedcdc627b5600689cd1a0;This is allowed from network side ? ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,04/Oct/23 1:18 PM
BL: Add ABU Endpoints to MasterCard Clients,OPS-13472,111166,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,,,Michael Martin Chiwere,6273fbf9e01c14006a5309eb,Michael Martin Chiwere,6273fbf9e01c14006a5309eb,05/Sep/23 8:20 AM,05/Sep/23 8:52 AM,,,,,,,,,,,,,,Service Delivery. DO NOT USE. Team moved to ESRM Jira,,,,,,,,,,,0,,,,,"The clearing team has recently implemented MasterCard settlement files logic tests. Before these tests are enabled, we need each MasterCard client to have an ABU Endpoint configured in the {{p_clients}} table in {{paycore}} database. We therefore request updating the {{abu_endpoint}} field in the table with the ABU Endpoint for each of the clients listed below: 

{adf:display=block}
{""type"":""table"",""attrs"":{""isNumberColumnEnabled"":false,""layout"":""default"",""localId"":""caa82194-522a-4511-8c56-1f3624757c89""},""content"":[{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Environment""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Client ID""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Client Name""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""ABU Endpoint""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""BOJ""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""344186""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Bank of Jordan""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""ISB""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""136309""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Islandsbanki""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""rowspan"":6},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""SHARED02""}]},{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]},{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]},{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]},{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]},{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""793455        ""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Manigo""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""835251        ""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""GSB - Constantinople""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""453476""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Bank of London and The Middle East PLC""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""275953        ""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""TPL (Transact Payments Ltd)""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""856725        ""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""BB2 DIGITAL AND TECHNOLOGY SERVICES LTD""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":"" ""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""937695        ""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Utility Warehouse""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0070656""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""MOX""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""191166""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Dragon-SC""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0078828""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""METTLE""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""597899""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Mettle""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0075691""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""TWEEQ Production""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""TWEEQ UAT""}]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[]}]},{""type"":""tableCell"",""attrs"":{},""content"":[{""type"":""paragraph"",""content"":[]}]}]}]}
{adf}

The table above shows the current data that is in the respective environments, where the ABU Endpoint is either empty or is already set. For the clients where the endpoint is empty, we do not know what the value should be and hopefully you may know it, or where to get it. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEV-11642052,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3410d458,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzxq3r:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,05/Sep/23 8:20 AM
Mettle - DR - Apps Sync,OPS-13454,111119,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,Salik.hashmi,611a52967b538a006964a439,Bilal Hashmi,60fedcdc627b5600689cd1a0,Bilal Hashmi,60fedcdc627b5600689cd1a0,04/Sep/23 2:19 PM,04/Sep/23 2:19 PM,,,,,,,,,,,,,,Service Delivery. DO NOT USE. Team moved to ESRM Jira,,,,,,,,,,,0,,,,,Synchronize Mettle DR Apps with production,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3012f4bf,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzxpvz:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,04/Sep/23 2:19 PM
UAT - Mettle - allow new endpoints for FAST,OPS-13308,110373,Task,In Progress,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,High,,Mostafa Elhoseiny,6328729388ed2ebef978552f,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,23/Aug/23 1:57 PM,08/Sep/23 2:11 PM,,,,,,,,,,,,,,Infrastructure. DO NOT USE. Team moved to PLTI Jira,,,,,,,,,,,0,jira_escalated,,,,"Please can you check if we need to whitelist URL/ allow connection on Network level to assist in setting up the new endpoints for FAST?
The endpoints has already been amended in UAT, but its not sending FAST to Mettle

- http://card-payments.stg.nwboxed.com:80/v1/ctrl/fast/auth
- http://card-payments.stg.nwboxed.com:80/v1/ctrl/fast/presentment



Also tried now to telnet to this destination card-payments.stg.nwboxed.com on port 80 but cannot reach.

_[mostafa.elhoseiny@pt-uat-app01 ~]$ telnet card-payments.stg.nwboxed.com 80 --> Trying 10.52.30.32..._

~* Please see Zendesk Support tab for further comments and attachments.~",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@29a7296f,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzxlen:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-08-24 07:28:59.404,,,"24/Aug/23 9:15 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Hi [~accountid:712020:967b64b6-cf4c-4bcb-a081-78dce695db27] [~accountid:61dc367f7aa7ac00707aefc5] can you please help assign someone to assist us with this request?

CC: [~accountid:6328729388ed2ebef978552f] ",24/Aug/23 9:28 AM;6328729388ed2ebef978552f;*Environment : UAT*,24/Aug/23 5:26 PM;61dc367f7aa7ac00707aefc5;hi [~accountid:601a574f332cbe007013fb6c]  - who from your team can assist?,29/Aug/23 4:02 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;[~accountid:601a574f332cbe007013fb6c] please can you assist with this?,30/Aug/23 10:29 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Hi [~accountid:61dc367f7aa7ac00707aefc5] can we perhaps get an ETA for this task to assist us with planning this with the client?,04/Sep/23 5:16 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Hi [~accountid:601a574f332cbe007013fb6c] [~accountid:712020:967b64b6-cf4c-4bcb-a081-78dce695db27] please can someone be assigned to whitelist these URLs as we cannot continue with any testing [~accountid:60fc636052162b00681d341b] [~accountid:615587377a6be40071b2df7e] [~accountid:6228aefd6a4c4c0070b197d9] [~accountid:60fedd468c15ca006ffc3ef1] can one of you pick this up please for [~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] ,"05/Sep/23 5:38 AM;60fedd468c15ca006ffc3ef1;HI [~accountid:6228aefd6a4c4c0070b197d9] 

Source is 172.18.110.9, Destination is [card-payments.stg.nwboxed.com|http://card-payments.stg.nwboxed.com]  (_10.52.30.32 ) , DST port_ *_80  / 443_* _, check if we require enable any connections._

[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1]  / [~accountid:6328729388ed2ebef978552f]  > can you confirm if port 80 for FAST ?  https ( 443) is not there. ? 

[~accountid:6328729388ed2ebef978552f] , Note:  Connections will be via 172.18.110.9 Nginx LB Server only, not directly from APP Server


[~accountid:60fc636052162b00681d341b]  [~accountid:6205526b9493720070b93fd2] ","05/Sep/23 10:13 AM;6228aefd6a4c4c0070b197d9;Hi [~accountid:60fedd468c15ca006ffc3ef1] 

Port 443 was already allowed, just added port 80.","05/Sep/23 10:23 AM;60fedd468c15ca006ffc3ef1;HI [~accountid:6328729388ed2ebef978552f] ,

Kindly use [http://172.18.110.9:8050|http://172.18.110.9:8050] in application instead of [+card-payments.stg.nwboxed.com+|http://card-payments.stg.nwboxed.com/v1/ctrl/fast/presentment]+,.+

Note : Client URL is not connecting with 80 , it is connecting only witn 443 . so backend is configured with [https://card-payments.stg.nwboxed.com|https://card-payments.stg.nwboxed.com]

[~accountid:6205526b9493720070b93fd2] [~accountid:557058:02ca33b7-4178-4972-b264-fbfc803b29aa] ","05/Sep/23 2:57 PM;6328729388ed2ebef978552f;Hi [~accountid:60fedd468c15ca006ffc3ef1] ,

provided URL is now used on Mettle UAT , gave a try by simulating a transaction to make sure it reached the new URL but recieved error : 

*2023/09/05 12:53:23.915 DEBUG [Thread-24992] -> Logics.PayAuthDaemon -* {color:#bf2600}*Response code obtained: 426*{color}
*2023/09/05 12:53:23.930 ERROR [Thread-24992] -> Logics.PayAuthDaemon - FAST Active Request: Send FAILED. Client id = 438126(Mettle)* [*http://172.18.110.9:8050/v1/ctrl/fast/auth*|http://172.18.110.9:8050/v1/ctrl/fast/auth] *- . Error occured while Sending/Receiving message to/from FAST Client.*



*Full Log :* 



{noformat}2023/09/05 12:53:23.867 INFO  [Thread-24992] -> Models.DbPayCore - StandInPGSQL updated for mtid: 0100
2023/09/05 12:53:23.875 INFO  [Thread-24992] -> Logics.PayAuthDaemon - FAST Active Advisement Request: Send SUCCESS. Client id = 438126(Mettle)  ( Response Override ) , http://172.18.110.9:8050/v1/ctrl/fast/auth - {
  ""MESSAGE_TYPE"" : {
    ""Message_Type"" : ""0120"",
    ""Message_Desc"" : ""Authorisation Advice""
  },
  ""SUMMARY"" : {
    ""TID"" : ""2438464032345000145"",
    ""RID"" : ""2474089"",
    ""PID"" : ""449"",
    ""Client_Id"" : ""438126"",
    ""Transaction_Date_Time"" : ""05-09-2023 12:53:23"",
    ""Network"" : ""PPWR"",
    ""Spend_Type"" : ""POS - Purchase"",
    ""Spend_Location"" : ""Tesco Cent Ofline PIN      London    GBR"",
    ""Transaction_Amount"" : ""21"",
    ""Transaction_Currency"" : ""GBP"",
    ""Billing_Amount"" : ""21"",
    ""Billing_Currency"" : ""GBP"",
    ""Card_Use_Type"" : ""Chip"",
    ""Customer_Validation"" : ""ARQC "",
    ""Processor_Decision_Code"" : ""05"",
    ""Processor_Reason_Code"" : ""910"",
    ""Processor_Decision_Desc"" : ""Decline - Response Format Error"",
    ""Merchant_Category"" : ""5499 - Miscellaneous Food Stores-Convenience Stores and Specialty Markets"",
    ""Account_Id"" : ""721221148"",
    ""Customer_Ac"" : ""6549a3dd-663a-486e-b461-b4bfaae89ed6"",
    ""Total_Fee_Bill"" : ""0.0""
  },
  ""PROCESSOR_VALIDATIONS"" : {
    ""Pan_Check"" : ""PASS"",
    ""Pin_Check"" : ""NA"",
    ""Expiry_Check"" : ""PASS"",
    ""Track_Check"" : ""PASS"",
    ""CVV_Type"" : ""4"",
    ""CVV_Check"" : ""BYPASS"",
    ""ARQC_Check"" : ""PASS"",
    ""3DS_Check"" : ""NA"",
    ""Test_Matrix"" : ""2447425042760349113"",
    ""Test_Results"" : ""0"",
    ""Rules_Checked"" : ""783"",
    ""Rules_Triggered"" : """",
    ""Rules_Decision"" : ""00""
  },
  ""ISO_MSG"" : {
    ""DE2"" : ""977431176"",
    ""DE3_1"" : ""00"",
    ""DE3_2"" : ""00"",
    ""DE3_3"" : ""00"",
    ""DE4"" : ""000000002100"",
    ""DE6"" : ""000000002100"",
    ""DE7"" : ""0905125323"",
    ""DE10"" : ""61000000"",
    ""DE11"" : ""000145"",
    ""DE12"" : ""122850"",
    ""DE13"" : ""0905"",
    ""DE14"" : ""2806"",
    ""DE15"" : ""0612"",
    ""DE16"" : ""0612"",
    ""DE18"" : ""5499"",
    ""DE22"" : ""051"",
    ""DE23"" : ""000"",
    ""DE32"" : ""012345"",
    ""DE35"" : ""977431176D28062260977431176***"",
    ""DE37"" : ""085000100003"",
    ""DE38"" : ""10530Z"",
    ""DE39"" : ""05"",
    ""DE41"" : ""12345678"",
    ""DE42"" : ""123456789123456"",
    ""DE43"" : ""Tesco Cent Ofline PIN      London    GBR"",
    ""DE48"" : {
      ""1"" : ""R"",
      ""38"" : ""Z""
    },
    ""DE49"" : ""826"",
    ""DE51"" : ""826"",
    ""DE55"" : {
      ""82"" : ""5800"",
      ""95"" : ""0000000000"",
      ""9F10"" : ""0101030003000000"",
      ""9F27"" : ""80"",
      ""9F36"" : ""0008"",
      ""9F34"" : ""440300"",
      ""9F33"" : ""E0E8E8""
    },
    ""DE60"" : ""113"",
    ""DE61"" : ""0000000000800826902101234"",
    ""DE63"" : ""MCS0110QJ""
  },
  ""RULES"" : [ {
    ""Rule_Id"" : 783,
    ""Rule_Type"" : ""Au"",
    ""Rule_Check_Result"" : 0,
    ""Pattern_Result"" : false,
    ""Current_Txn_Amt_Deviation"" : 0.0,
    ""Aggregate_Deviation"" : 0.0,
    ""Count_Deviation"" : 0
  } ]
}
2023/09/05 12:53:23.915 DEBUG [Thread-24992] -> Logics.PayAuthDaemon - Response code obtained: 426
2023/09/05 12:53:23.930 ERROR [Thread-24992] -> Logics.PayAuthDaemon - FAST Active Request: Send FAILED. Client id = 438126(Mettle) http://172.18.110.9:8050/v1/ctrl/fast/auth - . Error occured while Sending/Receiving message to/from FAST Client.{noformat}


*Environment : UAT*",06/Sep/23 1:02 PM;6328729388ed2ebef978552f;[~accountid:60fedd468c15ca006ffc3ef1] can you please check on the NGINX server ?,"06/Sep/23 1:57 PM;60fedd468c15ca006ffc3ef1;HI [~accountid:6328729388ed2ebef978552f] ,

Below is the logs from nginx .  request has reached client &got 426 error .

now enabled  proxy_http_version 1.1; can you try again , if not working we need to check with Client

{noformat}[06/Sep/2023:07:32:34 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.076 uct=""0.023"" uht=""0.038"" urt=""0.038"" uaddr=""10.52.30.80:443""
[06/Sep/2023:07:32:38 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.181 uct=""0.165"" uht=""0.181"" urt=""0.181"" uaddr=""10.52.30.133:443""
[06/Sep/2023:08:00:00 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.224 uct=""0.023"" uht=""0.038"" urt=""0.038"" uaddr=""10.52.30.80:443""
[06/Sep/2023:08:00:00 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.041 uct=""0.024"" uht=""0.041"" urt=""0.041"" uaddr=""10.52.30.32:443""
[06/Sep/2023:08:30:00 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.215 uct=""0.021"" uht=""0.035"" urt=""0.035"" uaddr=""10.52.30.80:443""{noformat}","06/Sep/23 3:20 PM;6328729388ed2ebef978552f;Hi [~accountid:60fedd468c15ca006ffc3ef1] ,

Now the error changed : 

{color:#bf2600}023/09/06 12:57:36.781 DEBUG [Thread-554] -> Logics.PayAuthDaemon - Response code obtained: 404{color}
{color:#bf2600}2023/09/06 12:57:36.789 ERROR [Thread-554] -> Logics.PayAuthDaemon - FAST Active Request: Send FAILED. Client id = 438126(Mettle) {color}[{color:#bf2600}http://172.18.110.9:8050/v1/ctrl/fast/auth/{color}|http://172.18.110.9:8050/v1/ctrl/fast/auth/]{color:#bf2600} - . Error occured while Sending/Receiving message to/from FAST Client.{color}","06/Sep/23 4:28 PM;60fedd468c15ca006ffc3ef1;Hi [~accountid:6328729388ed2ebef978552f] ,

Need to check with the Client.   repsonse is from Client URL","06/Sep/23 4:51 PM;6328729388ed2ebef978552f;Hi [~accountid:60fedd468c15ca006ffc3ef1] ,
After removing the “/” from the end of URL , received Error Response code {color:#bf2600}*obtained: 502*{color}

{color:#bf2600}2023/09/06 14:47:03.588 DEBUG [Thread-599] -> Logics.PayAuthDaemon - Response code obtained: 502{color}
{color:#bf2600}2023/09/06 14:47:03.845 ERROR [Thread-599] -> Logics.PayAuthDaemon - FAST Active Request: Send FAILED. Client id = 438126(Mettle) {color}[{color:#bf2600}http://172.18.110.9:8050/v1/ctrl/fast/auth{color}|http://172.18.110.9:8050/v1/ctrl/fast/auth]{color:#bf2600} - . Error occured while Sending/Receiving message to/from FAST Client.{color}


Can you double check is this response code is from the Mettle URL as well  ?","07/Sep/23 2:42 PM;60fedd468c15ca006ffc3ef1;HI [~accountid:6328729388ed2ebef978552f] ,

Response is from Client Side

{noformat}[06/Sep/2023:07:32:34 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.076 uct=""0.023"" uht=""0.038"" urt=""0.038"" uaddr=""10.52.30.80:443""
[06/Sep/2023:07:32:38 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.181 uct=""0.165"" uht=""0.181"" urt=""0.181"" uaddr=""10.52.30.133:443""
[06/Sep/2023:08:00:00 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.224 uct=""0.023"" uht=""0.038"" urt=""0.038"" uaddr=""10.52.30.80:443""
[06/Sep/2023:08:00:00 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.041 uct=""0.024"" uht=""0.041"" urt=""0.041"" uaddr=""10.52.30.32:443""
[06/Sep/2023:08:30:00 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 426 0 ""-"" ""Java/1.8.0_372""rt=0.215 uct=""0.021"" uht=""0.035"" urt=""0.035"" uaddr=""10.52.30.80:443""
[06/Sep/2023:12:57:36 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 404 0 ""-"" ""Java/1.8.0_372""rt=0.076 uct=""0.023"" uht=""0.039"" urt=""0.039"" uaddr=""10.52.30.32:443""
[06/Sep/2023:12:57:36 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 404 0 ""-"" ""Java/1.8.0_372""rt=0.041 uct=""0.025"" uht=""0.041"" urt=""0.041"" uaddr=""10.52.30.32:443""
[06/Sep/2023:13:00:00 +0000] ""POST /v1/ctrl/fast/auth/ HTTP/1.1"" ""-"" 404 0 ""-"" ""Java/1.8.0_372""rt=0.053 uct=""0.023"" uht=""0.039"" urt=""0.039"" uaddr=""10.52.30.133:443""
[06/Sep/2023:13:30:00 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.360 uct=""0.021"" uht=""0.228"" urt=""0.228"" uaddr=""10.52.30.80:443""
[06/Sep/2023:14:00:00 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.272 uct=""0.024"" uht=""0.242"" urt=""0.242"" uaddr=""10.52.30.133:443""
[06/Sep/2023:14:30:00 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.426 uct=""0.027"" uht=""0.245"" urt=""0.245"" uaddr=""10.52.30.80:443""
[06/Sep/2023:14:47:02 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.415 uct=""0.023"" uht=""0.234"" urt=""0.234"" uaddr=""10.52.30.80:443""
[06/Sep/2023:14:47:03 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.240 uct=""0.022"" uht=""0.240"" urt=""0.240"" uaddr=""10.52.30.80:443""
[06/Sep/2023:14:47:03 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.239 uct=""0.022"" uht=""0.239"" urt=""0.239"" uaddr=""10.52.30.80:443""
[06/Sep/2023:14:47:03 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.246 uct=""0.023"" uht=""0.246"" urt=""0.246"" uaddr=""10.52.30.133:443""
[06/Sep/2023:15:00:00 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.250 uct=""0.024"" uht=""0.233"" urt=""0.233"" uaddr=""10.52.30.80:443""
[06/Sep/2023:15:00:01 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.234 uct=""0.026"" uht=""0.234"" urt=""0.234"" uaddr=""10.52.30.133:443""
[06/Sep/2023:15:30:00 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.298 uct=""0.028"" uht=""0.236"" urt=""0.236"" uaddr=""10.52.30.133:443""
[06/Sep/2023:16:00:00 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.399 uct=""0.025"" uht=""0.242"" urt=""0.242"" uaddr=""10.52.30.133:443""
[06/Sep/2023:16:30:00 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.282 uct=""0.024"" uht=""0.236"" urt=""0.236"" uaddr=""10.52.30.133:443""
[06/Sep/2023:17:00:00 +0000] ""POST /v1/ctrl/fast/auth HTTP/1.1"" ""-"" 502 0 ""-"" ""Java/1.8.0_372""rt=0.330 uct=""0.022"" uht=""0.240"" urt=""0.240"" uaddr=""10.52.30.80:443""
{noformat}

[~accountid:6205526b9493720070b93fd2] [~accountid:601a574f332cbe007013fb6c] ",07/Sep/23 2:45 PM;6328729388ed2ebef978552f;Thank you [~accountid:60fedd468c15ca006ffc3ef1] for your support.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,04/Sep/23 5:20 PM
Apple Pay - change velocity check for cvv from 30 min to 24 hours,OPS-12042,104822,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,High,,,,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,17/May/23 10:14 AM,17/May/23 10:17 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"Apple Pay requirements and the feedback from Mettle certification is that they'd expect the FPAN to be locked from further attempts for 24 hours.

We have the velocity rule of 30 minutes at the moment for NOMO, not sure if this is something we can use/change to 24 hours?

!image-20230517-081354.png|width=800,height=402!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,17/May/23 10:14 AM;ug:3e4f5544-8421-4a2a-884b-4704ced3f3b6;image-20230517-081354 (16f745fb-b1bb-4edc-9581-b191b9b6c198).png;https://paymentology.atlassian.net/rest/api/3/attachment/content/59655,17/May/23 10:13 AM;ug:3e4f5544-8421-4a2a-884b-4704ced3f3b6;image-20230517-081354.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/59654,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@2a46d99a,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzwqv3:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,17/May/23 10:14 AM
UAT-Mettle-Tokenization-CSAPI-MeaWallet-TokenUpdateAccount,OPS-11411,102747,Bug,Awaiting Deployment,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,Joshua Caponong,62b592a433a882e2be4b4280,Mostafa Elhoseiny,6328729388ed2ebef978552f,Mostafa Elhoseiny,6328729388ed2ebef978552f,10/Apr/23 2:29 PM,26/Apr/24 4:50 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Hi [~accountid:60fedcdc75ad960069b85175] and [~accountid:62b592a433a882e2be4b4280]  , 

During processing the response received from MW , Payapi raised a null pointer exception. accordingly replied back to the API call by{{ ""error_id"" : 900,}}
{{ ""error_desc"" : ""Internal Server Error}}

Full log ( request sent to MW and received from MW ) is attached.

Slack Reference:  [https://paymentology.slack.com/archives/C02CSC3K05R/p1680787456782259|https://paymentology.slack.com/archives/C02CSC3K05R/p1680787456782259|smart-link] 

[^UAT - status = 200 Response - TokenUpdate MW Req-Resp.txt]

",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,10/Apr/23 2:29 PM;6328729388ed2ebef978552f;UAT - status = 200 Response - TokenUpdate MW Req-Resp.txt;https://paymentology.atlassian.net/rest/api/3/attachment/content/58016,13/Apr/23 4:25 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230413-142427.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58249,13/Apr/23 4:25 PM;ug:138c8bbb-a6f7-4f16-b235-64e7d78df047;image-20230413-142458.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/58250,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@8d7bc3b,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzwg7r:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-04-13 14:25:09.575,,,"11/Apr/23 9:28 AM;6328729388ed2ebef978552f;Request Message : 
{

""api_call_unique_identifier"":""b3093787-9c5f-40fb-a097-98e4a7422165"",

""client_id"":438126,

""token"":292321677,

""replacement_token"":351944868,

""reasonCode"":""R""

}","13/Apr/23 4:25 PM;62b592a433a882e2be4b4280;Tested in UAT and nullptr exception is not encountered anymore. However, since the replaced token is not available in {{p_card_wallet_token}} a new error which is SQL exception is encountered. But this is more of a different issue than this ticket nor related to this. So from this error: 


!image-20230413-142427.png|width=574,height=653!

It is now fixed, but this the next issue since there is no token to update in the database: 

!image-20230413-142458.png|width=2342,height=908!","17/Apr/23 2:17 PM;62b592a433a882e2be4b4280;Changes for Shared02 for next CCM (April 18, 2023)

PayApi (Shared02) - merged in release branch [https://gitlab.com/paymento/source/bl2.0/payapi/-/tree/release/2.12.5-patch|https://gitlab.com/paymento/source/bl2.0/payapi/-/tree/release/2.12.5-patch]
Next tag number: 2.12.14



PayApi (ADQ) - merged in release branch [https://gitlab.com/paymento/source/bl2.0/payapi/-/tree/release/2.9.7.2-patch|https://gitlab.com/paymento/source/bl2.0/payapi/-/tree/release/2.9.7.2-patch]

Next tag number: 2.9.7.10","18/Apr/23 1:09 PM;611a52967b538a006964a439;Following CCM 18/04 - *SH02*

No Downtime - Only RiskTime
Activity Window: 25th April 2023
Time : 0600 - 0800 UTC",18/Apr/23 1:16 PM;62b592a433a882e2be4b4280;Hi [~accountid:611a52967b538a006964a439] when will be the schedule for ADQ server?,"18/Apr/23 2:09 PM;611a52967b538a006964a439;This is scedule on Following CCM 18/04 *- ADQ*

Planned for 27th April
Time: 22:00 - 23:00 *UAE TIME*
No Downtime Time (Only fucntion deployment) and API restart for another ticket.","18/Apr/23 2:09 PM;611a52967b538a006964a439;This is scedule on Following CCM 18/04 *- ADQ*

Planned for 27th April
Time: 22:00 - 23:00 *UAE TIME*
No Downtime Time (Only fucntion deployment) and API restart for another ticket.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,18/Apr/23 8:13 AM
BL 1.4.42,OPS-10941,100728,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,,,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,01/Mar/23 7:06 AM,01/Mar/23 7:50 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"[[DEV-11637002] - JIRA (atlassian.net)|https://paymentology.atlassian.net/browse/DEV-11637002]
[[DEV-11635741] [PT Internal] DC, MOX, METTLE - Missing table p_status_acc causing f_report_monthly_active_account_2 function to fail - JIRA (atlassian.net)|https://paymentology.atlassian.net/browse/DEV-11635741]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@14c26a79,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzw5rz:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,01/Mar/23 7:06 AM
BL: As Mettle I would like to have a Key pair generated on UAT to be used for MDES TAV Generation,OPS-10598,99460,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Major,,Abishek Subramaniyam,6228aefc8a4bb60068f5ab06,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,01/Feb/23 3:41 PM,13/Mar/23 6:37 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"In order for Mettle to use our new implementation of [Generate MDES Digitization Data API|https://uat.banking.live/paycontrol/api#operation/v2_sc_generate_MDES_digitization_data] during their push provisioning process, they first need a key-pair generated. That way we are able to generate a TAV value and sign it with the private key.

h3. 

h3. What needs to happen?

* We need to generate an asymmetric key pair, using RSA (minimum 2048-bit key).
** !Captura de pantalla 2023-02-02 a las 8.39.43.png|width=919,height=289!

** !Captura de pantalla 2023-02-02 a las 9.43.44.png|width=922,height=441!

* I believe we will need to create a CSR for this as well
** Because this will be on UAT and Mettle will not actually be uploading the public key to Mastercard, I don’t think we need the CSR. (But we will need it when we create the keys on prod) 
** The CSR must be in PKCS#10 format, base64 encoded.  
*** Common Name (CN) = Customer Identifier (CID)   
**** 6-digit identifier used internally by Mastercard to uniquely identify an institution  
**** We need to get the CID from Mettle  
*** Organization Unit (OU) = Key Unique Reference  
**** UTF-8 encoded value restricted to alphanumeric upper case characters and ‘-’ (U+002D); the value is a maximum of 24 characters determined by the issuer.  
***** I guess we can use any reference we want here  
*** Organization (O) = Free text determined by the issuer  
**** Should we use Mettle?  
*** Country (C) = ISO 3166 
**** 2-character country code  
***** Mettle is based in the UK so we should use GB

* We will need to share the public key with Mettle -so that they can upload it to the Mastercard Portal-
** They will not be sharing the key with Mastercard yet
* We will need to store the private key on the server
** Where do we currently store keys?
*** This is an example of the location in UAT:

!Captura de pantalla 2023-02-01 a las 18.39.03.png|width=569,height=120!

** The engineers will then update the DB value {{p_client_mdes_config}}.{{private_key_path_for_tav_signature}} to point to the private key location
* Please can we do this for UAT
* Mettle are not ready for Prod testing yet",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,01/Feb/23 7:40 PM;sean;Captura de pantalla 2023-02-01 a las 18.39.03.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/54586,02/Feb/23 9:42 AM;sean;Captura de pantalla 2023-02-02 a las 8.39.43.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/54596,02/Feb/23 10:48 AM;sean;Captura de pantalla 2023-02-02 a las 9.43.44.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/54601,02/Feb/23 10:11 AM;sean;Public Key infrastructure Exchange Procedures for Mastercard Business Partners.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/54598,13/Mar/23 6:37 PM;ug:3e4f5544-8421-4a2a-884b-4704ced3f3b6;TAV UAT testing.msg;https://paymentology.atlassian.net/rest/api/3/attachment/content/56634,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@71c42e54,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvzfr:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"13/Mar/23 6:37 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;[~accountid:557058:4f540850-1319-42e3-9630-bc67cd95e8c2] [~accountid:6127cacc3ef46a007079f2b3] Mettle would like to move the TAV changes to production. And provided sign-off - attached email.
Can this be presented at CCM? ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,01/Feb/23 3:41 PM
prod/mettle,OPS-10526,99287,Sub-task,On Hold,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,Salik.hashmi,611a52967b538a006964a439,James Evans,61dc367f7aa7ac00707aefc5,James Evans,61dc367f7aa7ac00707aefc5,27/Jan/23 6:33 PM,19/Sep/23 12:39 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,OPS-10538,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@66070fcb,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvyi7:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-02-23 09:36:48.442,,,"23/Feb/23 11:36 AM;611a52967b538a006964a439;Below actions discussed as part of Liquibase Enablement On Mettle.

1 Production DB Schema Export - DBA  [@Finlay Tachiona|https://paymentology.slack.com/team/U0283TMCAE6]
2 Schema Review + Script Creation  - Dev [@Rohan Ale|https://paymentology.slack.com/team/U0280SZRVUM]
3 SH03 Database server specs to be upgrade as per prod env- Infra
4 PG Admin Upgrade - DBA [@Finlay Tachiona|https://paymentology.slack.com/team/U0283TMCAE6]
5 Production DB restore on SH03 DB- DBA [@Finlay Tachiona|https://paymentology.slack.com/team/U0283TMCAE6]
6 Script Execution (Capture and Document Duration of Each Script) -  DBA + Dev + Rule Engine Team [@Finlay Tachiona|https://paymentology.slack.com/team/U0283TMCAE6] . [@Rohan Ale|https://paymentology.slack.com/team/U0280SZRVUM] [@Grigory|https://paymentology.slack.com/team/U02RKLFKPL1]
7 Signoff OF Downtime Duration W.r.t To Finalized Script
8 Application (PS, API, Paycontrol and PKS) start on SH03 server- SD [@Salik Hashmi|https://paymentology.slack.com/team/U02BZTDT03S]
9 API call testing  - QA
10 HandleAuth, Pretok and RuleEngine function call testing via PGAdmin - Dev [@Rohan Ale|https://paymentology.slack.com/team/U0280SZRVUM]
11 Final Signoff to Upgrade Production - SD  [@Salik Hashmi|https://paymentology.slack.com/team/U02BZTDT03S]
12 Production Deployment - SD [@Salik Hashmi|https://paymentology.slack.com/team/U02BZTDT03S]
","23/Feb/23 11:36 AM;611a52967b538a006964a439;Point 1 completed, thanks [@Finlay Tachiona|https://paymentology.slack.com/team/U0283TMCAE6].[https://paymentology.atlassian.net/browse/OPS-10539|https://paymentology.atlassian.net/browse/OPS-10539|smart-link] ","23/Feb/23 11:37 AM;611a52967b538a006964a439;Point 2, it has been decided to get the script as per latest BL 1.5.X family. ETA identified. 24 Feb 2023. Thursday.[https://paymentology.atlassian.net/browse/DEV-11636349|https://paymentology.atlassian.net/browse/DEV-11636349|smart-link] ",23/Feb/23 11:37 AM;611a52967b538a006964a439;Referring point 2 - we are observing a delay due to dev alignment in other priority projects - Refer - [https://paymentology.atlassian.net/browse/DEV-11636349|https://paymentology.atlassian.net/browse/DEV-11636349|smart-link] ,25/Apr/23 3:50 PM;61dc367f7aa7ac00707aefc5;Hi [~accountid:611a52967b538a006964a439]  - are you still waiting on the tickets below?,19/Sep/23 11:59 AM;61dc367f7aa7ac00707aefc5;has mettle been liquibased?? [~accountid:611a52967b538a006964a439]  or [~accountid:60fedcdc627b5600689cd1a0] ,19/Sep/23 12:02 PM;60fedcdc627b5600689cd1a0;No its not done yet,19/Sep/23 12:39 PM;61dc367f7aa7ac00707aefc5;how do we get a date? [~accountid:60fedcdc627b5600689cd1a0] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,96758,OPS-9962,Liquibase-ing Legacy Environments,In Progress,07/Feb/23 4:34 PM
Mastercard clearing FAST message - DE25 missing,OPS-10294,98393,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,09/Jan/23 9:32 AM,16/Jan/23 12:15 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"As per conversation here:
[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1673002032574899|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1673002032574899|smart-link]

When you look at the clearing messages for Mettle in Paycontrol - FAST clearing messages, DE25 is not available. The question is, do we receive DE 25? Or do we not receive it from Scheme?

This is a question that came from client as they are seeing increasing number in *below scenario of pre-auths*

# Receive Auth (categorized as a pre-authorisation)
# Presentment for full amount of the auth is received and auth is settled.
# Then another pre-auth arrives with a Trace ID linked back to the 1st pre-auth but after it was settled.
# Finally a Presentment for full amount of the immediate prior auth.  ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@4317260d,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvszj:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-01-16 10:15:42.878,,,"16/Jan/23 11:58 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Hi [~accountid:611a52967b538a006964a439] coping Slack here
[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1673250494950549?thread_ts=1673002032.574899&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1673250494950549?thread_ts=1673002032.574899&cid=C02CA1QPG5Q|smart-link] 

Is it possible to know if we are receiving this element only sometimes? 

When we do, can you perhaps post a sample here?",16/Jan/23 12:15 PM;611a52967b538a006964a439;Requested input has been shared on [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1673010317981399?thread_ts=1673002032.574899&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1673010317981399?thread_ts=1673002032.574899&cid=C02CA1QPG5Q|smart-link] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,09/Jan/23 9:32 AM
SLA Management,OPS-10253,98197,Story,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,Bilal Hashmi,60fedcdc627b5600689cd1a0,James Letley,6107af3775ad960069182ae2,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,03/Jan/23 12:14 PM,30/Mar/23 12:01 AM,,,,,,,,,,,,,,Service Delivery. DO NOT USE. Team moved to ESRM Jira,,,,,,,,,,,0,jira_escalated,,,,"This ticket is for James Letley and he's team to assist in creating SLA Uptime dashboards/pages for visibility of Uptime for all our platforms/products.

*REQUIREMENT*

UPTIME Pages for our separate products, i.e. ENTERPRISE (dedicated instances), PRO (Shared instances) and SPRINT (shared environment - VE).

*WHY THIS IS URGENTLY REQUIRED*

SLA Monitoring/dashboards are critical for the Client Service Team, as all our Tier 1 clients and many Tier 2 are demanding SLA performance to be presented on a monthly basis at their Monthly Reviews.

Although we may have more complex and specific SLA's with our ENTERPRISE clients (AUTH and API success/failure for example) most clients are only looking for an UPTIME % specific to them or their environment. This will also allow Client Service Team to be able to map the uptime to the client Contract, and present any service credits that could apply, based on the instance/platform performance for the month.



+*POSSIBLE SOLUTION*+

+*ENTERPRISE CLIENTS*+

* We need platform UPTIME % per client instance. This should be total platform availability taking all issues into account and putting a percentage for total uptime for the month.
* We need a total number of AUTH’s and API’s processed per instance, *i.e. 34000 auths processed and 350000 API’s processed for Mettle etc.*



+*PRO*+

* We need platform UPTIME % per environemnt. This should be total platform availability taking all issues into account and putting a percentage for total uptime for the month.



+*SPRINT*+

* There appears to be a page on confluence specifically for GRAB [https://paymentology.atlassian.net/wiki/spaces/CC/pages/6130565221/Grab+-+SLA+Tracker|https://paymentology.atlassian.net/wiki/spaces/CC/pages/6130565221/Grab+-+SLA+Tracker]
* We need a page which would show TOTAL platform availability (VE) and then any specific clients that may have been individually affected for the month would need to be specified and their relative uptime detailed.
* It is NOT expected to show EVERY VE client - only if a client has been affected and it has caused downtime for that client(s) outside of VE as a platform, *i.e. a NODE failure has occurred affecting 3 VE clients.*



+*BANKING.LIVE UAT*+

* We need an UPTIME for our UAT environment, as some of our clients have UAT Environment UPTIME as an SLA in their contract.
* Please see Zendesk Support tab for further comments and attachments.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,05/Jan/23 1:51 PM;ug:2f1b7805-4a81-47c2-bc3e-a86da7df5f16;Mettle API and Auth Percentage for Aug and Sep.xlsx;https://paymentology.atlassian.net/rest/api/3/attachment/content/53428,05/Jan/23 12:57 PM;ug:07acf089-4098-4443-9f3d-bb36ef43144a;image-20230105-104536.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/53424,05/Jan/23 1:43 PM;ug:07acf089-4098-4443-9f3d-bb36ef43144a;image-20230105-114137.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/53427,05/Jan/23 1:43 PM;ug:07acf089-4098-4443-9f3d-bb36ef43144a;image-20230105-114304.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/53426,05/Jan/23 1:52 PM;ug:2f1b7805-4a81-47c2-bc3e-a86da7df5f16;image-20230105-115159.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/53429,05/Jan/23 2:00 PM;ug:2f1b7805-4a81-47c2-bc3e-a86da7df5f16;image-20230105-115929.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/53430,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@16547862,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvrun:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-01-05 10:57:17.317,,,"05/Jan/23 12:57 PM;60fedcdc627b5600689cd1a0;* We then need a 100% correct and signed-off number for AUTHs and API's as per the engagement between Shaun Hodgkiss and the SD team a few weeks ago relating to service credit for METTLE which we retracted based on incorrect data received from SD Team.


We can discuss improvement later but I totally disagree with this point. 

Here the SD team provided the correct data however CE team calculated it wrongly as the CE team believed that reject transactions are downtime.  This is not ideal to blame the team without actually knowing the fact. We can educate the CE team and tell the difference between rejected transactions and downtime. 

Cc. [~accountid:623b163c50bb2b0070b636ea] 

!image-20230105-104536.png|width=942,height=756!","05/Jan/23 1:18 PM;6273fc10807e0000691d5dee;Hi [~accountid:60fedcdc627b5600689cd1a0] just to clarify on your second point, what was requested is what is listed on our SLA with Mettle, what was provided by SD was used directly, there was no interpretation on our side or added data included on our side. As per the engagement with Shaun the SLA’s are not measurable, that this is the main issue here and to rectify this we are in the process of changing these SLA’s cc [~accountid:623b163c50bb2b0070b636ea] ","05/Jan/23 1:43 PM;60fedcdc627b5600689cd1a0;[~accountid:6273fc10807e0000691d5dee] , who provided you the following % highlighted in yellow ? 



!image-20230105-114137.png|width=1024,height=270!

Since Jennifer provided you following in the zendesk ticket



!image-20230105-114304.png|width=1430,height=550!

Please confirm","05/Jan/23 1:48 PM;623b163c50bb2b0070b636ea;[~accountid:60fedcdc627b5600689cd1a0] - I am all for discussing and understanding where issues occur and moving forward, but please can we not muddy the water on what the request on this ticket is. Yes, we need to figure out HOW to present on those SLA’s (AUTH and API’s which is an issue) but this ticket is actually for the creation of MUCH NEEDED and CRITICAL SLA dashboards across the board for all out Products. Happy to continue this discussion over slack between the relevant parties.","05/Jan/23 1:51 PM;6273fc10807e0000691d5dee;Hi [~accountid:60fedcdc627b5600689cd1a0] 

It was Jenifer on this ticket - [https://paymentology.zendesk.com/agent/tickets/389440|https://paymentology.zendesk.com/agent/tickets/389440] - sent on 17/10



!image-20230105-115159.png|width=895,height=470!



In the attached excel sheet that she provided (attached here)

[^Mettle API and Auth Percentage for Aug and Sep.xlsx]

I simply took the data that she provided and even clarified after to be sure that this was correct.

Thanks,

Michael","05/Jan/23 1:57 PM;60fedcdc627b5600689cd1a0;[~accountid:6273fc10807e0000691d5dee] I understood what the confusion here is. 

In the excel sheet provided by Jennifer, it is the % of decline vs successful transactions where as you reported that as an SLA uptime/downtime. 

However, the uptime/downtime matrix was shared separately.","05/Jan/23 2:00 PM;6273fc10807e0000691d5dee;[~accountid:60fedcdc627b5600689cd1a0] - yes the matrix is one of their SLA’s but Mettle are unique in that they have lots of ridiculous SLA’s including the snapshot below and that is what Jenifer provided data on, she was correct in doing so and didn’t make an error I want to make that clear, the error was ultimately made by whoever put the SLA in place on the contract as we cannot possibly measure it!

!image-20230105-115929.png|width=345,height=323!","30/Jan/23 8:41 PM;623b163c50bb2b0070b636ea;[~accountid:60fedcdc627b5600689cd1a0] [~accountid:6107af3775ad960069182ae2] - Please can we have an ETA for this request. With the number of issues we have had recently, our clients are becomes demanding of a full SLA report back on a monthly basis. We cannot do this without these dashboards.","28/Feb/23 9:34 AM;6107af3775ad960069182ae2;This is likely to be Q3/4

cc [~accountid:61dc367f7aa7ac00707aefc5] for scheduling",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,03/Jan/23 12:14 PM
Mettle DR - client connectivity,OPS-9726,95814,Sub-task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,High,,,,James Evans,61dc367f7aa7ac00707aefc5,James Evans,61dc367f7aa7ac00707aefc5,02/Nov/22 1:50 PM,10/May/23 3:26 PM,,,,,,,,,,,,,,Infrastructure. DO NOT USE. Team moved to PLTI Jira,,,,,,,,,,,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,OPS-9466,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5cb5ebeb,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvf4n:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-05-10 13:04:54.467,,,"02/Nov/22 1:51 PM;61dc367f7aa7ac00707aefc5;Currently we have no connectivty in DR for mettle; we have server, dbase etc but no connections.

Before we put any connectivity we need to understand MIPS locations","10/May/23 2:57 PM;61dc367f7aa7ac00707aefc5;hi [~accountid:6228aefd6a4c4c0070b197d9]  - so i’m assuming this ticket can now be marked as done?  or if not done we can start getting all the connectivity in place??

cc [~accountid:601a574f332cbe007013fb6c] ","10/May/23 3:04 PM;601a574f332cbe007013fb6c;No [~accountid:61dc367f7aa7ac00707aefc5], this ticket is for Mettle client connectivity, 

and now we need to initiate the connectivity details with Mettle, 

[~accountid:61e885fc9d17400069e6d5e8]  can loop me in with the client to discuss the change.",10/May/23 3:26 PM;61e885fc9d17400069e6d5e8;Hi [~accountid:601a574f332cbe007013fb6c]  Copying [~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1]  for support.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,93191,OPS-9465,Mettle DR - remaining elements,To Do,02/Nov/22 1:50 PM
Mettle DR - remaining elements,OPS-9465,93191,Task,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,High,,,,James Evans,61dc367f7aa7ac00707aefc5,James Evans,61dc367f7aa7ac00707aefc5,05/Oct/22 11:16 AM,02/Nov/22 1:52 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,OPS-8155,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@28736e71,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzv6bb:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,90011,OPS-8430,UK DR site,To Do,05/Oct/22 11:16 AM
"Check log Hung Issue on DC, Shared 02, MOX and METTLE",OPS-8786,53940,Bug,To Do,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,High,,Bimal Paudel,619a20dff2415000728442aa,abdul.sahaptheen,623ddb7a866b810069e527bc,abdul.sahaptheen,623ddb7a866b810069e527bc,27/Apr/22 9:54 AM,29/Dec/22 11:11 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"Please be informed that in BL we are often facing an issue which is Checklog process is often going to hung mode and the logs are not getting updated in API due to which the alert e mails are not being triggered to Monitoring Team.

Upon investigation with Dev Team, It has been suspected that the function being called is  *CheckLog*
*paylog \\ ps_email_on_error*  and there must be db lock during the function calls.

Hence requesting your assistance to find the lock and fix it.

Herewith attaching the 

[^Shared02_PaySchedulerLogs_Error_ 04212022.txt]
[^Checklogs_Error_Shared02_08th April2022.txt]

application logs during the job hung period.





More details on the slack thread 

[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1650459705449569?thread_ts=1649677884.658059&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1650459705449569?thread_ts=1649677884.658059&cid=C02CA1QPG5Q|smart-card]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,INFR_RELEASES-232,,,,,,,,,,,27/Apr/22 9:54 AM;ug:0fdfee46-fef9-4e69-a82c-95053566662d;Checklogs_Error_Shared02_08th April2022.txt;https://paymentology.atlassian.net/rest/api/3/attachment/content/37788,06/May/22 10:28 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;Existing_DC_Paylog_function_ps_email_on_error_05062022.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/37954,11/May/22 10:14 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;Existing_METTLE_Paylog_function_ps_email_on_error_05112022.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/38022,06/May/22 10:28 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;Existing_MOX_Paylog_function_ps_email_on_error_05062022.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/37953,11/May/22 4:55 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;Existing_SHARED02_Paylog_function_ps_email_on_error_05112022.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/38017,27/Apr/22 9:54 AM;ug:0fdfee46-fef9-4e69-a82c-95053566662d;Shared02_PaySchedulerLogs_Error_ 04212022.txt;https://paymentology.atlassian.net/rest/api/3/attachment/content/37789,04/May/22 3:41 PM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;get_latest_log_update.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/37890,12/May/22 11:13 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;image-20220512-091134.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/38035,12/May/22 11:43 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;image-20220512-094241.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/38037,12/May/22 11:58 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;image-20220512-095752.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/38038,12/May/22 12:11 PM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;image-20220512-101114.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/38039,06/May/22 10:47 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;ps_email_on_error.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/37955,04/May/22 3:24 PM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;ps_email_on_error_v1.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/37889,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@17807fe9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzufsn:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Level 2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2022-05-04 13:24:27.494,,,"04/May/22 3:24 PM;619a20dff2415000728442aa;This single function {{ps_email_on_error}} is used for getting error logs for {{payscheduler}}  {{payapi}} {{paypower}} and {{paykeyservice}} , inside this function we are using left join between trace and error table for each application. While testing it is found that too much time is used to get the logs and I believe we are experiencing timeout because of this delay.

Provided below is the fix for this function, please replace the content of the above function with the content of this function.

[^ps_email_on_error_v1.sql]

","04/May/22 3:41 PM;619a20dff2415000728442aa;Also, this job is in hung state for long time, so we might get alot of emails for errors. For this this we need to update the latest error log id of each application. Please use the query below to get the latest error id of each application from paylog database and update them in paycore database.

[^get_latest_log_update.sql]

","06/May/22 10:28 AM;61d7273c125b120071fe08fa;The affected environments for this currently is MOX, DC and SHARED02. All imapcted environments will be updated with the new function shared by [~accountid:619a20dff2415000728442aa] .

Attaching the existing function *ps_email_on_error* in DC and MOX Paylog DB. For SHARED02 to follow.



[^Existing_DC_Paylog_function_ps_email_on_error_05062022.sql]
[^Existing_MOX_Paylog_function_ps_email_on_error_05062022.sql]




[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1651651679505539?thread_ts=1651196590.687539&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1651651679505539?thread_ts=1651196590.687539&cid=C02CA1QPG5Q|smart-card]","06/May/22 10:47 AM;619a20dff2415000728442aa;This is the final {{ps_email_on_error}} function that needs be executed and the existing {{ps_email_on_error}} will be replaced.

[^ps_email_on_error.sql]

","11/May/22 4:55 AM;61d7273c125b120071fe08fa;Attaching the existing function *ps_email_on_error* in SHARED02 Paylog DB.



[^Existing_SHARED02_Paylog_function_ps_email_on_error_05112022.sql]

","11/May/22 10:14 AM;61d7273c125b120071fe08fa;Attaching the existing function *ps_email_on_error* in METTLE Paylog DB.

[^Existing_METTLE_Paylog_function_ps_email_on_error_05112022.sql]

","12/May/22 10:59 AM;611a52967b538a006964a439;Functioned deployed: 2022-05-12 09:57:37.62486+01

Below actions performed. 

Out from paylog
select ps_jb_log_id from log_payscheduler_trace order by cre_dt desc limit 1 -- 14129197

select api_cl_log_id from log_payapi_trace order by cre_dt desc limit 1  -- 5166360

select pp_tr_log_id from log_paypower_trace order by cre_dt desc limit 1 -- 1890393

select pks_tr_log_id from log_paykey_trace order by cre_dt desc limit 1-- 9919018


Existing values in paycore:
Select last_checked_id_ps,last_checked_id_pp,last_checked_id_api,last_checked_id_pks from conf_psrv;

13943681	1829581	4661547	9867461



update conf_psrv set last_checked_id_ps = 14129197, last_checked_id_pp = 1890393, last_checked_id_api = 5166360, last_checked_id_pks = 9919018;","12/May/22 11:13 AM;61d7273c125b120071fe08fa;Mettle Checklogs are now working fine and updated *ps_email_on_error*  has been deployed in METTLE Paylog DB.



!image-20220512-091134.png|width=1431,height=467!","12/May/22 11:34 AM;611a52967b538a006964a439;Deployed on shared02 : 2022-05-12 10:34:46.034191+01

select ps_jb_log_id from log_payscheduler_trace order by cre_dt desc limit 1 -- 33485246

select api_cl_log_id from log_payapi_trace order by cre_dt desc limit 1  -- 174767622

select pp_tr_log_id from log_paypower_trace order by cre_dt desc limit 1 -- 86727652

select pks_tr_log_id from log_paykey_trace order by cre_dt desc limit 1-- 75320041

update conf_psrv set last_checked_id_ps = 33485246, last_checked_id_pp = 86727652, last_checked_id_api = 174767622, last_checked_id_pks = 75320041

Select last_checked_id_ps,last_checked_id_pp,last_checked_id_api,last_checked_id_pks from conf_psrv;

""last_checked_id_ps""	""last_checked_id_pp""	""last_checked_id_api""	""last_checked_id_pks""
28077542	69704207	154484844	67165476","12/May/22 11:38 AM;611a52967b538a006964a439;Deployed in DC: 2022-05-12 05:38:44.691041-04

select ps_jb_log_id from log_payscheduler_trace order by cre_dt desc limit 1 -- 7663033

select api_cl_log_id from log_payapi_trace order by cre_dt desc limit 1  -- 32120762

select pp_tr_log_id from log_paypower_trace order by cre_dt desc limit 1 -- 10653184

select pks_tr_log_id from log_paykey_trace order by cre_dt desc limit 1-- 34750011

update conf_psrv set last_checked_id_ps = 7663033, last_checked_id_pp = 10653184, last_checked_id_api = 32120762, last_checked_id_pks = 34750011

Select last_checked_id_ps,last_checked_id_pp,last_checked_id_api,last_checked_id_pks from conf_psrv;

7188240	8958223	29715628	33511336","12/May/22 11:43 AM;61d7273c125b120071fe08fa;SHARED02 Checklogs are now working fine and updated *ps_email_on_error* has been deployed in SHARED02 Paylog DB.

!image-20220512-094241.png|width=50%!","12/May/22 11:58 AM;61d7273c125b120071fe08fa;DC Checklogs are now working fine and updated *ps_email_on_error* has been deployed in DC Paylog DB.

!image-20220512-095752.png|width=1420,height=455!","12/May/22 12:11 PM;61d7273c125b120071fe08fa;MOX Checklogs are now working fine and updated *ps_email_on_error* has been deployed in MOX Paylog DB.



!image-20220512-101114.png|width=1436,height=293!","12/May/22 12:22 PM;611a52967b538a006964a439;Mox deployed: 


select ps_jb_log_id from log_payscheduler_trace order by cre_dt desc limit 1 -- 48264934

select api_cl_log_id from log_payapi_trace order by cre_dt desc limit 1  -- 58293830

select pp_tr_log_id from log_paypower_trace order by cre_dt desc limit 1 -- 351669942

select pks_tr_log_id from log_paykey_trace order by cre_dt desc limit 1-- 168595050

update conf_psrv set last_checked_id_ps = 48264934, last_checked_id_pp = 351669942, last_checked_id_api = 58293830, last_checked_id_pks = 168595050

Select last_checked_id_ps,last_checked_id_pp,last_checked_id_api,last_checked_id_pks from conf_psrv;

""last_checked_id_ps""	""last_checked_id_pp""	""last_checked_id_api""	""last_checked_id_pks""
46740309	334693742	54003128	159033261","03/Jun/22 2:37 AM;61d7273c125b120071fe08fa;Hi [~accountid:619a20dff2415000728442aa] as were still encountering the issue on Checklogs. Kindly provide updates here like fixes and also proof that this has been tested.

CC: [~accountid:611a52967b538a006964a439] ","03/Jun/22 2:38 AM;61d7273c125b120071fe08fa;Slack Thread: 

[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1653791869172569?thread_ts=1651196590.687539&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1653791869172569?thread_ts=1651196590.687539&cid=C02CA1QPG5Q|smart-card]","03/Jun/22 10:11 AM;619a20dff2415000728442aa;Hotfix for this issue in Shared 02 is created with the tag {{2.5.2}}, changes include some code enhancement and added logs which will provide us more insight in future, this can be downloaded from [https://gitlab.com/groups/paymento/-/packages/7172630|https://gitlab.com/groups/paymento/-/packages/7172630|smart-link] 
All changes are valid and have passed the test, following is the test result:

{noformat}2022-06-03 08:04:11.464 [main] INFO  MainService - PayScheduler  started ...
2022-06-03 08:04:17.022 [main] INFO  MainService - Database for paycore connected.
2022-06-03 08:04:22.551 [main] INFO  MainService - Database for paytok connected.
2022-06-03 08:04:28.388 [main] INFO  MainService - Database for paylog connected.
2022-06-03 08:04:31.358 [main] INFO  MainService - Updated application startup info to db
2022-06-03 08:04:35.690 [main] INFO  CheckLogs - Getting last checked ids and instance of the applications from db
2022-06-03 08:04:39.352 [main] INFO  CheckLogs - Getting error logs from db 
2022-06-03 08:04:39.654 [main] INFO  CheckLogDb - query:  select * from ps_email_on_error(32027178,30656917,5173719,33638333,?,?,?,?)  as result
2022-06-03 08:05:06.791 [main] INFO  CheckLogs - Error logs size for Module PayScheduler: 10
2022-06-03 08:05:06.836 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.838 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.841 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.844 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.846 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.848 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.850 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.852 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.854 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.856 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.857 [main] INFO  CheckLogs - Error logs size for Module PayPower: 10
2022-06-03 08:05:06.859 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.861 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.863 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.865 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.868 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.870 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.872 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.874 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.876 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.878 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.878 [main] INFO  CheckLogs - Error logs size for Module PayApi: 10
2022-06-03 08:05:06.880 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.882 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.884 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.886 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.887 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.889 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.891 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.893 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.895 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.897 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.898 [main] INFO  CheckLogs - Error logs size for Module PayKeyService: 10
2022-06-03 08:05:06.900 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.902 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.905 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.907 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.909 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.912 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.914 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.915 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.917 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:06.919 [main] INFO  Utility - Email sent to upendra.gautam@paymentology.com
2022-06-03 08:05:07.133 [main] INFO  CheckLogDb - Update query:  update conf_psrv set last_checked_id_ps = 32027191 , last_checked_id_pp = 30657011 ,last_checked_id_api = 5175009, last_checked_id_pks = 33657424
2022-06-03 08:05:07.709 [main] INFO  CheckLogs - Successfully updated last checked id of log for all applications{noformat}","07/Jun/22 2:54 PM;618e4413e1b3e0006973000c;[Bimal Paudel|https://gitlab.com/bimal.paudel] mentioned this issue in [a merge request|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/merge_requests/76] of [Paymento / Source / BL 2.0 / PayScheduler|https://gitlab.com/paymento/source/bl2.0/payscheduler] on branch [feature/INFR_MAIN-728-fix-checklog-hung-issue|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/tree/feature/INFR_MAIN-728-fix-checklog-hung-issue]:{quote}Resolve INFR_MAIN-728 ""Feature/ fix checklog hung issue""{quote}",07/Jun/22 3:22 PM;618e4413e1b3e0006973000c;[upendra gautam|https://gitlab.com/upendra.gautam] mentioned this issue in [a commit|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/commit/a2a08d01657e51bc9d8dc25d01e579a2521ca0b3] of [Paymento / Source / BL 2.0 / PayScheduler|https://gitlab.com/paymento/source/bl2.0/payscheduler] on branch [feature/INFR_MAIN-728-fix-checklog-hung-issue|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/tree/feature/INFR_MAIN-728-fix-checklog-hung-issue]:{quote}Merge branch 'master' into 'feature/INFR_MAIN-728-fix-checklog-hung-issue'{quote},"09/Jun/22 3:04 PM;618e4413e1b3e0006973000c;[Bimal Paudel|https://gitlab.com/bimal.paudel] mentioned this issue in [a merge request|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/merge_requests/78] of [Paymento / Source / BL 2.0 / PayScheduler|https://gitlab.com/paymento/source/bl2.0/payscheduler] on branch [feature/INFR_MAIN-728-fix-checklog-hung-issue|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/tree/feature/INFR_MAIN-728-fix-checklog-hung-issue]:{quote}Resolve INFR_MAIN-728 ""Feature/ fix checklog hung issue""{quote}",10/Jun/22 10:40 AM;618e4413e1b3e0006973000c;[upendra gautam|https://gitlab.com/upendra.gautam] mentioned this issue in [a commit|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/commit/75ef1ba56ae291f97c9a7b81d1b0c6572b443c4e] of [Paymento / Source / BL 2.0 / PayScheduler|https://gitlab.com/paymento/source/bl2.0/payscheduler] on branch [master|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/tree/master]:{quote}Merge branch 'feature/INFR_MAIN-728-fix-checklog-hung-issue' into 'master'{quote},"12/Jul/22 3:30 PM;618e4413e1b3e0006973000c;[Bimal Paudel|https://gitlab.com/bimal.paudel] mentioned this issue in [a commit|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/commit/e98931d0cefbee796d97533587d2794eca20249b] of [Paymento / Source / BL 2.0 / PayScheduler|https://gitlab.com/paymento/source/bl2.0/payscheduler]:{quote}Resolve INFR_MAIN-728 ""Feature/ fix checklog hung issue""{quote}",12/Jul/22 3:30 PM;618e4413e1b3e0006973000c;[upendra gautam|https://gitlab.com/upendra.gautam] mentioned this issue in [a commit|https://gitlab.com/paymento/source/bl2.0/payscheduler/-/commit/75ef1ba56ae291f97c9a7b81d1b0c6572b443c4e] of [Paymento / Source / BL 2.0 / PayScheduler|https://gitlab.com/paymento/source/bl2.0/payscheduler]:{quote}Merge branch 'feature/INFR_MAIN-728-fix-checklog-hung-issue' into 'master'{quote},09/Aug/22 6:29 PM;618e4413e1b3e0006973000c;[Bimal Paudel|https://gitlab.com/bimal.paudel] mentioned this issue in [a merge request|https://gitlab.com/paymento/source/bl2.0/paydb/paylogdb/-/merge_requests/13] of [Paymento / Source / BL 2.0 / PayDB / PayLogDB|https://gitlab.com/paymento/source/bl2.0/paydb/paylogdb] on branch [INFR_MAIN-728-check-log-hung-issue-email-on-error-changes|https://gitlab.com/paymento/source/bl2.0/paydb/paylogdb/-/tree/INFR_MAIN-728-check-log-hung-issue-email-on-error-changes]:{quote}INFR_MAIN-728-check log hung issue email on error changesf ix{quote},10/Aug/22 9:22 AM;618e4413e1b3e0006973000c;[Bimal Paudel|https://gitlab.com/bimal.paudel] mentioned this issue in [a commit|https://gitlab.com/paymento/source/bl2.0/paydb/paylogdb/-/commit/7a6039b8fe7cca7b5dc0f0c3c3f608d43554d799] of [Paymento / Source / BL 2.0 / PayDB / PayLogDB|https://gitlab.com/paymento/source/bl2.0/paydb/paylogdb]:{quote}INFR_MAIN-728-check log hung issue email on error changesf ix{quote},10/Aug/22 9:22 AM;618e4413e1b3e0006973000c;[Bimal Paudel|https://gitlab.com/bimal.paudel] mentioned this issue in [a commit|https://gitlab.com/paymento/source/bl2.0/paydb/paylogdb/-/commit/d878d4706f7736ffe6eda90f5c2f59e0f8edbc93] of [Paymento / Source / BL 2.0 / PayDB / PayLogDB|https://gitlab.com/paymento/source/bl2.0/paydb/paylogdb] on branch [master|https://gitlab.com/paymento/source/bl2.0/paydb/paylogdb/-/tree/master]:{quote}Merge branch 'INFR_MAIN-728-check-log-hung-issue-email-on-error-changes' into 'master'{quote},"29/Dec/22 11:11 AM;62473036f3824d006a5993b1;Hello [~accountid:619a20dff2415000728442aa] , was there a release made for the changes made to the PayLogDB?

For context with this question, see [https://paymentology.slack.com/archives/CF9RFAGUQ/p1672304760322459|https://paymentology.slack.com/archives/CF9RFAGUQ/p1672304760322459|smart-link]

cc: [~accountid:60fedcdc75ad960069b85175] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,06/Sep/22 7:18 PM
Mettle Database Version Upgrade + Rule Engine 3_10 -> 3_11a,OPS-8575,90587,Task,Awaiting Deployment,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Lowest,,,,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,01/Aug/22 9:51 AM,26/Apr/24 4:50 PM,,,,,,,,,,,,,,Service Delivery. DO NOT USE. Team moved to ESRM Jira,,,,,,,,,,,0,,,,,This ticket is created to track all items/actions done subjected to DB migration and version upgrade.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,01/Aug/22 7:38 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;Installer_Derayah_UAT_Older_FW_3_10_to_3_11a_01082022.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/48032,01/Aug/22 7:38 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;Installer_FW_3_10_to_3_11a_Post_Installation_Steps_28062022.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/48034,11/Aug/22 10:36 AM;ug:19077f7d-b152-45e8-9d9f-bdc81e288491;Installer_FW_3_10_to_3_11a_Step_1_Pre_Installation_10082022.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/48228,11/Aug/22 10:36 AM;ug:19077f7d-b152-45e8-9d9f-bdc81e288491;Installer_FW_3_10_to_3_11a_Step_3_Post_Installation_10082022.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/48229,02/Aug/22 2:29 PM;ug:38c5c2e4-0783-428b-adb6-447c94ed09d1;Mettle Rules engine upgrade and Postgres upgrade to vsersion 14 RESULTS (e17bc85c-89a8-4c21-a4f1-2e23fc712b2e).txt;https://paymentology.atlassian.net/rest/api/3/attachment/content/48045,01/Aug/22 7:38 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;PaymentologyC2 (371e8f80-b856-4647-b058-f662ff74a7c7).c;https://paymentology.atlassian.net/rest/api/3/attachment/content/48033,01/Aug/22 9:53 AM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;PaymentologyC2.c;https://paymentology.atlassian.net/rest/api/3/attachment/content/48009,03/Aug/22 9:09 AM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;RuleEngine-Validated Extract Logs.csv;https://paymentology.atlassian.net/rest/api/3/attachment/content/48060,03/Aug/22 9:09 AM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;RuleEngine-Validated Extract.csv;https://paymentology.atlassian.net/rest/api/3/attachment/content/48059,01/Aug/22 9:53 AM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;RuleEngineTest.docx;https://paymentology.atlassian.net/rest/api/3/attachment/content/48010,01/Aug/22 9:53 AM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;tvf_ppwr_ruleengine_v5_3_10_8f.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/48011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@11b8a3e0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzutcn:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2022-08-01 17:38:49.141,,,"01/Aug/22 9:53 AM;611a52967b538a006964a439;attached are the items provided by [~accountid:60fedcb88c15ca006ffc380f]  as part of existing CLIB to work on V14



[^PaymentologyC2.c]
[^tvf_ppwr_ruleengine_v5_3_10_8f.sql]
[^RuleEngineTest.docx]

","01/Aug/22 7:38 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:611a52967b538a006964a439] and [~accountid:60fedcfbec92ab0070555259] \! This is the installer file (don’t be confused by name Derayah in it; just the current state of the Rule Engine Framework is the same). These are the steps I recommend:

# Delete (make a copy first) the PaymentologyC2.so file from the lib subfolder of the Postgre SQL 10 installation
# Upgrade the database server to version 14
# Compile and install the new PaymentologyC2.so file to the lib sunbfolder of the Postgre SQL 14 installation.
# Run the Installer script.
# Run the Post Installation Steps script.

These are the files required:

[^PaymentologyC2 (371e8f80-b856-4647-b058-f662ff74a7c7).c]
[^Installer_Derayah_UAT_Older_FW_3_10_to_3_11a_01082022.sql]
[^Installer_FW_3_10_to_3_11a_Post_Installation_Steps_28062022.sql]

Good luck\!","03/Aug/22 9:09 AM;611a52967b538a006964a439;Now Mettle DB Isolated from shared02 DB stack and new dedicated DBs assigned to it.
Mettle DBs are now running on new version (i.e V14)
Latest Rule Engine Framework and CLIB deployed to Mettle DB. Please be noted currently we still using ruleengineV5 (instead of ruleengineV6) as it require Paypower upgrade as welll.
Validation done for ruleengineV5 requesting [~accountid:60fedcb88c15ca006ffc380f] to review (refer attachments)


[^RuleEngine-Validated Extract.csv]
[^RuleEngine-Validated Extract Logs.csv]

","10/Aug/22 6:13 PM;61bcc3e5028e300068b66a25;Steps to solve problem with deployment:

# Run Pre-Installer which:
a) remebers max ta_id from T_AUTH
b) pre-computes T_AUTH (txns with ta_id <= max_ta_id) into T_RAT3_TMP: ~ 1 hour, txns are being processed in parallel
# stop txn processing
# run Installer
# run Post-Installer: copy data from T_RAT3_TMP into T_RAT3, recompute new txns with ta_id > max_ta_id from T_AUTH appeared on step 1
# enable txn processing

[^Installer_FW_3_10_to_3_11a_Step_3_Post_Installation_10082022.sql]
[^Installer_FW_3_10_to_3_11a_Step_1_Pre_Installation_10082022.sql]

",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,01/Aug/22 7:39 PM
UK DR site,OPS-8430,90011,Epic,In Progress,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Low,,James Evans,61dc367f7aa7ac00707aefc5,James Evans,61dc367f7aa7ac00707aefc5,James Evans,61dc367f7aa7ac00707aefc5,12/Jul/22 5:44 PM,30/Sep/24 4:26 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,EnvironmentBuild,,,,"In order to:

* Provide DR for UK only clients
* Have resilience at the MIP/EAS level
* Have resilience at the cloud region level

We will:

* confirm list of clients that are in scope (for all UK clients e.g. Shared02, Mettle, BAE …)
* check legal requirements for each client
* migrate client by client across to new DR solution
* confirm which DCs will be used - create HLD
* configure the datacentre resources (PR, PK, HSM) - Singapore
* build the Cloud (Azure) infrastructure - Frankfurt - DONE
* enable additional network connections for clients as required - VPNs etc may need to replicated into different regions
* update client and internal documentation

Done when:

* DR/failover tested
* documents updated



+-Note-+

-We will have access to a single MOX MIP in Singapore which we can add our other customers to.  This enables us to build active DR for PayRoute and passive DR for all other services in Singapore.  No longer required due to focus on cloud mips.-",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,OPS-7976,OPS-10488,PLTI-2447,OPS-8155,OPS-8156,OPS-8157,OPS-8158,OPS-12470,,,OPS-9466,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@749704aa,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ghx-label-11,UK DR,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,teal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzqbov:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-05-17 11:52:09.691,,,21/Jul/22 2:44 PM;61dc367f7aa7ac00707aefc5;aiming to have this completed by end of October 2022,26/Jul/22 3:33 PM;61dc367f7aa7ac00707aefc5;meeting on thrusday to discuss  in more detail,30/May/23 2:49 PM;61dc367f7aa7ac00707aefc5;taking off hold and now a priority,16/Jun/23 1:55 PM;61dc367f7aa7ac00707aefc5;where is cloud mips ticket?,16/Jun/23 2:08 PM;61dc367f7aa7ac00707aefc5;currently getting cloud MIP & EAS setup.  Once complete then we need to confirm which client will need to move across.,17/May/24 1:52 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - OPS-12470 has got status Done,"30/Sep/24 4:26 PM;63bea5a049a31f95b873b88c;[~accountid:61dc367f7aa7ac00707aefc5] what's the ETA for BOJ & BAE, when can we start testing the DR for them ?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,03/Aug/22 2:51 PM
IR - Mettle DR,OPS-8155,55037,Task,Blocked,OPS,Operations,software,James Evans,61dc367f7aa7ac00707aefc5,,,Highest,,James Evans,61dc367f7aa7ac00707aefc5,James Evans,61dc367f7aa7ac00707aefc5,James Evans,61dc367f7aa7ac00707aefc5,14/Jun/22 4:22 PM,25/Jan/23 6:37 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"DoD - This client has a DR.

Nb. this is here as a placeholder - updates will be tracked in linked ticket - OPS-8430",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,OPS-8153,,,,,,,,,,,,,,,,,OPS-8430,OPS-9465,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@2a3034a4,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzum53:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,05/Oct/22 11:09 AM;61dc367f7aa7ac00707aefc5;we have completed the cloud elements; we still need address completing a full multi cloud setup; but we need the client to pay for this,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,55028,OPS-8146,Infrastructure Resilience Workstream,In Progress,05/Sep/22 12:10 PM
Azure - Mettle Prod,LMTRCE-49,126525,Task,Backlog,LMTRCE,Linux migration to Rocky Linux (CentOS EoL),software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,,,James Evans,61dc367f7aa7ac00707aefc5,James Evans,61dc367f7aa7ac00707aefc5,07/May/24 4:35 PM,20/Dec/24 6:32 PM,,,,,,,,,,,,,,,,,,,,,,,,13/Feb/25 12:00 AM,0,,,,,,,James Evans,,,,,,,,,,,61dc367f7aa7ac00707aefc5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@a283023,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzzxml:i,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,10/Feb/25 12:00 AM,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,126065,LMTRCE-21,[Workstream 6] Patching and upgrade strategy per cloud/on-prem scenario,To Do,07/May/24 4:35 PM
Azure - Mettle DR,LMTRCE-48,126524,Task,Backlog,LMTRCE,Linux migration to Rocky Linux (CentOS EoL),software,James Evans,61dc367f7aa7ac00707aefc5,,,Normal,,,,James Evans,61dc367f7aa7ac00707aefc5,James Evans,61dc367f7aa7ac00707aefc5,07/May/24 4:35 PM,20/Dec/24 6:32 PM,,,,,,,,,,,,,,,,,,,,,,,,21/Feb/25 12:00 AM,0,,,,,,,James Evans,,,,,,,,,,,61dc367f7aa7ac00707aefc5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@1118d052,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzzxmm:b,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,18/Feb/25 12:00 AM,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,126065,LMTRCE-21,[Workstream 6] Patching and upgrade strategy per cloud/on-prem scenario,To Do,07/May/24 4:35 PM
Mettle - Configure ABU report in production to be sent to MTF,IMP_METTLE-33,52574,Task,In development,IMP_METTLE,IMP: Mettle,software,Kevin.Austin,5fc70793d670b8006e0416a8,,,High,Done,Rohit Thapa,60efedaa4257a90070c63774,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,Sonia Sonnekus,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,17/Mar/22 9:56 AM,25/Apr/22 6:17 PM,,17/Mar/22 9:56 AM,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"We require ABU to be setup for Mettle in production.

Mettle has their own environment:

[+https://prod-lb02.banking.live:48011/paycontrol/+|https://prod-lb02.banking.live:48011/paycontrol/]

 We require:

* scheduled job à “GenerateABU”
the report is to be sent to Mastercard MFE

example below we created for Utility warehouse, we need the same for Mettle.
!image-20220405-161620.png|width=731,height=316!",,ramon.gouveia,Salik.hashmi,Sonia Sonnekus,,,,,,,,,6205526df38765006f676f67,611a52967b538a006964a439,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,INFR_RELEASES-226,INFR_RELEASES-229,,,,,,,,,,05/Apr/22 6:16 PM;ug:3be053c3-01f4-4781-82bb-7e1d33bac05f;image-20220405-161620.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/37413,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@25382517,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzubhj:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2022-04-19 10:40:36.395,null,,24/Mar/22 11:22 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;[~accountid:60fedd388ad5b600707750e1] please can you provide update on scheduling ABU report? Rohit should be able to provide guidance,"28/Mar/22 11:46 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;[~accountid:60fedd388ad5b600707750e1] [~accountid:60fedcdc627b5600689cd1a0] Please need to confirm 

Requesting you to confirm the User ID to add bulk file with the endpoint .I could see user ID Z218278 configured with the bulks T275 & T284 , please confirm whether same user ID to be configured for the bulk R274.

[~accountid:60fedd0cc51f3a00697da234] ","19/Apr/22 12:40 PM;611a52967b538a006964a439;Hi [~accountid:60efedaa4257a90070c63774] ,

As discussed, can you please add Mettle ABU File to Payserv such that it may stage to MFE automatically.","22/Apr/22 10:54 PM;6205526df38765006f676f67;Will be done next monday.
[~accountid:60efedaa4257a90070c63774] ","25/Apr/22 6:17 PM;6205526df38765006f676f67;Done.


[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1646992254201189|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1646992254201189|smart-card]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,28/Mar/22 11:46 AM
Jira access under Customer Support ,IMP_METTLE-20,45454,Task,Deployed to UAT,IMP_METTLE,IMP: Mettle,software,Kevin.Austin,5fc70793d670b8006e0416a8,,,Normal,,Former user,60fedcf97ab143006ea59e60,Former user,60fedcf97ab143006ea59e60,Former user,60fedcf97ab143006ea59e60,18/Dec/20 12:05 PM,24/Jul/22 2:42 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Hi [~accountid:61f621778d9e3c00687d9e16]

We need to grant Jira access to Mettle teams under Jira Customer Support. 

Please see all the user details in the attached form. 

[^Mettle_Jira_access form 1.0.docx]

 

Any questions please let me know. 

Kind regards, 

Claudia ",,Faizan.Qureshi,Former user,Vijay Sridhar,,,,,,,,,601a574f332cbe007013fb6c,60fedcf97ab143006ea59e60,60fedd468c15ca006ffc3ef1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,18/Dec/20 12:04 PM;ug:62f6c112-394c-4938-8965-2a258d970fe4;Mettle_Jira_access form 1.0.docx;https://paymentology.atlassian.net/rest/api/3/attachment/content/29825,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@657c5e12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzs22n:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2021-02-03 09:22:46.699,,,"03/Feb/21 11:22 AM;60fedd468c15ca006ffc3ef1;Hi [~accountid:60fedcf97ab143006ea59e60],

Today we have Jira Activity . post that activity will check these details & get back to you incase anything required 

CC [~accountid:601a574f332cbe007013fb6c]","08/Feb/21 8:27 AM;60fedcdc627b5600689cd1a0;[~accountid:60fedcf97ab143006ea59e60] /[~accountid:60fedd468c15ca006ffc3ef1] why do we have 2 CS projects ?

[~accountid:60fedd468c15ca006ffc3ef1] we will be giving client access to CS: Mettle project ",08/Feb/21 10:10 AM;60fedcf97ab143006ea59e60;[~accountid:60fedcdc627b5600689cd1a0] we dont need 2 CS projects for Mettle - I am not sure why there are 2 CS pages. ,"08/Feb/21 12:00 PM;60fedd468c15ca006ffc3ef1;Hi [~accountid:5fc70793d670b8006e0416a8]

we are having 2 Projects created for Mettle 22-Dec-2020 , 

To which project we should Provide access to customer 

 
|*Sl.No*|*Project Name*|*Project Key*|*Project lead*|
|1|CS: Mettle|CM|Bilal Hashmi|
|2|CS: Mettle_NW|CM_NW|Bilal Hashmi|

CC [~accountid:601a574f332cbe007013fb6c] [~accountid:60fedcf97ab143006ea59e60] [~accountid:60fedcdc627b5600689cd1a0]",08/Feb/21 12:03 PM;5fc70793d670b8006e0416a8;Checking now,08/Feb/21 12:04 PM;5fc70793d670b8006e0416a8;Please can we use  CS: Mettle [~accountid:60fedcdc627b5600689cd1a0] and [~accountid:60fedd468c15ca006ffc3ef1],"14/Feb/21 1:00 PM;60fedd468c15ca006ffc3ef1;Hi [~accountid:60fedcf97ab143006ea59e60],

we already have  10 users for mettle account in  Paymentology Jira

 
|Sl.No|Name|User ID|Email ID|
|1|Anil Guntupalli|anil.guntupalli|anil.guntupalli@mettle.co.uk|
|2|Irene Symeonidou|irene.symeonidou|irene.symeonidou@mettle.co.uk|
|3|Luis Mirabal|luis.mirabal|luis.mirabal@mettle.co.uk|
|4|Leelavathi Kathirappa|leelavathi.kathirappa|leelavathi.kathirappa@mettle.co.uk|
|5|Robert Boothby|robert.boothby|robert.boothby@mettle.co.uk|
|6|Stuart Bowes|stuart.bowes|stuart.bowes@mettle.co.uk|
|7|Charlie Wood|charlie.wood|charlie@mettle.co.uk|
|8|Chris Rahnejat|chris.rahnejat|chris.rahnejat@mettle.co.uk|
|9|Ciprian Briscaru|ciprian.briscaru|ciprian@mettle.co.uk|
|10|Dan Heaver|dan.heaver|dan.heaver@mettle.co.uk|","14/Feb/21 1:00 PM;60fedd468c15ca006ffc3ef1;below 6 users will be disabled as it in the [^Mettle_Jira_access form 1.0.docx] list
|Sl.No|Name|User ID|Email ID|
|1|Anil Guntupalli|anil.guntupalli|anil.guntupalli@mettle.co.uk|
|2|Ciprian Briscaru|ciprian.briscaru|ciprian@mettle.co.uk|
|3|Chris Rahnejat|chris.rahnejat|chris.rahnejat@mettle.co.uk|
|4|Leelavathi Kathirappa|leelavathi.kathirappa|leelavathi.kathirappa@mettle.co.uk|
|5|Robert Boothby|robert.boothby|robert.boothby@mettle.co.uk|
|6|Charlie Wood|charlie.wood|charlie@mettle.co.uk|","14/Feb/21 1:03 PM;60fedd468c15ca006ffc3ef1;these 9 users will be having access for mettle project
||Sl.No||Name||Email ID||
|1|Tanah Bere|tanah.bere@mettle.co.uk|
|2|Ian Hayward|ian.hayward@mettle.co.uk|
|3|Ginto Mathew|ginto.mathew@mettle.co.uk|
|4|Marcus Sanders|marcus.sanders@mettle.co.uk|
|5|Jon Sweet|jon.sweet@mettle.co.uk|
|6|Dan Heaver|dan.heaver@mettle.co.uk|
|7|Irene Symeonidou|irene.symeonidou@mettle.co.uk|
|8|Stuart Bowes|stuart.bowes@mettle.co.uk|
|9|Luis Mirabal|luis.mirabal@mettle.co.uk|",14/Feb/21 1:08 PM;60fedd468c15ca006ffc3ef1;Group with the name *Customer : METTLE* has been created ,"14/Feb/21 3:54 PM;60fedd468c15ca006ffc3ef1;Hi [~accountid:60fedcf97ab143006ea59e60],

mentioned users are created in Jira & mapped to CS: Mettle Project .

*users will have mapped to below 3 groups*
||Sl.No||Group Name||
|1|confluence-users|
|2|Customer (general)|
|3|Customer : METTLE|

CC [~accountid:601a574f332cbe007013fb6c] [~accountid:5fc70793d670b8006e0416a8]","15/Feb/21 11:13 AM;60fedcf97ab143006ea59e60;[~accountid:60fedd468c15ca006ffc3ef1] Thanks for the update. 

Please could you clarify the 3 projects above? I am a bit confused, sorry. 

Kind regards, 

Claudia ","15/Feb/21 11:15 AM;60fedd468c15ca006ffc3ef1;Hi [~accountid:60fedcf97ab143006ea59e60],

it was typo error . now updated it ""groups ""

users will be part of 3 groups ","15/Feb/21 11:21 AM;60fedcf97ab143006ea59e60;[~accountid:60fedd468c15ca006ffc3ef1] thanks for clarifying the above. I have emailed Mettle to confirm the receipt of the user details. 
once I have received their confirmation I will close the ticket./ 

Kind regards, 

Claudia ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,30/Jan/22 7:47 AM
PROD - Mettle - Enabling BASIC STIP (Throttling & Un-throttling) Feature,ESRM-1651,193990,Story,On Hold,ESRM,IT - Release Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,High,,Salik.hashmi,611a52967b538a006964a439,Mostafa Elhoseiny,6328729388ed2ebef978552f,Mostafa Elhoseiny,6328729388ed2ebef978552f,20/Jan/26 4:59 PM,03/Feb/26 12:10 PM,,,,,,,,,,,,,,Config,Investigation,Release,,,,,,,,,0,imps_escalated,,,,"Hi ITSM team ,


Mettle signed off testing the throttling and un-throttling feature (Basic STIP) in UAT and they are asking about *the timescale to get this into Production.*


*The Pre-requisites for enabling this feature in Mettle dedicated production environment are the (*Fix Deployments , Feature deployment - Database Columns and the count of SAF records stored in t_processor_msgs table*)*



*1- Fix Deployments* : 

* Ensure BL version 3.2.0 is available in the dedicated Mettle production environment where the non-success status code fix is existing [https://paymentology.atlassian.net/browse/AUTH-1781|https://paymentology.atlassian.net/browse/AUTH-1781|smart-link]



*2- Feature deployment - Database Columns :* 

* Table Conf_Pauth ( Paycore DB ) should be altered for adding new columns : 

+_Changes in conf_pauth for Throttling :_+

* *_Is_throttling_* { Type =boolean, Default = False}: To mark the FAST client is/isn't throttling.
* *_Threshold_count_to_throttle_*{Type = integer, Default = 100}: Threshold count out of the total count to determine throttling(Value of Y in above example). 
p.s These value will be configurable as per the FAST client requirement.
* *Throttle_time_window*{Type = integer, Default = 10000 ): Time period to be taken into consideration for the transactions within this period to determine if the client endpoint has been throttled. The value of it should be in milliseconds.

 

+_Changes in conf_pauth for un-throttling :_+

* *Time_before_unthrottle* {Type = integer, Default = 10000): Time period to be taken into consideration before attempting to unthrottle the already throttled end points. The value of it would be in milliseconds.
* New column *last_throttle_time* is introduced in the conf_pauth table and is populated during throttling and we are using this value to compare with Time_before_unthrottle.

Ref. [https://paymentology.atlassian.net/wiki/spaces/TS/pages/7891812384/STIP+Internal+Document#%5BinlineExtension%5DThrottling/un-throttling|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7891812384/STIP+Internal+Document#%5BinlineExtension%5DThrottling/un-throttling|smart-link] 



*3- Count of SAF Records in t_processor_msgs in Mettle dedicated production environment :* 

* Query on the SAF records to study in case we need to clear some of them to avoid sending all SAF records once SendAdviceMessage job is configured as part of the feature enablement


----

----

*The Feature configuration for enabling BASIC STIP as per Mettle requirements :*

{color:#bf2600}*Client Requirements :* {color}

* Threshold count (transactions): 10 – Backend Database
* Throttle check frequency: ≥ 5 s  - Scheduler
* Time window (ms): 10,000 – Backend Database
* Grace period before un-throttle (ms): 10,000
* Unthrottle check frequency = Every 5 s
* *Job Scheduler*:
** Throttling : Every 5 Seconds
** Unthrottling : Every 5 Seconds
** SendAdviceMessage : Every Hour



{color:#bf2600}*Database and Jobs Configuration :*{color}

* Table : conf_pauth
** Record : Mettle Client Fast record 
** Column : Threshold_count_to_throttle = 10 (10 txns) (The Criteria triggers throttling )
** Column : throttle_time_window = 10000 (10 mins) (The Criteria triggers throttling )
** Column : time_before_unthrottle = 10000 (10 mins) (Grace period before un-throttle )
* Jobs : 
** Throttling : Every 5 Seconds - Email recipient : [genie-cards-engineering@mettle.co.uk|mailto:genie-cards-engineering@mettle.co.uk]
** Unthrottling : Every 5 Seconds - Email recipient : [genie-cards-engineering@mettle.co.uk|mailto:genie-cards-engineering@mettle.co.uk]
** SendAdviceMessage : Every Hour
* Reference is UAT



*Environment : Mettle Dedicated Production*

cc : [~accountid:6273fc10807e0000691d5dee] ",,Mostafa Elhoseiny,Salik.hashmi,,,,,,,,,,6328729388ed2ebef978552f,611a52967b538a006964a439,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,26/Jan/26 2:27 PM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;image-20260126-122726.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/137929,26/Jan/26 2:31 PM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;t_processor_msgs-mettle.csv;https://paymentology.atlassian.net/rest/api/3/attachment/content/137930,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@4662b71a,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07qx0:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2026-01-26 12:27:48.469,,,"23/Jan/26 5:47 PM;6328729388ed2ebef978552f;Hi [~accountid:60fedcdc627b5600689cd1a0] 
Hope all is well
Appreciate your time taking a look at this for Mettle and assigning it a priority.

cc : [~accountid:6273fc10807e0000691d5dee] ","26/Jan/26 2:27 PM;611a52967b538a006964a439;Jobs are setup and parameter are set as advised. 

Currently jobs disabled to confirm on below count of below query. 



Select client_id, flag,transmit_count, count(*) from t_processor_msgs  group by client_id, flag,transmit_count

!image-20260126-122726.png|width=503,alt=""image-20260126-122726.png""!","26/Jan/26 2:31 PM;611a52967b538a006964a439;[^t_processor_msgs-mettle.csv]

","26/Jan/26 2:31 PM;611a52967b538a006964a439;Select client_id, flag,transmit_count,mtid, to_char(cre_Dt,'MON-YYYY'), count(_) from t_processor_msgs  group by client_id, flag,transmit_count,mtid, to_char(cre_Dt,'MON-YYYY')_
_order by count(_) desc","03/Feb/26 12:09 PM;6328729388ed2ebef978552f;[~accountid:611a52967b538a006964a439] Based on the db query results of SAF records [+here+ |https://paymentology.atlassian.net/browse/ESRM-1651?focusedCommentId=302754], and as per the product team [+recommendation+ |https://paymentology.slack.com/archives/C0311J0K146/p1770020732888739?thread_ts=1743774568.648689&cid=C0311J0K146]we should proceed with the following :

1- Full backup _t_processor_msgs_

2- Updating _t_processor_msgs_ with flag = 3 so messages will not be retransmitted.

3- Activate the job tasks including *SendAdviceMessage*

*Important Note : we must update the flag to 3 before enabling SendAdviceMessage job task to avoid sending all thousands history records.*

*Env : Mettle Production.*","03/Feb/26 12:10 PM;6328729388ed2ebef978552f;*Target Date : Client is notified to activate the feature in production by the end of week. so we suggest Wednesday 04-February please confirm to notify the client about the date and time.*

cc : [~accountid:6273fc10807e0000691d5dee] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,157516,ESRM-1020,Ad Hoc - Change and Release Management Requests,In Progress,26/Jan/26 2:28 PM
Prod |Mettle | Renew MDES - Push Provisioning (Shared PEPK) in Production - Due date Mar 18,ESRM-1610,191409,Task,Backlog,ESRM,IT - Release Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,High,,Salik.hashmi,611a52967b538a006964a439,Huy Pham,712020:f8cabd38-666b-418d-89de-e64ca2b2eb95,Huy Pham,712020:f8cabd38-666b-418d-89de-e64ca2b2eb95,01/Jan/26 4:38 AM,30/Jan/26 4:13 PM,07/Jan/26 8:56 AM,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Note: The request needs to be completed *before Mar 19, 2026*.

Mastercard Sends an email similar to the following saying that the certificate is expiring

{noformat}From Mastercard: Important comment: 
This is the renewal of PEPK Push Provisioning for Google for PRD (SN: 0909952418899CD87EFC26B26C188875 expiring on 2026-03-19). 
For any question, kindly contact Digital Payment Team (Digital_Payments_Cert_MGMT@mastercard.com){noformat}

Reference: 

* ZD: [https://paymentology.zendesk.com/agent/tickets/1082202|https://paymentology.zendesk.com/agent/tickets/1082202]
* Previous Jira: [https://paymentology.atlassian.net/browse/ESRM-432|https://paymentology.atlassian.net/browse/ESRM-432|smart-link] 
* PECA: [https://paymentology.atlassian.net/wiki/spaces/TS/pages/7914913793/PECA-363+BL+Renew+MDES+-+Push+Provisioning+Shared+PEPK+-+Production+-+Google+for+Mettle#Flow-for-the-migration|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7914913793/PECA-363+BL+Renew+MDES+-+Push+Provisioning+Shared+PEPK+-+Production+-+Google+for+Mettle#Flow-for-the-migration|smart-link] 

The new certificate was downloaded and will be provided by the Implementation team.

FYI [~accountid:557058:337aa529-c7df-4ad6-9c4f-ed7cc3b75b74] [~accountid:611a52967b538a006964a439] ",,Genevieve Mattheus ,Huy Pham,,,,,,,,,,557058:337aa529-c7df-4ad6-9c4f-ed7cc3b75b74,712020:f8cabd38-666b-418d-89de-e64ca2b2eb95,,,,,,,,,,,,,,,,,,,,,,,,,,ESRM-432,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@42e85d,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07i44:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2026-01-01 14:06:48.276,,,01/Jan/26 4:46 AM;712020:f8cabd38-666b-418d-89de-e64ca2b2eb95;Hi [~accountid:557058:337aa529-c7df-4ad6-9c4f-ed7cc3b75b74] Please share the new certificate file,"01/Jan/26 4:06 PM;557058:337aa529-c7df-4ad6-9c4f-ed7cc3b75b74;Hi [~accountid:712020:f8cabd38-666b-418d-89de-e64ca2b2eb95] Hope all good there. Thank you. 



Will you be working on the certificate renewal? I was thinking to share directly with the person who the ticket gets assigned rather than simply attach to Jira ","07/Jan/26 6:29 AM;712020:f8cabd38-666b-418d-89de-e64ca2b2eb95;Hi [~accountid:557058:337aa529-c7df-4ad6-9c4f-ed7cc3b75b74] 

SD team will make the change of the certificate.

This task has not been assigned to our SD team. I will raise this to Standby for the team to take the case and plan the activity.",07/Jan/26 6:32 AM;712020:f8cabd38-666b-418d-89de-e64ca2b2eb95;Standby [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1767760327300919|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1767760327300919|smart-link] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,157516,ESRM-1020,Ad Hoc - Change and Release Management Requests,To Do,01/Jan/26 4:38 AM
Reconfigure the Bash script for Mettle,ESRM-1438,178961,Sub-task,Backlog,ESRM,IT - Release Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,Salik.hashmi,611a52967b538a006964a439,David Praise Chukwuma Kalu,63404a582eaaa5dcfa17a0e9,David Praise Chukwuma Kalu,63404a582eaaa5dcfa17a0e9,07/Oct/25 12:08 PM,07/Oct/25 12:13 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,David Praise Chukwuma Kalu,,,,,,,,,,,63404a582eaaa5dcfa17a0e9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@61964a11,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06ejw:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,178941,ESRM-1428,Banking.Live - Management Report Job: Repoint The Bash File Uploader From Teya's S3 to Paymentology S3,To Do,07/Oct/25 12:09 PM
GSR Migration: Mettle to use dynamic reporting framework.,ESRM-1215,164766,Task,To Do,ESRM,IT - Release Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,,,Bimal Paudel,619a20dff2415000728442aa,Bimal Paudel,619a20dff2415000728442aa,01/Jul/25 12:56 PM,26/Jan/26 10:06 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"*Environment*: Mettle

*Client*: Mettle

*Version:* BL-2.25.1 and above

Task *GenerateSettlementReport* using the *ps_transactions_out_v1* is currently generating 3 reports:

* Presentment report
* Fees report
* Interchange report

To successfully migrate task *GenerateSettlementReport* to the dynamic reporting framework following three new tasks need to be created, and the respective tasks need to be updated with the required JSON configuration values in the table {{ps_tasks.configurations}} :

* *PresentmentReport*
* *InterchangeFeesReport*
* *SchemeFeesReport*

 

Configuration update script:

{noformat}UPDATE ps_tasks
SET configurations = '<correspoding json template file content>'
WHERE task_id = <corresponding task id>{noformat}

 

Configurations for different reports:

*Presentment Report Configurations*

{
    ""report"":
    {
        ""PY__RID_Settlement"": ""PY__RID_Settlement"",
        ""PY__RID_Authorization"": ""PY__RID_Authorization"",
        ""PY__Account_ID"": ""PY__Account_ID"",
        ""PY__Token"": ""PY__Token"",
        ""PY__Account_External_Reference"": ""PY__Account_External_Reference"",
        ""PY__File_ID"": ""PY__File_ID"",
        ""PY__Transaction_ID"": ""PY__Transaction_ID"",
        ""PY__Network"": ""PY__Network"",
        ""PY__MTID"": ""PY__MTID"",
        ""PY__Created_Date"": ""PY__Created_Date"",
        ""PY__Matched_Status"": ""PY__Matched_Status"",
        ""PY__Is_Debit"": ""PY__Is_Debit"",
        ""PY__Product_ID"": ""PY__Product_ID"",
        ""PY__Product_Name"": ""PY__Product_Name"",
        ""PY__Settlement_Note"": ""PY__Settlement_Note"",
        ""DE3_1__Cardholder_Transaction_Type"": ""DE3_1__Cardholder_Transaction_Type"",
        ""DE3_2__Cardholder_from_Account_Type_Code"": ""DE3_2__Cardholder_from_Account_Type_Code"",
        ""DE3_3__Cardholder_To_Account_Type_Code"": ""DE3_3__Cardholder_To_Account_Type_Code"",
        ""DE4__Transaction_Amount"": ""DE4__Transaction_Amount"",
        ""DE5__Reconciliation_Amount"": ""DE5__Reconciliation_Amount"",
        ""DE6__Billing_Amount"": ""DE6__Billing_Amount"",
        ""DE9__Conversion_Rate_Reconciliation"": ""DE9__Conversion_Rate_Reconciliation"",
        ""DE10__Conversion_Rate_Billing"": ""DE10__Conversion_Rate_Billing"",
        ""DE12__Transaction_Date_Time"": ""DE12__Transaction_Date_Time"",
        ""DE22_6__Card_Present_Data"": ""DE22_6__Card_Present_Data"",
        ""DE22_7__Card_Data_Input_Mode"": ""DE22_7__Card_Data_Input_Mode"",
        ""DE22_8__Cardholder_Authentication_Method"": ""DE22_8__Cardholder_Authentication_Method"",
        ""DE23__Card_Sequence_Number"": ""DE23__Card_Sequence_Number"",
        ""DE24__Function_Code"": ""DE24__Function_Code"",
        ""DE25__Message_Reason_Code"": ""DE25__Message_Reason_Code"",
        ""DE26__Merchant_Category_Code"": ""DE26__Merchant_Category_Code"",
        ""DE30_1__Original_Amount_Transaction"": ""DE30_1__Original_Amount_Transaction"",
        ""DE30_2__Original_Amount_Reconciliation"": ""DE30_2__Original_Amount_Reconciliation"",
        ""DE31__Acquirer_Reference_Data"": ""DE31__Acquirer_Reference_Data"",
        ""DE32__Acquiring_Institution_ID_Code"": ""DE32__Acquiring_Institution_ID_Code"",
        ""DE33__Forwarding_Institution_ID_Code"": ""DE33__Forwarding_Institution_ID_Code"",
        ""DE37__Retrieval_Reference_Number"": ""DE37__Retrieval_Reference_Number"",
        ""DE38__Approval_Code"": ""DE38__Approval_Code"",
        ""DE40__Service_Code"": ""DE40__Service_Code"",
        ""DE41__Card_Acceptor_Terminal_ID"": ""DE41__Card_Acceptor_Terminal_ID"",
        ""DE42__Card_Acceptor_ID_Code"": ""DE42__Card_Acceptor_ID_Code"",
        ""DE43_1__Card_Acceptor_Name"": ""DE43_1__Card_Acceptor_Name"",
        ""DE43_2__Card_Acceptor_Street_Address"": ""DE43_2__Card_Acceptor_Street_Address"",
        ""DE43_3__Card_Acceptor_City"": ""DE43_3__Card_Acceptor_City"",
        ""DE43_4__Card_Acceptor_Zip_Code"": ""DE43_4__Card_Acceptor_Zip_Code"",
        ""DE43_5__Card_Acceptor_State_Code"": ""DE43_5__Card_Acceptor_State_Code"",
        ""DE43_6__Card_Acceptor_Country_Code"": ""DE43_6__Card_Acceptor_Country_Code"",
        ""DE48_0002__GCMS_Product_Identifier"": ""DE48_0002__GCMS_Product_Identifier"",
        ""DE48_0003__Licensed_Product_Identifier"": ""DE48_0003__Licensed_Product_Identifier"",
        ""DE48_0023__Terminal_Type"": ""DE48_0023__Terminal_Type"",
        ""DE48_0025_1__Message_Reversal_Indicator"": ""DE48_0025_1__Message_Reversal_Indicator"",
        ""DE48_0105__Network_File_Reference"": ""DE48_0105__Network_File_Reference"",
        ""DE48_0158_1__Card_Program_Identifier"": ""DE48_0158_1__Card_Program_Identifier"",
        ""DE48_0158_2__Business_Service_Arrangement_Type_Code"": ""DE48_0158_2__Business_Service_Arrangement_Type_Code"",
        ""DE48_0158_3__Business_Service_ID_Code"": ""DE48_0158_3__Business_Service_ID_Code"",
        ""DE48_0158_4__Interchange_Rate_Designaor"": ""DE48_0158_4__Interchange_Rate_Designaor"",
        ""DE48_0158_5__Central_Site_Business_Date"": ""DE48_0158_5__Central_Site_Business_Date"",
        ""DE48_0158_6__Business_Cycle"": ""DE48_0158_6__Business_Cycle"",
        ""DE48_0158_7__Card_Acceptor_Classification_Override_Indicator"": ""DE48_0158_7__Card_Acceptor_Classification_Override_Indicator"",
        ""DE48_0158_8__Product_Class_Override_Indicator"": ""DE48_0158_8__Product_Class_Override_Indicator"",
        ""DE48_0158_9__Corporate_Incentive_Rates_Apply_Indicator"": ""DE48_0158_9__Corporate_Incentive_Rates_Apply_Indicator"",
        ""DE48_0158_10__Special_Conditions_Indicator"": ""DE48_0158_10__Special_Conditions_Indicator"",
        ""DE48_0158_11__MC_Assigned_ID_Override_Indicator"": ""DE48_0158_11__MC_Assigned_ID_Override_Indicator"",
        ""DE48_0158_12__Account_Level_Management_Account_Category_Code"": ""DE48_0158_12__Account_Level_Management_Account_Category_Code"",
        ""DE48_0158_13__Rate_Indicator"": ""DE48_0158_13__Rate_Indicator"",
        ""DE48_0158_14__Masterpass_Incentive_Indicator"": ""DE48_0158_14__Masterpass_Incentive_Indicator"",
        ""DE48_159_3__Settlement_Service_Level_Code"": ""DE48_159_3__Settlement_Service_Level_Code"",
        ""DE48_159_6__Reconciliation_Date"": ""DE48_159_6__Reconciliation_Date"",
        ""DE48_159_7__Reconciliation_Cycle"": ""DE48_159_7__Reconciliation_Cycle"",
        ""DE48_159_8__Settlement_Date"": ""DE48_159_8__Settlement_Date"",
        ""DE48_159_9__Settlement_Cycle"": ""DE48_159_9__Settlement_Cycle"",
        ""DE48_0177_1__Cross_Border_Indicator"": ""DE48_0177_1__Cross_Border_Indicator"",
        ""DE48_0177_2__Currency_Indicator"": ""DE48_0177_2__Currency_Indicator"",
        ""DE49__Currency_Code_Transaction"": ""DE49__Currency_Code_Transaction"",
        ""DE50__Currency_Code_Reconciliation"": ""DE50__Currency_Code_Reconciliation"",
        ""DE51__Currency_Code_Billing"": ""DE51__Currency_Code_Billing"",
        ""DE54_2__Additional_Amount_Type"": ""DE54_2__Additional_Amount_Type"",
        ""DE54_3__Additional_Amount_Currncy_Code"": ""DE54_3__Additional_Amount_Currncy_Code"",
        ""DE54_4__Additional_Amount_Sign"": ""DE54_4__Additional_Amount_Sign"",
        ""DE54_5__Additional_Amount"": ""DE54_5__Additional_Amount"",
        ""DE63__Transaction_Life_Cycle_ID"": ""DE63__Transaction_Life_Cycle_ID"",
        ""DE71__Message_Number"": ""DE71__Message_Number"",
        ""DE72__Data_Record"": ""DE72__Data_Record"",
        ""DE73__Action_Date"": ""DE73__Action_Date"",
        ""DE93__Transaction_Destination_Institution_ID"": ""DE93__Transaction_Destination_Institution_ID"",
        ""DE94__Transaction_Originator_Institution_ID"": ""DE94__Transaction_Originator_Institution_ID"",
        ""DE100__Receiving_Institution_ID"": ""DE100__Receiving_Institution_ID"",
        ""DE111__Amount_Currency_Conversion_Assessment"": ""DE111__Amount_Currency_Conversion_Assessment""
    }
}

*InterchangeFees Report Configurations*

{
    ""report"": {
        ""PY__RID_Settlement"": ""PY__RID_Settlement"",
        ""PY__RID_Authorization"": ""PY__RID_Authorization"",
        ""PY__Account_ID"": ""PY__Account_ID"",
        ""PY__Token"": ""PY__Token"",
        ""PY__Account_External_Reference"": ""PY__Account_External_Reference"",
        ""PY__File_ID"": ""PY__File_ID"",
        ""PY__Transaction_ID"": ""PY__Transaction_ID"",
        ""PY__Network"": ""PY__Network"",
        ""PY__MTID"": ""PY__MTID"",
        ""PY__Created_Date"": ""PY__Created_Date"",
        ""PY__Is_Debit"": ""PY__Is_Debit"",
        ""DE48_0105__Network_File_Reference"": ""DE48_0105__Network_File_Reference"",
        ""DE48_0146_2__Fee_Processing_Code"": ""DE48_0146_2__Fee_Processing_Code"",
        ""DE48_0146_3__Fee_Settlement_Indicator"": ""DE48_0146_3__Fee_Settlement_Indicator"",
        ""DE48_0146_4__Fee_Currency_Code"": ""DE48_0146_4__Fee_Currency_Code"",
        ""DE48_0146_5__Fee_Interchange_Amount"": ""DE48_0146_5__Fee_Interchange_Amount"",
        ""DE48_0146_6__Fee_Currency_Code_Reconciliation"": ""DE48_0146_6__Fee_Currency_Code_Reconciliation"",
        ""DE48_0146_7__Fee_Interchange_Amount_Reconciliation"": ""DE48_0146_7__Fee_Interchange_Amount_Reconciliation"",
        ""DE48_0158_1__Card_Program_Identifier"": ""DE48_0158_1__Card_Program_Identifier"",
        ""DE48_0158_2__Business_Service_Arrangement_Type_Code"": ""DE48_0158_2__Business_Service_Arrangement_Type_Code"",
        ""DE48_0158_3__Business_Service_ID_Code"": ""DE48_0158_3__Business_Service_ID_Code"",
        ""DE48_0158_4__Interchange_Rate_Designaor"": ""DE48_0158_4__Interchange_Rate_Designaor"",
        ""DE48_0158_5__Central_Site_Business_Date"": ""DE48_0158_5__Central_Site_Business_Date"",
        ""DE48_0158_6__Business_Cycle"": ""DE48_0158_6__Business_Cycle"",
        ""DE48_0158_7__Card_Acceptor_Classification_Override_Indicator"": ""DE48_0158_7__Card_Acceptor_Classification_Override_Indicator"",
        ""DE48_0158_8__Product_Class_Override_Indicator"": ""DE48_0158_8__Product_Class_Override_Indicator"",
        ""DE48_0158_9__Corporate_Incentive_Rates_Apply_Indicator"": ""DE48_0158_9__Corporate_Incentive_Rates_Apply_Indicator"",
        ""DE48_0158_10__Special_Conditions_Indicator"": ""DE48_0158_10__Special_Conditions_Indicator"",
        ""DE48_0158_11__MC_Assigned_ID_Override_Indicator"": ""DE48_0158_11__MC_Assigned_ID_Override_Indicator"",
        ""DE48_0158_12__Account_Level_Management_Account_Category_Code"": ""DE48_0158_12__Account_Level_Management_Account_Category_Code"",
        ""DE48_0158_13__Rate_Indicator"": ""DE48_0158_13__Rate_Indicator"",
        ""DE48_0158_14__Masterpass_Incentive_Indicator"": ""DE48_0158_14__Masterpass_Incentive_Indicator"",
        ""DE48_159_6__Reconciliation_Date"": ""DE48_159_6__Reconciliation_Date"",
        ""DE48_159_7__Reconciliation_Cycle"": ""DE48_159_7__Reconciliation_Cycle"",
        ""DE48_159_8__Settlement_Date"": ""DE48_159_8__Settlement_Date"",
        ""DE48_159_9__Settlement_Cycle"": ""DE48_159_9__Settlement_Cycle"",
        ""DE71__Message_Number"": ""DE71__Message_Number"",
        ""DE100__Receiving_Institution_ID"": ""DE100__Receiving_Institution_ID""
    }
}

*SchemeFees Report Configurations*

{
    ""report"":
    {
        ""PY__RID_Settlement"": ""PY__RID_Settlement"",
        ""PY__Account_ID"": ""PY__Account_ID"",
        ""PY__Token"": ""PY__Token"",
        ""PY__Account_External_Reference"": ""PY__Account_External_Reference"",
        ""PY__File_ID"": ""PY__File_ID"",
        ""PY__Transaction_ID"": ""PY__Transaction_ID"",
        ""PY__Network"": ""PY__Network"",
        ""PY__MTID"": ""PY__MTID"",
        ""PY__Created_Date"": ""PY__Created_Date"",
        ""PY__Matched_Status"": ""PY__Matched_Status"",
        ""PY__Is_Debit"": ""PY__Is_Debit"",
        ""PY__Settlement_Note"": ""PY__Settlement_Note"",
        ""DE3_1__Cardholder_Transaction_Type"": ""DE3_1__Cardholder_Transaction_Type"",
        ""DE3_2__Cardholder_from_Account_Type_Code"": ""DE3_2__Cardholder_from_Account_Type_Code"",
        ""DE3_3__Cardholder_To_Account_Type_Code"": ""DE3_3__Cardholder_To_Account_Type_Code"",
        ""DE4__Transaction_Amount"": ""DE4__Transaction_Amount"",
        ""DE5__Reconciliation_Amount"": ""DE5__Reconciliation_Amount"",
        ""DE9__Conversion_Rate_Reconciliation"": ""DE9__Conversion_Rate_Reconciliation"",
        ""DE24__Function_Code"": ""DE24__Function_Code"",
        ""DE25__Message_Reason_Code"": ""DE25__Message_Reason_Code"",
        ""DE26__Merchant_Category_Code"": ""DE26__Merchant_Category_Code"",
        ""DE30_1__Original_Amount_Transaction"": ""DE30_1__Original_Amount_Transaction"",
        ""DE30_2__Original_Amount_Reconciliation"": ""DE30_2__Original_Amount_Reconciliation"",
        ""DE31__Acquirer_Reference_Data"": ""DE31__Acquirer_Reference_Data"",
        ""DE32__Acquiring_Institution_ID_Code"": ""DE32__Acquiring_Institution_ID_Code"",
        ""DE33__Forwarding_Institution_ID_Code"": ""DE33__Forwarding_Institution_ID_Code"",
        ""DE38__Approval_Code"": ""DE38__Approval_Code"",
        ""DE41__Card_Acceptor_Terminal_ID"": ""DE41__Card_Acceptor_Terminal_ID"",
        ""DE42__Card_Acceptor_ID_Code"": ""DE42__Card_Acceptor_ID_Code"",
        ""DE43_1__Card_Acceptor_Name"": ""DE43_1__Card_Acceptor_Name"",
        ""DE43_2__Card_Acceptor_Street_Address"": ""DE43_2__Card_Acceptor_Street_Address"",
        ""DE43_3__Card_Acceptor_City"": ""DE43_3__Card_Acceptor_City"",
        ""DE43_4__Card_Acceptor_Zip_Code"": ""DE43_4__Card_Acceptor_Zip_Code"",
        ""DE43_5__Card_Acceptor_State_Code"": ""DE43_5__Card_Acceptor_State_Code"",
        ""DE43_6__Card_Acceptor_Country_Code"": ""DE43_6__Card_Acceptor_Country_Code"",
        ""DE48_0002__GCMS_Product_Identifier"": ""DE48_0002__GCMS_Product_Identifier"",
        ""DE48_0003__Licensed_Product_Identifier"": ""DE48_0003__Licensed_Product_Identifier"",
        ""DE48_0023__Terminal_Type"": ""DE48_0023__Terminal_Type"",
        ""DE48_0025_1__Message_Reversal_Indicator"": ""DE48_0025_1__Message_Reversal_Indicator"",
        ""DE48_0105__Network_File_Reference"": ""DE48_0105__Network_File_Reference"",
        ""DE48_0158_1__Card_Program_Identifier"": ""DE48_0158_1__Card_Program_Identifier"",
        ""DE48_0158_2__Business_Service_Arrangement_Type_Code"": ""DE48_0158_2__Business_Service_Arrangement_Type_Code"",
        ""DE48_0158_3__Business_Service_ID_Code"": ""DE48_0158_3__Business_Service_ID_Code"",
        ""DE48_0158_4__Interchange_Rate_Designaor"": ""DE48_0158_4__Interchange_Rate_Designaor"",
        ""DE48_0158_5__Central_Site_Business_Date"": ""DE48_0158_5__Central_Site_Business_Date"",
        ""DE48_0158_6__Business_Cycle"": ""DE48_0158_6__Business_Cycle"",
        ""DE48_0158_7__Card_Acceptor_Classification_Override_Indicator"": ""DE48_0158_7__Card_Acceptor_Classification_Override_Indicator"",
        ""DE48_0158_8__Product_Class_Override_Indicator"": ""DE48_0158_8__Product_Class_Override_Indicator"",
        ""DE48_0158_9__Corporate_Incentive_Rates_Apply_Indicator"": ""DE48_0158_9__Corporate_Incentive_Rates_Apply_Indicator"",
        ""DE48_0158_10__Special_Conditions_Indicator"": ""DE48_0158_10__Special_Conditions_Indicator"",
        ""DE48_0158_11__MC_Assigned_ID_Override_Indicator"": ""DE48_0158_11__MC_Assigned_ID_Override_Indicator"",
        ""DE48_0158_12__Account_Level_Management_Account_Category_Code"": ""DE48_0158_12__Account_Level_Management_Account_Category_Code"",
        ""DE48_0158_13__Rate_Indicator"": ""DE48_0158_13__Rate_Indicator"",
        ""DE48_0158_14__Masterpass_Incentive_Indicator"": ""DE48_0158_14__Masterpass_Incentive_Indicator"",
        ""DE48_159_3__Settlement_Service_Level_Code"": ""DE48_159_3__Settlement_Service_Level_Code"",
        ""DE48_159_6__Reconciliation_Date"": ""DE48_159_6__Reconciliation_Date"",
        ""DE48_159_7__Reconciliation_Cycle"": ""DE48_159_7__Reconciliation_Cycle"",
        ""DE48_159_8__Settlement_Date"": ""DE48_159_8__Settlement_Date"",
        ""DE48_159_9__Settlement_Cycle"": ""DE48_159_9__Settlement_Cycle"",
        ""DE49__Currency_Code_Transaction"": ""DE49__Currency_Code_Transaction"",
        ""DE50__Currency_Code_Reconciliation"": ""DE50__Currency_Code_Reconciliation"",
        ""DE63__Transaction_Life_Cycle_ID"": ""DE63__Transaction_Life_Cycle_ID"",
        ""DE71__Message_Number"": ""DE71__Message_Number"",
        ""DE72__Data_Record"": ""DE72__Data_Record"",
        ""DE73__Action_Date"": ""DE73__Action_Date"",
        ""DE93__Transaction_Destination_Institution_ID"": ""DE93__Transaction_Destination_Institution_ID"",
        ""DE94__Transaction_Originator_Institution_ID"": ""DE94__Transaction_Originator_Institution_ID"",
        ""DE100__Receiving_Institution_ID"": ""DE100__Receiving_Institution_ID""
    }
}

 

_Note: These tasks can be configured to run 20-30 minutes apart from each other. The job chaining can be implemented however the latter two task needs to be configured to run on distant future to prevent duplicate report (containing REGEN in the file name) from being delivered to client’s SFTP._

 

Related confluence pages:

* [PresentmentReport Job - Team Hubs - Confluence|https://paymentology.atlassian.net/wiki/spaces/TS/pages/8315305985/PresentmentReport+Job]
* [InterchangeFees Report Job - Team Hubs - Confluence|https://paymentology.atlassian.net/wiki/spaces/TS/pages/8315338753/InterchangeFees+Report+Job]
* [SchemeFees Report Job - Team Hubs - Confluence|https://paymentology.atlassian.net/wiki/spaces/TS/pages/8315338771/SchemeFees+Report+Job]
* [Flexible Reporting Design - Team Hubs - Confluence|https://paymentology.atlassian.net/wiki/spaces/TS/pages/8575385762/Flexible+Reporting+Design]
* [BL: Migrate Presentment report to dynamic reporting - Team Hubs - Confluence|https://paymentology.atlassian.net/wiki/spaces/TS/pages/8783265794/BL+Migrate+Presentment+report+to+dynamic+reporting]
* [BL: Clearing - Generate Settlement Report (Mastercard) task migration. - Team Hubs - Confluence|https://paymentology.atlassian.net/wiki/spaces/TS/pages/8816754689/BL+Clearing+-+Generate+Settlement+Report+Mastercard+task+migration.]
* [How to configure job chains for scheduled tasks - Team Hubs - Confluence|https://paymentology.atlassian.net/wiki/spaces/TS/pages/8746434571/How+to+configure+job+chains+for+scheduled+tasks]",,Bimal Paudel,Salik.hashmi,,,,,,,,,,619a20dff2415000728442aa,611a52967b538a006964a439,,,,,,,,,,,,,,,,,,DEFECT-3916,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-1222,,,,,22/Aug/25 2:58 PM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;MettleReports.zip;https://paymentology.atlassian.net/rest/api/3/attachment/content/121508,22/Aug/25 2:58 PM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;ps_interchangefees_report_v1.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/121509,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@12d0e48f,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i055ps:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,a8693810-01fb-4d1c-8714-51e4229f5c10,PE - Processing - Clearing,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-08-22 12:58:49.111,,,"22/Aug/25 2:58 PM;611a52967b538a006964a439;Hi [~accountid:619a20dff2415000728442aa]  ,

After setting up the jobs and updating {{ps_Tasks.configurations}} according to the respective job schemas, we generated the reports for comparison. We noticed that the *Settlement Report* includes a new column ({{PY__Transaction_Type}}), which can be disregarded as it does not affect the data integrity.

However, in the *Interchange Report*, we observed that the new report contains fewer records compared to the old version. Please see the details below.


[bluser@pt-mettle-psch01 Settlement Reports]$ wc -l METTLE_Presentments_20250822.csv
45843 METTLE_Presentments_20250822.csv
[bluser@pt-mettle-psch01 Settlement Reports]$ wc -l METTLE_Presentments_20250821_REGEN_02.csv
45492 METTLE_Presentments_20250821_REGEN_02.csv
[bluser@pt-mettle-psch01 Settlement Reports]$ wc -l METTLE_Interchange_20250822.csv
{color:#bf2600}*45843* {color}METTLE_Interchange_20250822.csv
[bluser@pt-mettle-psch01 Settlement Reports]$ wc -l METTLE_Interchange_20250821_REGEN_02.csv
{color:#bf2600}*45492* {color}METTLE_Interchange_20250821_REGEN_02.csv
[bluser@pt-mettle-psch01 Settlement Reports]$


This discrepancy could potentially cause issues on the client side. I’ve attached both the old and new versions of the reports for your review.

[^MettleReports.zip] 

Also attaching interchange function:
[^ps_interchangefees_report_v1.sql] 

Fyi  [*BL version 2.29.8-hf.5*|https://github.com/Paymentology/bl-environments/blob/2.29.8-hf.5/versions/release/versions.yaml] *running on mettle and all other envs.*

 

[~accountid:5fae4bd414da26006857925c] [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] ","22/Aug/25 3:26 PM;557058:a4bced0a-e933-4a8a-9216-49655949788e;[~accountid:619a20dff2415000728442aa] , I have raised a DEFECT for this (linked).  It can be picked up by the Zendesk rotation person.  He can get in touch with you if required.","27/Aug/25 2:59 PM;619a20dff2415000728442aa;Hello [~accountid:611a52967b538a006964a439],
The active *GenerateSettlementReport* in this environment is using *ps_transactions_out_v1*, have updated the description in this ticket, now we will have appropriate columns for presentment report.
For interchange fees report, there should not be any discrepancies in both reported elements (i.e. columns) and reported records (rows), from the shared files for August 21 and August 22 we can see the similar number of records.

_Note: We would suggest confirming the old function used in the environment and their corresponding new functions in this confluence:_ [BL: Clearing - Generate Settlement Report (Mastercard) task migration. - Team Hubs - Confluence|https://paymentology.atlassian.net/wiki/spaces/TS/pages/8816754689/BL+Clearing+-+Generate+Settlement+Report+Mastercard+task+migration.]

Cc. [~accountid:712020:dff64d28-7e4d-4386-b35b-18c681ef213d] [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] ","02/Sep/25 2:32 PM;619a20dff2415000728442aa;Hello [~accountid:611a52967b538a006964a439] 
{{METTLE_Interchange_20250821_REGEN_02}} Corresponds with {{METTLE_Interchange_20250821.csv}} not with {{METTLE_Interchange_20250822}}and from data base data we assume they have same number of records:

{noformat}select *
from client_files
where id in (8183, 8193);{noformat}

We do not see any problem here, please confirm and proceed with implementing new tasks.

Cc. [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] [~accountid:712020:dff64d28-7e4d-4386-b35b-18c681ef213d] ","12/Sep/25 10:49 AM;557058:a4bced0a-e933-4a8a-9216-49655949788e;[~accountid:611a52967b538a006964a439] , can the Mettle migration be re-initiated?  Do you have any concerns or questions with regards to [~accountid:619a20dff2415000728442aa] 's comments?","16/Sep/25 2:46 PM;611a52967b538a006964a439;Upon validation, we have enabled the new job followed by old job disabled.","20/Oct/25 3:35 PM;557058:a4bced0a-e933-4a8a-9216-49655949788e;[~accountid:611a52967b538a006964a439] , is Mettle running the new jobs now?  Or did it get reverted due to double quote issue?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,162320,CLR-875,Migrate clients off of GenerateSettlementReport job,To Do,26/Jan/26 10:06 AM
Presentment reports v2 and v1 in parallel,ESRM-1194,164649,Task,In Progress,ESRM,IT - Release Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,High,,Bilal Hashmi,60fedcdc627b5600689cd1a0,muneer,63c1495f2341bff4fff70492,muneer,63c1495f2341bff4fff70492,30/Jun/25 2:33 PM,30/Jun/25 3:18 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Hi Team,

Client: Mettle

Env  : PROD

ZD :  [Ticket: Presentment reports v2 and v1 in… – Paymentology – Zendesk|https://paymentology.zendesk.com/agent/tickets/981225]

Issue : Client requested to have the Settlement report with Paycore function ps_transactions_out_v2(new report)   parallel along with Settlement report with Paycore function ps_transactions_out_v1(current report)  and to stages these 2 reports in SFTP .



!image-20250630-123356.png|width=1473,height=353,alt=""image-20250630-123356.png""!





Tasks -1)Create new job  GenerateSettlementReport with  Paycore function ps_transactions_out_v2 

           2) Need to create subfolder in the path  in /bl/PSData/PS_Mettle/Client_Outbound Pay Scheduler  to stage this new report.

           3) Need to create a subfolder in Payfilemon  targetPath=""/mettlebank-prd-genie-paymentology/paymentology/",,muneer,Salik.hashmi,,,,,,,,,,63c1495f2341bff4fff70492,611a52967b538a006964a439,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,30/Jun/25 2:34 PM;63c1495f2341bff4fff70492;image-20250630-123356.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/116503,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@2360d849,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,PROD,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i0551k:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-06-30 13:17:25.257,,,"30/Jun/25 2:35 PM;63c1495f2341bff4fff70492;Hi [~accountid:611a52967b538a006964a439] ,

Kindly  request you confirm for the below process.

1)Create new job  GenerateSettlementReport with  Paycore function ps_transactions_out_v2

# Need to create subfolder in the path  in /bl/PSData/PS_Mettle/Client_Outbound Pay Scheduler  to stage this new report.

# Need to create a subfolder in Payfilemon  targetPath=""/mettlebank-prd-genie-paymentology/paymentology/

h2. ",30/Jun/25 3:17 PM;611a52967b538a006964a439;Approved. and please proceed as this is just new job setup without changing on existing job report. ,30/Jun/25 3:18 PM;611a52967b538a006964a439;just clone all configuration from existing report and selection other function which is required. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,157516,ESRM-1020,Ad Hoc - Change and Release Management Requests,In Progress,30/Jun/25 3:17 PM
Request To Load Mettle MDES TAV KEYS,ESRM-976,155697,Task,Backlog,ESRM,IT - Release Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,02/Apr/25 11:19 AM,23/Apr/25 3:40 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,Request To Load Mettle MDES TAV KEYS,,Salik.hashmi,,,,,,,,,,,611a52967b538a006964a439,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,02/Apr/25 11:33 AM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;mettle-prod.private-key-02042025.der;https://paymentology.atlassian.net/rest/api/3/attachment/content/109193,02/Apr/25 11:20 AM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;mettle-prod.private-key.der;https://paymentology.atlassian.net/rest/api/3/attachment/content/109192,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@290a0407,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i043s4:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"02/Apr/25 11:20 AM;611a52967b538a006964a439;Keys shared by [~accountid:5a246636e7a1121a1ecce06d] 
[^mettle-prod.private-key.der] ","02/Apr/25 11:21 AM;611a52967b538a006964a439;Loaded by [~accountid:611a52967b538a006964a439] 

Actions: 
1) Update in table with new file name of MDES TAV cert file. 
No need of restart as service reads table in real-time instead of cached..

{{SELECT    mastercard_public_certificate_for_mdes_card_data_encryption,   private_key_path_for_tav_signature FROM   public.p_client_mdes_config WHERE client_id = 597899}}
Currently  {{""/bl/mdes_certs/mettle-prod.private-key.topk8.der""}}



The query to change the file path:
{{UPDATE public.p_client_mdes_config SET private_key_path_for_tav_signature = '/bl/mdes_certs/mettle-prod.private-key-02042025.der' WHERE client_id = 597899}}",02/Apr/25 11:26 AM;611a52967b538a006964a439;Backup:  backups.p_client_mdes_config_bkpESRM976,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,157516,ESRM-1020,Ad Hoc - Change and Release Management Requests,To Do,02/Apr/25 11:19 AM
Mettle DR Dockerised Environment - Deployment Execution,ESRM-349,126219,Task,Backlog,ESRM,IT - Release Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,Bilal Hashmi,60fedcdc627b5600689cd1a0,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,30/Apr/24 3:05 PM,11/Apr/25 4:24 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Salik.hashmi,,,,,,,,,,,611a52967b538a006964a439,,,,,,,,,,,14400,14400,,0%,14400,14400,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@7ab63ff8,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,purple,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i000c7:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,126178,ESRM-309,Dockerize - DR Mettle,To Do,30/Apr/24 3:05 PM
Dockerize - DR Mettle,ESRM-309,126178,Epic,Backlog,ESRM,IT - Release Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,Salik.hashmi,611a52967b538a006964a439,Bilal Hashmi,60fedcdc627b5600689cd1a0,Salik.hashmi,611a52967b538a006964a439,30/Apr/24 2:58 PM,12/Sep/24 7:51 PM,,,,,,,,,,,,,,,,,,,,,,,,11/Oct/24 12:00 AM,0,Infra2024,,,,"|Dockerization|Note:These efforts are estimated for 1 environment| | | | | |
| |Item|Owner| | |Dedicated Efforts|Remarks|
|1|Docker Software Installation|Infra| | | | |
|2|Docker POC on reduntant service|SD| | |1 - Manday| |
|3|Review and Detailing Configuration (Keys, URL , Permissions etc)|SD| | |2 - Manday| |
|4|Branch Configuration|SD| | |1 - Manday| |
|5|Planning and Scheduling|SD| | |0.5 Manday| |
|6|Deployment Execution|SD| | |0.5 Manday| |",,Salik.hashmi,Vijay Sridhar,,,,,,,,,,611a52967b538a006964a439,60fedd468c15ca006ffc3ef1,,,,,,,,,,,,,,144000,144000,,,,,,,,,,,ESRM-304,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@15f2f31e,,,,,,,,,,,,,,,,,,,,,,,[10-14] - High,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,ghx-label-6,Dockerize - DR Mettle,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,green,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i00026:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,23/Jun/24 12:00 AM,,,,,,,,,,,,,87c04ed7-d42a-47ec-9df4-5c757db79ff9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-09-02 13:47:20.834,,,02/Sep/24 3:47 PM;611a52967b538a006964a439;[~accountid:60fedd468c15ca006ffc3ef1]  can you please share Mettle DR servers details page.,"02/Sep/24 3:49 PM;60fedd468c15ca006ffc3ef1;HI [~accountid:611a52967b538a006964a439] 
[AZURE - Mettle DR Site - Team Hubs - Confluence (atlassian.net)|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7059177619/AZURE+-+Mettle+DR+Site]
[~accountid:712020:1dd21fc5-5f79-48c3-9dc9-52aa64b3c218] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,126062,TECH-117,Dockerization - BL Legacy Environment,To Do,30/Apr/24 2:58 PM
Annotation broken client process,DEV_SCHEDULER-595,103248,Bug,Open,DEV_SCHEDULER,DEV: PayScheduler,software,dilip.shrestha,60fedcf9ae72b2006fe287d2,,,Normal,,upendra gautam,60fedd46b704b400688a8e79,lucas.cesar,6205526c9493720070b93fd4,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,18/Apr/23 11:47 PM,18/Apr/23 11:47 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"Hello Dev team Mettle has automatic process and broken their process because we are sending a broken character parameter 

So we need so remove those special character psrv_matching

On the line 165

Actually it's this information

update t_set_staging set orig_blk_amt = t_set_staging.de6, txn_id = t_auth.txn_id, rid = t_auth.rid, 
		txn_date_utc = t_auth.de7, match_found = 4, match_note = match_note || 'match (4) on tok+de42,  
		de4 < Auth de4  (no de38 match) ',	t_auth_id = ta_id, tcid = tc_id, bin = t_auth.bin, prod_id = t_auth.prod_id
		from t_auth
		WHERE t_set_staging.token = t_auth.de2 and t_set_staging.de42 = t_auth.de42 	
		and  t_set_staging.de4 > t_auth.de4 and t_auth.auth_status = 1 and t_set_staging.match_found = 0 and t_auth.matched_Status = 0 and T_Auth.MTID = '0100'  and left(t_set_staging.de3_1,1) <> '2';
		

Need to be this format to avoid broken process

update t_set_staging set orig_blk_amt = t_set_staging.de6, txn_id = t_auth.txn_id, rid = t_auth.rid, 
		txn_date_utc = t_auth.de7, match_found = 4,match_note = match_note || 'match (4) on tok+de42,de4 < Auth de4  (no de38 match) ',	t_auth_id = ta_id, tcid = tc_id, bin = t_auth.bin, prod_id = t_auth.prod_id
		from t_auth
		WHERE t_set_staging.token = t_auth.de2 and t_set_staging.de42 = t_auth.de42 	
		and  t_set_staging.de4 > t_auth.de4 and t_auth.auth_status = 1 and t_set_staging.match_found = 0 and t_auth.matched_Status = 0 and T_Auth.MTID = '0100'  and left(t_set_staging.de3_1,1) <> '2';
		

Let me know if need more information
Thanks at all

~* Please see Zendesk Support tab for further comments and attachments.~",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@620323ab,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzwiv3:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,18/Apr/23 11:47 PM
Mettle | Card Personalization Failiure,DEV_SCHEDULER-583,53768,Bug,Open,DEV_SCHEDULER,DEV: PayScheduler,software,dilip.shrestha,60fedcf9ae72b2006fe287d2,,,Normal,,Desiree Chow,6127cacc3ef46a007079f2b3,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,14/Apr/22 2:38 PM,30/May/22 2:29 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"WE have Generate Manufacturer Card setup on Paycontrol, Everyday that job executed and generate Perso file and staged to >
Step 1: Extract Cards Based On Status_Sys = 200 in table p_tok on Paytok DB (Working Fine)
Step 2: Generate Perso File
Step 3: Sign, Encrypt and then stage file to client sftp via PT internal SFTP.
If any of the step fails, status not updated and card will pick in next job execution as well as per our understanding. Currently previous days cards are picking in step 1 since those card status remain as 200. This is critical because if this happen PIN BLOCK data for the card will update in system and we need to stage the card which already staged.  So we are handling it manually but its a big risk.
The error is on Step 3, and this start happening after upgrade.
PS build before upgrade: 2.1.69.5.jar
PS build after upgrade: 2.5.0.jar
Error Logs:
2022-04-14 05:05:36.666 [Scheduler_Worker-12] INFO  JobGenerateManufacturerCard - ...............................................Job started...............................................
2022-04-14 05:05:36.713 [Scheduler_Worker-12] INFO  ProcessCards - Cards loaded from db for manufacturer id : 1
2022-04-14 05:05:36.715 [Scheduler_Worker-12] INFO  ProcessCards - Count of product : 1
2022-04-14 05:05:36.715 [Scheduler_Worker-12] INFO  ProcessCards - Count of record : 7
2022-04-14 05:05:36.717 [Scheduler_Worker-12] INFO  ConnectPayKeyServ - Creating a secure socket for PayKeyService, 10.155.100.20:7777
2022-04-14 05:05:36.908 [Scheduler_Worker-12] INFO  ConnectPayKeyServ - Request sent to paykeyserv:
2022-04-14 05:05:36.978 [Scheduler_Worker-12] INFO  ProcessCards - Request Sent to PayKeyServ with  7 ecnos
2022-04-14 05:05:36.980 [Scheduler_Worker-12] INFO  ProcessCards - CardProcessing: XML Manu File creation process Started
2022-04-14 05:05:36.983 [Scheduler_Worker-12] INFO  ProcessCards - XML file generated: /bl/PSData/PS_Mettle/XML_Outbound/1/1_METTLE_FC_1929_305_14042022_0505.xml
2022-04-14 05:05:36.983 [Scheduler_Worker-12] INFO  ProcessCards - Executing Signing and encryption in single step for file 1_METTLE_FC_1929_305_14042022_0505.xml with enc key: 5C1ABA02 and
sign key: 61366B7B
2022-04-14 05:05:37.051 [Scheduler_Worker-12] INFO  Cards - Sucessfully uploaded card details.
2022-04-14 05:05:37.051 [Scheduler_Worker-12] ERROR  ProcessCards - Error during generating xml for manufacturer with id : 1
java.lang.Exception: java.lang.Exception: Could not encrypt card xml file
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.CompleteProcessing(ProcessCards.java:828)
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.ProcessXML(ProcessCards.java:102)
        at com.paymentology.payscheduler.schedulerjobs.JobGenerateManufacturerCard.execute(JobGenerateManufacturerCard.java:56)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
Caused by: java.lang.Exception: Could not encrypt card xml file
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.exportToDir(ProcessCards.java:939)
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.CompleteProcessing(ProcessCards.java:730)
        ... 4 more
Caused by: java.lang.Exception: Error while trying to sign and encrypt xml file with pgp key in cryptoPGP.
        at com.paymentology.payscheduler.services.CryptoPGP.signAndEncrypt(CryptoPGP.java:138)
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.exportToDir(ProcessCards.java:927)
        ... 5 more
Caused by: java.lang.Exception: Problem during signing !
        at com.paymentology.payscheduler.services.CryptoPGP.signAndEncrypt(CryptoPGP.java:126)
        ... 6 more
2022-04-14 05:05:37.480 [Scheduler_Worker-12] INFO  JobGenerateManufacturerCard - ...............................................Job ended...............................................

~* Please see Zendesk Support tab for further comments and attachments.~",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEV-8803,,,,,,,,,,,24/May/22 10:27 AM;ug:31ed5a2e-7f35-4a4b-b443-771accbbea98;7_METTLE_FC_1969_497_24052022_0817-orig.xml;https://paymentology.atlassian.net/rest/api/3/attachment/content/38253,24/May/22 10:27 AM;ug:31ed5a2e-7f35-4a4b-b443-771accbbea98;7_METTLE_FC_1969_497_24052022_0817.xml;https://paymentology.atlassian.net/rest/api/3/attachment/content/38254,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@77669079,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzuet3:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2022-04-18 07:23:24.523,,,18/Apr/22 9:23 AM;623ddb7a866b810069e527bc;[~accountid:617191aea6ecfc007110a8ab]  [~accountid:557058:c5ebc7cf-23ce-4b2e-84e7-aeeb4a55c83f] .. Gentle Reminder.. Your kind assistance will help to solve the issue asap.,"18/Apr/22 9:27 AM;623ddb7a866b810069e527bc;As we analyse the logs,During signing the task  is failing.Please  check and support","19/Apr/22 10:38 AM;617191aea6ecfc007110a8ab;[~accountid:623ddb7a866b810069e527bc] I am looking into this, it seems the issue is occurring for both signing and encryption… is the failure only happening for mettle?",19/Apr/22 10:42 AM;623ddb7a866b810069e527bc;[~accountid:617191aea6ecfc007110a8ab] ..Yes.. It is happening only for Mettle Perso file encryption & Signing. For other clients signing is  not  mandated only for Mettle  Signing is happening. Thats the difference we can see between Mettle and other clients.,20/Apr/22 2:21 AM;617191aea6ecfc007110a8ab;[~accountid:623ddb7a866b810069e527bc] I created keys on my local machine and tested it… I am having no issue with the encryption/signing. The error ‘Problem when signing’ is a custom error message so I have asked [~accountid:60fedd46b704b400688a8e79] if he can advise me on how to get the java error message in production so I can identify the cause,20/Apr/22 1:34 PM;617191aea6ecfc007110a8ab;[~accountid:623ddb7a866b810069e527bc] I have added logs to show the output of the cmd line commands and submitted a merge request. Once this is approved I will let you know so you can forward it to testing so it can be deployed to production. Then I will be able to see the output messages and look into what is causing the error,"21/Apr/22 2:52 PM;623ddb7a866b810069e527bc;[~accountid:617191aea6ecfc007110a8ab]  Request you to update us  the status  further.Since Mettle may produce cards in bulk in near future, Requesting your assistance to resolve this issue at the earliest.

[~accountid:611a52967b538a006964a439] ",21/Apr/22 5:27 PM;617191aea6ecfc007110a8ab;[~accountid:623ddb7a866b810069e527bc] Still waiting for Merge request approval as had to resubmit it this morning with updated changes - Once this is done I will notify you immediately so you can forward it to testing and then Prod. After this I will be able to look at what is causing the issue,22/Apr/22 10:55 AM;617191aea6ecfc007110a8ab;[~accountid:623ddb7a866b810069e527bc] merge request has been approved - can you forward GenerateManufacturerCard Job to testing so it can be pushed to production (then we will be able to see the actual error logs),23/Apr/22 3:07 AM;623ddb7a866b810069e527bc;[~accountid:617191aea6ecfc007110a8ab] ..I could not understand the last comment mentioned by you. Request you to elaborate more on it.,"25/Apr/22 10:52 AM;617191aea6ecfc007110a8ab;Hi [~accountid:623ddb7a866b810069e527bc]… what i meant was that i had to make some changes to add a more detailed error output so that we can see what is causing the signing to fail (as when i ran it on my local machine with local keys, it was signing and encrypting fine). The merge request for this has been complete. Now this updated code for GenerateManufacturerCard needs to be pushed to prod so we can see what the error is for Mettle - could you forward this to testing to it can be pushed to production 🙂 ","26/Apr/22 7:23 PM;623ddb7a866b810069e527bc;Currently we have disabled the signing and encryption and doing it manually. Because there is very critical and serious impact if job fails due to signing and encryption (like PVV become null for the card and also card status remains the same therefor same card will pick in next job execution.  .

We would suggest if you may compare the tables and data where key stores and also on PS server the key store. It should be syn as of UAT provided UAT there is no issue, we can identify by this.

But still if you need to execute the job and need logs , then we might need  to check with client to take any test card or use any old card that is not in use. But this approach will definitely unhappy client :)

Please share updated gitlink of updated jar from where we can download. Also confirm if that jar only  contains the said change related to GenerateManufacturerCard debugging alone and has no impact on existing functionality","28/Apr/22 12:08 PM;617191aea6ecfc007110a8ab;Hi [~accountid:623ddb7a866b810069e527bc] I had another look and it seems somewhere along the line, a decryption of the passphrase was turned into an encryption so the passphrase was being double encrypted instead of encrypted and decrypted. I have changed this and assuming the keys in production match the ones in the prod database for mettle, the signing/encrypting for mettle should now work. I have submitted merge request and will send gitlink when it is approved 🙂 ","29/Apr/22 12:52 PM;623ddb7a866b810069e527bc;Hi Vishal,

Requesting your feedback further on this case. Please note for now we are doing the manual encryption in the off hours and sending the files to Perso bureau vendor afraid that the manual process will lead to error prone zone and we might receive another escalation from client. Hence your quick  assistance on this case is much appreciated.



Cc : [~accountid:557058:c5ebc7cf-23ce-4b2e-84e7-aeeb4a55c83f] [~accountid:60fedcdc627b5600689cd1a0] [~accountid:611a52967b538a006964a439] ","29/Apr/22 12:57 PM;617191aea6ecfc007110a8ab;Hi [~accountid:623ddb7a866b810069e527bc] still awaiting approval for merge request - will ask for it to be looked at now… once it is, I will update you so you can push to testing and production","29/Apr/22 1:53 PM;617191aea6ecfc007110a8ab;Hi Abdul, merge request has been approved… the following classes were changed; TaskConfig,java and CryptoPGP.java (the changes only affect the mettle problem as no other clients use signing up to now)",29/Apr/22 1:59 PM;623ddb7a866b810069e527bc;Thanks very much [~accountid:617191aea6ecfc007110a8ab] ..Please let us know the next course of [action.|http://action.Do] Was this change has bene done production already or yet to be deployed on production ?,"29/Apr/22 2:01 PM;617191aea6ecfc007110a8ab;This change is yet to be deployed - can you assign to testing team and once they confirm it is okay, then it can be pushed to prod","02/May/22 4:12 PM;623ddb7a866b810069e527bc;[~accountid:60fedd1e8c15ca006ffc3c63] 



Requesting your assistance on the below Query","03/May/22 10:53 PM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab]  Please elaborate what you fixed for subject change/Issue.

cc- [~accountid:60fedd207ab143006ea5a013] ","04/May/22 1:16 PM;617191aea6ecfc007110a8ab;Encryption in TaskConfig.java should have been decryption (it was resulting in double encryption instead of encryption->decryption) - Lines 139-143 in TaskConfig.java

Command changed for CryptoPGP.java ({{--pinentry-mode loopback}} added to command to automatically use passphrase for signing) - Line 152 in CryptoPGP.java



These changes were made to allow the signing and encryption of Mettle perso file in GenerateManufacturerCard job [~accountid:60fedd1e8c15ca006ffc3c63] ",05/May/22 9:45 AM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab]  change is deployed on UAT? and is it specific to Mettle client only ?,"05/May/22 11:12 AM;617191aea6ecfc007110a8ab;The change was made in the java code only - no database changes. And although the change was made for the signing which only Mettle uses at the moment, it is part of common code for all clients 🙂 ","05/May/22 12:54 PM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab]  Thanks for the response.

As discussed, could you please tell me on UAT , what PGP Encryption Key ID , PGP sign Key ID and password can used for encryption and signing.

Regards,

Ameen",05/May/22 12:58 PM;617191aea6ecfc007110a8ab;[~accountid:60fedd1e8c15ca006ffc3c63] Currently no keys exist in UAT database for Idema UK. These will need to be created first and then added via paycontrol,"05/May/22 4:27 PM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab]  As discussed, below exception is occurring on UAT for generating perso file. please check and revert.

getting this error.xml with enc key: 0BAC1238 and sign key: 0BAC1238
2022-05-05 12:00:53.437 \[Scheduler_Worker-6] INFO  CryptoPGP - Here is the standard output of the command:2022-05-05 12:00:53.439 \[Scheduler_Worker-6] INFO  CryptoPGP - Here is the standard error of the command (if any):*2022-05-05 12:00:53.439 \[Scheduler_Worker-6] ERROR  CryptoPGP - gpg: invalid option ""--pinentry-mode""*
2022-05-05 12:00:53.440 \[Scheduler_Worker-6] ERROR  ProcessCards - Error during generating xml for manufacturer with id : 7
java.lang.Exception: java.lang.Exception: Could not encrypt card xml file
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.CompleteProcessing(ProcessCards.java:828)
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.ProcessXML(ProcessCards.java:102)
        at com.paymentology.payscheduler.schedulerjobs.JobGenerateManufacturerCard.execute(JobGenerateManufacturerCard.java:56)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
Caused by: java.lang.Exception: Could not encrypt card xml file
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.exportToDir(ProcessCards.java:939)
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.CompleteProcessing(ProcessCards.java:802)
        ... 4 more
Caused by: java.lang.Exception: Error while trying to sign and encrypt xml file with pgp key in cryptoPGP.
        at com.paymentology.payscheduler.services.CryptoPGP.signAndEncrypt(CryptoPGP.java:196)
        at com.paymentology.payscheduler.modules.cardfile.ProcessCards.exportToDir(ProcessCards.java:927)
        ... 5 more
Caused by: java.lang.Exception: Problem during signing \!
        at com.paymentology.payscheduler.services.CryptoPGP.signAndEncrypt(CryptoPGP.java:184)
        ... 6 more",10/May/22 12:14 PM;617191aea6ecfc007110a8ab;Hi [~accountid:60fedd1e8c15ca006ffc3c63] changes have been merged with master - The following files were changed: ‘CryptoPGP.java’,11/May/22 5:30 PM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab]  Please share the GIT SSO URL for build download and deployment of UAT environment.,13/May/22 2:41 PM;617191aea6ecfc007110a8ab;[~accountid:60fedd1e8c15ca006ffc3c63] No Jar files / dependencies changed or added so build should remain the same,"13/May/22 2:45 PM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab]  but still job is failing on UAT  Please suggest

2022-05-13 12:44:04.822 \[Scheduler_Worker-11] INFO  CryptoPGP - Here is the standard error of the command (if any):

2022-05-13 12:44:04.822 \[Scheduler_Worker-11] ERROR  CryptoPGP - gpg: invalid option ""--pinentry-mode""
2022-05-13 12:44:04.822 \[Scheduler_Worker-11] ERROR  ProcessCards - Error during generating xml for manufacturer with id : 7
java.lang.Exception: java.lang.Exception: Could not encrypt card xml file
at com.paymentology.payscheduler.modules.cardfile.ProcessCards.CompleteProcessing(ProcessCards.java:828)
at com.paymentology.payscheduler.modules.cardfile.ProcessCards.ProcessXML(ProcessCards.java:102)
at com.paymentology.payscheduler.schedulerjobs.JobGenerateManufacturerCard.execute(JobGenerateManufacturerCard.java:56)
at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
Caused by: java.lang.Exception: Could not encrypt card xml file
at com.paymentology.payscheduler.modules.cardfile.ProcessCards.exportToDir(ProcessCards.java:939)
at com.paymentology.payscheduler.modules.cardfile.ProcessCards.CompleteProcessing(ProcessCards.java:802)
... 4 more
Caused by: java.lang.Exception: Error while trying to sign and encrypt xml file with pgp key in cryptoPGP.
at com.paymentology.payscheduler.services.CryptoPGP.signAndEncrypt(CryptoPGP.java:196)
at com.paymentology.payscheduler.modules.cardfile.ProcessCards.exportToDir(ProcessCards.java:927)
... 5 more
Caused by: java.lang.Exception: Problem during signing \!
at com.paymentology.payscheduler.services.Crypt",18/May/22 4:54 PM;617191aea6ecfc007110a8ab;New merge request has been submitted and asked for approval following aforementioned issues with merging before,19/May/22 11:51 AM;617191aea6ecfc007110a8ab;[~accountid:60fedd1e8c15ca006ffc3c63] the java changes have been merged with master - i have seen the changes have been made on master this time. The only changes are in CryptoPGP.java and TaskConfig.java so no jars are needed,"19/May/22 7:18 PM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab] Still getting same exception on UAT. Please check and suggest how the changes will effect on UAT, any Library  need to deploy or something?",19/May/22 8:52 PM;617191aea6ecfc007110a8ab;[~accountid:60fedd1e8c15ca006ffc3c63] what is in the error message in uat after this: ‘INFO CryptoPGP - Here is the standard error of the command (if any):’,"19/May/22 8:56 PM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab]  same error

ERROR CryptoPGP - gpg: invalid option ""--pinentry-mode""
2022-05-13 12:44:04.822 \[Scheduler_Worker-11] ERROR ProcessCards - Error during generating xml for manufacturer with id : 7",20/May/22 6:55 PM;617191aea6ecfc007110a8ab;[~accountid:60fedd1e8c15ca006ffc3c63] Pinentrymode is no longer in the master code as of yesterdays merge. Are you sure you are testing the latest changes?,"20/May/22 8:19 PM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab]  same i want to know how your changes will be applied/effected on UAT environment. As no jar/db function or library given for deployment.



[~accountid:60fedd46b704b400688a8e79]  please help/assist.



cc- [~accountid:60efedaa4257a90070c63774] [~accountid:5bd70c398995b717bb1b846f] ",20/May/22 9:46 PM;617191aea6ecfc007110a8ab;No changes were made to the DB and no libraries were used - only changes were directly in the existing lines of code which needed slight tweeks [~accountid:60fedd1e8c15ca006ffc3c63] ,"23/May/22 11:37 AM;60fedd1e8c15ca006ffc3c63;[~accountid:617191aea6ecfc007110a8ab]  As discussed with Upendra , you seems to provide GIT SSO URL for Payscheduler jar. Kindly coordinate.

cc- [~accountid:60fedd46b704b400688a8e79] , [~accountid:5bd70c398995b717bb1b846f] ",23/May/22 11:45 AM;617191aea6ecfc007110a8ab;Creating release now and will send URL [~accountid:60fedd1e8c15ca006ffc3c63] ,"23/May/22 4:22 PM;617191aea6ecfc007110a8ab;Hi [~accountid:60fedd1e8c15ca006ffc3c63] release pipeline has been created. Here is the URL 

[https://gitlab.com/paymento/registries/releases/maven/-/packages/6958301|https://gitlab.com/paymento/registries/releases/maven/-/packages/6958301|smart-link] ","24/May/22 10:27 AM;60fedd1e8c15ca006ffc3c63;Hi [~accountid:617191aea6ecfc007110a8ab]  Validated this change on UAT by using shared PS build and it seems fine. Kindly refer the below logs and attached Perso file.

Pay Scheduler - *payscheduler-2.7.1.jar*

*Logs:*
2022-05-24 08:17:52.699 \[Scheduler_Worker-3] INFO  JobGenerateManufacturerCard - ...............................................Job started...............................................
2022-05-24 08:17:52.913 \[Scheduler_Worker-3] INFO  ProcessCards - Cards loaded from db for manufacturer id : 7
2022-05-24 08:17:52.915 \[Scheduler_Worker-3] INFO  ProcessCards - Count of product : 1
2022-05-24 08:17:52.915 \[Scheduler_Worker-3] INFO  ProcessCards - Count of record : 1
2022-05-24 08:17:52.916 \[Scheduler_Worker-3] INFO  ConnectPayKeyServ - Creating a normal socket for PayKeyService, 172.18.100.10:7777
2022-05-24 08:17:52.918 \[Scheduler_Worker-3] INFO  ConnectPayKeyServ - Request sent to paykeyserv:
2022-05-24 08:17:52.923 \[Scheduler_Worker-3] INFO  ProcessCards - Request Sent to PayKeyServ with  1 ecnos
2022-05-24 08:17:52.924 \[Scheduler_Worker-3] INFO  ProcessCards - CardProcessing: XML Manu File creation process Started
2022-05-24 08:17:52.926 \[Scheduler_Worker-3] INFO  ProcessCards - XML file generated: /bl/PSData/XML_Outbound/7/7_METTLE_FC_1969_497_24052022_0817.xml
*2022-05-24 08:17:52.926 \[Scheduler_Worker-3] INFO  ProcessCards - Executing Signing and encryption in single step for file 7_METTLE_FC_1969_497_24052022_0817.xml with enc key: 0BAC1238 and sign key: 0BAC1238*
*2022-05-24 08:17:52.927 \[Scheduler_Worker-3] INFO  CryptoPGP - Here is the standard output of the command:*

*2022-05-24 08:17:53.139 \[Scheduler_Worker-3] INFO  CryptoPGP - Here is the standard error of the command (if any):*

*2022-05-24 08:17:53.139 \[Scheduler_Worker-3] INFO  ProcessCards - Sucessfully signed and encrypted to /bl/PSData/XML_Outbound/7/encrypted/7_METTLE_FC_1969_497_24052022_0817.xml*
select client_sftp_details.*,card_manu,'' as client_name from client_sftp_details inner join p_manufacturer on client_sftp_details.manufacturer_id = p_manufacturer.id where manufacturer_id = 7 and connection_type = 'm'
2022-05-24 08:17:53.196 \[Scheduler_Worker-3] INFO  Cards - CardProcessing: 0 rows of PinBlock was submitted to database for Manufacurer ID = 7
2022-05-24 08:17:53.202 \[Scheduler_Worker-3] INFO  Cards - Sucessfully uploaded card details.
2022-05-24 08:17:55.090 \[Scheduler_Worker-3] INFO  JobGenerateManufacturerCard - ...............................................Job ended...............................................

[^7_METTLE_FC_1969_497_24052022_0817.xml]
[^7_METTLE_FC_1969_497_24052022_0817-orig.xml]

cc- [~accountid:623ddb7a866b810069e527bc] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,19/May/22 2:51 PM
Synchronization of tables related to BIN,DEV_SCHEDULER-459,46567,Task,Open,DEV_SCHEDULER,DEV: PayScheduler,software,dilip.shrestha,60fedcf9ae72b2006fe287d2,,,Normal,,Rohit Thapa,60efedaa4257a90070c63774,Hassan Ahmad,60fedd0cc51f3a00697da234,Hassan Ahmad,60fedd0cc51f3a00697da234,03/Jun/21 2:14 PM,03/Jun/21 2:14 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Hi [~accountid:60efedaa4257a90070c63774]/[~accountid:5bd70c398995b717bb1b846f]/[~accountid:6094db8cc87b550069f11ee6],
Synchronization of tables related to BIN is required as per production incident.
[Rohit Thapa: Hi Hassan Ahmad, we store bin value in various tables and from the very … |https://teams.microsoft.com/l/message/19:c47ef38200c54f6ea762e0b9b25eeae3@thread.tacv2/1622717250388?tenantId=4f7797e2-a59f-4381-ad8e-b81223603c9d&groupId=d90711d5-df6f-4e35-9d89-6dc2026a6771&parentMessageId=1622645069105&teamName=Projects&channelName=Mettle&createdTime=1622717250388]
posted in Projects / Mettle at Thursday, June 3, 2021 2:47:30 PM
 ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@14b15b4d,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzsanj:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,30/Jan/22 8:16 AM
Client Personal information available in Paycontrol,DEV_CONTR-1059,113769,Bug,Open,DEV_CONTR,DEV: PayControl,software,Rohan Ale,5bd70c398995b717bb1b846f,,,Normal,,Florin Vistig,5a9e4751a00c7f2a80155fda,ramon.gouveia,6205526df38765006f676f67,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,13/Oct/23 6:05 PM,07/Dec/23 10:21 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"A summary of the request/issue: Client Personal information available in Paycontrol

Platform: Banking.Live - Mettle

Environment: PROD  

Troubleshooting Steps Followed (please try to list everything you have already verified )

Checking the transaction ID (8000000031691003122) in Paycontrol ([https://prod-lb02.banking.live:48011/paycontrol/transactions|https://prod-lb02.banking.live:48011/paycontrol/transactions]) , there is the client name available in the FAST message to mettle.
Client is asking to remove it.

Bug Details: 
{{""48"":}}

{noformat}""0002003BPD0003003BPD001500723101220023003NA 01460360019018260000000000808260000000000800147048001901826000000000000803014826000000000000803014014800482620158031DMC48260017523101303 BPDNNNNNNN01590673480 12800031 3EU00082602N23101303231013010165001M01700320163487763 0163487763 0172014MR DAVID RILEY0173011PORTER NASH0177002N 01910012""{noformat}

!Screenshot 2023-10-13 at 13.06.12.png|width=1279,height=141!

Expected result: Remove personal info of clients.

* Please see Zendesk Support tab for further comments and attachments.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,13/Oct/23 6:06 PM;ug:3be053c3-01f4-4781-82bb-7e1d33bac05f;Screenshot 2023-10-13 at 13.06.12.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/68995,22/Nov/23 4:15 PM;ug:00f06698-dbcb-4abb-bbc5-678d49dd8ee4;image-20231122-141239.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/71790,22/Nov/23 4:15 PM;ug:00f06698-dbcb-4abb-bbc5-678d49dd8ee4;image-20231122-141307.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/71789,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@1d8b6b7d,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzy3in:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-11-12 00:47:57.905,,,"12/Nov/23 2:47 AM;61952b163618cd006f27e765;Hello [~accountid:5bd70c398995b717bb1b846f] 

Can you please check on this Jira and advised?

Thank you ",20/Nov/23 11:38 AM;5bd70c398995b717bb1b846f;[~accountid:5a9e4751a00c7f2a80155fda]  Please take a look into this ticket . ,"20/Nov/23 12:17 PM;5a9e4751a00c7f2a80155fda;[~accountid:6205526df38765006f676f67] [~accountid:61952b163618cd006f27e765] not sure what is requested here. If there’s improper display in PayControl, it should be fixed by Portals team",20/Nov/23 12:19 PM;5bd70c398995b717bb1b846f;@Florin paypower is logging the data and as per what i understood is that there are some sensitive information on DE48 elements which should be fixed by the authorisation team . But correct me if portal team should work on that . ,"20/Nov/23 2:04 PM;5a9e4751a00c7f2a80155fda;[~accountid:632872d207a27ebeff12903b] [~accountid:6297155ee76a9c00705e2b50] if I understand correctly the ticket request, we should remove sensitive information from DE-48 from FAST message. I feel like this would break a lot of functionality from other clients, and it also doesn’t feel like it’s a bug, but a new feature request.",21/Nov/23 10:44 AM;632872d207a27ebeff12903b;[~accountid:6205526df38765006f676f67] please clarify if the client wants it removed form FAST feed we are sending to client?,"21/Nov/23 4:20 PM;6205526df38765006f676f67;Hi [~accountid:632872d207a27ebeff12903b] ,

I’m not sure if you checked the example, but please note the information that we sent on DE48 through the FAST message (MTID 1240 - TID *8000000031691003122*).
DE48: ""0002003BPD0003003BPD001500723101220023003NA 01460360019018260000000000808260000000000800147048001901826000000000000803014826000000000000803014014800482620158031DMC48260017523101303 BPDNNNNNNN01590673480 12800031 3EU00082602N23101303231013010165001M01700320163487763 0163487763 0172014MR DAVID RILEY0173011PORTER NASH0177002N 01910012""

Part of DE48 =  {color:#ff5630}""MR DAVID RILEY0173011PORTER NASH0177002N 01910012""{color}
Mettle wants us to remove that information.","22/Nov/23 4:15 PM;6297155ee76a9c00705e2b50;After the investigation, it has been found that this data is related to the MasterCard clearing PDS data.

!image-20231122-141239.png|width=768,height=323!

!image-20231122-141307.png|width=755,height=60!



[~accountid:632872d207a27ebeff12903b] [~accountid:5a9e4751a00c7f2a80155fda] [~accountid:5bd70c398995b717bb1b846f] Is sending a FAST settlement message under the responsibility of the authorization team?","23/Nov/23 12:00 PM;632872d207a27ebeff12903b;the fast if 1240 , 
indeed its related to clearing component.


[~accountid:5a9e4751a00c7f2a80155fda] your take on this?","23/Nov/23 4:00 PM;5a9e4751a00c7f2a80155fda;I’m not familiar with how clearing process is sending information to FAST. [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] , I would guess it doesn’t use PayPower for doing it right ?","23/Nov/23 4:25 PM;557058:a4bced0a-e933-4a8a-9216-49655949788e;If this is PDS data, what makes it private information?   The business appears to be registered as a sole proprietor under that name, based on [~accountid:6297155ee76a9c00705e2b50] ‘s feedback.   We don’t format any of that data before forwarding on to client as far as I’m aware, and if the client has his business registered that way, why does Mettle want it removed?

Doing so would be a feature request in my opinion, CC: [~accountid:627e6181f29dcb0068fa4152] .","23/Nov/23 4:42 PM;627e6181f29dcb0068fa4152;What is the actual concern here?

Data being sent in the FAST feed or the data is visible somewhere in the Paycontrol UI?","28/Nov/23 9:00 PM;6205526df38765006f676f67;[~accountid:627e6181f29dcb0068fa4152] , exactly.
Client doesn’t want this data visible in Paycontrol and FAST as well.","07/Dec/23 10:13 AM;627e6181f29dcb0068fa4152;First of all this is not a bug, this is a change request and should come through a PR.

Secondly, as far as the FAST feed is concerned, I am not aware of the mentioned data if it is considered sensitive by the PCI standards or by the scheme itself. 

If there are any justification please raise them through a PR. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,13/Oct/23 6:05 PM
Move databases to Liquibase. ,DEV-11637334,101214,Epic,In Progress,DEV,Development,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,Rohan Ale,5bd70c398995b717bb1b846f,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,09/Mar/23 1:39 PM,14/Sep/23 4:39 PM,,,,,,,,,,,,,,PM,,,,,,,,,,,0,,,,,"This Epic will track all envs we need to move to the Liquibase. Each environment is a separate task

*Prod Envs:*

* SHARED01,
* METTLE,
* ADQ,
* BAE,
* MOX



*UAT Envs:*
[TBD]



*Expected Result:*

* Listed Envs are moved to Liquibase
* Info about the version is added to the [https://paymentology.atlassian.net/wiki/spaces/TS/pages/6803882030/Production+Environment+Component+Versions|https://paymentology.atlassian.net/wiki/spaces/TS/pages/6803882030/Production+Environment+Component+Versions|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEV-11638346,DEV-11638384,DEV-11638401,DEV-11637336,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3640cf8d,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ghx-label-13,BL: Liquibase for Envs,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,BL Envs Alignment,,,dark_green,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzw8av:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,09/May/23 6:54 PM
Transaction ID = 0 received from PAYKEY | METTLE,DEV-11637305,101137,Story,Backlog,DEV,Development,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,,,Raajaganapathy K,61f80301f51e85007087ad38,Raajaganapathy K,61f80301f51e85007087ad38,08/Mar/23 4:24 PM,10/Mar/23 10:55 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"please find the below attached error message

{noformat}Instance Name	:	METTLE_PP_01
Log Id	:	4318914
Rid	:	166874
Txn Id	:	0
Time	:	08 Mar 2023 12:51:10
Description	:	Transaction id = 0 received from paytok.
Detail

java.lang.Exception: Tid = 0 exception at Logics.Message0100ProcessThread.PreTokenize0100(Message0100ProcessThread.java:183) at Logics.RequestRouter.fineRouting(RequestRouter.java:114) at Logics.RequestRouter.run(RequestRouter.java:98) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at java.lang.Thread.run(Thread.java:750){noformat}

Upon checking, we received DE_39 = 05 at the TOKENIZATION stage.

Token number for the affected transaction = 539947579

Account ID is = 640929008

DE_11 for the affected transaction - 641827

time of the transaction - 12:51:10.224

Seems, we received ACCOUNT_ID as 0 and the transactions ID was also 0 which makes us impossible to fetch the transactions from Paycontrol.

Kindly find the attached PP, PKS logs for reference and do the needful.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,08/Mar/23 4:21 PM;ug:3942613c-e2b9-4473-b01e-a0499bec3706;PKS_nohup.out;https://paymentology.atlassian.net/rest/api/3/attachment/content/56412,08/Mar/23 4:21 PM;ug:3942613c-e2b9-4473-b01e-a0499bec3706;PP_nohup.out;https://paymentology.atlassian.net/rest/api/3/attachment/content/56413,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5b00c542,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzw7xr:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,08/Mar/23 4:24 PM
Mettle PP - Client observed 3 txn timeout declines,DEV-11637151,100872,Task,Backlog,DEV,Development,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,Abhishek Bhujel,6094db8cc87b550069f11ee6,Former user,62b2e4869abb660ab14b277d,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,02/Mar/23 9:21 PM,27/Apr/23 1:18 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"Dear Team
Mettle observed 3 txn timeout declines and when we investigated the issue in Paycontrol we discovered some delay in the response received from Rules engine. Could you kindly investigate on the reason for these declines or delay which resulted in 3 TIDs
Please find attached PP log which has 2 of these txns;

TID: 2251501905909097036 - RID: 159459
TID: 2251501960779189530 - RID: 159460
TID: 2251501580252462041 - RID: 159458

~* Please see Zendesk Support tab for further comments and attachments.~",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,02/Mar/23 9:37 PM;ug:17d65037-ae7e-4d49-87a9-f3b45fca83e7;Rules Engine delays.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/56126,02/Mar/23 9:24 PM;ug:17d65037-ae7e-4d49-87a9-f3b45fca83e7;Transaction - 02-Mar-2023 19_17_48.xlsx;https://paymentology.atlassian.net/rest/api/3/attachment/content/56124,02/Mar/23 9:28 PM;ug:17d65037-ae7e-4d49-87a9-f3b45fca83e7;image-20230302-192659.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/56125,02/Mar/23 9:21 PM;ug:17d65037-ae7e-4d49-87a9-f3b45fca83e7;nohup_2BV.zip;https://paymentology.atlassian.net/rest/api/3/attachment/content/56123,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5ddfe15c,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzw6jb:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-10 08:18:09.807,,,"02/Mar/23 9:28 PM;62b2e4869abb660ab14b277d;cc: [~accountid:60fedd468c15ca006ffc3ef1] [~accountid:6228aefd6a4c4c0070b197d9] copying you to kindly advise if there were any  Network or Infra related issues during the attached timestamps mentioned in Mettle Paypower server

!image-20230302-192659.png|width=1691,height=446!","10/Mar/23 10:18 AM;6094db8cc87b550069f11ee6;Have investigated for these transactions and came up with following statistics.
And based on the statistics it kind of looks like there has been some sort of locking in paycore db which we can investigate it further with the DBA team on it.
[~accountid:60fedcfbec92ab0070555259] , can we investigate if there has been locking of certain tables of paycore db at around  *2023-03-02 13:55:00 –  2023/03/02 13:57:02.726.*

c.c [~accountid:60fedcdc75ad960069b85175] , [~accountid:5bd70c398995b717bb1b846f] 

----

h3. *_2251501580252462041_*


*_0100_*
Rule engine ==> {color:#bf2600}2023-03-02 13:55:58.647 -- 2023-03-02 13:56:07.872 ==> ~9 sec{color}
Handle auth ==> {color:#bf2600}2023/03/02 13:56:45.379 -- 2023/03/02{color}{color:#bf2600} *13:57:02.726*{color}{color:#bf2600} ==> ~17 sec{color}

*_0420_*
Rule engine ==> 2023-03-02 13:56:07.569 -- 2023-03-02 13:56:08.027 ==> ~1 sec
Handle auth ==> 2023-03-02 13:56:08.129 -- 2023-03-02 13:56:08.27 ==>  milli

*_0120_*
Rule engine ==> 2023-03-02 13:57:07.058 -- 2023-03-02 13:57:07.163 ==>  milli
Handle auth ==> 2023-03-02 13:57:07.303 -- 2023-03-02 13:57:07.388 ==>  milli

----

h3. *_2251501905909097036_*


*_0100_*
Rule engine ==> {color:#bf2600}2023-03-02 13:56:31.057 -- 2023-03-02 13:56:44.969 ==> ~13 sec{color}
Handle auth ==>{color:#ff5630} {color}{color:#bf2600}2023-03-02 13:56:45.379 -- 2023-03-02 {color}{color:#bf2600}*13:57:02.726*{color}{color:#bf2600} ==> ~17 sec{color}

*_0420_*
Rule engine ==> 2023-03-02 13:56:40.016 -- 2023-03-02 13:56:45.067 ==> ~5 sec
Handle auth ==> {color:#bf2600}2023-03-02 13:56:45.422 -- 2023-03-02 {color}{color:#bf2600}*13:57:02.816*{color}{color:#bf2600} ==> ~17 sec{color}

*_0120_*
Rule engine ==> 2023-03-02 13:57:07.849 -- 2023-03-02 13:57:07.883 ==> milli
Handle auth ==> 2023-03-02 13:57:07.947 -- 2023-03-02 13:57:08.031 ==> milli

----

h3. *2251501960779189530*


*_0100_*
Rule engine ==> 2023-03-02 13:56:36.541 -- 2023-03-02 13:56:44.968 ==> ~8 sec
Handle auth ==>{color:#bf2600} 2023-03-02 13:56:45.081 -- 2023-03-02 {color}{color:#bf2600}*13:57:02.709*{color}{color:#bf2600} ==> ~17 sec{color}

*_0420_*
Rule engine ==>{color:#bf2600} 2023-03-02 13:56:47.455 -- 2023-03-02 13:57:02.841 ==> ~15 sec{color}
Handle auth ==> 2023-03-02 13:57:02.998 -- 2023-03-02 13:57:03.122 ==> milli

*_0120_*
Rule engine ==> 2023-03-02 13:57:08.44 -- 2023-03-02 13:57:08.471 ==> milli
Handle auth ==> 2023-03-02 13:57:08.542 -- 2023-03-02 13:57:08.542 ==> milli

----","11/Apr/23 8:48 PM;62b2e4869abb660ab14b277d;Dear Team,

A kind reminder on this request [~accountid:60fedcfbec92ab0070555259]  cc:[~accountid:6094db8cc87b550069f11ee6] [~accountid:60fedcdc75ad960069b85175] ","27/Apr/23 1:18 PM;60fedcdc75ad960069b85175;[~accountid:62b2e4869abb660ab14b277d] The issue looks in db side.
PLease follow up with DBA team.
I will remove it from rapid components for now.
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,02/Mar/23 9:21 PM
Mettle Schema Review + Script Creation,DEV-11636349,99317,Story,Backlog,DEV,Development,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,Rohan Ale,5bd70c398995b717bb1b846f,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,30/Jan/23 9:50 AM,21/Feb/23 9:20 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"HI [~accountid:5bd70c398995b717bb1b846f]  and team,

In reference to Liquibase enablement on Mettle, this ticket is created for below actions from dev.

Once DBA attached requested details here [https://paymentology.atlassian.net/browse/OPS-10539|https://paymentology.atlassian.net/browse/OPS-10539|smart-link]  and pre-req of this ticket, please generate the script of each DB as we did on SH02. This will then execute on SH03 for downtime assessment and basic functionality testing.

CC: [~accountid:60fedcdc627b5600689cd1a0] [~accountid:61f80302845d670071f2138e] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@46143ab2,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvyof:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-02-21 07:20:35.425,,,"14/Feb/23 12:46 PM;611a52967b538a006964a439;Following the call, it has been decided to get the script as per latest BL 1.5.X family.

ETA - 24 Feb 2023. Thursday.

","21/Feb/23 9:20 AM;5bd70c398995b717bb1b846f;Due to the Tweeq and D60 , this ticket is not getting priority. 

Will prioritize once above priority task completion.


CC: [~accountid:611a52967b538a006964a439]  ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,99313,OPS-10538,Mettle - Plan For Liquibase Enablement,To Do,30/Jan/23 9:50 AM
METTLE Chargeback Report generation Issues ,DEV-11635851,98489,Story,Backlog,DEV,Development,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,,,Mandla Sibiya,557058:916680d9-3622-4c1b-a84f-5cbad19df544,Mandla Sibiya,557058:916680d9-3622-4c1b-a84f-5cbad19df544,10/Jan/23 1:26 PM,28/Mar/23 9:42 AM,,,,,,,,,,,,,,Services - QA - DO NOT USE -> ES - QUALITY ASSURANCE,,,,,,,,,,,0,,,,,"Please assist in fixing the below error:
All the chargeback reports generated on different dates are identical to each other. Upon checking the report generation job in PayControl, we could see that the DEFAULT function is used for report generation. Attached is the sample report from PayScheduler. Please check the database function that is used to generate the report. Unable to fetch the exact function name from PayControl.

!image-20221118-073245.png|width=1496,height=671!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,10/Jan/23 1:28 PM;mandla;image-20221118-073245.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/53572,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@437e9e49,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvtlr:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,42069,DEV-7100,Stories for the QA Team,To Do,10/Jan/23 1:26 PM
Compliance requirement for UK clients - Recurring transactions for MC5968,DEV-11635217,97552,Story,Backlog,DEV,Development,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,,,Mandla Sibiya,557058:916680d9-3622-4c1b-a84f-5cbad19df544,Mandla Sibiya,557058:916680d9-3622-4c1b-a84f-5cbad19df544,12/Dec/22 3:17 PM,12/Dec/22 3:18 PM,,,,,,,,,,,,,,Services - QA - DO NOT USE -> ES - QUALITY ASSURANCE,,,,,,,,,,,0,,,,,"*What are you trying to Achieve?* 
﻿+In regards to UK Mastercard clients:+

In the Authorisation Requisition/0100 message if the recurring transaction indicator is set or the merchant category code is 5968 - (Direct Marketing- Continuity/Subscription Merchants) it states that the issuer must not check the expiry date and cannot decline the transaction for the reason that the expiry date quote in the authorisation message is incorrect, or that the expiry date is missing from the message  

*How should this work?* 
﻿  
*Only for UK clients, where 0100 message is recurring and merchant* *MCC* *= 5968, we must not decline the transaction if the expiry date is incorrect or missing.*

*What happens if we cannot make this work? (consequence)* 
﻿Then Paymentology is not compliant with regards to this rule for Mastercard UK clients.  

*Due Date:* 
﻿Seems like this is already a requirement as per the Mastercard documentation   

*Can this be re-used by other clients?:* 
﻿Yes, we have Mettle, Nomo, Utility Warehouse, ONMO, etc.  

*Developer Documentation:* 

*Internal Documentation:* 

[^mc_uk_domestic_rules.pdf]

!image_(24).png|width=313,height=445!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEV-9334,,,,,,,,,,,,,,,,,,,,12/Dec/22 3:18 PM;mandla;image_(24).png;https://paymentology.atlassian.net/rest/api/3/attachment/content/52612,12/Dec/22 3:18 PM;mandla;mc_uk_domestic_rules.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/52611,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@27104993,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvoi7:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,42069,DEV-7100,Stories for the QA Team,To Do,12/Dec/22 3:17 PM
Tokenization: TAV and Encrypted data for to be sent to client (Not using Meawallet),DEV-11634783,96772,Story,Backlog,DEV,Development,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,,,Mandla Sibiya,557058:916680d9-3622-4c1b-a84f-5cbad19df544,Mandla Sibiya,557058:916680d9-3622-4c1b-a84f-5cbad19df544,22/Nov/22 1:37 PM,24/Nov/22 12:44 PM,,,,,,,,,,,,,,Services - QA - DO NOT USE -> ES - QUALITY ASSURANCE,,,,,,,,,,,0,,,,,"*One year ago, before Paymentology 1.0 and Tutuka merged, a change request was approved by Mettle where we were required to do work that would enable them and other clients using us directly for provisioning tokens,not wanting to make use of Meawallet.* 

The purpose of this is to share PAN information and a TAV to non PCI compliant clients where they can use the data in the payloads to the Wallets during provisioning.

In order to do this successfully, we needed to generate encrypted card data and the TAV for Apple and something similar for non-Apple wallets.  Attached to the story are the requirements that were approved by the client.



*What was built?*

Paymentology built two new client facing APIs to generate TAV and encrypted card data for Apple Pay and MDES. 

* [Generate Apple Digitization Data|https://developer.paymentology.com/reference/sc_generate_apple_digitization_data]
* [Generate MDES Digitization Data|https://developer.paymentology.com/reference/v2_sc_generate_mdes_digitization_data]



*What are the differences between the 2 API’s?*

The only differences between the 2 is what is used to encrypt the card data and how it is done. 
TAV generation is done the same for both implementations (Please see page 88 of the [_MDES Issuer Implementation Guide_|https://paymen.sharepoint.com/:b:/r/sites/Engineering/Engineering/Specifications/MDES/MDES%20Issuer%20Implementation%20Guide%20-%20July%202022.pdf?csf=1&web=1&e=LaucJp] for more information on TAV generation)

* [Generate Apple Digitization Data|https://developer.paymentology.com/reference/sc_generate_apple_digitization_data]
** We use values from the incoming request to encrypt the card data ie.
*** Apple public Key
*** Apple generated nonce (random string) Key
*** Apple signed nonce (signed random string) Key
** Please look at page 50 of the [Apple Pay Guide|https://paymen.sharepoint.com/:b:/r/sites/Engineering/Engineering/Specifications/Apple/Getting%20Started%20with%20Apple%20Pay%20In-App%20Provisioning,%20Verification%20%26%20Security%20(3.0).pdf?csf=1&web=1&e=xXNShj] to see how we use these values to encrypt the data
* [Generate MDES Digitization Data|https://developer.paymentology.com/reference/v2_sc_generate_mdes_digitization_data]
** We use a Mastercard Public Key and fingerprint (stored on our system) to encrypt the card data
** Please look at page 162 of the [_MDES Issuer Implementation Guide_|https://paymen.sharepoint.com/:b:/r/sites/Engineering/Engineering/Specifications/MDES/MDES%20Issuer%20Implementation%20Guide%20-%20July%202022.pdf?csf=1&web=1&e=LaucJp] for more information on how the card data is encrypted



*What’s the problem?*

The problem is that the client specification was misunderstood

Mettle wanted the option to sign the TAV signature themselves via an argument supplied to the API’s: {{tavSigned}}

* If {{tavSigned = 1}}
** We would encrypt the card data
** We create the hashed and *signed signature*
** We return both the encrypted card data as well as the TAV
* If {{tavSigned = 0}}
** We would encrypt the card data
** We create the hashed signature, *but do not sign it*
** We return both the encrypted card data as well as the TAV



*But instead we built the logic in this way:*

* {{If tavSigned = 1}}
** We will fail the request
*** [MDES|https://gitlab.com/paymento/source/bl2.0/payapi/-/blob/951a2add27215bac7220392037b7bdf2c539323b/src/main/java/com/paymentology/payapi/v2/controller/PaySecureCardController.java#L1162] & [Apple|https://gitlab.com/paymento/source/bl2.0/payapi/-/blob/951a2add27215bac7220392037b7bdf2c539323b/src/main/java/com/paymentology/payapi/v2/controller/PaySecureCardController.java#L1292]
* {{If tavSigned = 0}}
** We would encrypt the card data
** We would create the TAV with a hashed and then signed signature
** We return both the encrypted card data as well as the TAV
** This all happens [here|https://gitlab.com/paymento/source/bl2.0/payapi/-/blob/951a2add27215bac7220392037b7bdf2c539323b/src/main/java/com/paymentology/payapi/v1/model/paysecurecard/PaySecureCardDBV2.java#L1549] for MDES and [here|https://gitlab.com/paymento/source/bl2.0/payapi/-/blob/951a2add27215bac7220392037b7bdf2c539323b/src/main/java/com/paymentology/payapi/v1/model/paysecurecard/PaySecureCardDBV2.java#L1832] for Apple



*How can we fix this?*

Please follow the correct logic.

* If {{tavSigned = 1}}
** We need to sign the TAV signature ourselves
* If {{tavSigned = 0}}
** Do not sign the signature, just return the SHA256 hash of the signature in the TAV object



We also need to get the code into a production ready state please. Currently the code is written in a way of hardcoded values for testing purposes.



* In the cases of where we are expected to sign the signature, we need to be storing the Issuers private TAV key which must be provided to us by the client. (Please see page 88 of the [_MDES Issuer Implementation Guide_|https://paymen.sharepoint.com/:b:/r/sites/Engineering/Engineering/Specifications/MDES/MDES%20Issuer%20Implementation%20Guide%20-%20July%202022.pdf?csf=1&web=1&e=LaucJp] for more information)
* For non Apple Pay wallets - We also need to be storing the clients Mastercard Encryption Public Key & Fingerprint which is used to encrypt the card data. (Please see page 163 of the [_MDES Issuer Implementation Guide_|https://paymen.sharepoint.com/:b:/r/sites/Engineering/Engineering/Specifications/MDES/MDES%20Issuer%20Implementation%20Guide%20-%20July%202022.pdf?csf=1&web=1&e=LaucJp] for more information)
* For Apple Pay wallets - a different encryption key and process is used. The values are passed to us in the request,. so we do not need to be storing anything.



_For more information on TAV generation and TAV signature generation, please see from the bottom of page 85 of the_ [_MDES Issuer Implementation Guide_|https://paymen.sharepoint.com/:b:/r/sites/Engineering/Engineering/Specifications/MDES/MDES%20Issuer%20Implementation%20Guide%20-%20July%202022.pdf?csf=1&web=1&e=LaucJp]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEV-9553,,,,,,,,,,,,,,,,,,,,22/Nov/22 1:39 PM;mandla;DEV-9553_attachments.zip;https://paymentology.atlassian.net/rest/api/3/attachment/content/51820,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5af42fd7,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzvk9j:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2022-11-24 10:44:57.681,,,"24/Nov/22 12:44 PM;5a246636e7a1121a1ecce06d;Out of curiosity, what is this task for? Is it for tracking QA effort for the original task? [https://paymentology.atlassian.net/browse/DEV-9553|https://paymentology.atlassian.net/browse/DEV-9553|smart-link]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,42069,DEV-7100,Stories for the QA Team,To Do,22/Nov/22 1:37 PM
METTLE Ping Drop Issue,DEV-10996,94390,Bug,In Progress,DEV,Development,software,Shaun Hodgkiss,557058:89fff8ff-87f9-4cdf-926a-b8784bf788d0,,,Normal,,Raajaganapathy K,61f80301f51e85007087ad38,Raajaganapathy K,61f80301f51e85007087ad38,Raajaganapathy K,61f80301f51e85007087ad38,13/Oct/22 1:26 PM,14/Oct/22 12:07 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,,"Failed to PING to METTLE. Lot of Ping failures observed between 06:39 and 06:48. Attached the screenshot for reference

Slack Thread - [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1665656623721199|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1665656623721199|smart-link]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,13/Oct/22 1:26 PM;ug:3942613c-e2b9-4473-b01e-a0499bec3706;Screenshot 2022-10-13 at 10.38.50 (1).png;https://paymentology.atlassian.net/rest/api/3/attachment/content/49970,13/Oct/22 1:26 PM;ug:3942613c-e2b9-4473-b01e-a0499bec3706;image (21).png;https://paymentology.atlassian.net/rest/api/3/attachment/content/49971,14/Oct/22 12:07 PM;ug:0940e0d8-0d86-42f7-b5d8-940797c223f2;mettle_access_13_Oct.txt;https://paymentology.atlassian.net/rest/api/3/attachment/content/50019,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@28e97cd9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzv7yv:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2022-10-14 10:05:42.198,,,"14/Oct/22 12:05 PM;60fedd468c15ca006ffc3ef1;Hi [~accountid:61f80301f51e85007087ad38] ,

For 13/Oct/2022:*13:20  to 13:43  54 request Failed*

{noformat}HTTP Error code Split up  
499 - > 49 request 
404  -> 3 request 
502   ->   2 request {noformat}

all request were sent to *10.23.2.11:48009* during this time*23:13 to 23:18   11 request Failed*

{noformat}HTTP Error code Split up   
499 - > 10 request , 
502 - >  1 request{noformat}

all request were sent to *10.23.2.10:48009* during this time

[~accountid:60fedcdc627b5600689cd1a0]  [~accountid:60efea9cf749c400680c020e]  [~accountid:601a574f332cbe007013fb6c] [~accountid:611a52967b538a006964a439] ",14/Oct/22 12:07 PM;60fedd468c15ca006ffc3ef1;Attching the Logs from nginx ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress,14/Oct/22 12:05 PM
BL | METTLE | Unexpected problem arised during pre-tokenization ,DEFECT-4335,185169,Defect,In Review,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Normal,,Henrique Misael Machado,6157201a64ff01007122c0b6,Juliano Polican Ciena,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,13/Nov/25 12:03 AM,02/Feb/26 2:57 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,,,"Hello team,

This is due PD alert [[#640858] Error Notification - Module PayPower ( BL 2.0 METTLE-PROD ) - Unexpected problem arised during pre-tokenization. - PagerDuty|https://tutuka.pagerduty.com/incidents/Q0OPSJQHQ4Z9KT]
 

!_name=image.png|width=765!



 
 
[+Log Explorer | Datadog+|https://app.datadoghq.eu/logs?query=%22Multiple%20cards%20found%20for%20the%20given%20encrypted%20PAN%22&agg_m=count&agg_m_source=base&agg_q=status%2Cservice&agg_q_source=base%2Cbase&agg_t=count&clustering_pattern_field_path=message&cols=host%2Cservice&messageDisplay=inline&refresh_mode=sliding&sort_m=%2C&sort_m_source=%2C&sort_t=%2C&storage=hot&stream_sort=desc&top_n=10%2C10&top_o=top%2Ctop&viz=stream&x_missing=true%2Ctrue&from_ts=1761511776591&to_ts=1762807776591&live=true]


{noformat}2025-11-10 20:23:53.754 ERROR [pool-2-thread-16] [com.paymentology.paypower.service.processor.BaseWorkflow] [traceId=691249d900000000148d898139b20452 spanId=1021662786974372374 requestId=1725111008235373223 ppRequestId=27306131]  Unexpected problem arised during pre-tokenization.
com.paymentology.paypower.exception.MultipleCardException: Multiple cards found for the given encrypted PAN
 at com.paymentology.paypower.adapter.out.persistence.CardPortDatabase.getCard(CardPortDatabase.java:47)
 at com.paymentology.authorisationengine.transaction.TransactionService.buildTransaction(TransactionService.kt:26)
 at {noformat}



Here are findings from Codex: 

[https://chatgpt.com/s/cd_6915056645508191baa1e7153f601146|https://chatgpt.com/s/cd_6915056645508191baa1e7153f601146|smart-card]



Version 1

* The {{CardDatabaseAdapter#getCard}} method throws {{MultipleCardException}} whenever the {{CardEntity}} returned by the validation repository reports a {{count}} greater than one, interpreting that as “multiple cards found for the given encrypted PAN.”
* That {{count}} field is populated in {{CardRowMapper}} from the {{token_count}} column of the SQL result set.
* The SQL in {{ValidationCardRepository#getCardEntity}} joins {{p_tok}} records for the supplied encrypted PAN ({{ecno}}) and adds a lateral subquery {{SELECT COUNT(1) AS tok_count FROM p_tok WHERE ecno = pt.ecno}}. If more than one row exists in {{p_tok}} for the same encrypted PAN, {{tok_count}} becomes greater than one, which in turn causes the adapter to raise {{MultipleCardException}}.

h3. Interpretation

The most likely underlying cause is duplicated or non-archived rows in the {{p_tok}} table for the same encrypted PAN. Cleaning up the data (so that each encrypted PAN maps to a single active token record) or altering the query/count logic would prevent {{tok_count}} from exceeding one and therefore avoid the exception.



Please advise if action above need to be taken to prevent this issue.",,Cagdas Evren Gerede,Florin Vistig,Henrique Misael Machado,Juliano Polican Ciena,Murats Voroneckis (Meawallet),Zendesk Support for Jira,,,,,,5a246636e7a1121a1ecce06d,5a9e4751a00c7f2a80155fda,6157201a64ff01007122c0b6,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,639833c977c9c3a008b8fae1,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,DEFECT-4360,,,,,,,,,,,,,,,,,,,,,,18/Nov/25 2:15 PM;ug:0fab03c0-c89a-42e5-b27f-48d23d780847;Mettle_Query_output_Paytok.xlsx;https://paymentology.atlassian.net/rest/api/3/attachment/content/130825,13/Nov/25 12:12 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;_name=image.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/130203,26/Nov/25 12:16 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20251125-220603.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/131752,26/Nov/25 12:16 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20251125-220643.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/131751,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PE - Processing  - Authorisations,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@499fc9a5,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,Shared Production [BL],,,,,,,,,,,,,,,,N / A [Internal / Partner],,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,Mettle,1|i06y30:,,,,P3,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-15,2025-16,2025-17,2026-01,2026-2,,,,,,,,,,,,,,,,,,,,,,,7b08db5f-ae7a-4912-8c53-a918d97163b3,PE - Core - API,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-11-13 07:43:35.779,,,"13/Nov/25 9:43 AM;5a9e4751a00c7f2a80155fda;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] as the error mentions {{Multiple cards found for the given encrypted PAN}} , this issue is related to multiple tokens associated to the same ECNO (encrypted PAN). My team is not the owner of card issuance, so this is best to be handled by Card API team.",16/Nov/25 11:44 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:5a9e4751a00c7f2a80155fda] thanks. Now assigned to API team,17/Nov/25 1:25 AM;5a246636e7a1121a1ecce06d;[~accountid:6157201a64ff01007122c0b6] please check out.,"18/Nov/25 1:30 PM;6157201a64ff01007122c0b6;Please [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] may we have more information on what was done in the environment if anything?

If the environment is untouched, please, run the following query to help with the investigation:

{code:sql}WITH duplicated_ecnos AS (
    SELECT
        ecno,
        COUNT(*) AS tok_count
    FROM p_tok
    GROUP BY ecno
    HAVING COUNT(*) > 1
)
SELECT
    encode(p.ecno, 'hex')         AS ecno_hex,
    d.tok_count                   AS total_tokens_for_ecno,
    p.pr_tok,
    p.pan,
    p.expiry,
    p.cre_dt,
    p.status                      AS status_legacy,
    p.status_sys,
    p.status_nwk,
    p.load_status,
    p.acc_id,
    p.crd_prdct_id,
    p.tok_flags,
    p.card_type
FROM p_tok p
         JOIN duplicated_ecnos d
              ON p.ecno = d.ecno
ORDER BY
    encode(p.ecno, 'hex'),
    p.cre_dt ASC{code}","18/Nov/25 2:15 PM;6157201a64ff01007122c0b6;Got the result from AS:

[^Mettle_Query_output_Paytok.xlsx]

","19/Nov/25 4:02 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Last update in slack: 

[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1763490440959519?thread_ts=1762806238.921049&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1763490440959519?thread_ts=1762806238.921049&cid=C02CA1QPG5Q|smart-link] 

In any case [@Praveen B|https://paymentology.slack.com/team/U09056UHNE6] [@Juliano|https://paymentology.slack.com/team/U053GUMC83H] my hypothesis is that the problem is that the problem occured with the token 115683293 (hex ECNO is 53965490ba541b0a0e3c70cd498ddc22), that have status_sys 202 (delivered I believe?). status_nwk=1000 which means active I guess? That shouldn't be possible since, again, this token was part of the duplicate ECNO problem. We should void this token and it shouldn't be used anymore.We have to search all environments affected by the duplicate ECNO issue to see if there are {{p_tok}} records with duplicate ECNOs that were not voided in the original cleanup.

{noformat}WITH duplicated_ecnos AS (
    SELECT
        ecno,
        COUNT(*) AS tok_count
    FROM p_tok
    GROUP BY ecno
    HAVING COUNT(*) > 1
)
SELECT
    encode(p.ecno, 'hex')         AS ecno_hex,
    d.tok_count                   AS total_tokens_for_ecno,
    p.pr_tok,
    p.pan,
    p.expiry,
    p.cre_dt,
    p.status                      AS status_legacy,
    p.status_sys,
    p.status_nwk,
    p.load_status,
    p.acc_id,
    p.crd_prdct_id,
    p.tok_flags,
    p.card_type
FROM p_tok p
         JOIN duplicated_ecnos d
              ON p.ecno = d.ecno
ORDER BY
    encode(p.ecno, 'hex'),
    p.cre_dt ASC{noformat}

As I did, the result of this query (in each of the environments) will have to be investigated to see if any of the results ({{p_tok}} records) have {{status_sys}} field different from 99 (the status we have set in the original cleanup). If it does, we need to work on voiding the card ({{status_nwk}} should be the value for void/cancelled card as well). Just to be extra careful, I would advise to check {{pan_stack}} table for the ECNOs that were duplicate and see that the {{pan_stack.status}} is *different than 1*. If the status in that table is 1, the ECNO may be picked up and cause further problems. I believe [@Kamal|https://paymentology.slack.com/team/U027X5NR89L] should be able to help with the understanding of the problem and correct me if my assumptions regarding the state of the db are wrong.",19/Nov/25 4:10 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;CC [~accountid:712020:18302a5b-39e6-4cf6-85d4-20f9e73932c6] wrt [Ticket: linked to apple pay issue. - TNP… – Paymentology – Zendesk|https://paymentology.zendesk.com/agent/tickets/1029861],"19/Nov/25 10:22 PM;6157201a64ff01007122c0b6;Before wrapping up the runbook to fix the issue I just want confirmation from [~accountid:5a9e4751a00c7f2a80155fda] that my understanding is correct: the system does not handle two different {{p_tok}} records with the same ECNO, and that would lead to the processing failing. It doesn’t matter the status of the token, if we have two different tokens but only one of them is with valid status, the system won’t accept that token for processing.

If we do have that confirmed, then we can follow this runbook to find and fix the problematic tokens in the database: [https://paymentology.atlassian.net/wiki/spaces/TS/pages/9255125033/DEFECT-4335+Unexpected+problem+arised+during+pre-tokenization#C.-Runbook|https://paymentology.atlassian.net/wiki/spaces/TS/pages/9255125033/DEFECT-4335+Unexpected+problem+arised+during+pre-tokenization#C.-Runbook|smart-link] ","20/Nov/25 10:41 AM;5a9e4751a00c7f2a80155fda;[~accountid:6157201a64ff01007122c0b6] yes, that’s correct.","24/Nov/25 4:52 PM;6157201a64ff01007122c0b6;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] let me know if there’s any questions about the document. Also, if someone from AS could describe the process for voiding cards in the document that would be much appreciated. It can be added right after I state that the tokens have to be voided, in section C.1",24/Nov/25 11:25 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:6157201a64ff01007122c0b6] I will review and come back on this,"26/Nov/25 12:16 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:6157201a64ff01007122c0b6] from info in the [page|https://paymentology.atlassian.net/wiki/spaces/TS/pages/9255125033/DEFECT-4335+Unexpected+problem+arised+during+pre-tokenization#C.-Runbook], I understood that for mettle there is only one token pb_tok 732358266 which has a duplicated ecno

|ecno_hex|total_tokens_for_ecno|pb_tok|cre_dt|status_sys|status_nwk|crd_prdct_id|
|53965490ba541b0a0e3c70cd498ddc22|2|732358266|13/10/2025 17:09|202|1000|1|

Token is Fully Operational. AS does not change card status unless requested by client, when it happens, we do it via PC if few cases, or ask client to do it via API when several. 

I think we need to tell client that this had a problem on creation and ask them to void it with status *1199*​: Void card, I guess the last one in screen below. Client has an external reference account; they might have some control on cards on their side, hence void should come from them.  Maybe TAM [~accountid:639833c977c9c3a008b8fae1] can advise on that.



Could you raise a CCM for the cleanup suggested? Perhaps we need to discuss a process to check for duplicates and do the cleanup when need. I can ask someone from AS to join the call. 

!image-20251125-220603.png|width=590,alt=""image-20251125-220603.png""!

!image-20251125-220643.png|width=363,alt=""image-20251125-220643.png""!","26/Nov/25 1:46 PM;6157201a64ff01007122c0b6;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] The CCM can be created if we see the need for that. First AS could help running the READONLY queries to identify whenever cleanup is actually needed. I believe it won’t be needed, but it doesn’t hurt to be safe.","26/Nov/25 5:44 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:6157201a64ff01007122c0b6][~accountid:639833c977c9c3a008b8fae1] 
Notes from our call today

Root cause was fixed, somehow pan_stack was changes to this issue happen again. 

Actions:

Henrique will check how card/token records can be fixed to enable cardholder to use it.

Juliano to run extracts in all other envs/clients to check if issue persists.

Feel free to add or amend.","27/Nov/25 7:25 PM;6157201a64ff01007122c0b6;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] As far as I could investigate it doesn’t seem it would cause harm to set {{p_tok.ecno = NULL}} for that record that have {{status=99}} and {{status_nwk=1199}}. I don’t know if Clearing ([~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] ) or Authorizations ([~accountid:5a9e4751a00c7f2a80155fda] ) would think otherwise. This would enable the active card to be used without further problems, without we needing to void the card and inform the client, as [~accountid:6328729388ed2ebef978552f] suggested.","27/Nov/25 9:31 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:6157201a64ff01007122c0b6] Ok, let’s wait for inputs from them.","01/Dec/25 9:35 AM;557058:a4bced0a-e933-4a8a-9216-49655949788e;[~accountid:6157201a64ff01007122c0b6] , from a clearing perspective, if ECNO is null we won’t be able to resolve that record for the ECNO which means that the “correct” record should resolve.  So this looks OK as a “fix” to me, as long as root cause is fixed.","05/Dec/25 9:59 AM;639833c977c9c3a008b8fae1;[~accountid:6157201a64ff01007122c0b6] then I assume we are good to move forward with the fix?
cc [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] ","05/Dec/25 8:49 PM;6157201a64ff01007122c0b6;[~accountid:639833c977c9c3a008b8fae1] It seems so to me. The fix would be to set the {{ecno}} column to {{NULL}} in the inactive token that is duplicating the ecno of the active one. The inactive token is also a lot older I believe.

Did we see any of it in any other environment?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147570,PECA-686,[NOW] Bugs/Defects,In Progress,17/Nov/25 6:51 PM
"BL: Monthly Management Report (Discrepancies on Settlement, Active Account, Active Cards)",DEFECT-4111,177745,Defect,To Do,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Normal,,jose.oliveira,6205526c5d18ad00729a63a2,Keatlegile Khumalo,557058:d62d46f7-6cba-47aa-ad0c-3cc4f0e13123,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,29/Sep/25 5:23 PM,21/Oct/25 2:02 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,jira_update,,,,"Hi team, inside of the excel sheet, we have some discrepancies issues between the numbers on the ""Individual Reports"" vs the ""Consolidated Reports"" (Monthly Transaction PayUK report).

Once you open the excel file, please view the 'Details"" tab and see the rows.

The green part highlighted shows the part which has been validated when we compare both reports and the yellow part (just ignore it).

You'll noticed that for example (but please go through the entire excel sheet to get a good view of everything)


Settlement number is different for:

- BAE
- D360

Number of Active Accounts:

- MOX

Number of Active Cards

- Mettle

Number of Fully Operational Cards

- Utility Warehouse
- ONMO
- BAE


        h3. Attachments


        [Individual vs Consolidated Reports - Aug 2025.xlsx|https://paymentology.zendesk.com/attachments/token/bJzMb3IwCQbYMF7GrTUInYFa1/?name=Individual+vs+Consolidated+Reports+-+Aug+2025.xlsx]


      ~* Please see Zendesk Support tab for further comments and attachments.~",,Automation for Jira,David Praise Chukwuma Kalu,jose.oliveira,Zendesk Support for Jira,,,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,63404a582eaaa5dcfa17a0e9,6205526c5d18ad00729a63a2,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEFECT-3930,PECR-683,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@76d24b7e,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06a2c:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,PECR Sprint 30,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-09-29 15:24:41.851,,,29/Sep/25 5:24 PM;63404a582eaaa5dcfa17a0e9;Reference: [https://paymentology.atlassian.net/browse/DEFECT-3930|https://paymentology.atlassian.net/browse/DEFECT-3930|smart-link] ,"30/Sep/25 7:02 PM;6205526c5d18ad00729a63a2;[~accountid:63404a582eaaa5dcfa17a0e9], there are two fixes for those problems:

* [+/release/1.242+|https://github.com/Paymentology/paycoredb/tree/release/1.242] (UAT)
** [https://github.com/Paymentology/paycoredb/commit/9872fc036ff119cd764839f54e3cc4902c1c223a|https://github.com/Paymentology/paycoredb/commit/9872fc036ff119cd764839f54e3cc4902c1c223a|smart-link] 
*** addresses the duplictions by allowing them since we can have partials that must be counted separetly for {{total_no_of_fully_settled_transactions}}



* [+release/1.229+|https://github.com/Paymentology/paycoredb/tree/release/1.229] (closed for production)
** [https://github.com/Paymentology/paycoredb/commit/fff0da610d7a0dbdb281b0a43092cef4e0ee779d|https://github.com/Paymentology/paycoredb/commit/fff0da610d7a0dbdb281b0a43092cef4e0ee779d|smart-link] 
*** addresses duplications in the managemnet report for column {{total_no_of_active_cards}}
*** addresses missing data in the consolidate report for the column {{total_no_of_active_accounts}}
** [https://github.com/Paymentology/paycoredb/commit/4e80477f6b2ab6bb2803a71cc8230d0885dafe6d|https://github.com/Paymentology/paycoredb/commit/4e80477f6b2ab6bb2803a71cc8230d0885dafe6d|smart-link] 
*** adjustments for {{total_no_of_fully_operation_cards}} by simpligying the query removing duplication



* the column {{total_no_of_active_paycontrol_users}} error must be caused by the difference in which the data was collected

Those are the five columns with errors, the PROD release was marked to last until September 26th, UAT for October 17th.",21/Oct/25 2:02 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - DEFECT-3930 has got status Done,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,29/Sep/25 5:23 PM
Disconnection from All clients using prod-switch.paymentology.org.,DEFECT-3961,173675,Defect,Backlog,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Major,,,,kevin.valle,61d72768326554006c1a590a,kevin.valle,61d72768326554006c1a590a,01/Sep/25 12:36 AM,01/Sep/25 12:57 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Hi team,

We had observed multiple Azure clients affectedd by socket disconnection between 21:14 PM UTC - 21:28 PM UTC on 31 Aug.

{noformat}2025-08-31 21:14:41.843 [iso-packet-reader] ERROR c.p.p.n.c.NetworkConnectionHandler - Socket Disconnected, cancelling echo and null timers.
Exception in thread ""iso-packet-reader"" java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.FutureTask@64db1b7d[Not completed, task = java.util.concurrent.Executors$RunnableAdapter@499e8f3e[Wrapped task = com.paymentology.payroute.network.connection.NetworkConnectionHandler$1$$Lambda/0x00007f4d506d2410@2bc8bc16]] rejected from java.util.concurrent.ThreadPoolExecutor@2e41e0c[Running, pool size = 100, active threads = 100, queued tasks = 0, completed tasks = 3082358]
	at java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2081)
	at java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:841)
	at java.base/java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1376)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:123)
	at com.paymentology.payroute.network.connection.NetworkConnectionHandler$1.onMessageReceived(NetworkConnectionHandler.java:93)
	at com.paymentology.payroute.logics.PaySocket.lambda$readBytes$0(PaySocket.java:297)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Exception in thread ""iso-packet-reader"" java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.FutureTask@64db1b7d[Not completed, task = java.util.concurrent.Executors$RunnableAdapter@499e8f3e[Wrapped task = com.paymentology.payroute.network.connection.NetworkConnectionHandler$1$$Lambda/0x00007f4d506d2410@2bc8bc16]] rejected from java.util.concurrent.ThreadPoolExecutor@2e41e0c[Running, pool size = 100, active threads = 100, queued tasks = 0, completed tasks = 3082358]
	at java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2081)
	at java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:841)
	at java.base/java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1376)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:123)
	at com.paymentology.payroute.network.connection.NetworkConnectionHandler$1.onMessageReceived(NetworkConnectionHandler.java:93)
	at com.paymentology.payroute.logics.PaySocket.lambda$readBytes$0(PaySocket.java:297)
	at java.base/java.lang.Thread.run(Thread.java:1583){noformat}



[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1756675775793589|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1756675775793589|smart-link] 


Sample of affected clients below along with Payroute IPs details.

*DC PayRoute*
Source IP: 10.155.100.249, 10.155.100.250
Dest: IP: [vpce-043627aca2990cd1d-ydl5lia1.vpce-svc-0fa93cb855ded941e.eu-central-1.vpce.amazonaws.com|http://vpce-043627aca2990cd1d-ydl5lia1.vpce-svc-0fa93cb855ded941e.eu-central-1.vpce.amazonaws.com]
Port: 20004, 21004



*MOX PayRoute*
Source IP: 10.22.2.30, 10.22.2.31
Dest IP: 216.119.220.147, 216.119.220.146
Port: 6303


*Mettle PayRoute*
Source IP: 10.23.2.13, 10.23.2.14
Dest IP: 216.119.220.135, 216.119.220.146
Port: 6026


*ISB PayRoute*
Source IP: 10.88.2.12, 10.88.2.13
Dest IP: 216.119.220.147, 216.119.220.146
Port: 6028

",,kevin.valle,,,,,,,,,,,61d72768326554006c1a590a,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@2fc84c2c,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,BAE [BL],MOX [BL],Shared Production [BL],,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,Can you please help to investigate why [+prod-switch.paymentology.org+|http://prod-switch.paymentology.org/] got disconnected from 21:14 to 21:28 UTC?,,,,,,,,,,,,,,,1|i05wow:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,49167870-fbd1-4337-b708-c191282fb937,PLT - Network Ops,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,01/Sep/25 12:36 AM
"[ADQ, Shared EU and other environments] Total blue screen on paycontrol when trying to access the additional information in DE48 ",DEFECT-3341,160833,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,High,Released,Bibek Ghale Pariyar,60efeafbf749c400680c06cb,Sari Salti,6317544c3310c2492b5b698a,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,22/May/25 1:33 PM,12/Sep/25 10:40 AM,,02/Jul/25 4:00 AM,BL-2.26.10,BL-2.27.1,BL-2.28.0,PC-4.137.4,PC-4.145.2,PC-4.151.3,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"[ADQ, Shared EU] Total blue screen on payment control when trying to access the additional information in DE48

After the upgrade of BL release 2.25.8, we are facing the issue as while trying to access DE48, blue screen appears on Paycontrol

*Client Affected:*  MOX, Shared02, Mettle, ADQ, Shared EU, Shared UAE, Tyme

!image-20250522-114617.png|width=1435,height=644,alt=""image-20250522-114617.png""!

!image-20250522-114319.png|width=1465,height=808,alt=""image-20250522-114319.png""!

!image-20250522-114327.png|width=3619,height=1814,alt=""image-20250522-114327.png""!

* Please see Zendesk Support tab for further comments and attachments.
",,Automation for Jira,Bibek Ghale Pariyar,Joseph Obilo,Zendesk Support for Jira,,,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,60efeafbf749c400680c06cb,712020:6ba10834-36f8-42e3-83b6-c18a34ca0297,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-1028,,,,,,,,,,,22/May/25 1:46 PM;63c1496004b5f5c7b5ede6a7;image-20250522-114319.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/113224,22/May/25 1:46 PM;63c1496004b5f5c7b5ede6a7;image-20250522-114327.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/113226,22/May/25 1:46 PM;63c1496004b5f5c7b5ede6a7;image-20250522-114617.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/113225,23/May/25 1:25 PM;ug:14f63285-246b-4c44-aa64-6053d24d5529;receivedTransactionTab.spec.cy.ts.mp4;https://paymentology.atlassian.net/rest/api/3/attachment/content/113341,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6ee0082d,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod/bae,prod/boj,prod/isb,prod/mox,prod/om,prod/shared,prod/shared02,uat/aws,uat/isb,uat/om,uat/shared,uat/tweeq,uatshared/paysimulator,,,,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=4}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":4,""lastUpdated"":""2025-05-23T14:38:23.000+0200"",""stateCount"":4,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitHub"":{""count"":4,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i04eo7:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,b37a5c4c-e514-433c-b05b-898c22cbbfff,PE - Core - Portals,"!receivedTransactionTab.spec.cy.ts.mp4|width=1280,height=720,alt=""receivedTransactionTab.spec.cy.ts.mp4""!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Defect [production],,,,2025-05-28 05:23:31.864,10315_*:*_1_*:*_0_*|*_10306_*:*_1_*:*_1345430_*|*_3_*:*_1_*:*_66864952_*|*_10000_*:*_1_*:*_1416817_*|*_10400_*:*_1_*:*_426527843,https://paymentology.productboard.com/entity-detail/features/10185c73-f273-4255-957b-5e02a090a5a7,28/May/25 7:23 AM;60efeafbf749c400680c06cb;Changing status to blocked due to awaiting for deployment.,06/Jun/25 11:36 AM;712020:6ba10834-36f8-42e3-83b6-c18a34ca0297;Hi [~accountid:60efeafbf749c400680c06cb] is this still on blocked? I see it is part of BL 2.28,"06/Jun/25 11:38 AM;60efeafbf749c400680c06cb;Hi [~accountid:712020:6ba10834-36f8-42e3-83b6-c18a34ca0297], it is in the blocked status until it got deployed in the environment mentioned.",19/Aug/25 4:13 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - CCM-1028 has got status Done,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,148515,PECP-528,BL Portals: Defects and Root Cause Fixes,Done,16/Jun/25 9:40 AM
BL  - METTLE | Issue with MCSettlementmatching job,DEFECT-3273,160144,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Highest,Released,Bimal Paudel,619a20dff2415000728442aa,Suganya.Eswaran,63c149612a526608c55073dd,Suganya.Eswaran,63c149612a526608c55073dd,15/May/25 8:22 AM,08/Jul/25 5:47 AM,,02/Jul/25 4:00 AM,BL-2.26.6,BL-2.27.1,PCDB-1.157.7,PCDB-1.169.4,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"Hello Team,

Scheme:MC 

Env: PROD

We have noticed the issue with MCSettlementMatching job after the upgrade BL 2.25 the job was statred but it does not macth the records .

The matching job is not matching any records and is being called every 200ms.

{noformat}ppayscheduler-1  | Mettle:M 2025-05-15 04:28:13.821 [Scheduler_Worker-7] INFO  SettlementMatchingRepository - 
Calling settlement matching function psrv_matching_v3_mettle payscheduler-1  | Mettle:M 2025-05-15 04:28:13.833
[Scheduler_Worker-7] INFO  SettlementMatchingRepository - select * from psrv_matching_v3_mettle(('99'::int4),
(NULL)) as result payscheduler-1  | Mettle:M 2025-05-15 04:28:13.833 [Scheduler_Worker-7] INFO  
SettlementMatchingRepository - Completed matching function call payscheduler-1  | Mettle:M 2025-05-15 04:28:13.833
[Scheduler_Worker-7] INFO  SettlementMatchingService - Remaining settlements to be matched  22301 payscheduler-1 
| Mettle:M 2025-05-15 04:28:13.833 [Scheduler_Worker-7] INFO  SettlementMatchingService - **** Calling matching 
finalize function ***** payscheduler-1  | Mettle:M 2025-05-15 04:28:13.836 [Scheduler_Worker-7] INFO 
SettlementMatchingRepository - select * from psrv_matching_finalize(('M')) as result{noformat}

!image-20250515-062304.png|width=1415,height=906,alt=""image-20250515-062304.png""!

*Function Name: psrv_matching_v3_mettle*",,Bimal Paudel,Joseph Obilo,Suganya.Eswaran,,,,,,,,,619a20dff2415000728442aa,712020:6ba10834-36f8-42e3-83b6-c18a34ca0297,63c149612a526608c55073dd,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-1003,,,,,,,,,,,,,,CLR-825,,,,15/May/25 10:58 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;beforeFixLogs.txt;https://paymentology.atlassian.net/rest/api/3/attachment/content/112497,15/May/25 8:23 AM;63c149612a526608c55073dd;image-20250515-062304.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/112484,15/May/25 10:58 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;image-20250515-084913.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/112499,15/May/25 10:58 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;image-20250515-085029.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/112498,15/May/25 11:13 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;psrv_matching_v3_mettle.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/112501,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6f47fb68,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod/bae,prod/boj,prod/isb,prod/mox,prod/om,prod/shared,prod/shared02,uat/aws,uat/isb,uat/om,uat/shared,,,,,,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=2}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":2,""lastUpdated"":""2025-05-20T10:26:33.000+0200"",""stateCount"":2,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitHub"":{""count"":2,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i04kjs:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,CLR Sprint 24,,,,,,,,,,,,,,,,,,,,,,,,,,,a8693810-01fb-4d1c-8714-51e4229f5c10,PE - Processing - Clearing,"*MCSettlementMatching* task execution logs before fixes, this has revealed a vulnerability in the application: _during this encounter task is running indefinitely and needs to stop the application to halt the matching process._
  

[^beforeFixLogs.txt]


Task execution logs after fixes:


!image-20250515-084913.png|width=1273,height=741,alt=""image-20250515-084913.png""!


Transactions available in the transaction screen of *Paycontrol*.

!image-20250515-085029.png|width=1799,height=533,alt=""image-20250515-085029.png""!

Cc. [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] [~accountid:60fedd46b704b400688a8e79] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-05-15 09:03:05.256,10306_*:*_1_*:*_3570950_*|*_3_*:*_1_*:*_6761980_*|*_10001_*:*_1_*:*_0_*|*_10400_*:*_1_*:*_429520966,,"15/May/25 11:03 AM;619a20dff2415000728442aa;Hello Team,
Due to incompatibility between this custom matching function {{psrv_matching_v3_mettle}} and matching finalize function this was encountered.
Fix has been implemented, pull-request to the master repo: [paycoredb-641|https://github.com/Paymentology/paycoredb/pull/641]","15/May/25 11:13 AM;619a20dff2415000728442aa;To resolve this issue, please follow the procedures mentioned as below:

# Update necessary parameter values for the finalization pending records in the {{t_set_staging_mc}}

{noformat}# Records to be updated count: 99

UPDATE t_set_staging_mc
SET network = 'M', mtid = '1240'
WHERE network IS NULL;
{noformat}
# Replace the custom matching function for *Mettle* with this updated version:
[^psrv_matching_v3_mettle.sql] 
# Enable and execute the *MCSettlementMatching* task.
# Verify the matched transactions and monitor.
","06/Jun/25 11:32 AM;712020:6ba10834-36f8-42e3-83b6-c18a34ca0297;Hi [~accountid:619a20dff2415000728442aa] this is part of BL 2.28, would you like to include it in the release notes? If so, please provide the Defect Condition and Defect Fix to be included in the release notes and indicate if this is an item for internal or client communication",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147662,CLR-714,Defects,Done,20/May/25 10:33 AM
"Aborted transactions, no reply from PKS - Investigate Cause",DEFECT-3062,156332,Defect,Backlog,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Normal,,,,Stephen Kerin,62c5616bb6357aecd7c70e56,Stephen Kerin,62c5616bb6357aecd7c70e56,08/Apr/25 2:25 PM,28/Jul/25 5:38 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"This is a direct close of [https://paymentology.atlassian.net/browse/DEFECT-2256|https://paymentology.atlassian.net/browse/DEFECT-2256|smart-link].  

We should *_never_* drop any 0120 under any circumstances.  In these case, PayRoute has to forward the transaction on to PayPower so that it can generate a valid 0130 response.  

We are seeing ~7k of these advices per week across multiple envs


|Environment|BIN|7 day volume|
|ADQ|549211|679|
|BAE|402482|7|
|BAE|425697|5|
|BOJ|534968|992|
|ISB|516739|781|
|ISB|531594|328|
|ISB|537228|5|
|Mettle|559806|1000|
|Shared02|537257|511|
|Shared02|531743|809|
|Shared02|537236|392|
|SharedEU|516856|1021|
|SharedEU|537213|104|
|TWEEQ|541672|548|
|Total| |7182|

----

Original ticket:


We have a lot of ""Aborting a transaction because no reply received from PayKeyService"" and ""Default PayKeyService not found. Could not perform crypto action"" is this normal?

[https://app.datadoghq.eu/logs?query=env%3A""prod%2Fshared02"" AND %40level%3AERROR ""Aborting a transaction because no reply received from PayKeyService""&agg_m=count&agg_m_source=base&agg_t=count&cols=host%2Cservice&fromUser=true&messageDisplay=inline&refresh_mode=sliding&storage=hot&stream_sort=desc&viz=stream&from_ts=1731843392885&to_ts=1731929792885&live=true|https://app.datadoghq.eu/logs?query=env%3A%22prod%2Fshared02%22%20AND%20%40level%3AERROR%20%22Aborting%20a%20transaction%20because%20no%20reply%20received%20from%20PayKeyService%22&agg_m=count&agg_m_source=base&agg_t=count&cols=host%2Cservice&fromUser=true&messageDisplay=inline&refresh_mode=sliding&storage=hot&stream_sort=desc&viz=stream&from_ts=1731843392885&to_ts=1731929792885&live=true]",,Automation for Jira,Stephen Kerin,,,,,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,62c5616bb6357aecd7c70e56,,,,,,,,,,,,,,,,,,,,,,,,,,DEFECT-2256,,,,,,,,,,,,DEFECT-3732,,,,,,,,,,,08/Apr/25 2:25 PM;62c5616bb6357aecd7c70e56;image-20241119-131247.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/109675,08/Apr/25 2:25 PM;62c5616bb6357aecd7c70e56;image-20241119-131649.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/109678,08/Apr/25 2:25 PM;62c5616bb6357aecd7c70e56;image-20241119-132511.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/109676,08/Apr/25 2:25 PM;62c5616bb6357aecd7c70e56;image-20241119-132534.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/109677,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@4768ed16,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i046lw:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,22fa3a9e-c220-4fe3-a1c8-8f9453bc8c3d,PE - Processing - Integrations (PayRoute),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-07-28 03:38:24.977,,,"08/Apr/25 2:39 PM;62c5616bb6357aecd7c70e56;[https://paymentology.atlassian.net/browse/INT-325|https://paymentology.atlassian.net/browse/INT-325|smart-link] can’t be worked on before this fix is made, otherwise we will generate 6k false flags per week",28/Jul/25 5:38 AM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - DEFECT-3732 has got status Done,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,148404,INT-283,Defect fixes and improvements - Q1 2026,To Do,08/Apr/25 2:25 PM
Mettle: QMR report failed,DEFECT-1914,137589,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Normal,Done,Nour-Eddine Alouane,6317c8ef62fe1e6eac6da703,Rajesh.Subramanian,63c1496004b5f5c7b5ede6a7,Rajesh.Subramanian,63c1496004b5f5c7b5ede6a7,02/Oct/24 12:49 PM,12/May/25 12:58 PM,,20/Nov/24 7:34 PM,BL-2.18.1,BL-2.19.0,PCDB-1.43.9,PCDB-1.47.3,,,,,,,,,,,,,,,,,,,0,,,,,"Mettle: QMR report



2024-10-02 10:01:42.175 [Scheduler_Worker-11] ERROR  JobReport - Error while executing Job GenerateQMReport java.lang.NullPointerException 	at com.paymentology.payscheduler.modules.reporting.services.GenerateQMRService.buildTransactionsMetrics(GenerateQMRService.java:335) 	at com.paymentology.payscheduler.modules.reporting.services.GenerateQMRService.process(GenerateQMRService.java:142) 	at com.paymentology.payscheduler.schedulerjobs.JobReport.execute(JobReport.java:104) 	at org.quartz.core.JobRunShell.run(JobRunShell.java:202) 	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)",,Automation for Jira,Nour-Eddine Alouane,Rajesh.Subramanian,,,,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,6317c8ef62fe1e6eac6da703,63c1496004b5f5c7b5ede6a7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ESQA-2216,,,,,,,,,,,15/Oct/24 11:43 AM;6317c8ef62fe1e6eac6da703;METTLE_QMR_Q3_20241001_BPD.xlsx;https://paymentology.atlassian.net/rest/api/3/attachment/content/96142,15/Oct/24 11:43 AM;6317c8ef62fe1e6eac6da703;METTLE_QMR_Q3_20241001_MDS.xlsx;https://paymentology.atlassian.net/rest/api/3/attachment/content/96141,02/Oct/24 12:49 PM;63c1496004b5f5c7b5ede6a7;extract-2024-10-02T10_46_24.752Z.csv;https://paymentology.atlassian.net/rest/api/3/attachment/content/95229,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@21e63c9e,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=2}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":2,""lastUpdated"":""2024-10-09T18:44:04.000+0200"",""stateCount"":2,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitHub"":{""count"":2,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzssyg:di,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,PECR Sprint 14,PECR Sprint 15,PECR Sprint 16,,,,,,,,,,,,,3.0,,,,,,,,,,,,808d7b01-3256-45cc-8ff1-6cc435430b86,PE - Core - Reporting,"Reports were generated successfully from PS in local env 

[^METTLE_QMR_Q3_20241001_MDS.xlsx]
[^METTLE_QMR_Q3_20241001_BPD.xlsx]

",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-10-03 17:29:09.7,10306_*:*_1_*:*_98676604_*|*_3_*:*_1_*:*_1020422483_*|*_10001_*:*_1_*:*_0_*|*_10345_*:*_1_*:*_3138763334,,"03/Oct/24 7:29 PM;6317c8ef62fe1e6eac6da703;Both Mettle QMR reports were manually generated and sent to the team

The error described in the ticket was due to a MC program that had no transaction following QMR business rules during the quarter, this scenario was not expected in the QMR implementation of payscheduler, a fix has been created",12/Nov/24 4:12 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - ESQA-2216 has got status Done,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147587,PECR-505,BL - Reporting : Defects & Root Cause Fixes (BAU) - P1/P2/P3/P4,Done,20/Nov/24 7:34 PM
AVS Check Not Including MDES transactions,DEFECT-1384,131201,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,High,Done,Febby Oktaviani,629a26eba0eafd0069ea2343,michael.ellery,6273fc10807e0000691d5dee,michael.ellery,6273fc10807e0000691d5dee,12/Jul/24 10:59 AM,06/May/25 5:48 PM,,20/Sep/24 12:14 PM,BL-2.14.1,BL-2.15.0,PCDB-1.32.7,PCDB-1.33.0,,,,,,,,,,,,,,,,,,,0,,,,,"The fix put in for [[DEFECT-395] Merchant saying AVS check result not being sent [Mettle] - JIRA (atlassian.net)|https://paymentology.atlassian.net/browse/DEFECT-395] does not include transactions that are MDES transactions and according to Mastercard documentation it should do, please add this functionality to the existing fix",,Automation for Jira,Elisha Tavagadza,Febby Oktaviani,Lucy Simpson,michael.ellery,Savio,Shehroz Ahmed Siddiqui,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,712020:64580c54-e845-4cad-8527-822d7a6e6fee,629a26eba0eafd0069ea2343,5f623946b9fcc1007734b378,6273fc10807e0000691d5dee,60fedd388ad5b600707750e1,632872d207a27ebeff12903b,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ESQA-1386,,,,,,,,,,,24/Jul/24 12:53 PM;712020:64580c54-e845-4cad-8527-822d7a6e6fee;DEFECT-1384-AVS Check Not Including MDES transactions.docx;https://paymentology.atlassian.net/rest/api/3/attachment/content/89371,15/Jul/24 7:00 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;DEFECT-1384-AVS-MDES-handleauth-output.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88498,15/Jul/24 7:00 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;DEFECT-1384-AVS-MDES-outputToken.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88499,15/Jul/24 7:00 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;DEFECT-1384-AVS-MDES-received.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88497,15/Jul/24 7:00 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;DEFECT-1384-AVS-MDES-response.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88500,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@45edebb1,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2024-08-20T09:43:14.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":5,""name"":""GitLab""},""GitHub"":{""count"":4,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i00qql:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,Sprint 9,Sprint 10,Sprint 11,Sprint 12,Sprint 13,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,"h1. Local Test Evidence

h3. Received AVS Request in MDES transaction with product setting and card token flag to allow avs fail as avs supported enabled.

* token flag: allow avs check fail is turned on
* product settings {{allow_avs_fail_as_avs_supported}} is TRUE

!DEFECT-1384-AVS-MDES-received.png|width=58.333333333333336%,alt=""DEFECT-1384-AVS-MDES-received.png""!

h3. Transaction is approved and DE48_83 is set to actual AVS result (OutputToken)

!DEFECT-1384-AVS-MDES-outputToken.png|width=58.333333333333336%,alt=""DEFECT-1384-AVS-MDES-outputToken.png""!

h3. Transaction is approved and DE48_82and DE48_83 is included in the DE48 output from handleAuth

!DEFECT-1384-AVS-MDES-handleauth-output.png|width=58.333333333333336%,alt=""DEFECT-1384-AVS-MDES-handleauth-output.png""!

h2. AVS result is sent in the response to scheme

!DEFECT-1384-AVS-MDES-response.png|width=58.333333333333336%,alt=""DEFECT-1384-AVS-MDES-response.png""!



h3. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-07-12 10:09:10.087,10205_*:*_1_*:*_781072652_*|*_10306_*:*_1_*:*_7464785_*|*_3_*:*_1_*:*_238406764_*|*_10001_*:*_1_*:*_0_*|*_10400_*:*_1_*:*_16932419_*|*_10345_*:*_1_*:*_5008677945,,"12/Jul/24 12:09 PM;629a26eba0eafd0069ea2343;[~accountid:6273fc10807e0000691d5dee] based on this MC doc, MC won’t be forward DE48_82 and DE48_83 to Acquirer. Then this need to be tested by QA with MC simulator to make sure that this change won’t break any certification.
cc:  [~accountid:632872d207a27ebeff12903b] [~accountid:6373d8b28fd2d2d5f12c213c] ","12/Jul/24 12:36 PM;632872d207a27ebeff12903b;[~accountid:60fedd0cc51f3a00697da234] [~accountid:5f9ff6b28c4efd006f32febe] this might effect certifications if not tested right.
Tagging for better visibility ","12/Jul/24 1:22 PM;629a26eba0eafd0069ea2343;[~accountid:6273fc10807e0000691d5dee] [~accountid:60fedd388ad5b600707750e1] should this fixed be patched as HF or through regular BL version upgrade?
","12/Jul/24 1:23 PM;60fedd388ad5b600707750e1;[~accountid:629a26eba0eafd0069ea2343] I would want this to be QA and then UAT by Mettle, the hotfixes are not helping much. 

[~accountid:6273fc10807e0000691d5dee] Your Inputs.",12/Jul/24 3:19 PM;6273fc10807e0000691d5dee;I agree [~accountid:60fedd388ad5b600707750e1] [~accountid:629a26eba0eafd0069ea2343] - Mettle usually avoid hot fixes,"12/Jul/24 3:19 PM;629a26eba0eafd0069ea2343;Noted [~accountid:60fedd388ad5b600707750e1] [~accountid:6273fc10807e0000691d5dee], I will provide the patch to QA1 on Monday. ",15/Jul/24 7:41 AM;629a26eba0eafd0069ea2343;Avaliable in QA1 with tag [1.32.7|https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/commits/1.32.7?ref_type=tags].,24/Jul/24 12:52 PM;712020:64580c54-e845-4cad-8527-822d7a6e6fee;Hi [~accountid:629a26eba0eafd0069ea2343] Testing completed. please find attached test results. you can please move project to next stage.,"24/Jul/24 12:59 PM;629a26eba0eafd0069ea2343;[~accountid:6273fc10807e0000691d5dee], QA has tested this in QA1 so move this to Awaiting Deployment. ",24/Jul/24 3:35 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - ESQA-1386 has got status Done,"31/Jul/24 6:06 AM;5f623946b9fcc1007734b378;Hi [~accountid:629a26eba0eafd0069ea2343] 
I’m doing the release notes (sent to clients) for BL2.15 which this one will be apart of.
Can you please advise if the AVS check result code will also be sent to FAST requests or FAST advisements to clients?","31/Jul/24 7:06 AM;629a26eba0eafd0069ea2343;Hi [~accountid:5f623946b9fcc1007734b378] 
In FAST message we send the iso msg received from scheme which in 0100 msg this won’t be present in DE48 from scheme, but we send the AVS check result in the response to scheme.",20/Sep/24 12:15 PM;629a26eba0eafd0069ea2343;Marked as done as Mettle already in BL 2.15.x,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147455,AUTH-1096,BAU Bug Fixes - PayPower,Done,20/Sep/24 12:14 PM
Mettle: Preauth txns from different merchant are mapped to the same TID,DEFECT-1319,130450,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Normal,Done,Prabin Shrestha,6195bb56ef18ca0071c7a9de,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,02/Jul/24 3:07 PM,21/Apr/25 7:24 PM,,26/Mar/25 8:28 AM,BL-2.23.0,BL-2.25.0,PP-3.143.0,PP-3.179.1,PTDB-1.111.2,PTDB-1.96.0,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,,,"*Issue Description:*

Mettle client reported lots of different txn are mapped to the same Txn id 2479608054979466007 

Platform: Banking.Live

Environment: PROD - Mettle

Runbooks used: 

[https://paymentology.atlassian.net/wiki/spaces/TS/pages/7465173005/Banking.Live+Is+Pre-auth+Incremental+transaction|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7465173005/Banking.Live+Is+Pre-auth+Incremental+transaction|smart-link] 



*Troubleshooting Steps Followed* 

TID 2479608054979466007 

we have same DE48_63(Trace ID) for all transaction and later assigned same TID during transaction, though the txns are coming from different merchant.

!image-20240704-084717.png|width=720,height=248,alt=""image-20240704-084717.png""!



We have also sent attached mail to MasterCard asking why the same Trace ID is sent for all txns, but they have advised to contact acquirer as this is how they received from Acquirer . Attached the mail communication for the same.

Also, First txn was received on 16-10-2023 and the subsequent linked txns received from 8th May 2024 onwards. 



*Expected result:* 

Can you check and advise on the next steps for this.

De42 is different in these cases. While checking Pre-Auth incremental txns, along with TraceID can we also include DE42 element in the checks before assigning the same Txn id.?

Also, Initial txn was received on 16-10-2023 and the subsequent linked txns received from 8th May 2024 onwards. Can we put a threshold like 1 month duration between initial txns and the subsequent txns for mapping the pre-Auth incremental txns?



h2. Configuration

Product Flag {{enable_asi_constraints_for_tid}}",,Automation for Jira,Florin Vistig,Lucy Simpson,Prabin Shrestha,Raajaganapathy K,Shehroz Ahmed Siddiqui,Shoaib Iqbal,William Dunne,Zendesk Support for Jira,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,5a9e4751a00c7f2a80155fda,5f623946b9fcc1007734b378,6195bb56ef18ca0071c7a9de,61f80301f51e85007087ad38,632872d207a27ebeff12903b,6297155ee76a9c00705e2b50,557058:5363d7a1-da13-4012-8609-f44e54c1d062,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ESRM-905,,,,,,,,,,,02/Jul/24 3:07 PM;63c1496004b5f5c7b5ede6a7;RE_ Clarification needed on DE 48_ subfield 63 (Trace ID)    Case # 04840530.msg;https://paymentology.atlassian.net/rest/api/3/attachment/content/87631,04/Jul/24 11:14 AM;63c1496004b5f5c7b5ede6a7;image-20240704-084717.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/87774,08/Jul/24 7:34 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20240708-053259.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/87933,06/Nov/24 12:36 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20241106-103412.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/97953,06/Nov/24 12:36 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20241106-103516.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/97954,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115316.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104888,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115452.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104894,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115500.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104892,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115552.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104893,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115606.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104899,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115631.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104889,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115637.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104896,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115728.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104890,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115735.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104895,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115742.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104897,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115825.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104898,04/Feb/25 1:58 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250204-115831.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104891,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-063852.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105523,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-063923.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105521,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-063958.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105520,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-064038.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105527,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-064111.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105525,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-064218.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105516,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-064417.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105519,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-064503.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105529,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-064850.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105528,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-064915.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105517,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-064932.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105524,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-064948.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105518,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-065002.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105522,13/Feb/25 8:51 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250213-065107.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/105526,06/Mar/25 12:24 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250306-064344.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/107165,06/Mar/25 12:24 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250306-064849.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/107164,06/Mar/25 1:25 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250306-111910.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/107172,06/Mar/25 1:25 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250306-112232.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/107174,06/Mar/25 1:25 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250306-112513.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/107173,10/Mar/25 8:59 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250310-065905.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/107376,11/Mar/25 12:34 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250311-100030.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/107542,11/Mar/25 12:34 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250311-100550.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/107543,11/Mar/25 12:34 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20250311-101215.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/107544,,,,,,,,,,,PE - Processing  - Authorisations,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@27e6bcd6,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=4}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":4,""lastUpdated"":""2025-03-19T09:55:18.000+0200"",""stateCount"":4,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitHub"":{""count"":4,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzn8a5:zzzzi,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,Sprint 9,Sprint 10,Sprint 11,Sprint 12,Sprint 13,Sprint 14,Sprint 15,Sprint 16,Sprint 17,Sprint 18,Sprint 19,Sprint 20,Sprint 21,Sprint 22,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,"IT test = [https://github.com/Paymentology/paypower/pull/283|https://github.com/Paymentology/paypower/pull/283|smart-link] 

* ASI Followed by Authorization
** Process an ASI, then an authorization that links back to the ASI.
** Expected result: The authorization gets a unique TID, different from the TID of the ASI.
* *Test*
** ASI
** !image-20250204-115316.png|width=1598,height=653,alt=""image-20250204-115316.png""!
** Authorization
** !image-20250204-115500.png|width=1592,height=728,alt=""image-20250204-115500.png""!
** !image-20250204-115452.png|width=1591,height=274,alt=""image-20250204-115452.png""!

* ASI Followed by Multiple Authorizations
** Process an ASI, then multiple authorizations that all link back to the same ASI.
** Expected result: Each authorization generates a unique TID distinct from the ASI and from one another.
* *Test*
** Another Authorization
** !image-20250204-115552.png|width=1603,height=700,alt=""image-20250204-115552.png""!
** !image-20250204-115606.png|width=1581,height=314,alt=""image-20250204-115606.png""!

* ASI Followed by Reversal (Post-Authorization)
** Process an ASI, followed by an authorization, and then a reversal that links back to the authorization.
** Expected result: The reversal uses the authorization’s TID, while the ASI and authorization have separate, unique TIDs.
* *Test*
** Reversal for 3rd authorization
** !image-20250204-115637.png|width=1608,height=664,alt=""image-20250204-115637.png""!
** !image-20250204-115631.png|width=1604,height=303,alt=""image-20250204-115631.png""!

* ASI Followed by Decline Advice (Post-Authorization)
** Process an ASI, an authorization, and then a decline advice for the authorization.
** Expected result: The decline advice uses the authorization’s unique TID; no TID sharing occurs between the ASI and authorization.
* *Test*
** Authorization
** !image-20250204-115728.png|width=1607,height=355,alt=""image-20250204-115728.png""!
** Decline Advisement for 4th authorization
** !image-20250204-115735.png|width=1627,height=265,alt=""image-20250204-115735.png""!
** !image-20250204-115742.png|width=1574,height=365,alt=""image-20250204-115742.png""!

* ASI Followed by Decline Advice for ASI (Post-Authorization)
** Process an ASI, and then a decline advice for the ASI.
** Expected result: The decline advice uses the ASI’s unique TID; no new TID generated
* *Test*
** Advisement for ASI
** !image-20250204-115825.png|width=1585,height=696,alt=""image-20250204-115825.png""!
** !image-20250204-115831.png|width=1613,height=359,alt=""image-20250204-115831.png""!
* Full Lifecycle: ASI to Auth to Settlement 
** Process an ASI, then an authorization, and a settlement.
** Expected result: ASI and authorisation have their own TIDs, but settlement correctly links to the authorization’s TID.

ASI 2965234011319000016

!image-20250213-063852.png|width=2167,height=921,alt=""image-20250213-063852.png""!

!image-20250213-063923.png|width=2038,height=557,alt=""image-20250213-063923.png""!

Pre-Auth linking to ASI 2965236549901000019

!image-20250213-064038.png|width=2176,height=1009,alt=""image-20250213-064038.png""!

!image-20250213-063958.png|width=2085,height=597,alt=""image-20250213-063958.png""!

Settlement of Auth

!image-20250213-064111.png|width=2179,height=281,alt=""image-20250213-064111.png""!

Table

t_core

!image-20250213-064218.png|width=1915,height=534,alt=""image-20250213-064218.png""!

t_auth

!image-20250213-064417.png|width=1901,height=579,alt=""image-20250213-064417.png""!

t_set (match (1a) on tok+de38)

!image-20250213-064503.png|width=1831,height=429,alt=""image-20250213-064503.png""!

----

* *AFD case* (prod: 2846657165909092182 and 2876367925909235366)

Prod

!image-20250213-064850.png|width=1697,height=687,alt=""image-20250213-064850.png""!

*No change when the flag is enabled, as the original transaction is not ASI.* Testing with the same PayTok call.

Test

!image-20250213-064915.png|width=1910,height=544,alt=""image-20250213-064915.png""!

!image-20250213-064932.png|width=1899,height=663,alt=""image-20250213-064932.png""!

!image-20250213-064948.png|width=1911,height=615,alt=""image-20250213-064948.png""!

!image-20250213-065002.png|width=1897,height=576,alt=""image-20250213-065002.png""!

!image-20250213-065107.png|width=1875,height=345,alt=""image-20250213-065107.png""!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Defect [production],,,,2024-07-02 13:36:55.58,10306_*:*_1_*:*_264919815_*|*_3_*:*_1_*:*_532637301_*|*_10000_*:*_1_*:*_17945253993_*|*_10400_*:*_1_*:*_7591986_*|*_10345_*:*_1_*:*_0,,02/Jul/24 3:36 PM;5a9e4751a00c7f2a80155fda;[~accountid:61f80301f51e85007087ad38] what is requested from Authorisations team in this ticket?,"08/Jul/24 7:34 AM;6195bb56ef18ca0071c7a9de;Hi [~accountid:63c1496004b5f5c7b5ede6a7] Did you get any feedback from the acquirer? For the above transactions, we are getting the same DE48SE63, and we used that field to link and assign the TID.

!image-20240708-053259.png|width=1247,height=905,alt=""image-20240708-053259.png""!

cc [~accountid:61f80301f51e85007087ad38] ","09/Jul/24 11:56 AM;6195bb56ef18ca0071c7a9de;[~accountid:63c1496004b5f5c7b5ede6a7] assigning this ticket to you as you are investigating this issue with Mastercard and Acquirer.

There is nothing to say about the above case from the authorization team because we are receiving the same trace ID for all transactions, and the current logic will assign the same TID if the trace ID matches. and we don’t check DE42 during TID linking.

If DE42 needed to be checked during assigning TID, this is a new requirement and can affect other clients. So, I suggest bringing this new requirement from the product rather than a defect ticket.

Thanks

cc [~accountid:61f80301f51e85007087ad38] [~accountid:623ddb7a866b810069e527bc] [~accountid:5a9e4751a00c7f2a80155fda] ","24/Oct/24 9:41 AM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;To highlight as a potential concern, with SCA there are usecases where we would anticipate the merchant submitting payments on multiple acquirers and potentially different merchant descriptions that share a trace ID

What merchant is this [~accountid:6195bb56ef18ca0071c7a9de] ? If it’s Paypal or some similar service (perhaps Stripe) there might be a perfectly valid reason to share the Trace ID ","06/Nov/24 12:36 PM;6195bb56ef18ca0071c7a9de;[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] Yes, there are few PayPal merchant. I think all of them are done through Curve wallet (CRV*)

!image-20241106-103412.png|width=895,height=420,alt=""image-20241106-103412.png""!



!image-20241106-103516.png|width=1207,height=414,alt=""image-20241106-103516.png""!",06/Nov/24 1:35 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:632872d207a27ebeff12903b] thoughts on this? No idea how on earth we should handle this use case,"07/Nov/24 11:42 AM;632872d207a27ebeff12903b;we can look for the solution to restrict it on the basis of merchant id but its a hard   pushed solution , not an ideal one","21/Jan/25 12:23 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] [~accountid:5a9e4751a00c7f2a80155fda] [~accountid:63c1496004b5f5c7b5ede6a7] 

As an initial partial solution, what we should do is:

* Change the _default_ behaviour of get_transaction_idv2 to generate a new TID when the trace ID links back to an ASI (defined as 61_7 = 8 )
* Insert for _all_ existing clients (including Mettle) configuration to use the current behaviour
* Contact me when it’s on UAT, and Mettle will perform additional testing
* We can then get rid of that configuration to enable the (new) default behaviour for Mettle

This needs to be tested with the following test cases:

*AFD cases based upon Mettle provided TIDs*

2846657165909092182 and 2876367925909235366

*ASI Followed by Authorization*

* Process an ASI, then an authorization that links back to the ASI.
* Expected result: The authorization gets a unique TID, different from the TID of the ASI.

*ASI Followed by Multiple Authorizations*

* Process an ASI, then multiple authorizations that all link back to the same ASI.
* Expected result: Each authorization generates a unique TID distinct from the ASI and from one another.

*ASI Followed by Reversal (Post-Authorization)*

* Process an ASI, followed by an authorization, and then a reversal that links back to the authorization.
* Expected result: The reversal uses the authorization’s TID, while the ASI and authorization have separate, unique TIDs.

*ASI Followed by Decline Advice (Post-Authorization)*

* Process an ASI, an authorization, and then a decline advice for the authorization.
* Expected result: The decline advice uses the authorization’s unique TID; no TID sharing occurs between the ASI and authorization.

*ASI Followed by Decline Advice for ASI (Post-Authorization)*

* Process an ASI, and then a decline advice for the ASI.
* Expected result: The decline advice uses the ASI’s unique TID; no new TID generated

*Full Lifecycle: ASI to Auth to Settlement*

* Process an ASI, then an authorization, and a settlement.
* Expected result: ASI and authorisation have their own TIDs, but settlement correctly links to the authorization’s TID.","21/Jan/25 12:33 PM;6195bb56ef18ca0071c7a9de;[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] If trace ID is not linked to ASI, the existing behavior should remain unchanged, correct? And this should apply to all transaction types, like increment, recurring, refund, etc i.e. if a trace ID exists and is linked to ASI, the new logic should be implemented.","21/Jan/25 1:01 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] that’s right, if an auth links to another auth (but neither is an ASI) behaviour should remain the same. Basically, we want to always consider ASIs separate payments","21/Jan/25 1:02 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;There should be no increments - the only exceptions I could think of are:



* decline advice for an ASI - should share TID
* 0 value reversal for ASI (if such a thing exists?) that should also share the TID

(See test cases) ",21/Jan/25 1:03 PM;6195bb56ef18ca0071c7a9de;Understood. How urgent is this requirement?,21/Jan/25 1:20 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] ideally it would be started this sprint,21/Jan/25 1:21 PM;6195bb56ef18ca0071c7a9de;Okay. I'll start working on this ticket once the current in progress is completed.,"04/Feb/25 1:44 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] thanks I see you’ve made progress on this.

Mettle has requested that we share the testing results/logs on the below:

Any questions please let us know. We'd also like definitive confirmation that these, along with the AFD ones, will all be accommodated by Paymentology.

*ASI Followed by Authorization*
Process an ASI, then an authorization and a settlement that link back to the ASI.
Expected result: The authorization gets a unique TID, different from the TID of the ASI, and settlement correctly links to the authorization’s TID.

*ASI Followed by Multiple Authorizations*
Process an ASI, then multiple authorizations that all link back to the same ASI and a respective settlements for the subsequent authorizations
Expected result: authorizations and settlements have a common unique TID distinct from the ASI; all authorizations and settlements correctly matched

*ASI Followed by Authorization and multiple settlements*
Process an ASI, then an authorization that links back to the ASI, and a few settlements clearing the auth (i.e. split shipment clearing).
Expected result: The authorization and settlements get a unique TID, different from the TID of the ASI; all settlements correctly matched to the TID for the associated authorization

*ASI Followed by Reversal (Post-Authorization)*
Process an ASI, followed by an authorization, and then a reversal that links back to the authorization.
Expected result: The reversal uses the authorization’s TID, while the ASI and authorization have separate, unique TIDs.

*ASI Followed by Decline Advice (Post-Authorization)*
Process an ASI, an authorization, and then a decline advice for the authorization.
Expected result: The decline advice uses the authorization’s unique TID; no TID sharing occurs between the ASI and authorization.

*ASI Followed by Decline Advice for ASI (Post-Authorization)*
Process an ASI, and then a decline advice for the ASI.
Expected result: The decline advice uses the ASI’s unique TID; no new TID generated

*ASI Followed by Reversal Advice and Auth Advise for ASI (Post-Authorization)*
On _Prd_ we discovered quite common pattern of payments with ASI auth, so we'd like to emulate it in advance. Example of tids: 2584510518505844741, 2641617231590523856, 2875499274470428259","04/Feb/25 2:02 PM;6195bb56ef18ca0071c7a9de;[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] Local test was performed using the same PayTok query call from production and [IT test|https://github.com/Paymentology/paypower/pull/283] created in PayPower for these changes. Are the function execution screenshots sufficient for testing results, or do we need to provide them TID sample once deployed to UAT?","12/Feb/25 8:28 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] thank you, some of those screenshots are sufficient, but Mettle is quite a stickler for the testing… they specifically asked about settlements so I don’t think they’ll be satisfied to see it’s out of scope",12/Feb/25 9:15 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Also I don’t see any cases built on the basis of the AFD use cases they shared [~accountid:6195bb56ef18ca0071c7a9de] ,"13/Feb/25 8:55 AM;6195bb56ef18ca0071c7a9de;[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] Test Updated. 

Please note that during settlement execution via card test, it is not using the same DE38 received in the Auth response. So, I’ve to manually update DE38 and execute settlement while testing above result. I will report this to the tooling team.","13/Feb/25 9:35 AM;6195bb56ef18ca0071c7a9de;Ticket raised to the tooling team. This needs to be fixed during UAT testing if the client wants to test it there.

[https://paymentology.atlassian.net/browse/EST-1057|https://paymentology.atlassian.net/browse/EST-1057|smart-link] 

cc [~accountid:5a9e4751a00c7f2a80155fda] [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] ","14/Feb/25 12:08 AM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] we could also show testing logs from QA, doesn’t necessarily need to be on UAT or with Mettle’s product (although any relevant config around TID generation should be replicated)","24/Feb/25 12:47 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] I see there’s one test now which also includes the clearing screenshot - it was quite a long list of test cases they want, do we have any more? ","24/Feb/25 1:02 PM;6195bb56ef18ca0071c7a9de;Once it’s available to UAT, I’m planning to provide more through card test.",26/Feb/25 10:40 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Mettle has requested we test on their product on UAT so they can see the testing results on PayControl ,"27/Feb/25 8:27 AM;6195bb56ef18ca0071c7a9de;Okay, noted.","04/Mar/25 2:35 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] I believe their environment has now been updated in UAT, please can we get all of those tests performed on their product?","04/Mar/25 3:19 PM;6195bb56ef18ca0071c7a9de;Yes, I think BL 2.23 on SH UAT now. Let me test it tomorrow and drop transaction id (with their product) sample here.","05/Mar/25 8:16 AM;6195bb56ef18ca0071c7a9de;Hi [~accountid:611a52967b538a006964a439] [~accountid:60fedd388ad5b600707750e1] Need your help. Could you enable this product setting for Mettle, SH UAT?

{{enable_asi_constraints_for_tid}}

[https://paymentology.atlassian.net/wiki/spaces/TS/pages/7517274378/BL+PayPower+Settings+through+Product+ID+or+Client+ID|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7517274378/BL+PayPower+Settings+through+Product+ID+or+Client+ID|smart-link] ",05/Mar/25 9:24 AM;6195bb56ef18ca0071c7a9de;ESRM created [https://paymentology.atlassian.net/browse/ESRM-905|https://paymentology.atlassian.net/browse/ESRM-905|smart-link] ,06/Mar/25 8:23 AM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - ESRM-905 has got status Done,"06/Mar/25 12:24 PM;6195bb56ef18ca0071c7a9de;Post deployment verification - UAT - Mettle 

Token used = 639995923

{color:#ff991f}*Before*{color}

TID = {{2985223261319000078}}

{color:#ff991f}*After*{color}

{color:#4c9aff}*ASI Followed by Authorization*{color}

ASI = {{2986234461319000167}} (DE63 + DE15 = MDUHNSW7B + 0311)

Pre-Auth linking to ASI through trace id = {{2986234999901000168}} (DE48_63 = MDUHNSW7B0311)

{color:#4c9aff}*ASI Followed by Multiple Authorizations*{color}

ASI = {{2986234461319000167}} (DE63 + DE15 = MDUHNSW7B + 0311)

Pre-Auth linking to ASI through trace id = {{2986234999901000168}} (DE48_63 = MDUHNSW7B0311)

Another Pre-Auth = {{2986238129901000169}} (DE48_63 = MDUHNSW7B0311)

{color:#4c9aff}*ASI Followed by Authorization and multiple settlements*{color}

ASI = {{2986234461319000167}} (DE63 + DE15 = MDUHNSW7B + 0311)

Pre-Auth linking to ASI through trace id = {{2986234999901000168}} (DE48_63 = MDUHNSW7B0311)

Another Pre-Auth = {{2986238129901000169}} (DE48_63 = MDUHNSW7B0311)

!image-20250306-064344.png|width=1641,height=519,alt=""image-20250306-064344.png""!

{color:#4c9aff}*ASI Followed by Reversal (Post-Authorization)*{color}

ASI = {{2986244221319000170}} (DE63 + DE15 = MDUHNSW8T + 0311)

Pre-Auth linking to ASI through trace id = {{2986244639901000171}} (DE48_63 = MDUHNSW8T0311)

Reversal for pre-auth = {{2986244639901000171}}

!image-20250306-064849.png|width=1632,height=370,alt=""image-20250306-064849.png""!

{color:#4c9aff}*ASI Followed by Decline Advice (Post-Authorization)*{color}

ASI = {{2986262521319000176}} (DE63 + DE15 = MDUHNTW7T + 0311)

Pre-Auth linking to ASI through trace id = {{2986263109901000177}} (DE48_63 = MDUHNTW7T0311, DE63 + DE15 = MCC930579 + 1202)

Decline Advisement = {{2986263109901000177}}

{color:#4c9aff}*ASI Followed by Decline Advice for ASI (Post-Authorization)*{color}

ASI = {{2986371321319000207}}

Decline Advisement for ASI = {{2986371321319000207}}

{color:#4c9aff}*ASI Followed by Reversal Advice and Auth Advise for ASI (Post-Authorization)*{color}

ASI = {{2986373951319000208}}

Decline Advisement = {{2986373951319000208}}

Reversal advisement = {{2986373951319000208}}

cc [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] ","06/Mar/25 12:30 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] thank you - which ones are 

*AFD cases based upon Mettle provided TIDs*

2846657165909092182 and 2876367925909235366","06/Mar/25 12:34 PM;6195bb56ef18ca0071c7a9de;Again missed AFD🤦‍♂️. I test only for *bold* one [https://paymentology.atlassian.net/browse/DEFECT-1319?focusedCommentId=234725|https://paymentology.atlassian.net/browse/DEFECT-1319?focusedCommentId=234725]

Let me run it.","06/Mar/25 12:55 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Thanks [~accountid:6195bb56ef18ca0071c7a9de] the first message was my tests that I came up with (minus the TIDs specifically mentioned by Mettle as problematic)

The second message was a request specifically from Mettle ","06/Mar/25 1:25 PM;6195bb56ef18ca0071c7a9de;{color:#4c9aff}*For AFD,*{color}

*Production sample*

!image-20250306-112232.png|width=1062,height=494,alt=""image-20250306-112232.png""!

*UAT*

Pre-auth = {{2986405250243000218}}

AFD = {{2986405250243000218}}

!image-20250306-111910.png|width=1630,height=264,alt=""image-20250306-111910.png""!

!image-20250306-112513.png|width=1319,height=475,alt=""image-20250306-112513.png""!","06/Mar/25 5:42 PM;6195bb56ef18ca0071c7a9de;For settlement, sample TID already there. Fix for cardtest settlement issue already merged into UAT branch.","07/Mar/25 4:59 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Sorry to be a pain [~accountid:6195bb56ef18ca0071c7a9de] 

“Thanks for providing references to test evidence. We have reviewed them. Overall results look good however we have two remarks:

# All the posted auth requests in the referenced payments are internal : they weren’t actually sent to us making it impossible to validate the scenarios e2e. Would it be possible to execute those e2e including sending the transaction for authorization to us?
# We think the evidence for scenario *ASI Followed by Authorization and multiple settlements* is missing. The evidence provided is the same as for the previous case, but this scenario intends to cover partially clearing use case, where single auth is followed by multiple presentments”","10/Mar/25 8:56 AM;6195bb56ef18ca0071c7a9de;# All the posted auth requests in the referenced payments are internal : they weren’t actually sent to us making it impossible to validate the scenarios e2e. Would it be possible to execute those e2e including sending the transaction for authorization to us?

 → I tried performing the request through external auth, but the external service was down at the time, causing a timeout. Sample TID: {{2985220031319000076}}. I can try again if the service is active now. I thought they only require test evidence for TID and our TID logic is same for both internal and external. 

# We think the evidence for scenario *ASI Followed by Authorization and multiple settlements* is missing. The evidence provided is the same as for the previous case, but this scenario intends to cover partially clearing use case, where single auth is followed by multiple presentments”

→ I'm not sure if this is possible through CardTest. If the test cases involve an ASI followed by multiple authorizations and multiple settlements, then it should work. But I don’t think multiple settlements for a single authorization is possible in CardTest. Maybe QA knows if it can be done or how to test it.","10/Mar/25 8:59 AM;6195bb56ef18ca0071c7a9de;Still same, TID {{2990251881319000369}}

!image-20250310-065905.png|width=1765,height=728,alt=""image-20250310-065905.png""!",11/Mar/25 11:33 AM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Who needs to get that working? Mettle wants to see it tested e2e [~accountid:6195bb56ef18ca0071c7a9de] ,11/Mar/25 11:37 AM;6195bb56ef18ca0071c7a9de;I’ll check with Impl or SD team.,"11/Mar/25 12:34 PM;6195bb56ef18ca0071c7a9de;{color:#6554c0}*ASI Followed by Authorization*{color}

ASI = {{2991356981319000444}} (DE63 + DE15 = MDUHABW7T + 0311)

Pre-Auth linking to ASI through trace id = {{2991357629901000445}} (DE48_63 = MDUHABW7T0311)

{color:#6554c0}ASI Followed by Multiple Authorizations{color}

ASI = {{2991356981319000444}} (DE63 + DE15 = MDUHABW7T + 0311)

Pre-Auth linking to ASI through trace id = {{2991356981319000444}} (DE48_63 = MDUHABW7T0311)

Another Pre-Auth = {{2991358559901000446}} (DE48_63 = MDUHABW7T0311)

{color:#6554c0}*ASI Followed by multiple Authorization and multiple settlements*{color}

ASI = {{2991356981319000444}} (DE63 + DE15 = MDUHABW7T + 0311)

Pre-Auth linking to ASI through trace id = {{2991356981319000444}} (DE48_63 = MDUHABW7T0311)

Another Pre-Auth = {{2991358559901000446}} (DE48_63 = MDUHABW7T0311)

!image-20250311-100030.png|width=1846,height=526,alt=""image-20250311-100030.png""!

{color:#6554c0}*ASI Followed by Authorization and multiple settlements*{color}

ASI = {{2991365191319000454}} (DE63 + DE15 = MDUHNSW7T+ 0311)

Pre-Auth linking to ASI through trace id = {{2991366229901000455}} (DE48_63 = MDUHNSW7T0311) (amount = 19)

{color:#ff5630}*Multiple settlement* {color}{{2991366229901000455}} (amount 10 + 5 + 4)

!image-20250311-101215.png|width=1846,height=712,alt=""image-20250311-101215.png""!

{color:#6554c0}*ASI Followed by Reversal (Post-Authorization)*{color}

ASI = {{2991362851319000451}} (DE63 + DE15 = MDUHNS7AT + 0311)

Pre-Auth linking to ASI through trace id = {{2991363379901000452}} (DE48_63 = MDUHNS7AT0311)

Reversal for pre-auth = {{2991363379901000452}}

!image-20250311-100550.png|width=1839,height=462,alt=""image-20250311-100550.png""!

{color:#6554c0}*ASI Followed by Decline Advice (Post-Authorization)*{color}

ASI = {{2991368841319000456}} (DE63 + DE15 = MDUHNSADV + 0311)

Pre-Auth linking to ASI through trace id = {{2991369599901000457}} (DE48_63 = MDUHNSADV0311, DE63 + DE15 = MCC679270 + 1202)

Decline Advisement = {{2991369599901000457}}

{color:#6554c0}*ASI Followed by Decline Advice for ASI (Post-Authorization)*{color}

ASI = {{2991371171319000459}}

Decline Advisement for ASI = {{2991371171319000459}}

{color:#6554c0}*ASI Followed by Reversal Advice and Auth Advise for ASI (Post-Authorization)*{color}

ASI = {{2991373551319000461}}

Decline Advisement = {{2991373551319000461}}

Reversal advisement = {{2991373551319000461}}

{color:#ff5630}*And last AFD case*{color}

Pre-auth = {{2991376330243000462}}

AFD = {{2991376330243000462}}",11/Mar/25 12:34 PM;6195bb56ef18ca0071c7a9de;[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] updated with external auth + multiple settlement case for single auth.,12/Mar/25 1:17 PM;6195bb56ef18ca0071c7a9de;Hi [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] all good? let me know if anything is missing.,"12/Mar/25 1:20 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] damn, those are with external auth? Just got a reply from Mettle this morning explaining their platform has working hours","12/Mar/25 1:33 PM;6195bb56ef18ca0071c7a9de;Yes, the latest one with external auth. Maybe this time I test it during working hours.","17/Mar/25 3:25 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] Mettle is happy with the testing that’s been completed - I know this has been painful but they are a quite important customer and the better we could do on this, the more credibility we have with them

Please can you confirm on me, when this is deployed, what will the behaviour be for existing clients/new clients/Mettle?","17/Mar/25 3:34 PM;6195bb56ef18ca0071c7a9de;Thank you!

{color:#ff991f}Please can you confirm on me, when this is deployed, what will the behaviour be for existing clients/new clients/Mettle?{color}

Change is present in BL 2.23. It is planned for 25 March.

[https://paymentology.atlassian.net/wiki/spaces/TS/pages/7824244738/Banking+Live+Release+Cycle|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7824244738/Banking+Live+Release+Cycle|smart-link] 

Whole change is behind product setting flag {{enable_asi_constraints_for_tid}} (by default, disable)

[https://paymentology.atlassian.net/wiki/spaces/TS/pages/7517274378/BL+PayPower+Settings+through+Product+ID+or+Client+ID|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7517274378/BL+PayPower+Settings+through+Product+ID+or+Client+ID|smart-link] 

For existing client, by default this flag is disable

For mettle, we need to enable this flag once BL 2.23 deployed

For new client, it’ll be disable. Do we need to enable it by default for new client?","17/Mar/25 10:55 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Thanks [~accountid:6195bb56ef18ca0071c7a9de] for confirming

Yes, ideally this would be the new default behaviour for any customers being onboarded, it’s not urgent to rush that change out but would be good to get in place for the future","18/Mar/25 8:54 AM;6195bb56ef18ca0071c7a9de;How can we check if this is a new customer? I think one way is to check the client ({{p_clients}}) created date and compare it with a specific hardcoded date. 

Is there any other way for this?","18/Mar/25 9:56 AM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] my assumed way of doing it would be to:


* Create a change to have this behaviour be on by-default
* Pre-run on each environment a script that disables the behaviour for all existing customers
* Deploy change for it to be on by-default","18/Mar/25 10:01 AM;6195bb56ef18ca0071c7a9de;Yeah, right. makes sense 🤦‍♂️ ","08/Apr/25 4:48 AM;5f623946b9fcc1007734b378;Hi [~accountid:6195bb56ef18ca0071c7a9de] [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] this one also has the BL-2.25 fixversion.

* Can you please confirm the impact to existing clients (if any)
* The impact to clients onboarded after BL-2.25 release (if any)","08/Apr/25 7:38 AM;6195bb56ef18ca0071c7a9de;Hi [~accountid:5f623946b9fcc1007734b378] 

The change was introduced in BL 2.23. In BL 2.25, a script was added to disable it by default for existing clients and enable it by default for newly onboarded clients. Previously it was disable for both old and new clients.

* Can you please confirm the impact to existing clients (if any)

→ The feature is behind a product flag and is disabled by default, so there should be no impact on existing clients.

* The impact to clients onboarded after BL-2.25 release (if any)

→ For new clients onboarded after BL 2.25, the change involves unlinking the transaction identifier (i.e. creating new transaction identifier, TID) if a pre-auth transaction attempts to link to an original transaction (by trace ID) is an ASI transaction.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147455,AUTH-1096,BAU Bug Fixes - PayPower,Done,26/Mar/25 8:28 AM
UAT - Mettle - MC 3DS AAV OBS - MC Mandate Testing,DEFECT-576,120401,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Normal,Done,Febby Oktaviani,629a26eba0eafd0069ea2343,Mostafa Elhoseiny,6328729388ed2ebef978552f,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,02/Feb/24 8:16 PM,06/May/25 5:48 PM,,11/Jun/24 7:33 AM,BL-2.13.0,PCDB-1.28.0,PCDB-1.28.25,PCDB-1.29.5,PCDB-1.30.2,PCDB-1.31.0,PTDB-1.28.0,PTDB-1.28.6,PTDB-1.29.6,PTDB-1.30.2,PTDB-1.31.0,,,,,,,,,,,,0,jira_escalated,jira_update,,,"Hi , 

Dev. team implemented a workaround to rely on some indicators for decisioning (approve/decline) for 3DS-Secure code transactions to meet 
MC Mandate

we ran these test cases : 

1- Perform a transaction with SLI = 212 and leading indicator kC with OBS 05=V (Transaction Successful) >>> TID = (V) 2588449599907837574 , (A) 2588453609907837576 approved from PTy , declined by Mettle

2- Perform a transaction with SLI = 212 and leading indicator kD without OBS 05 (Transaction Successful) >>> TID = 2588468659907684032 approved from PTy , declined by Mettle

3- Perform a transaction with SLI = 212 and leading indicator kC with OBS 05 not in A or V (Transaction Decline) >>> TID = (F) 2588452369907837575 declined from Pty

4- Perform a transaction with SLI = 214 and leading indicator kX with OBS 05  A or V (Transaction Successful) >>> TID = (V) 2588461399907684029 , (A) 2588463209907684030  approved from PTy , declined by Mettle

5- Perform a transaction with SLI = 214 and leading indicator kX without OBS 05(Transaction Successful) >> TID = 2588467449907684031 approved from PTy , declined by Mettle


The Fast out message for the approved ones by PTY has a wrong indicator which is ""3DS_Check"": ""FAIL"" and this is impacting the client decisioning on their side.

Sample : 
""MESSAGE_TYPE"":{
2 items
""Message_Type"":
""0100""
""Message_Desc"":
""Authorisation Request""
}

""SUMMARY"":{
21 items
""TID"":
""2588468659907684032""
""RID"":
""2541843""
""PID"":
""449""
""Client_Id"":
""438126""
""Transaction_Date_Time"":
""02-02-2024 13:01:08""
""Network"":
""MC""
""Spend_Type"":
""ECOM - Purchase""
""Spend_Location"":
""Merchant name Merchant city AZ ""
""Transaction_Amount"":
""95""
""Transaction_Currency"":
""USD""
""Billing_Amount"":
""99.99""
""Billing_Currency"":
""GBP""
""Card_Use_Type"":
""Electronic commerce""
""Customer_Validation"":
""3DS ""
""Processor_Decision_Code"":
""00""
""Processor_Reason_Code"":
""000""
""Processor_Decision_Desc"":
""Approve""
""Merchant_Category"":
""5999 - Miscellaneous & Specialty Retail Stores""
""Account_Id"":
""756588171""
""Customer_Ac"":
""d38d0f8d-e4e5-4320-84c4-08276e1d7a21""
""Total_Fee_Bill"":
""0.0""
}

""PROCESSOR_VALIDATIONS"":{
13 items
""Pan_Check"":
""PASS""
""Pin_Check"":
""NA""
""Expiry_Check"":
""PASS""
""Track_Check"":
""PASS""
""CVV_Type"":
""0""
""CVV_Check"":
""NA""
""ARQC_Check"":
""NA""
""3DS_Check"":
""FAIL""
""Test_Matrix"":
""2450521198784688632""
""Test_Results"":
""2449958197289549824""
""Rules_Checked"":
""67356,783""
""Rules_Triggered"":
""""
""Rules_Decision"":
""00""
}

Environment : UAT

Ref. 
https://paymentology.atlassian.net/browse/AUTH-150
https://paymentology.atlassian.net/browse/AUTH-157
https://paymentology.atlassian.net/browse/AUTH-347

Slack Ref. https://paymentology.slack.com/archives/C02BSM9UXGB/p1706012311473099

~* Please see Zendesk Support tab for further comments and attachments.~",,Bil Gurung,Febby Oktaviani,Florin Vistig,Lucy Simpson,michael.ellery,Mostafa Elhoseiny,Savio,Shehroz Ahmed Siddiqui,Zendesk Support for Jira,,,60fedcdc75ad960069b85175,629a26eba0eafd0069ea2343,5a9e4751a00c7f2a80155fda,5f623946b9fcc1007734b378,6273fc10807e0000691d5dee,6328729388ed2ebef978552f,60fedd388ad5b600707750e1,632872d207a27ebeff12903b,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,28/Mar/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;240-on_behalf_mc_aav_verified-fast.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80707,28/Mar/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;240-on_behalf_mc_aav_verified-paytok.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80704,28/Mar/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;241-aav_skipped_product_config-fast.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80705,28/Mar/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;241-aav_skipped_product_config-paytok.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80708,28/Mar/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;242-aav_skipped_based_on_merchant_risk-fast.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80706,28/Mar/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;242-aav_skipped_based_on_merchant_risk-paytok.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80709,27/Mar/24 6:07 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;3ds-mismatch-test-results.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80606,27/Mar/24 6:07 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;aav-from-pks-failed.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80604,28/Mar/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;p_reason_code.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80710,28/Mar/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;product_settings.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80703,27/Mar/24 6:07 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;tok_pre_18-failed-aav-set-3ds-mismatch-flag.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80605,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CE - Enhanced Support,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@7a96763c,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,UAT [BL],,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=38, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":38,""lastUpdated"":""2024-05-14T11:08:19.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":38,""name"":""GitLab""},""GitHub"":{""count"":20,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzz47b:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,AUTH Sprint 3,AUTH Sprint 4,AUTH Sprint 5,Sprint 7,Sprint 8,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,"h1. Local test evidence

h2. Product setting enable

to enable product setting please refer to [https://paymentology.atlassian.net/wiki/spaces/TS/pages/7517274378/BL+PayPower+Settings+through+Product+ID+or+Client+ID|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7517274378/BL+PayPower+Settings+through+Product+ID+or+Client+ID]

!product_settings.png|width=749,height=322,alt=""product_settings.png""!

h2. New reason codes inserted to p_reason_code table

!p_reason_code.png|width=574,height=269,alt=""p_reason_code.png""!

h2. Test Cases

||*Case*||*Evidence*||
|3DS IAV verified by Mastercard On behalf
Given
* product setting {{on_behalf_service_mastercard_aav_verification}} is TRUE
* SLI: 212 
* leading indicator: kC
* OBS 05 = V
* aav from PKS = 0
Then
* Transaction is approved with reason code 240 (3DS IAV verified by Mastercard On behalf)
* FAST Feed Summary contains
** Processor_Decision_code: 240
** Processor_Deccision_Desc: Approve - 3DS IAV verified by Mastercard On behalf|!240-on_behalf_mc_aav_verified-paytok.png|width=66.66666666666666%,alt=""240-on_behalf_mc_aav_verified-paytok.png""!
!240-on_behalf_mc_aav_verified-fast.png|width=66.66666666666666%,alt=""240-on_behalf_mc_aav_verified-fast.png""!|
|AAV skipped based on product config
Given
* product setting {{skip_aav_validation_mc_generated}} is TRUE
* SLI: 212
* leading indicator: kD
* aav from PKS = 0
Then
* Transaction is approved with reason code 241 (AAV skipped based on product config)
* FAST Feed Summary contains
** Processor_Decision_code: 241
** Processor_Deccision_Desc: Approve - AAV skipped based on product config.|!241-aav_skipped_product_config-paytok.png|width=66.66666666666666%,alt=""241-aav_skipped_product_config-paytok.png""!
!241-aav_skipped_product_config-fast.png|width=66.66666666666666%,alt=""241-aav_skipped_product_config-fast.png""!|
|AAV skipped based on merchant risk
Given:
* product setting {{bypass_aav_on_merchant_risk}} is TRUE
* SLI: 214
* leanding indicator: kX
* aav = 0
Then:
* Transaction is approved with reason code 242 (AAV skipped based on merchant risk)
* FAST Feed Summary contains
** Processor_Decision_code: 242
** Processor_Deccision_Desc: Approve - AAV skipped based on merchant risk|!242-aav_skipped_based_on_merchant_risk-paytok.png|width=66.66666666666666%,alt=""242-aav_skipped_based_on_merchant_risk-paytok.png""!
!242-aav_skipped_based_on_merchant_risk-fast.png|width=66.66666666666666%,alt=""242-aav_skipped_based_on_merchant_risk-fast.png""!|",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-03-15 09:33:24.952,10205_*:*_1_*:*_121856_*|*_10306_*:*_2_*:*_1986645031_*|*_3_*:*_3_*:*_2609860300_*|*_10000_*:*_2_*:*_125440621_*|*_10001_*:*_1_*:*_0_*|*_10400_*:*_2_*:*_4058498906_*|*_10345_*:*_1_*:*_2405689693,,15/Mar/24 11:33 AM;60fedcdc75ad960069b85175;Hi [~accountid:632872d207a27ebeff12903b] Can you check this issue ,"15/Mar/24 11:47 AM;632872d207a27ebeff12903b;[~accountid:60fedcdc75ad960069b85175] how can i help here?
is there any process change to assign bugs/ certification tickets to product team?","15/Mar/24 11:52 AM;60fedcdc75ad960069b85175;Apologies [~accountid:632872d207a27ebeff12903b] if you are not correct can you re-assign to someone on auth team 
Because current impl support team is restructured and we are moving any pending tickets to respective engineering board.
","15/Mar/24 12:19 PM;632872d207a27ebeff12903b;[~accountid:60fedcdc75ad960069b85175] thanks for the update, do we have any process for it now, what should be way forward, as I know , dev team picks up ticket wihch are “defect”",15/Mar/24 12:30 PM;60fedcdc75ad960069b85175;We can move it to PRODUCTION DEFECT under Auth team I think [~accountid:632872d207a27ebeff12903b] ,"15/Mar/24 12:43 PM;632872d207a27ebeff12903b;sure sir, please move and assign it to [~accountid:5a9e4751a00c7f2a80155fda] , he will investigate if it will fall under Defect category","15/Mar/24 1:30 PM;5a9e4751a00c7f2a80155fda;[~accountid:632872d207a27ebeff12903b] [~accountid:6328729388ed2ebef978552f] just to confirm, the 3DS_Check flag should be Success in case of OBS exemptions?","27/Mar/24 6:07 AM;629a26eba0eafd0069ea2343;[~accountid:632872d207a27ebeff12903b] [~accountid:6328729388ed2ebef978552f] , would you please answer Florin question?

Currently, we set the 3ds mismatch token flag as failed whenever the aav result from PKS is not success even though the transaction is approved due to OBS exemption/product flag setting.

[src/main/sql/replace/functions/public/ppwr_tok_pre18.sql · master · Paymento / Source / BL 2.0 / PayDB / PayTokDB · GitLab|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2539-2544]

!tok_pre_18-failed-aav-set-3ds-mismatch-flag.png|width=969,height=598!

!aav-from-pks-failed.png|width=574,height=403!

!3ds-mismatch-test-results.png|width=462,height=367!

We rely on this flag to set 3DS_Check result on FAST feed.

Should we set 3DS mismatch token flag only when the transaction is declined?","27/Mar/24 10:53 AM;632872d207a27ebeff12903b;[~accountid:629a26eba0eafd0069ea2343] ,there should be a new processor reason code for OBS service with 3ds check as passed , also, if we start sending this as passed only now, mettle will start accepting these transactions and as [~accountid:6273fc10807e0000691d5dee] and [~accountid:60efea9cf749c400680c020e] are following for introducing the feature flag for this mandate to be disabled for mandate, we should not deploy this fix before disabling the mandate.","27/Mar/24 11:44 AM;632872d207a27ebeff12903b;[~accountid:6273fc10807e0000691d5dee] and [~accountid:60efea9cf749c400680c020e] your thoughts here pleaes:
as stated in this ticket below , Mettle wants this change?:
[https://paymentology.atlassian.net/browse/AUTH-150|https://paymentology.atlassian.net/browse/AUTH-150|smart-link] ","27/Mar/24 12:10 PM;629a26eba0eafd0069ea2343;[~accountid:632872d207a27ebeff12903b], we have reason code 24X available to be used for each 3ds bypassed conditions:

# iav_validated_by_mastercard OR valid_on_behalf_service_mastercard_aav_verification 
## reason code: 240 
## description: (3DS IAV verified by Mastercard On behalf)
# skip_aav_validation_mc_generated 
## reason code: 241 
## description: (AAV skipped based on product config)
# bypass_aav_on_merchant_risk 
## reason code: 242 
## description: (AAV skipped based on merchant risk)

what do you think? ","27/Mar/24 12:13 PM;632872d207a27ebeff12903b;looks fine but we have to update the portal documentation if we implement this and also let clients know about it.

[~accountid:5f623946b9fcc1007734b378] , what will be the process for this?",16/Apr/24 3:09 AM;632872d207a27ebeff12903b;[~accountid:5f623946b9fcc1007734b378] need help here please,16/Apr/24 8:42 AM;5f623946b9fcc1007734b378;Hi [~accountid:632872d207a27ebeff12903b] taking a look now at whats needed and will advise shortly,"16/Apr/24 8:56 AM;5f623946b9fcc1007734b378;Hi [~accountid:632872d207a27ebeff12903b] 

* once any change is available in prod raise a ticket under this stpry [https://paymentology.atlassian.net/browse/PMGMT-462|https://paymentology.atlassian.net/browse/PMGMT-462|smart-link] and assign it to me.
* It needs to include:
** what is actually needed to be made available as documentation to clients. By the looks of the ticket its:
*** new reason codes and descriptions that have been deployed
*** i would suggest a sample FAST auth and clearing message of this transaction type
*** if the 3ds check validation is changing - then provide the scenarios in which this may occur.",02/May/24 4:44 PM;632872d207a27ebeff12903b;[~accountid:629a26eba0eafd0069ea2343] do you know when is it planned to be deployed?,"03/May/24 5:13 AM;629a26eba0eafd0069ea2343;[~accountid:632872d207a27ebeff12903b], this is available in BL 2.10 and I don’t know when this will be deployed to Prod, maybe [~accountid:6273fc10807e0000691d5dee] or [~accountid:60fedd388ad5b600707750e1] know better about the deployment or upgrade plan for Mettle.",03/May/24 6:09 AM;60fedd388ad5b600707750e1;[~accountid:632872d207a27ebeff12903b] BL 2.10 will be deployed to UAT today and will start moving to Production between 20th May to 31st May.,03/May/24 11:13 AM;632872d207a27ebeff12903b;[~accountid:6273fc10807e0000691d5dee] FYI below,"13/May/24 7:35 AM;632872d207a27ebeff12903b;[~accountid:60fedd388ad5b600707750e1] [~accountid:629a26eba0eafd0069ea2343] Client doesn't want it anymore, it should not go live.

[~accountid:6273fc10807e0000691d5dee] please confirm","13/May/24 7:49 AM;629a26eba0eafd0069ea2343;[~accountid:632872d207a27ebeff12903b], the changes are already in BL 2.10 and it only to add new approved reason codes for specified conditions. Do we really need to revert the changes? ",13/May/24 1:20 PM;6273fc10807e0000691d5dee;Hi [~accountid:629a26eba0eafd0069ea2343] yes please do not proceed on this,"13/May/24 1:29 PM;629a26eba0eafd0069ea2343;[~accountid:632872d207a27ebeff12903b], please confirm that i need to revert the changes from BL 2.10, 2.11 and master. If yes, i will open a subtask ticket for the revert. The revert will be done on paytok and paycore (delete new inserted reason codes mentioned on this ticket).",13/May/24 1:34 PM;632872d207a27ebeff12903b;yes we need to revert,13/May/24 1:42 PM;60fedd388ad5b600707750e1;[~accountid:632872d207a27ebeff12903b] [~accountid:629a26eba0eafd0069ea2343] this has a feature flag so then why to revert?,"13/May/24 1:46 PM;629a26eba0eafd0069ea2343;[~accountid:60fedd388ad5b600707750e1] the feature flag is for the AAV OBS condition, not the reason code.","04/Jun/24 4:47 PM;6328729388ed2ebef978552f;Hi [~accountid:6273fc10807e0000691d5dee] [~accountid:629a26eba0eafd0069ea2343] [~accountid:632872d207a27ebeff12903b] 
are those changes in this ticket related to this announcement mentioned [here |https://paymentology.atlassian.net/browse/SOLAR-111]?",06/Jun/24 11:52 AM;6273fc10807e0000691d5dee;I’m not sure [~accountid:632872d207a27ebeff12903b] [~accountid:629a26eba0eafd0069ea2343] might you know?,"06/Jun/24 12:01 PM;632872d207a27ebeff12903b;[~accountid:6328729388ed2ebef978552f] no, this ticket is no longer required as it was for Mettle and they asked us to not implement this","06/Jun/24 12:39 PM;6328729388ed2ebef978552f;Hi [~accountid:632872d207a27ebeff12903b] so this ticket should be closed.  [~accountid:6273fc10807e0000691d5dee] appreciate your input here.

[~accountid:632872d207a27ebeff12903b] I have a question , starting from now on we are supporting OBS 05 and OBS 06 ? so we can rely on the AAV validation result performed by MC and we no longer need to share the AV key with the ACS for the self-validation for the new projects ? ( _same as we are doing in VISA projects_ ) ?",06/Jun/24 12:40 PM;6273fc10807e0000691d5dee;Correct [~accountid:6328729388ed2ebef978552f] please close,11/Jun/24 11:08 AM;6328729388ed2ebef978552f;Hi [~accountid:632872d207a27ebeff12903b] please advise regarding this [question |https://paymentology.atlassian.net/browse/DEFECT-576?focusedCommentId=190527]thanks in advance.,"24/Jun/24 3:46 PM;6328729388ed2ebef978552f;Hi [~accountid:632872d207a27ebeff12903b] Awaiting your valuable feedback , it’s very important to know in terms of our keys exchange and implementation with MC and the ACS vendors for the 3DS enablement. ","25/Jun/24 12:26 PM;632872d207a27ebeff12903b;Hi [~accountid:6328729388ed2ebef978552f] really sorry for late, I was on leave.

Currently we handle 05V for only some wallet ids and leading indicators as per mandate.

It wont cover the whole on behalf service","26/Jun/24 11:03 AM;6328729388ed2ebef978552f;Hi [~accountid:632872d207a27ebeff12903b] No problem , this is noted. 
please share the exact 05V mandate changes that’s already available now on UAT and production.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147455,AUTH-1096,BAU Bug Fixes - PayPower,Done,11/Jun/24 7:33 AM
Mettle| Refund presentment linked with Original Auth and created Same TID,DEFECT-468,122321,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,High,Done,Bimal Paudel,619a20dff2415000728442aa,abdul.sahaptheen,623ddb7a866b810069e527bc,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,01/Mar/24 12:21 PM,07/May/25 4:53 PM,,26/Apr/24 10:09 AM,PCDB-,PCDB-1.26.14,PCDB-1.27.9,PCDB-1.28.0,,,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,,,"As per the previous deployment(https://paymentology.atlassian.net/browse/CLR-45) which was deployed on Jan17th , The Refund Settlements are matched only with refund authorizations otherwise they should   have rid = 0 and txn_id starting with ‘8000’ e.g.: 
800000010535100831


However, the below Refund settlements which does not have the refund Auth linked with actual Auth which is not client's Expectation .

2601294816120698773
2598294096120844342


Checks & Observations by AS Team:  

   Verified the MC Matching function for Mettle. It is as expected(psrv_matching_v3_mettle.)
  We see both authorizations were declined one. So we believe that on earlier implementation the declined Auths were not considered. Please help to double verify .

Logs & Transaction  screenshots to be followed.

Cc :




~* Please see Zendesk Support tab for further comments and attachments.~",,abdul.sahaptheen,Ardiansyah,Bimal Paudel,Cristian Pop,michael.ellery,Zendesk Support for Jira,,,,,,623ddb7a866b810069e527bc,629a26eab407cc006901710c,619a20dff2415000728442aa,636bb413847c699ac651c290,6273fc10807e0000691d5dee,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ESQA-1059,,,,,,01/Mar/24 12:44 PM;ug:0fdfee46-fef9-4e69-a82c-95053566662d;DEFECT-468.txt;https://paymentology.atlassian.net/rest/api/3/attachment/content/78942,01/Mar/24 12:44 PM;ug:0fdfee46-fef9-4e69-a82c-95053566662d;image-20240301-104136.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78943,01/Mar/24 12:44 PM;ug:0fdfee46-fef9-4e69-a82c-95053566662d;image-20240301-104215.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78944,27/Mar/24 11:53 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;image-20240327-093848.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80621,27/Mar/24 11:53 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;image-20240327-094134.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80622,27/Mar/24 11:53 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;image-20240327-094941.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80620,27/Mar/24 11:53 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;image-20240327-095303.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80619,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PE - Processing - Clearing,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6c92eb76,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{pullrequest={dataType=pullrequest, state=OPEN, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2024-04-02T09:38:27.596+0200"",""stateCount"":1,""state"":""OPEN"",""dataType"":""pullrequest"",""open"":true},""byInstanceType"":{""GitLab"":{""count"":1,""name"":""GitLab""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,Mettle,1|hzzgen:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,CLR Sprint 3,CLR Sprint 4,CLR Sprint 5,,,,,,,,,,,,,,,,,,,,,,,,,a8693810-01fb-4d1c-8714-51e4229f5c10,PE - Processing - Clearing,"*Before Fix:*
_Authorization Data (t_auth)_

!image-20240327-093848.png|width=1089,height=294,alt=""image-20240327-093848.png""!

_Settlement Data (t_set) showing incorrectly matched with different purchase type (d3_1)_

!image-20240327-094134.png|width=1128,height=319,alt=""image-20240327-094134.png""!

*After Fix:*

_Authorization Data [Purchase Type: 28 and Purchase Type: 20]_

!image-20240327-094941.png|width=994,height=338,alt=""image-20240327-094941.png""!

_Settlement Data (Showing incorrect purchase type assigned new txn_id and correct purchase type properly matching)_

!image-20240327-095303.png|width=1120,height=324,alt=""image-20240327-095303.png""!



Testing done on *UAT* using {{psrv_matching_v3_mettle}} matching function.

*Authorisations*

# DE3_1: ""20""	TXN_ID: 2656534539901927459
# DE3_1: ""20""	TXN_ID:	2656534919901927460
# DE3_1: ""28""	TXN_ID:	2656535179901927461
# DE3_1: ""28""	TXN_ID:	2656535299901927462

*Settlements*

# DE3_1: ""20""	TXN_ID: 2656534539901927459	SETTLE_NOTE: ""1401=Previously approved auth -amt same; match(3a) on tok + de38""	
# DE3_1: ""28""	TXN_ID: 7000000370291000002 SETTLE_NOTE: ""1401=Previously approved auth -amt same; match (5a) : unmatched settlement except reversal. (known card)""	
# DE3_1: ""28""	TXN_ID: 2656535179901927461 SETTLE_NOTE: ""1401=Previously approved auth -amt same; match(3a) on tok + de38""	
# DE3_1: ""20""    TXN_ID: 7000000370311000002 SETTLE_NOTE: ""1401=Previously approved auth -amt same; match (5a) : unmatched settlement except reversal. (known card)""



If DE3_1 *matched* then the transaction matched with the settlement entry, if they were mismatched the settlement entry was marked as *unmatched*.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-03-20 05:14:31.879,10306_*:*_1_*:*_1811955663_*|*_3_*:*_1_*:*_419778209_*|*_10001_*:*_1_*:*_0_*|*_10400_*:*_1_*:*_101654717_*|*_10345_*:*_1_*:*_2497095565,,"01/Mar/24 12:44 PM;623ddb7a866b810069e527bc;2601294816120698773

!image-20240301-104136.png|width=1677,height=388!



2598294096120844342

!image-20240301-104215.png|width=1653,height=348!

Logs for 2601294816120698773



[^DEFECT-468.txt]



Slack Discussion in :  [https://paymentology.slack.com/archives/C04QN45A8KF/p1709285057733239?thread_ts=1704716718.563769&cid=C04QN45A8KF|https://paymentology.slack.com/archives/C04QN45A8KF/p1709285057733239?thread_ts=1704716718.563769&cid=C04QN45A8KF|smart-link] ","01/Mar/24 12:46 PM;623ddb7a866b810069e527bc;Also Please reveiw below observation from Client : 

*Part 1*



I've spotted two transactions that caused some issues on how we handled the updates to the customer account. When I looked at them more closely, they are examples of refund presentments being linked to the original authorisation. My suspicion is that they were missed from the fix applied to revert this behaviour for us. I've raised this in ticket [https://support.paymentology.com/hc/en-us/requests/707700|https://support.paymentology.com/hc/en-us/requests/707700]



*Part 2*I also further wanted to question (but not in the support ticket) the basis that Paymentology used to link the auth and the presentment. This is important to raise as I know Paymentology want us to move to being able to receive refund presentments that share the same TID as the authorisation. But I want reassurance that the linking logic is genuinely sound before we examine 

In   these examples we have:

* Authorisation with processing code (DE3_1) of 28. This designates it as a Payment Transaction
* Presentment with processing code 20. This designates it as a credit, purchase refund.

The linking logic stated in PayControl says that these were matched on *match (3b) on tok + de4 + de42* where DE4 is transaction amount and DE42 is the card acceptor code.I'm not sure if this is indicating the only criteria by which there was a match but if it does, is the fact that the amount and card acceptor code being the same enough to say that the presentment is a refund or the authorisation? Because they are both credit transactions. Logically the presentment can't be a refund of the authorisation, because the authorisation is a credit itself. I feel the processing code somewhat matters in this context. If the presentment was completing the credit from the authorisation, it would have had a processing code of 28 as the clearing processing code should reflect what happened at the point of the interaction i.e. mirror the authorisation. Given it has a different one, doesn't reference an authorisation code (i.e. DE38) the presentment in this case seems unrelated to the authorisation.","20/Mar/24 7:14 AM;629a26eab407cc006901710c;[~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] [~accountid:619a20dff2415000728442aa] 

Could you advise if there is any action required for impacted transaction? Or we can just ignore it.
Really appreciate feedback, so we can update client accordingly.
Thanks.","22/Mar/24 5:50 PM;619a20dff2415000728442aa;Looking at the data post deployment: 2024-01-22

authorization purchase return count: 1203

authorization payment transaction count: 27

settlement purchase return count: 13314

settlement payment transaction count: 0

total items mis-match count: 2

*AUTHORIZATION*

DE 3—Processing Code
Subfield 1—Cardholder Transaction Type Code
20 = Purchase Return/Refund
21 = Deposit
22 = Credit Adjustment
23 = Check Deposit Guarantee
24 = Check Deposit
28 = Payment Transaction

*CLEARING*

DE 3—Processing Code
Subfield 1: Cardholder Transaction Type

20 Credit (Purchase Return)
28 Payment Transaction
29 Fee Collection (Debit to Transaction Originator

Our current implementation is checking only the first character of the *presenment*-*de3_1* with *authorization-de3_1* and there is chance of _Purchase Return (20)_ matching with _Payment Transaction (28)_. The solution implemented in the previous fix can be enhanced to optimize this behavior as well.

I do not think any update should be done on the mentioned two transactions unless client is asking for, if necessary, they can be fixed with manual adjustments.

CC. [~accountid:629a26eab407cc006901710c] [~accountid:623ddb7a866b810069e527bc] [~accountid:6273fc10807e0000691d5dee] [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] [~accountid:627e6181f29dcb0068fa4152] ",25/Mar/24 12:53 AM;629a26eab407cc006901710c;Thanks [~accountid:619a20dff2415000728442aa] for the update and confirmation.,26/Mar/24 12:45 PM;6273fc10807e0000691d5dee;Hi [~accountid:619a20dff2415000728442aa] I just wanted to check if the enhancement will be made on this to capture this scenario?,"27/Mar/24 8:18 AM;619a20dff2415000728442aa;Hello [~accountid:6273fc10807e0000691d5dee],
Yes, the enhancement made will capture the scenario mentioned.",27/Mar/24 12:18 PM;6273fc10807e0000691d5dee;Hi [~accountid:619a20dff2415000728442aa] just to clarify this enhancement has already been made?,"28/Mar/24 12:32 PM;619a20dff2415000728442aa;Hello [~accountid:6273fc10807e0000691d5dee], 
Yes enhancement has been already done,  look into Testing tab for test results.",28/Mar/24 1:00 PM;6273fc10807e0000691d5dee;Great news is this enhancement already in production [~accountid:619a20dff2415000728442aa] ?,"28/Mar/24 1:11 PM;619a20dff2415000728442aa;No, 
Please co-ordinate accordingly to get this deployed to the production environment.
Changes are available in:

* _master_
* _Necessary BL version for mettle_
* _all other higher BL versions_.","02/Apr/24 4:06 PM;619a20dff2415000728442aa;Hello [~accountid:6273fc10807e0000691d5dee] 
This has not been deployed in production nor has it been planned.
Changes are available only in: [*BL >= 2.8.6, BL > 2.9.1 & above]*.

CC. [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] [~accountid:60fedd388ad5b600707750e1] ",11/Apr/24 9:59 AM;636bb413847c699ac651c290;Hello[~accountid:6273fc10807e0000691d5dee] . Results of the testing done on UAT can be found in the *Testing Evidence Tab*.,16/Apr/24 2:22 PM;619a20dff2415000728442aa;Changes have been presented and approved during [this|https://paymentology.atlassian.net/browse/CCM-64] CCM.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147662,CLR-714,Defects,Done,26/Apr/24 10:09 AM
[PT Internal] BL - PS Error java.lang.ClassCastException: Identified object is not a String,DEFECT-465,122281,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Normal,Done,Damian Grzankowski,712020:0466c907-d3fc-4fe7-a20b-e59d58030076,Dominic Wee,629a26eb2eafc9006eeddba3,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,01/Mar/24 5:47 AM,07/May/25 4:54 PM,,31/Jul/24 9:11 AM,BL-2.13.0,PS-2.29.5,PS-2.30.0,,,,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,,,"Hi Team,

Kindly check and advise on below error observed in PS log.

{noformat}java.lang.ClassCastException: Identified object is not a String. at org.quartz.utils.StringKeyDirtyFlagMap.getString(StringKeyDirtyFlagMap.java:378) at com.paymentology.payscheduler.schedulerjobs.JobSendSettlementIso.execute(JobSendSettlementIso.java:43) at org.quartz.core.JobRunShell.run(JobRunShell.java:202) at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573){noformat}

!image-20240301-035429.png|width=1465,height=148!



From checking, it doesn't look like it's affecting the sending of settlement messages to client.
However, this is causing a PD to be triggered.

This error is observed in :
Env: *Mettle*
Job: SendSettlementIso
[+https://tutuka.pagerduty.com/incidents/Q180COMUJYAX92+|https://tutuka.pagerduty.com/incidents/Q180COMUJYAX92]

Env: *Shared02*
Job: SendSettlementIso
[+https://tutuka.pagerduty.com/incidents/Q1OK63CGF65OQX+|https://tutuka.pagerduty.com/incidents/Q1OK63CGF65OQX]

Env: *ADQ*
Job: SettlementFastLite
[+https://tutuka.pagerduty.com/incidents/Q2M449OVNT1TAY+|https://tutuka.pagerduty.com/incidents/Q2M449OVNT1TAY]


See thread: [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1709254986469039|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1709254986469039|smart-link] 


PS logs attached for each environment

[^mettle-ps-nohup.rar]
[^adq-ps-nohup.rar]
[^sh02-ps-nohup.rar]

",,Damian Grzankowski,Dominic Wee,Zendesk Support for Jira,,,,,,,,,712020:0466c907-d3fc-4fe7-a20b-e59d58030076,629a26eb2eafc9006eeddba3,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,01/Mar/24 6:09 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;adq-ps-nohup.rar;https://paymentology.atlassian.net/rest/api/3/attachment/content/78911,16/May/24 8:25 AM;712020:0466c907-d3fc-4fe7-a20b-e59d58030076;client_list_test_evidence.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/84261,01/Mar/24 6:09 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240301-035429.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78913,02/Mar/24 2:04 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240301-234819.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78992,02/Mar/24 2:04 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240301-235011.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78987,02/Mar/24 2:04 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240301-235241.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78993,02/Mar/24 2:04 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240301-235451.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78991,02/Mar/24 2:04 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240301-235943.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78988,02/Mar/24 2:04 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240302-000228.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78989,02/Mar/24 2:04 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240302-000401.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78990,01/May/24 4:20 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240501-021811.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83063,01/May/24 4:20 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;image-20240501-021826.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83064,01/Mar/24 6:09 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;mettle-ps-nohup.rar;https://paymentology.atlassian.net/rest/api/3/attachment/content/78910,01/Mar/24 6:09 AM;ug:38c59bc5-1e22-466c-9196-4df7579766d2;sh02-ps-nohup.rar;https://paymentology.atlassian.net/rest/api/3/attachment/content/78912,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PE - Processing - Clearing,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5e1240a8,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=8, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":8,""lastUpdated"":""2024-05-27T09:14:34.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":8,""name"":""GitLab""},""GitHub"":{""count"":4,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzzu9z:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,CLR Sprint 5,CLR Sprint 7,CLR Sprint 8,CLR Sprint 9,CLR Sprint 10,,,,,,,,,,,,,,,,,,,,,,,a8693810-01fb-4d1c-8714-51e4229f5c10,PE - Processing - Clearing,"Tested using unit tests, on null, String, Integer, Array, List



!client_list_test_evidence.png|width=220,height=82,alt=""client_list_test_evidence.png""!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Bug [non-production],,,,2024-03-01 06:58:58.941,10306_*:*_1_*:*_4512760266_*|*_3_*:*_1_*:*_2070926050_*|*_10001_*:*_1_*:*_0_*|*_10400_*:*_1_*:*_962539539_*|*_10345_*:*_1_*:*_5598855346,,"01/Mar/24 5:49 AM;629a26eb2eafc9006eeddba3;Hi [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] Please let me know if you require 3 separate tickets (split for each environments) for this.
","01/Mar/24 8:58 AM;557058:a4bced0a-e933-4a8a-9216-49655949788e;This looks like a data or configuration issue.  Please can you obtain configuration data for these jobs from all environments where this is broken, [~accountid:629a26eb2eafc9006eeddba3] ?",01/Mar/24 11:21 AM;557058:a4bced0a-e933-4a8a-9216-49655949788e;Interesting that these jobs did complete subsequently..  Was there anything going on on those environments at that time?,"02/Mar/24 2:04 AM;629a26eb2eafc9006eeddba3;[~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] Here are the job configurations but I think there were no changes done recently.
Only some had other concurrent jobs running but don’t think it could have affected it.

Mettle (GenerateSettlementReport was running around the same time)

!image-20240301-234819.png|width=1094,height=401!

!image-20240301-235451.png|width=1458,height=438!



Shared02 (GenerateManagementReport for BB2 was running at the time when Constantinople SendSettlementIso job was triggered)

!image-20240301-235011.png|width=1092,height=398!

!image-20240302-000401.png|width=1498,height=80!

!image-20240302-000228.png|width=1504,height=66!


ADQ (no other running job at that time)

!image-20240301-235241.png|width=1093,height=342!

!image-20240301-235943.png|width=1434,height=272!",14/Mar/24 6:46 AM;629a26eb2eafc9006eeddba3;Hi [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] Did you have chance to review the configs above?,15/Apr/24 2:42 AM;629a26eb2eafc9006eeddba3;Hi [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] Gentle reminder on this. Thanks in advance,"24/Apr/24 2:20 PM;712020:0466c907-d3fc-4fe7-a20b-e59d58030076;For Mettle:


{noformat}2024-03-01 01:00:00.067 [Scheduler_Worker-7] INFO  JobMCSettlementMatching - ..........................................Job ended..........................................
2024-03-01 01:00:00.074 [Scheduler_Worker-9] INFO  JobSendSettlementIso - settlement_id - 
2024-03-01 01:00:00.074 [Scheduler_Worker-9] ERROR  JobSendSettlementIso - Error while executing Job SendSettlementIso
java.lang.ClassCastException: Identified object is not a String.
	at org.quartz.utils.StringKeyDirtyFlagMap.getString(StringKeyDirtyFlagMap.java:378)
	at com.paymentology.payscheduler.schedulerjobs.JobSendSettlementIso.execute(JobSendSettlementIso.java:43){noformat}

For ADQ


{noformat}024-03-01 01:00:00.008 [Scheduler_Worker-4] ERROR  JobSettlementFastlite - Error while executing Job SettlementFastlite
2024-03-01 01:00:00.008 [Scheduler_Worker-12] INFO  JobCheckLogs - ...................................Job started...................................
2024-03-01 01:00:00.008 [Scheduler_Worker-12] INFO  CheckLogs - Getting last checked ids and instance of the applications from db
java.lang.ClassCastException: Identified object is not a String.
	at org.quartz.utils.StringKeyDirtyFlagMap.getString(StringKeyDirtyFlagMap.java:378)
	at com.paymentology.payscheduler.schedulerjobs.JobSettlementFastlite.execute(JobSettlementFastlite.java:51)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202){noformat}

For Shared02

{noformat}payscheduler-1  | 2024-03-01 00:42:51.140 [Scheduler_Worker-7] INFO  SendFastNotifications - Data loaded from db for client SaltPay ProjectSea
payscheduler-1  | 2024-03-01 00:42:51.146 [Scheduler_Worker-7] INFO  JobSendFastNotifications - ...............................................Job ended... - id - 191................................................
payscheduler-1  | 2024-03-01 00:42:51.153 [Scheduler_Worker-7] INFO  JobSendSettlementIso - settlement_id - 
payscheduler-1  | 2024-03-01 00:42:51.154 [Scheduler_Worker-7] ERROR  JobSendSettlementIso - Error while executing Job SendSettlementIso
payscheduler-1  | java.lang.ClassCastException: Identified object is not a String.
payscheduler-1  | 	at org.quartz.utils.StringKeyDirtyFlagMap.getString(StringKeyDirtyFlagMap.java:378)
payscheduler-1  | 	at com.paymentology.payscheduler.schedulerjobs.JobSendSettlementIso.execute(JobSendSettlementIso.java:43)
payscheduler-1  | 	at org.quartz.core.JobRunShell.run(JobRunShell.java:202){noformat}



Line with issue:

{noformat}String client_list = schedulerContext.getString(""client_list"").toString();{noformat}","24/Apr/24 2:21 PM;712020:0466c907-d3fc-4fe7-a20b-e59d58030076;[~accountid:629a26eb2eafc9006eeddba3] We are trying to replicate the problem locally, that look like the job was executed for more than one client, but we are not sure how to replicate. 

Do you how idea what steps are required for the job to throw this exception","01/May/24 3:50 AM;629a26eb2eafc9006eeddba3;Hi [~accountid:712020:0466c907-d3fc-4fe7-a20b-e59d58030076] I’m not quite sure how this exception is triggered. 
I checked on Datadog for the past 2 weeks and observed 
1 occurrence for Mettle
3 occurrence for MOX
1 occurrence for Tyme

[https://app.datadoghq.eu/logs?query=""java.lang.ClassCastException%3A Identified object is not a String"" &agg_m=count&agg_m_source=base&agg_t=count&cols=host%2Cservice&event=AgAAAY8xql6h2y3BLAAAAAAAAAAYAAAAAEFZOHhxbUpyQUFEWG9sNVlRV01DT1FBUwAAACQAAAAAMDE4ZjMxYjEtNDBhZC00YzZjLWIxMWQtYWVkNGY5NTE3YjEz&fromUser=true&messageDisplay=inline&refresh_mode=sliding&storage=hot&stream_sort=desc&viz=stream&from_ts=1711936061374&to_ts=1714528061374&live=true|https://app.datadoghq.eu/logs?query=%22java.lang.ClassCastException%3A%20Identified%20object%20is%20not%20a%20String%22%20&agg_m=count&agg_m_source=base&agg_t=count&cols=host%2Cservice&event=AgAAAY8xql6h2y3BLAAAAAAAAAAYAAAAAEFZOHhxbUpyQUFEWG9sNVlRV01DT1FBUwAAACQAAAAAMDE4ZjMxYjEtNDBhZC00YzZjLWIxMWQtYWVkNGY5NTE3YjEz&fromUser=true&messageDisplay=inline&refresh_mode=sliding&storage=hot&stream_sort=desc&viz=stream&from_ts=1711936061374&to_ts=1714528061374&live=true]

I’m thinking it could be some settlement record since it’s not occurring daily.
What do you think ?","01/May/24 4:20 AM;629a26eb2eafc9006eeddba3;[~accountid:712020:0466c907-d3fc-4fe7-a20b-e59d58030076] Just throwing some idea here… perhaps it has something to do with the MCSettlementMatching job ?
I see both MOX and Mettle had the MCSettlementMatching job completed (without any records) and triggered the SendSettlementIso job leading to the exception.

MOX

!image-20240501-021811.png|width=1486,height=86,alt=""image-20240501-021811.png""!



Mettle

!image-20240501-021826.png|width=1454,height=73,alt=""image-20240501-021826.png""!","06/May/24 1:18 PM;712020:0466c907-d3fc-4fe7-a20b-e59d58030076;So from MCSettlementMatching job, SendSettlementIso is executed with empty string as a client_list parameter. 

That have to be sth else. Anyway we can generate solution, but without knowing the root of the problem. 

The method below, can handle any type of client_list and will convert it to proper string, [~accountid:629a26eb2eafc9006eeddba3]  what do you think about that



{noformat}    public String getClientListAsString(SchedulerContext schedulerContext ) {
        Object clientList = schedulerContext.get(""client_list"");

        if (clientList == null) {
            return """";
        } else if (clientList instanceof List) {
            return ((List<?>) clientList).stream()
                .map(Object::toString)
                .collect(Collectors.joining("",""));
        } else if (clientList.getClass().isArray()) {
            return Arrays.stream((Object[]) clientList)
                .map(Object::toString)
                .collect(Collectors.joining("",""));
        } else {
            return clientList.toString();
        }
    }{noformat}","13/May/24 5:01 AM;629a26eb2eafc9006eeddba3;[~accountid:712020:0466c907-d3fc-4fe7-a20b-e59d58030076]Are you saying that the empty client list string is the suspected root cause here ?

With this change, there won’t be any impact on the sending the settlements to client’s configured FAST URL ?
If PS task passes null clientID then, no settlement records will be sent to client ?

Maybe it would better to get a review from your team on this code as I believe they would be more familiar and knowledgeable on potential impact (if any).
","14/May/24 8:32 AM;712020:0466c907-d3fc-4fe7-a20b-e59d58030076;Hello, [~accountid:629a26eb2eafc9006eeddba3] 


Null checking is just an additional protection, but we suspect that the error is caused by the type, i.e., the {{client_list}} might be an object of type array/list or integer, but in this context, it should be a string.

We can address this issue in two ways:

# Add logging only: In the application logs, during a {{ClassCastException}}, we will log both the type of the object and its content.
# Add logging and a safeguard against other object types: When an object is converted to a string, we suspect that when an error occurs, it is caught by an exception, and then the {{client_list}} is added to the job context as an empty string. This is indicated by the code, so I don’t see any potential side effects here. Of course, this fix will undergo review by more experienced live banking developers.

I have already consulted with other team members about this issue, but we were unable to replicate a scenario in which the {{client_list}} is an object other than a string. It must be some edge case that we are unable to capture.

Let me know what you think about these approaches.",15/May/24 2:47 AM;629a26eb2eafc9006eeddba3;Hi [~accountid:712020:0466c907-d3fc-4fe7-a20b-e59d58030076] I think we should go with option 2 since additional logging should help and having safeguard would be great too incases of some abnormal format received.,"16/May/24 8:49 AM;712020:0466c907-d3fc-4fe7-a20b-e59d58030076;Hi [~accountid:629a26eb2eafc9006eeddba3] The change is already in review, could you tell, me how we should deploy this change, should we go with regular deploymnet or hotfix ?","23/May/24 11:41 AM;557058:a4bced0a-e933-4a8a-9216-49655949788e;[~accountid:712020:0466c907-d3fc-4fe7-a20b-e59d58030076] , let’s please go with regular deployment schedule.  I believe workaround is currently possible and occurrence rate is fairly low?","27/May/24 1:13 AM;629a26eb2eafc9006eeddba3;Yes, occurrence is very low as I don’t see any logged in last 15 days for ADQ/Mettle/Shared02.
However, I do see 1 trigger for Tweeq Prod on 15th May.

Can we have this applied for all environments as well ? 
[https://app.datadoghq.eu/logs?query=""java.lang.ClassCastException%3A Identified object is not a String. "" &agg_m=count&agg_m_source=base&agg_t=count&cols=host%2Cservice&event=AgAAAY95jHiFJ2_4mgAAAAAAAAAYAAAAAEFZOTVqSG9NQUFBQXBNMVhzMTAxSndBYwAAACQAAAAAMDE4Zjc5YzMtNjYzZS00YzFmLTkzN2EtN2FiNTI0MzAzOTk5&fromUser=true&messageDisplay=inline&refresh_mode=sliding&storage=hot&stream_sort=desc&viz=stream&from_ts=1714172966698&to_ts=1716764966698&live=true|https://app.datadoghq.eu/logs?query=%22java.lang.ClassCastException%3A%20Identified%20object%20is%20not%20a%20String.%20%22%20&agg_m=count&agg_m_source=base&agg_t=count&cols=host%2Cservice&event=AgAAAY95jHiFJ2_4mgAAAAAAAAAYAAAAAEFZOTVqSG9NQUFBQXBNMVhzMTAxSndBYwAAACQAAAAAMDE4Zjc5YzMtNjYzZS00YzFmLTkzN2EtN2FiNTI0MzAzOTk5&fromUser=true&messageDisplay=inline&refresh_mode=sliding&storage=hot&stream_sort=desc&viz=stream&from_ts=1714172966698&to_ts=1716764966698&live=true]

For my info, if following regular deployment schedule, what would be the timeline for it ? 
Is it within 2-3 weeks ?","27/May/24 8:49 AM;712020:0466c907-d3fc-4fe7-a20b-e59d58030076;[~accountid:629a26eb2eafc9006eeddba3] The change will be applied for all BL higher enviroments, standard regular deployment schedule is 4-6 weeks ","01/Jul/24 5:19 AM;629a26eb2eafc9006eeddba3;Hi [~accountid:712020:0466c907-d3fc-4fe7-a20b-e59d58030076] Has your change been deployed yet ?
I received 2 PD alerts for the same error here in:
*Mettle*: [https://tutuka.pagerduty.com/incidents/Q276E1TVBNYJXE|https://tutuka.pagerduty.com/incidents/Q276E1TVBNYJXE]
*ADQ*: [https://tutuka.pagerduty.com/incidents/Q1JGSQVCB9AMKD|https://tutuka.pagerduty.com/incidents/Q1JGSQVCB9AMKD]

Sample log for Mettle:

{noformat}payscheduler-1  | 2024-07-01 01:00:00.006 [Scheduler_Worker-5] INFO  JobSendSettlementIso - settlement_id -
payscheduler-1  | 2024-07-01 01:00:00.006 [Scheduler_Worker-5] ERROR  JobSendSettlementIso - Error while executing Job SendSettlementIso
payscheduler-1  | 2024-07-01 01:00:00.006 [Scheduler_Worker-4] INFO  JobMCSettlementMatching - ..........................................Job started.....
.....................................
payscheduler-1  | 2024-07-01 01:00:00.007 [Scheduler_Worker-4] INFO  SettlementMatchingService - Bulk size for matching is 99
payscheduler-1  | 2024-07-01 01:00:00.007 [Scheduler_Worker-4] INFO  SettlementMatchingRepository - Calling matching function psrv_matching_v3_mettle thr
ough doquery_matching
payscheduler-1  | 2024-07-01 01:00:00.007 [Scheduler_Worker-12] INFO  AbstractJobGenerateSettlementReport - SCHEDULER CONTEXT - datefrom - 2024-06-30 16:
00:58
payscheduler-1  | 2024-07-01 01:00:00.007 [Scheduler_Worker-12] INFO  AbstractJobGenerateSettlementReport - SCHEDULER CONTEXT - dateto - 2024-06-30 16:00
:58
payscheduler-1  | 2024-07-01 01:00:00.007 [Scheduler_Worker-12] INFO  AbstractJobGenerateSettlementReport - SCHEDULER CONTEXT - select_basis - 1
payscheduler-1  | 2024-07-01 01:00:00.007 [Scheduler_Worker-12] INFO  AbstractJobGenerateSettlementReport - SCHEDULER CONTEXT - client_list  - 0
payscheduler-1  | 2024-07-01 01:00:00.007 [Scheduler_Worker-12] INFO  AbstractJobGenerateSettlementReport - ..........................................Job started..........................................
payscheduler-1  | 2024-07-01 01:00:00.008 [Scheduler_Worker-12] INFO  AbstractJobGenerateSettlementReport - GenerateSettlementReport
payscheduler-1  | java.lang.ClassCastException: Identified object is not a String.
payscheduler-1  |       at org.quartz.utils.StringKeyDirtyFlagMap.getString(StringKeyDirtyFlagMap.java:378)
payscheduler-1  |       at com.paymentology.payscheduler.schedulerjobs.JobSendSettlementIso.execute(JobSendSettlementIso.java:43)
payscheduler-1  |       at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
payscheduler-1  |       at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
{noformat}",01/Jul/24 10:51 AM;712020:0466c907-d3fc-4fe7-a20b-e59d58030076;[~accountid:629a26eb2eafc9006eeddba3] Is not deployed yet ;/ ,"29/Jul/24 4:35 AM;629a26eb2eafc9006eeddba3;Hi [~accountid:712020:0466c907-d3fc-4fe7-a20b-e59d58030076] Could you advise if this has been deployed yet ?
Which BL version will it be available in ?

I had checked Datadog logs but I couldn’t find such errors anymore but unsure if error just never triggered or is fixed.","31/Jul/24 9:10 AM;712020:0466c907-d3fc-4fe7-a20b-e59d58030076;[~accountid:629a26eb2eafc9006eeddba3] 
Hi, The change should be available from version higher than 2.12 of BL. 
So it is avaialble for above clients ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147662,CLR-714,Defects,Done,31/Jul/24 9:11 AM
Create Feature flag for Mastercard DTAS Bypass IAV validation,DEFECT-443,122195,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,High,Done,Prabin Shrestha,6195bb56ef18ca0071c7a9de,kamal thapa,60efea9cf749c400680c020e,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,28/Feb/24 2:14 PM,06/May/25 5:46 PM,,05/Apr/24 7:50 AM,PTDB-1.28.0,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,,,"

Slack:  [https://paymentology.slack.com/archives/C02BSM9UXGB/p1709122277566569?thread_ts=1706857512.527749&cid=C02BSM9UXGB|https://paymentology.slack.com/archives/C02BSM9UXGB/p1709122277566569?thread_ts=1706857512.527749&cid=C02BSM9UXGB|smart-link] 



*Summary:*

Mettle client is requesting to decline every transaction that isn’t 3DS validated 
Sample TID:  2604063748505983317

!image-20240228-121700.png|width=859,height=538!



However, as per the recent mandate from Mastercard, [here|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7569049050/BL+Mastercard+DTAS+Bypass+IAV+validation], we are bypassing IAV validation and approving the transaction if this condition is met: 

{{IF DE-48-26 = 327 and DE-48-71-61-02 = V THEN Bypass AAV validation results, payment was validated successfully. END IF;}}

DEV Ticket: [[DEV-11638904] BL: Mastercard DTAS Bypass IAV validation - JIRA (atlassian.net)|https://paymentology.atlassian.net/browse/DEV-11638904] 



To meet the client’s expectations here, we need to enable a feature flag so that we can turn it on and off as per the client’s Request. 
",,Automation for Jira,Florin Vistig,kamal thapa,Prabin Shrestha,Shehroz Ahmed Siddiqui,Zendesk Support for Jira,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,5a9e4751a00c7f2a80155fda,60efea9cf749c400680c020e,6195bb56ef18ca0071c7a9de,632872d207a27ebeff12903b,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-83,,,,,,,,,,,28/Feb/24 2:26 PM;ug:06348425-920f-495d-a5a2-a8100bc25e4a;image-20240228-121700.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78744,19/Apr/24 11:20 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20240419-092010.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82090,10/May/24 8:31 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20240510-063116.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83738,10/May/24 8:31 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20240510-063132.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83739,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PE - Processing  - Authorisations,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@40c087ad,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2024-03-20T15:13:36.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":4,""name"":""GitLab""},""GitHub"":{""count"":2,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,Mettle,1|hzzdwv:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,AUTH Sprint 3,AUTH Sprint 4,AUTH Sprint 5,,,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,"Test local

Before

!image-20240510-063116.png|width=1709,height=732,alt=""image-20240510-063116.png""!

after flag enabled



!image-20240510-063132.png|width=1621,height=741,alt=""image-20240510-063132.png""!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-02-29 11:41:29.845,10306_*:*_1_*:*_1211861375_*|*_3_*:*_1_*:*_22061996_*|*_10000_*:*_1_*:*_580083685_*|*_10001_*:*_1_*:*_0_*|*_10400_*:*_1_*:*_1013093300_*|*_10345_*:*_1_*:*_346673633,,"28/Feb/24 2:59 PM;60efea9cf749c400680c020e;This ticket can be on hold for now until we get confirmation from the client in writing. 
[https://paymentology.slack.com/archives/C02BSM9UXGB/p1709124396491609?thread_ts=1706857512.527749&cid=C02BSM9UXGB|https://paymentology.slack.com/archives/C02BSM9UXGB/p1709124396491609?thread_ts=1706857512.527749&cid=C02BSM9UXGB|smart-link]  

","29/Feb/24 1:41 PM;632872d207a27ebeff12903b;We can make the change , to prevent any fraud, while [~accountid:6273fc10807e0000691d5dee] work on clients writings",13/Mar/24 1:08 PM;5a9e4751a00c7f2a80155fda;[~accountid:632872d207a27ebeff12903b] is this to be done as-is? It looks like a PR not a Defect…,"13/Mar/24 1:11 PM;632872d207a27ebeff12903b;[~accountid:5a9e4751a00c7f2a80155fda] according to client this mandate dose not apply to them and need to fix urgently to stop approving these transactions.

Ann marie is not with us to tell why it was here for all clients but we can make a feature falg for it .

[~accountid:60efea9cf749c400680c020e] did you get the confirmation from client ?",20/Mar/24 9:05 AM;6195bb56ef18ca0071c7a9de;Hello [~accountid:60efea9cf749c400680c020e] can i get paytok call for above sample tid = 2604063748505983317 ?,"20/Mar/24 12:50 PM;60efea9cf749c400680c020e;{noformat}
select * from ppwr_tok_pre18('0100','\xF67F440188E1A10A','\x0000000000000100','\xA99EA3F3C4A12FB46C4440BE2B8230E3','000000',11880,'0218014614',NULL,NULL,'61000000','983317','014614','0218','2810','0217','0217',NULL,'5817',NULL,NULL,NULL,'100',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'018505','200515',NULL,'021800983317',NULL,NULL,'KFPS4L4Z','ZN5UIGUBTNI0CVF','ACCESS UK LTD          +441274616878 GBR',NULL,NULL,'T420701032144328kXNIn4kaLmhtq92VgmG0uiuS1phx6315BPDUVX34W1017  66450101202364169f2c4-b848-45d3-adb8-342050ffa29682025261050000122140102010504M10233600101H0216559806599930498303042611050210080203061150186110520260332734110001000000W75130103001020230711250C 61V 18C ','826',NULL,'826',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'1024100006000826BD10 8QZ  ',NULL,'BPDZOCLWQ',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'041459       34   ',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,9,9,0,'537312',139,NULL,'M',3050231,0,6,'2024-02-18 01:46:15.205+00',1624021801461519658,'FALSE','FALSE',NULL) as result{noformat}","21/Mar/24 12:03 PM;6195bb56ef18ca0071c7a9de;Hello [~accountid:60efea9cf749c400680c020e] sir,

Do we need to present this for the upcoming CCM, or can it go to production with regular deployment?","05/Apr/24 7:50 AM;6195bb56ef18ca0071c7a9de;No response.

Change/Flag will deploy to production with a regular 3-week deployment cycle.

Closing this ticket.","19/Apr/24 11:09 AM;60efea9cf749c400680c020e;Hello [~accountid:6195bb56ef18ca0071c7a9de] , could you kindly specify the BL version number from which this change will be implemented? This will help us keep track of its release progress.","19/Apr/24 11:20 AM;6195bb56ef18ca0071c7a9de;Sure [~accountid:60efea9cf749c400680c020e] 

Change/fix is present in PayTok DB tag 1.28.0

!image-20240419-092010.png|width=553,height=387,alt=""image-20240419-092010.png""!

And BL version is 2.10

[https://gitlab.com/paymento/source/bl2.0/bl-environments/-/blob/release/2.10/versions/release/versions.yaml?ref_type=heads|https://gitlab.com/paymento/source/bl2.0/bl-environments/-/blob/release/2.10/versions/release/versions.yaml?ref_type=heads|smart-link] ",23/Apr/24 1:59 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - CCM-83 has got status Rejected,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147455,AUTH-1096,BAU Bug Fixes - PayPower,Done,23/Apr/24 2:00 PM
BL | METTLE | Rolling transaction limit rule | ZD#  703405,DEFECT-399,121795,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Normal,Done,Alexander V Tovstolis,60fedcb88c15ca006ffc380f,Juliano Polican Ciena,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,23/Feb/24 12:02 AM,21/Apr/25 7:24 PM,,01/Oct/24 12:57 PM,BL-2.13.0,PCDB-1.31.0,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,rules-engine,,"* *A summary of the request/issue*: 

The customer is reporting that Rule 06 might not be behaving as it should.

Their setup is a rule based on a rolling 30 day period for monthly ATM withdrawal limit. This is Rule ID 6 in the PROD env.



* *Platform:* Banking.Live
* *Environment* PROD - Mettle
* *Runbooks used*: N/A
* *Troubleshooting Steps Followed* (please try to list everything you have already verified )



Token: 900839820 

Since their last approved ATM withdrawal (15th Feb) TID 2601462278661158673 they made £3500 worth of approved ATM withdrawals in the last rolling 30 days (which takes us back to 18th Jan).

!https://paymentology.zendesk.com/collaboration/graphql/attachments/download/s3-e4596aea-f043-4e59-a9d2-bf8f6f68184a/image.png|width=50%!

However we can see that in TIDs 2603386278661214817; 2602604088661199185 and 2602603808661199169 they are not being permitted any further withdrawals of £500 due to rule 6. It specifically shows that they are breaching this by £500, which suggests they have already met their £4000 limits for the last 30 rolling days.

!https://paymentology.zendesk.com/collaboration/graphql/attachments/download/s3-809c1681-36b9-4ca5-87a5-d253c6a811fd/image.png|width=50%!

Example declined TID 2603386278661214817 due to Rule 6

!https://paymentology.zendesk.com/collaboration/graphql/attachments/download/s3-4fc6b915-7200-4426-8ae9-e5f49f0e1993/image.png|width=50%!

Now the TID 2578447608661288678 is for an auth advisement where Mastercard declined due to issuer timed out.

!https://paymentology.zendesk.com/collaboration/graphql/attachments/download/s3-985ed629-f57d-47aa-9204-2fda53caf359/image.png|width=50%!

!https://paymentology.zendesk.com/collaboration/graphql/attachments/download/s3-158f56e7-0dcb-40b5-bf56-d202eae06a30/image.png|width=50%!

However within this transaction (2578447608661288678) it seems that Rule 6 is being considered as part of the total spent amount - despite the transaction being declined.

In this case at least one on the mentioned declined TIDs 2603386278661214817; 2602604088661199185 and 2602603808661199169 should have been approved as the limit of 4000 is not reached yet (missing 500).

Also, I noticed the rule 6 has no actions set

!https://paymentology.zendesk.com/collaboration/graphql/attachments/download/s3-e3789111-f699-4727-977c-f251c8319515/image.png|width=50%!

* *Bug Details:* N/A
 
* *Expected result*: Please advise

 ",,Alexander V Tovstolis,Grigory Petrov,Hassan Ahmad,Jagadish Shrestha,Juliano Polican Ciena,Luis Diaz,michael.ellery,Mostafa Elhoseiny,Savio,Sean Routledge,Zendesk Support for Jira,60fedcb88c15ca006ffc380f,61bcc3e5028e300068b66a25,60fedd0cc51f3a00697da234,60fedd0d7ab143006ea59f36,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,5a4b476e2724d02a6fe27cfd,6273fc10807e0000691d5dee,6328729388ed2ebef978552f,60fedd388ad5b600707750e1,557058:4f540850-1319-42e3-9630-bc67cd95e8c2,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PR-1953,,,,,,,,,,,19/Apr/24 2:24 PM;ug:19077f7d-b152-45e8-9d9f-bdc81e288491;25.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82130,19/Apr/24 2:24 PM;ug:19077f7d-b152-45e8-9d9f-bdc81e288491;26.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82129,25/Apr/24 9:06 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;DEFECT-399 T_FRAUD_RULES.csv;https://paymentology.atlassian.net/rest/api/3/attachment/content/82624,01/May/24 6:44 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;Mettle_DEFECT-399_01052024 (38ba3fde-4223-4c9f-b48f-7faf8d83847e).sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/83097,24/May/24 10:18 AM;luis;Screenshot 2024-05-24 at 10.17.13.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/84863,24/May/24 10:19 AM;luis;Screenshot 2024-05-24 at 10.19.04.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/84864,28/Mar/24 12:24 PM;6328729388ed2ebef978552f;image-20240328-102425.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/80713,08/Apr/24 2:52 PM;6328729388ed2ebef978552f;image-20240408-125037.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/81315,18/Apr/24 6:19 PM;6328729388ed2ebef978552f;image-20240418-160923.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82010,18/Apr/24 6:19 PM;6328729388ed2ebef978552f;image-20240418-161517.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82009,18/Apr/24 6:19 PM;6328729388ed2ebef978552f;image-20240418-161615.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82008,19/Apr/24 2:45 PM;6328729388ed2ebef978552f;image-20240419-124457.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82132,25/Apr/24 9:06 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20240425-185959.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82625,01/May/24 6:20 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;image-20240501-154212.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83092,01/May/24 6:20 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;image-20240501-155350.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83094,01/May/24 6:20 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;image-20240501-155913.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83095,01/May/24 6:20 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;image-20240501-161708.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83093,10/May/24 6:49 PM;6328729388ed2ebef978552f;image-20240510-164842.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83814,10/Jul/24 11:39 AM;6328729388ed2ebef978552f;image-20240710-093756.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88157,10/Jul/24 6:03 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;image-20240710-155132.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88220,10/Jul/24 6:03 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;image-20240710-155356.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88219,10/Jul/24 6:03 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;image-20240710-155934.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88221,12/Jul/24 9:43 AM;6328729388ed2ebef978552f;image-20240712-073716.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88411,12/Jul/24 9:42 AM;6328729388ed2ebef978552f;image-20240712-074102.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88410,16/Jul/24 11:06 AM;6328729388ed2ebef978552f;image-20240716-090610.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88626,16/Jul/24 11:08 AM;6328729388ed2ebef978552f;image-20240716-090830.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/88627,23/Jul/24 9:53 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20240723-195201.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/89301,23/Jul/24 9:53 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20240723-195225.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/89300,23/Jul/24 9:53 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20240723-195253.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/89299,21/Aug/24 1:59 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20240820-235542.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/91808,21/Aug/24 1:59 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;t_fraud_rules.csv;https://paymentology.atlassian.net/rest/api/3/attachment/content/91809,23/Jul/24 10:33 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;test_case_re_f_UniversalChec3E_advises.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/89303,23/Jul/24 10:34 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;test_setup_re_f_UniversalCheck3E_advises.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/89304,23/Jul/24 10:33 PM;ug:40481306-48ab-4042-a906-eb8b6e0757e2;test_teardown_re_f_UniversalCheck3E_advises.sql;https://paymentology.atlassian.net/rest/api/3/attachment/content/89302,,,,,,,,,,,,,,,,,PE - Processing - Rule Engine,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@4813defb,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{pullrequest={dataType=pullrequest, state=OPEN, stateCount=2}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":2,""lastUpdated"":""2024-07-24T19:05:12.654+0200"",""stateCount"":2,""state"":""OPEN"",""dataType"":""pullrequest"",""open"":true},""byInstanceType"":{""GitLab"":{""count"":2,""name"":""GitLab""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzzbxr:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,Sprint 1,Sprint 2,Sprint 3,Sprint 4,Sprint 5,Sprint 7,Sprint 8,Sprint 9,Sprint 10,Sprint 11,Sprint 12,Sprint 13,Sprint 14,,,,,,XL (10-15bd),,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,"Tested with automated tests in:

[https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/merge_requests/2645|https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/merge_requests/2645|smart-link] 

Pipeline job:

[https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/jobs/6925990230|https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/jobs/6925990230|smart-link]



!Screenshot 2024-05-24 at 10.17.13.png|width=1112,height=219,alt=""Screenshot 2024-05-24 at 10.17.13.png""!

Showing a failing one for reference: 

[https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/jobs/6928982972|https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/jobs/6928982972|smart-link]  



!Screenshot 2024-05-24 at 10.19.04.png|width=1249,height=168,alt=""Screenshot 2024-05-24 at 10.19.04.png""!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Bug [non-production],,,,2024-02-26 15:00:08.944,10205_*:*_2_*:*_17448517196_*|*_10306_*:*_1_*:*_40246372_*|*_3_*:*_3_*:*_584687629_*|*_10000_*:*_1_*:*_274026393_*|*_10001_*:*_2_*:*_793414048,,"25/Feb/24 10:49 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Hi Team, [~accountid:60fedcb88c15ca006ffc380f] [~accountid:61bcc3e5028e300068b66a25] 
Please share an update or ETA for the fix.
Thank you in advance.","26/Feb/24 5:00 PM;61bcc3e5028e300068b66a25;Hi [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] , yes, advices are counted according to the rule 6. It’s required to add pattern {{_h_MTID_PATTERN_STR=>'IN;0100'}} to exclude them. Please add required action via PayControl.",29/Feb/24 7:11 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Thank you [~accountid:61bcc3e5028e300068b66a25] ,"06/Mar/24 9:23 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Hello [~accountid:61bcc3e5028e300068b66a25] , [~accountid:60fedcb88c15ca006ffc380f] 
Client came back saying:

{quote}_To be clear the behaviour I expect is:_

* _Approved auth advices DO count towards the rule_
* _Declined auth advices DO NOT count towards the rule_

_The example I shared was a declined auth advice. So I don't want them excluded, I just want approved ones only (i.e. ones that debited their balance) to be counted._{quote}

How can we achieve that?","11/Mar/24 1:11 PM;61bcc3e5028e300068b66a25;Hi [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] !
To filter approved txns it’s required to use param {{_c_DE39_PATTERN_STR}} for current txn or {{_h_DE39_PATTERN_STR}} for historical txns. For example, {{_c_DE39_PATTERN_STR=>'IN;00'}}.
De39=00 is not the single successfull code. It’s possible to list all of them or just use SUCCESSFUL operation: {{_c_DE39_PATTERN_STR=>'SUCCESSFUL'}}.","11/Mar/24 1:12 PM;61bcc3e5028e300068b66a25;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] , please find documentation with exmples of rule function calls here [https://paymentology.atlassian.net/wiki/spaces/TS/pages/6860996672/Banking.Live+Decision+Engine+Rule+Engine+V1.0|https://paymentology.atlassian.net/wiki/spaces/TS/pages/6860996672/Banking.Live+Decision+Engine+Rule+Engine+V1.0|smart-link] ","28/Mar/24 12:24 PM;6328729388ed2ebef978552f;Hi [~accountid:61bcc3e5028e300068b66a25] ,
I went through the comments and found you are suggesting to use {{_c_DE39_PATTERN_STR}} for current txn.

The rule already contains the following conditions : 


{code:sql}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'IN;01', _h_DE3_1_PATTERN_STR=>'IN;01',
 _h_DE39_PATTERN_STR=>'IN;00', _h_datepart_diff=>2592000, _aggregated_amount_OPERATION=>'>',
 _aggregated_amount_threshold_LIST=>'4000', _aggregated_amount_include_current=>TRUE){code}

!image-20240328-102425.png|width=808,height=680,alt=""image-20240328-102425.png""!


it doesn’t have *neither* {{_c_DE39_PATTERN_STR=>'IN;00'}} *nor* {{_c_DE39_PATTERN_STR=>'SUCCESSFUL'}}.

So which of those two missing parameters should be added to meet the requirements ? ","29/Mar/24 4:33 PM;60fedd0cc51f3a00697da234;Hello [~accountid:61bcc3e5028e300068b66a25] [~accountid:5a4b476e2724d02a6fe27cfd] 
Can you please confirm [~accountid:6328729388ed2ebef978552f] ","01/Apr/24 10:54 AM;61bcc3e5028e300068b66a25;Hi [~accountid:6328729388ed2ebef978552f] , you need to tick *Approved or completed successfully*","08/Apr/24 2:52 PM;6328729388ed2ebef978552f;Hi [~accountid:61bcc3e5028e300068b66a25] ,
Does Pty DE39 override the original request DE39 for the declined advices in db and being counted as Approved ? means if the Advice Message request from MC is *declined DE39 is not = 00*  then Pty will process it and respond back to MC *by DE39 = 00* in this case the final DE39 value in the Rules Engine is 00-Approved , so the rule in this case will be triggered if the *Approved or completed successfully* is ticked . please correct me if i’m wrong here.

!image-20240408-125037.png|width=436,height=566,alt=""image-20240408-125037.png""!","08/Apr/24 7:04 PM;61bcc3e5028e300068b66a25;Hi [~accountid:6328729388ed2ebef978552f] , no, if txn is already declined then rule engine can’t approve it, i.e. respond with de39=00.","15/Apr/24 10:05 AM;6328729388ed2ebef978552f;Hi [~accountid:61bcc3e5028e300068b66a25] ,
So it means the declined Advice from the scheme , The Rule Engine doesn’t count it as *Approved or completed successfully* in current or history even if our decision is *00* as a final transaction decision  ?","18/Apr/24 6:19 PM;6328729388ed2ebef978552f;Hi [~accountid:61bcc3e5028e300068b66a25] ,

Used MAS simulator to simulate declined advices coming from MC as DE39=05 to test the new conditions of the rule , please find the result : 

Token = 960933979
All the Advices are declined from MC DE39 = 05
Monthly Limit Rule triggered in TID = 2664579419701827387 despite the DE39 = 05 from MC.
Rule ID = 3717
Rule Conditions : 

{code:xml}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'IN;01',
 _c_DE39_PATTERN_STR=>'IN;00', _h_DE3_1_PATTERN_STR=>'IN;01',
 _h_DE39_PATTERN_STR=>'IN;00', _h_datepart_diff=>2592000, _adjust_for_reversals=>FALSE, 
_aggregated_amount_OPERATION=>'>', _aggregated_amount_threshold_LIST=>'4000', 
_aggregated_amount_include_current=>TRUE){code}

!image-20240418-160923.png|width=1227,height=471,alt=""image-20240418-160923.png""!



!image-20240418-161517.png|width=1401,height=526,alt=""image-20240418-161517.png""!



!image-20240418-161615.png|width=1146,height=602,alt=""image-20240418-161615.png""!

*Environment : UAT*","19/Apr/24 1:36 PM;61bcc3e5028e300068b66a25;Hi [~accountid:6328729388ed2ebef978552f] , please read documentation with examples [https://paymentology.atlassian.net/wiki/spaces/TS/pages/6860996672/Banking.Live+Decision+Engine+Rule+Engine+V1.0#Templates-of-the-most-frequently-used-rules|https://paymentology.atlassian.net/wiki/spaces/TS/pages/6860996672/Banking.Live+Decision+Engine+Rule+Engine+V1.0#Templates-of-the-most-frequently-used-rules|smart-link]  and [https://paymentology.atlassian.net/wiki/spaces/TS/pages/7608764410/Public+function+UniversalCheck3|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7608764410/Public+function+UniversalCheck3|smart-link] ","19/Apr/24 1:43 PM;61bcc3e5028e300068b66a25;[~accountid:6328729388ed2ebef978552f] , it’s required to add pattern {{_c_MTID_PATTERN_STR=>'IN;0100'}} and {{_h_MTID_PATTERN_STR=>'IN;0100'}} to exclude advises. Please check my message before [https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=172437|https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=172437|smart-link] ","19/Apr/24 2:05 PM;6328729388ed2ebef978552f;Hi [~accountid:61bcc3e5028e300068b66a25] ,

Of course we can exclude the advices by putting the “MTI = 0100” condition as a filter , but this will not meet Mettle requirements mentioned [here |https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=174414]: 



{noformat}To be clear the behaviour I expect is:

- Approved auth advices DO count towards the rule

- Declined auth advices DO NOT count towards the rule

The example I shared was a declined auth advice. So I don't want them excluded, I just want approved ones only (i.e. ones that debited their balance) to be counted.{noformat}


Mettle asked to count the approved Advices as well. How can we filter the Advices (MTI=0120) for counting the approved ones and don’t count the declined ones ?","19/Apr/24 2:11 PM;6328729388ed2ebef978552f;[~accountid:61bcc3e5028e300068b66a25] , appreciate to share the updated Rule Conditions/Summary that covers the client requirements. this is the current conditions :  


{noformat}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'IN;01',
 _c_DE39_PATTERN_STR=>'IN;00', _h_DE3_1_PATTERN_STR=>'IN;01',
 _h_DE39_PATTERN_STR=>'IN;00', _h_datepart_diff=>2592000,
 _adjust_for_reversals=>FALSE, _aggregated_amount_OPERATION=>'>',
 _aggregated_amount_threshold_LIST=>'4000', _aggregated_amount_include_current=>TRUE){noformat}","19/Apr/24 2:24 PM;61bcc3e5028e300068b66a25;[~accountid:6328729388ed2ebef978552f] there are two txns at the same time with the same txn_id = {{2664579419701827387}} but different rid. Everything is correct. Txn wth rid = 2558816 has de39=00. Looks like there is a problem with the test. Please check screenshots.



!26.png|width=869,height=178,alt=""26.png""!



!25.png|width=880,height=55,alt=""25.png""!","19/Apr/24 2:45 PM;6328729388ed2ebef978552f;[~accountid:61bcc3e5028e300068b66a25] RID 2558816 is declined from MC Side DE39=05


!image-20240419-124457.png|width=1366,height=680,alt=""image-20240419-124457.png""!","19/Apr/24 3:00 PM;61bcc3e5028e300068b66a25;[~accountid:6328729388ed2ebef978552f] , ok, but rule engine is not looking into MC Side de39. Rule engine is receiving DE39 from PayPower and it’s DE39=00. Are you sure your test is correct?
Sql to check rule engine call log {{select * from log_paypower_trace where pp_tr_log_id = 187668834;}}
 [~accountid:60fedd0d7ab143006ea59f36] could you please advise about this? Why is {{_de39_post_1stchecks=00}} and {{_de39_nwk_in=05}} in rule engine call?","19/Apr/24 3:06 PM;60fedd0d7ab143006ea59f36;Hi [~accountid:61bcc3e5028e300068b66a25]  , for advisement case we set approved response code even if its a declined advisment from network side
we cannot set decline  response code for advisements , thats why 
{{de39_post_1stchecks= 00 }}  (paytok function acknowledging and approving the advisement) 
and {{_de39_nwk_in=05 }}( from network / scheme pointing that its a declined advisement) ",19/Apr/24 3:25 PM;61bcc3e5028e300068b66a25;[~accountid:6328729388ed2ebef978552f] looks like now it’s not possible to count approved only advises because on rule engine side they are all approved.,"19/Apr/24 4:15 PM;6328729388ed2ebef978552f;Thanks [~accountid:61bcc3e5028e300068b66a25] and [~accountid:60fedd0d7ab143006ea59f36] for your investigation.
[~accountid:61bcc3e5028e300068b66a25] there is no solution can be provided ? if yes , we should communicate this to the client 

cc : [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] FYI","22/Apr/24 9:55 AM;60fedd0cc51f3a00697da234;Hello [~accountid:5a4b476e2724d02a6fe27cfd] [~accountid:557058:4f540850-1319-42e3-9630-bc67cd95e8c2] 
This is a production issue. Can you please have a look with [~accountid:61bcc3e5028e300068b66a25] on this.","23/Apr/24 6:35 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , add historical pattern for MTID to avoid counting advises. This should solve the problem. If you give me the exact rule_function_call column value from T_FRAUD_RULES table for this rule, I can give you a fix.","23/Apr/24 7:08 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , please give me the exact rule function call from Production:

SELECT rule_function_call
FROM public.T_FRAUD_RULES
WHERE rule_id=3717;",23/Apr/24 7:43 PM;60fedd0cc51f3a00697da234;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] can you provide production data requested by Alex. ,"25/Apr/24 6:32 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:60fedd0cc51f3a00697da234] and [~accountid:6328729388ed2ebef978552f] , it would be great to get the rule function call, But without it, try the following to fix the problem with advices. Add the following pattern to the rule_function_call:

*_c_final_total_debit_PATTERN_STR=>'!=;0.00'*

Please let me know if this helps. If not, we will need to get deeper.","25/Apr/24 9:06 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Hello [~accountid:60fedcb88c15ca006ffc380f] [~accountid:60fedd0cc51f3a00697da234] [~accountid:6328729388ed2ebef978552f] 

[https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=182580|https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=182580]

{quote}_Hi_ [~accountid:6328729388ed2ebef978552f] _, please give me the exact rule function call from Production:_

_SELECT rule_function_call_
_FROM public.T_FRAUD_RULES_
_WHERE rule_id=3717;_{quote}



!image-20240425-185959.png|width=606,height=467,alt=""image-20240425-185959.png""!



SELECT rule_function_call
FROM public.T_FRAUD_RULES
WHERE rule_id=6;

{{public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'IN;01', _h_DE3_1_PATTERN_STR=>'IN;01', _h_DE39_PATTERN_STR=>'IN;00', _h_datepart_diff=>2592000, _aggregated_amount_OPERATION=>'>', _aggregated_amount_threshold_LIST=>'4000', _aggregated_amount_include_current=>TRUE)}}



Just in case, extracted whole T_FRAUD_RULES (attached)
[^61a63ff5-5c25-415f-96b6-f69c3790ec5c] ","26/Apr/24 3:47 PM;6328729388ed2ebef978552f;Thanks [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] 

[~accountid:60fedcb88c15ca006ffc380f] [~accountid:61bcc3e5028e300068b66a25] and this is the rule function call for the same rule but on *UAT* : 


{noformat}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'IN;01',
 _c_DE39_PATTERN_STR=>'IN;00', _h_DE3_1_PATTERN_STR=>'IN;01', 
_h_DE39_PATTERN_STR=>'IN;00', _h_datepart_diff=>2592000, 
_adjust_for_reversals=>FALSE, _aggregated_amount_OPERATION=>'>', 
_aggregated_amount_threshold_LIST=>'4000', _aggregated_amount_include_current=>TRUE){noformat}","26/Apr/24 3:49 PM;6328729388ed2ebef978552f;[~accountid:60fedcb88c15ca006ffc380f] [~accountid:61bcc3e5028e300068b66a25] what’s the logic for this condition : 
*_c_final_total_debit_PATTERN_STR=>'!=;0.00'*

_Note : the client is external ledger , means the account balance is not impacted on Pty._","30/Apr/24 6:04 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , this is too exclude contributions of “pure advises”","01/May/24 6:20 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f], [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] and [~accountid:6273fc10807e0000691d5dee] , here are the results of my investigation:

Rule ID 6. Rule function call:

public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'IN;01', _h_DE3_1_PATTERN_STR=>'IN;01', _h_DE39_PATTERN_STR=>'IN;00', _h_datepart_diff=>2592000, _aggregated_amount_OPERATION=>'>', _aggregated_amount_threshold_LIST=>'4000', _aggregated_amount_include_current=>TRUE)

*Transaction ID: 2603386278661214817*. Rule ID 6 was triggered and the transaction was declined with DE39=61.

Details:

SELECT de2, de4, de6, de7 FROM public.T_AUTH
WHERE rid = 3039663;
-- DE6 = 500
-- DE7 = 2024-02-17 10:43:47

Now,let’s look at transactions made 30 days back SATISFYING the rule function call conditions:

!image-20240501-154212.png|width=978,height=526,alt=""image-20240501-154212.png""!

As you can see, we already have 8 txns 500.00 each. The *2603386278661214817’s* transaction amount is 500.00, and the rule has this:

_aggregated_amount_include_current=>TRUE

Thus, all together we have 4500.00 aggregated amount that exceeds the threshold of 4000.00, and the *rule is triggered, as expected*.

Now, let’s look closer at those transactions. One of them is not Authorization , but an authorization advise (MTID=0120), and final_total_debit=0.00 for it.

Because rule function call has nothing about MTID or final_total_debit, this authorization advise was also counted. I believe this is the exact trouble.

Let us look at two other transactions and see if we have the same issue.



*Transaction ID: 2602604088661199185*

!image-20240501-155350.png|width=1002,height=704,alt=""image-20240501-155350.png""!

As you can see, the rule’s decision was made correctly. The same exact situation.

*Transaction ID: 2602603808661199169*



!image-20240501-155913.png|width=1049,height=744,alt=""image-20240501-155913.png""!

Again, the same reason.

*CONCLUSION: Rule 6 worked out as expected. No issues. It was just configured incorrectly.*

*SOLUTION:* The easiest way would be to skip counting advises. but this might be inappropriate in some cases, because sometimes advise is the only thing we are getting. But if the authorization was made based on auth advise only, then final_total_debit is non-zero in that case. Thus, we can include the following to the rule_function_call:

_h_final_total_debit_PATTERN_STR=>'!=;0.00'

I would also replace some IN operations by = to make the function working faster. Finally, for MasterCard, DE39=00 is not the only approval code. Here is the full list:



!image-20240501-161708.png|width=490,height=455,alt=""image-20240501-161708.png""!



As result, +*this is what I suggest:*+

public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'=;01', _h_DE3_1_PATTERN_STR=>'=;01', _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87', _h_final_total_debit_PATTERN_STR=>'!=;0.00', _h_datepart_diff=>2592000, _aggregated_amount_OPERATION=>'>', _aggregated_amount_threshold_LIST=>'4000', _aggregated_amount_include_current=>TRUE)

I hope this will help.

P.S.: This is the file I used for troubleshooting:

[^Mettle_DEFECT-399_01052024 (38ba3fde-4223-4c9f-b48f-7faf8d83847e).sql]

{color:#bf2600}*WARNING:*{color}{color:#bf2600} Indeed, the decline action for rule_id = 6 is NOT CONFIGURED in the public.p_actions_dec_txn table.{color}

SELECT * FROM public.p_actions_dec_txn
WHERE rule_id = 6;

{color:#bf2600}This means that Rule Engine will not assign correct DE39 code when processing the transaction. I noticed that only two rules have decline codes – rule_id = 1 and 10. This is not acceptable. This means that Rule Engine does not generate correct response codes. It seems like there is another mechanism in place to then save DE39 in the public.T_AUTH table, but missing configuration for Rule Engine is unacceptable. {color}{color:#bf2600}*Every rule that being triggered leads to transaction decline MUST have a record in the public.p_actions_dec_txn table.*{color}",03/May/24 4:23 PM;6273fc10807e0000691d5dee;Hi [~accountid:6328729388ed2ebef978552f] what’s the best next step here?,"03/May/24 5:02 PM;60fedd0cc51f3a00697da234;[~accountid:6273fc10807e0000691d5dee] earlier suggested solution didn't work.



Last solution provided by Alex, needs to be reconfigured by [~accountid:6328729388ed2ebef978552f]  and test again if that work. He'll pick us this task in coming week. Monday is also off for Mostafa. ","07/May/24 2:30 PM;6328729388ed2ebef978552f;Hi [~accountid:6273fc10807e0000691d5dee] ,

Checking the suggestion shared by Alex.


{noformat}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'=;01',
 _h_DE3_1_PATTERN_STR=>'=;01', _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87', 
_h_final_total_debit_PATTERN_STR=>'!=;0.00', _h_datepart_diff=>2592000,
 _aggregated_amount_OPERATION=>'>', 
_aggregated_amount_threshold_LIST=>'4000', _aggregated_amount_include_current=>TRUE){noformat}

Planning for the test execution..","09/May/24 11:03 AM;5a4b476e2724d02a6fe27cfd;Hi [~accountid:6328729388ed2ebef978552f] , were you able to check if the suggestion works?","09/May/24 11:54 AM;6328729388ed2ebef978552f;Hi [~accountid:5a4b476e2724d02a6fe27cfd] [~accountid:60fedcb88c15ca006ffc380f] ,
I see the suggested function call doesn’t contain __c_DE39_PATTERN_STR_ , it means it will only query on the historical transactions and will not consider the current transactions. any reason for that ?

{{public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'=;01', _h_DE3_1_PATTERN_STR=>'=;01', _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87', _h_final_total_debit_PATTERN_STR=>'!=;0.00', _h_datepart_diff=>2592000, _aggregated_amount_OPERATION=>'>', _aggregated_amount_threshold_LIST=>'4000', _aggregated_amount_include_current=>TRUE)}}","10/May/24 3:37 PM;6328729388ed2ebef978552f;Hi [~accountid:5a4b476e2724d02a6fe27cfd] [~accountid:60fedcb88c15ca006ffc380f] ,

We have tested the suggested call function , please find the result : 
- Declined Advices don’t trigger the Rule - *Expected* >> sample TID = 2686485049701550560
- Approved Advices don’t trigger the Rule as well - *Not Expected* >> sample TID = 2686485999701550560

I kept sending both approved and declined advices for the same token 677086878 with a high amounts to test the rule functionalities. but the rule hasn’t been triggered neither for the declined nor the approved.

- Rule ID = 3717
- Rule Description = Withdrawal Limit - Monthly
- Rule function call = 


{noformat}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'=;01',
 _h_DE3_1_PATTERN_STR=>'=;01', _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_final_total_debit_PATTERN_STR=>'!=;0.00', _h_datepart_diff=>2592000,
 _aggregated_amount_OPERATION=>'>', _aggregated_amount_threshold_LIST=>'20000',
 _aggregated_amount_include_current=>TRUE){noformat}

Note : i increased the limit threshold to 20000 instead of 4000 just for the testing purposes.

*Environment : Shared UAT*","10/May/24 4:52 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , you have to look at final_total_debit column in T_AUTH fpr those transactions. If it is 0.00, that means, it’s just advice and an AUTH will follow. So, if an advice (approved) has final_total_debit non-zero, we count it. But if it has 0,00 in final_total_debit, we don’t, Check this column and you will see  what it is. The rule works correctly.","10/May/24 6:18 PM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] ,
I don’t get you clearly. please elaborate more. i have no idea about the relation between the advice transaction amount and the final_total_debit column.
The approved advices i simulated have an amounts in DE4 and DE6 , means those advices will hit the card holder account balance and the limit rule should count them. this is the expected result.","10/May/24 6:22 PM;6328729388ed2ebef978552f;Mentioning here again the client requirements : 

* _Approved auth advices DO count towards the rule_
* _Declined auth advices DO NOT count towards the rule_","10/May/24 6:49 PM;6328729388ed2ebef978552f;[~accountid:60fedcb88c15ca006ffc380f] what’s this value in final_total_debit refers to ? can you please advise why the approved advices haven’t been counted towards the limit ? 


!image-20240510-164842.png|width=874,height=290,alt=""image-20240510-164842.png""!","13/May/24 9:49 AM;5a4b476e2724d02a6fe27cfd;[~accountid:6328729388ed2ebef978552f] I am afraid that this is about how the ISO protocol works. Approved advices may or may not be relevant depending on what happened before and the view our system has on it. For example, we could receive and approved advice for an authorisation that we already have in our system, you cannot simply assume that has to be counted because that would be duplicating the authorisation and blocking funds twice. You can see how it works here: 

{noformat}advice       auth        PP             final_debit_amount

success      success     do nothing     0
fail         success     revert         +X
success      fail        auth           -X
fail         fail        do nothing     0
success      missing     auth           -X
fail         missing     do nothing     0{noformat}

So {{final_debit_amount}} will tell us what happened to the ledger (the account) when that message was processed. That single message may not reflect the full picture for that transaction, because there may be other messages belonging to the same transaction.","13/May/24 9:55 AM;60fedd0cc51f3a00697da234;Hello [~accountid:5a4b476e2724d02a6fe27cfd] ,
Currently is it possible to solve it for Mettle? 
OR
You’ll need more time for development so Implementation can move forward?",13/May/24 10:03 AM;5a4b476e2724d02a6fe27cfd;[~accountid:60fedd0cc51f3a00697da234] Solve what exactly? I am just describing how the ISO 8583 protocol works.,"13/May/24 10:07 AM;60fedd0cc51f3a00697da234;[~accountid:5a4b476e2724d02a6fe27cfd] I meant, if solution is available to be implemented? because as per last Mostafa’s comment, looks like he is unable to include approved advices.","13/May/24 10:13 AM;5a4b476e2724d02a6fe27cfd;[~accountid:60fedd0cc51f3a00697da234] Well, this is fairly simple, if it is not supported then it is not a bug, it is a feature request. So it has to go via product, analysed, prioritised, etc. 

But other than that, counting something may or may not be a valid use case. What is the goal of counting approved advices here? ","13/May/24 12:21 PM;6328729388ed2ebef978552f;Hi [~accountid:5a4b476e2724d02a6fe27cfd] ,
_What is the goal of counting approved advices here?_

The approved advice should be counted because the scheme STIP already approved the transaction and replied back to acquirer by approval on behalf of the issuer, so the issuer should impact the balance of the card holder account. that’s why they should be counted towards the limit.

Besides , these are the client requirements. [here|https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=174414]

*Note  : Mettle is an external ledger client.*",13/May/24 1:48 PM;5a4b476e2724d02a6fe27cfd;[~accountid:6328729388ed2ebef978552f] Can you please check what the value in {{t_auth}} is for that advice where the rule wasn’t triggered in the column {{final_debit_amount}}? ,13/May/24 1:49 PM;6328729388ed2ebef978552f;[~accountid:5a4b476e2724d02a6fe27cfd] asking for a TID other than the one shared on this [comment|https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=185723] ? it was a sample of a TID didn’t trigger the rule.,"13/May/24 1:52 PM;5a4b476e2724d02a6fe27cfd;[~accountid:6328729388ed2ebef978552f] No, thanks, missed it. ","14/May/24 1:29 AM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] and [~accountid:5a4b476e2724d02a6fe27cfd] , I found that when {{_h_final_total_debit_PATTERN_STR}} is engaged, the aggregated amount and the number of historical transactions are both 0. This is a glitch. I’m working on fixing it.","15/May/24 6:38 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] and [~accountid:5a4b476e2724d02a6fe27cfd] , the problem is solved. I prepared MRs and they should be merged soon.

The root cause was in the C-Library, which worked incorrectly with patterns on {{final_total_debit}}

The solution you need to implement is the same: {{_h_final_total_debit_PATTERN_STR}}=>'!=;0.00'

but AFTER the new C Library *3.16,03* is deployed.","15/May/24 7:13 PM;557058:a01b4872-0086-4bc3-903e-23f26637afa2;-- This notification was sent from Zendesk Support ticket #703405 to all linked JIRA issues by Mauro Merino. --
Based on the last message on this JIRA ticket I see that a solution has been found. 

Do you have any ETA that can be provided to the client for when this fix will be deployed?

Regards","15/May/24 10:11 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:557058:a01b4872-0086-4bc3-903e-23f26637afa2] , the MR is merged into Master branch. Furthermore, I created a tag 3.16.3 for the C Library, but I’m not in charge of actual deployments. This is just a C-Library, no other changes are required. Please ask [~accountid:624730348678e900705bddcd] when it could be done. I hope this will help.","22/May/24 1:00 PM;5a4b476e2724d02a6fe27cfd;Hi [~accountid:60fedd388ad5b600707750e1] ,  do you perhaps know if there are any plans to upgrade Mettle soon? I am asking because we want to patch the right BL version to solve this issue, at the moment that is 2.9.10 (according to [https://paymentology.atlassian.net/wiki/spaces/TS/pages/6803882030/Production+Environment+Component+Versions|https://paymentology.atlassian.net/wiki/spaces/TS/pages/6803882030/Production+Environment+Component+Versions|smart-link] ) but if they are moving to a newer version like 2.10, we should probably aim that one instead.

//cc [~accountid:63c148ea94d18cbf6773411b] ","29/May/24 2:22 PM;6328729388ed2ebef978552f;[~accountid:5a4b476e2724d02a6fe27cfd] [~accountid:60fedcb88c15ca006ffc380f] Thanks , it’s fixed.

Please find the result : 

* Declined Advices didn’t trigger the Rule -  *Expected* >> sample TID = 2705413289701763182
* Approved Advices triggered the Rule - *Expected* >> sample TID = 2705413909701681361


* Rule ID = 3717
* Rule Description = Withdrawal Limit - Monthly
* Rule function call = 

{noformat}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'=;01',
 _h_DE3_1_PATTERN_STR=>'=;01', _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_final_total_debit_PATTERN_STR=>'!=;0.00', _h_datepart_diff=>2592000,
 _aggregated_amount_OPERATION=>'>', _aggregated_amount_threshold_LIST=>'20000',
 _aggregated_amount_include_current=>TRUE){noformat}

*Environment : Sh-UAT*



Hi [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] ,
Once the fix is deployed on the production environment , you need to add this condition in the function call of the concerned limits : 
{{_h_final_total_debit_PATTERN_STR=>'!=;0.00'}}

*Note : i executed the test cases on the monthly limit only.*","13/Jun/24 11:19 PM;60fedcb88c15ca006ffc380f;Thank you very much, [~accountid:6328729388ed2ebef978552f] !","08/Jul/24 12:29 PM;6328729388ed2ebef978552f;Hi [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] 
If there is no support is still needed , you can close the ticket.

Thanks.","09/Jul/24 10:51 AM;6273fc10807e0000691d5dee;Hi [~accountid:6328729388ed2ebef978552f] [~accountid:60fedcb88c15ca006ffc380f] Mettle have just asked the following question:

This issue impacts all rules, not just ATM specific. Can you clarify for me whether this fix only corrects the behaviour for ATM rolling spend or will it apply to non-ATM spend as well e.g. POS?","09/Jul/24 2:42 PM;6328729388ed2ebef978552f;Hi [~accountid:6273fc10807e0000691d5dee] 
The test cases were covering the *Advices* , the fix counts the approved advices and doesn’t count the declined ones regardless of the original transaction type (POS or ATM , or even manual or Ecommerce). [~accountid:60fedcb88c15ca006ffc380f] appreciate if you want to add any more info. here.
Thanks.","09/Jul/24 5:18 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6273fc10807e0000691d5dee] , this is because you have this in the rule function call:

{{_h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87'}}

It counts only successful historical transactions. If you want to count any, then remove this pattern.

On the other hand, this pattern

{{_h_DE3_1_PATTERN_STR=>'=;01'}}

makes it count only withdrawals.

LONG STORY SHORT: Please ask the client what EXACTLY they want this rule to do. Because it follows from the discussion that nobody knows how the rule has to work.","09/Jul/24 6:15 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6273fc10807e0000691d5dee] , please note that there is a subtle thing about the advises.

Usually, advise comes first (MTID=0120) and then real transaction (MTID=0100), but sometimes the whole txn is done as an advise.

So, how to distinguish a “pure” advise from the advise that in fact is a real transaction?

We have to look at final_total_debit.

A pure advise, has it 0.00, but if it’s non-zero, then it’s in fact a real transaction, and we have to count it despite MTID=0120.

You can look at all REAL transactions in T_AUTH. You will see this pattern, If final_total_debit is non-zero, this txn has to be counted.

The easiest way would be to add this pattern to the rule_function_call:

_h_MTID_PATTERN_STR=>'IN;0100,0400'

but this will result in missing those advises with non-zero *final_total_debit*.

I hope this will help.","10/Jul/24 11:21 AM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] ,

I just retried right now this Rule  : 


* Rule ID = 3717
* Rule Description = Withdrawal Limit - Monthly
* Rule function call =

{noformat}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'=;01',
 _h_DE3_1_PATTERN_STR=>'=;01', _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_final_total_debit_PATTERN_STR=>'!=;0.00', 
_h_datepart_diff=>2592000, _aggregated_amount_OPERATION=>'>',
 _aggregated_amount_threshold_LIST=>'4000', 
_aggregated_amount_include_current=>TRUE){noformat}

Testing Result  : 

* *Declined Withdrawal Advices* triggered the Rule - {color:#bf2600}*Not Expected*{color} >> TID = 2747333429701585185

I kept sending the same Declined Withdrawal advice till reaching the limit amount and the rule is triggered once the total amounts reached the limit amount. 

Query Result.

!image-20240710-093756.png|width=914,height=348,alt=""image-20240710-093756.png""!

Please check,

*Environment : Sh-UAT*","10/Jul/24 3:55 PM;557058:4f540850-1319-42e3-9630-bc67cd95e8c2;Hi [~accountid:60fedcb88c15ca006ffc380f] 

Regarding your feedback [here|https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=196178]. What would you then suggest for us to be able to have limits, which *exclude* zero amount advices and *include* the non-zero advices?","10/Jul/24 5:34 PM;60fedcb88c15ca006ffc380f;HI [~accountid:557058:4f540850-1319-42e3-9630-bc67cd95e8c2] and [~accountid:6328729388ed2ebef978552f] , let me look at the transactions first.

[~accountid:557058:4f540850-1319-42e3-9630-bc67cd95e8c2] , this pattern {{_h_final_total_debit_PATTERN_STR=>'!=;0.00',}} already does exactly what you requested, but it includes non-zero amount transactions too, not only advises.","10/Jul/24 6:03 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , this is what is in T_AUTH:



!image-20240710-155132.png|width=908,height=854,alt=""image-20240710-155132.png""!

We have the same Transaction ID (2747333429701585185) and TWO RIDs. Every RID goes through the Rule Engine separately.  Look here now:



!image-20240710-155356.png|width=2322,height=788,alt=""image-20240710-155356.png""!

Thus, RID 2578135 triggered the rule 3717. Now, DE39 for this RID is 00 which by the way means that the rule had no proper action configured.

Now, looking at current txn’s DE39 is usually senseless. You don’t know if the transaction will be approved or declined yet (at the moment when you are checking rules).

{color:#bf2600}So, the requirement is not to count {color}{color:#bf2600}*historical*{color}{color:#bf2600} declined Advises. That’s it.{color}

Let me give you a little bit more in the first query:



!image-20240710-155934.png|width=966,height=592,alt=""image-20240710-155934.png""!

So, in fact, all the advises were kind of pure advises. We should not count them at all. Because usually those advises are followed by authorizations.

So, in fact, the rule was triggered by RID 2578135 because of its amount was greater than the threshold. And this is correct, because if you try to spend that much, the transaction has to be declined.

[~accountid:6328729388ed2ebef978552f] , please just try to think about a real situation and understand what you are testing.

I think the rule works 100% correctly.","12/Jul/24 9:43 AM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] 

The *withdrawal Advice transaction* TID = {{2747333429701585185}}with RID = {{2578135}} is already *declined* from MC (please check DE39 = 05 in the incoming message from MC simulator)

!image-20240712-073716.png|width=1407,height=614,alt=""image-20240712-073716.png""!

Despite it’s already coming declined from MC , counted and the Withdrawal Rule has been triggered 

!image-20240712-074102.png|width=1441,height=546,alt=""image-20240712-074102.png""!

* *Rule ID = 3717*
* *Rule Description = Withdrawal Limit - Monthly*
* *Rule function call =*

{noformat}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'=;01',
 _h_DE3_1_PATTERN_STR=>'=;01', _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_final_total_debit_PATTERN_STR=>'!=;0.00', 
_h_datepart_diff=>2592000, _aggregated_amount_OPERATION=>'>',
 _aggregated_amount_threshold_LIST=>'4000', 
_aggregated_amount_include_current=>TRUE){noformat}","12/Jul/24 11:45 AM;6328729388ed2ebef978552f;*Requirements :*

* _Approved auth advices DO count towards the rule_
* _Declined auth advices DO NOT count towards the rule_","13/Jul/24 5:00 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , if you are too bothered by this, you can add this

{{_c_DE39_PATTERN_STR=>'NOT IN;00,08,10,11,85,87'}}

Then rule will not be triggered if the transaction came with the decline code already.

HOWEVER, keep this in mind: No matter what, but if a txn came with decline code, the Rule Engine will not approve it even if zero rules were triggered.

This is because the resultant DE39 is computed based on severity on the initial DE39 and DE39 values configured for triggered rules.

So, nothing bad will happen. Txn will be declined anyhow.

Thus, I would leave the rule as it is.","15/Jul/24 10:11 AM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] ,

Please confirm if this should be the function call for the *Withdrawal Monthly Limit* that will meet the requirements  , i added c_DE39_ you have suggested.

{{public.f_UniversalCheck3E(<CTP>,}}
{{ _c_DE3_1_PATTERN_STR=>'=;01',}}
{{ _h_DE3_1_PATTERN_STR=>'=;01',}}
{{ _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',}}
{{ _h_final_total_debit_PATTERN_STR=>'!=;0.00',}}
{{ _h_datepart_diff=>2592000,}}
{{ _aggregated_amount_OPERATION=>'>',}}
{{ _aggregated_amount_threshold_LIST=>'4000',}}
{{ _aggregated_amount_include_current=>TRUE}}
{{ _c_DE39_PATTERN_STR=>'NOT IN;00,08,10,11,85,87')}}


*Requirements :*

* _Approved auth advices DO count towards the rule_
* _Declined auth advices DO NOT count towards the rule_","15/Jul/24 4:31 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , adding pattern for c_DE39_PATTERN_STR is pretty questionable. This won’t hurt but might potentially raise questions.

Even without this pattern, for historical data, successful advises (actually, any successful txns) are counted against the rule and unsuccessful advises are not.

With this pattern, you make the rule never triggered if the current txn already got declined code. If this is OK, then go ahead.","15/Jul/24 5:05 PM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] I don’t get you clearly , i am asking now about an exact function call that should meet the requirements.

Can you please give us the exact *Rule function Call* for the Withdrawal monthly limit at least ?","15/Jul/24 6:00 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , it depends on one little thing:

When an ALREADY DECLINED txn (say, with DE39='05') is coming, and we want the rule to be triggered or not (depending on the historical data), then this is the rule function call:

{{public.f_UniversalCheck3E(<CTP>,}}
{{ _c_DE3_1_PATTERN_STR=>'=;01',}}
{{ _h_DE3_1_PATTERN_STR=>'=;01',}}
{{ _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',}}
{{ _h_final_total_debit_PATTERN_STR=>'!=;0.00',}}
{{ _h_datepart_diff=>2592000,}}
{{ _aggregated_amount_OPERATION=>'>',}}
{{ _aggregated_amount_threshold_LIST=>'4000',}}
{{ _aggregated_amount_include_current=>TRUE}})

If the declined transaction has NOT to trigger the rule no matter what, then

{{public.f_UniversalCheck3E(<CTP>,}}
{{ _c_DE3_1_PATTERN_STR=>'=;01',}}

{{_c_DE39_PATTERN_STR=>'NOT IN;00,08,10,11,85,87',}}
{{ _h_DE3_1_PATTERN_STR=>'=;01',}}
{{ _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',}}
{{ _h_final_total_debit_PATTERN_STR=>'!=;0.00',}}
{{ _h_datepart_diff=>2592000,}}
{{ _aggregated_amount_OPERATION=>'>',}}
{{ _aggregated_amount_threshold_LIST=>'4000',}}
{{ _aggregated_amount_include_current=>TRUE}})

will do the job.

You might ask the client on what’s better for them","16/Jul/24 11:06 AM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] 
BOTH Rule functions don’t meet the requirements.

*Rule #1 :* 
Testing Result is [here |https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=196301]

*Rule #2 :* 
Testing Result : 

* TID = 2753314679701668111 (*Declined Withdrawal Advices* - incoming DE39 = 05 )  - Didn’t trigger the Rule >> *Expected*

!image-20240716-090610.png|width=1341,height=237,alt=""image-20240716-090610.png""!

* TID = 2753321159701668111 (*Approved Withdrawal Advices* - Incoming DE39 = 00 ) - Didn’t trigger the rule >> *Not Expected*

!image-20240716-090830.png|width=1341,height=276,alt=""image-20240716-090830.png""!","16/Jul/24 11:09 AM;6328729388ed2ebef978552f;Mentioning the requirements here again 

*Requirements :*

* _Approved auth advices DO count towards the rule_
* _Declined auth advices DO NOT count towards the rule_","16/Jul/24 3:42 PM;6328729388ed2ebef978552f;Hi [~accountid:5a4b476e2724d02a6fe27cfd] [~accountid:60fedcb88c15ca006ffc380f] ,
Can you please give us a rule function call can meet the client requirements ? i don’t mind if we can set a call to test and troubleshoot together in order to speed up the process for creating a valid function call meet the requirements.","16/Jul/24 10:43 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f], let’s make it easy. This

 rule function call corresponds to the requirements:

{{public.f_UniversalCheck3E(<CTP>,}}
{{ _c_DE3_1_PATTERN_STR=>'=;01',}}

{{_c_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',}}
{{ _h_DE3_1_PATTERN_STR=>'=;01',}}
{{ _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',}}
{{ _h_final_total_debit_PATTERN_STR=>'!=;0.00',}}
{{ _h_datepart_diff=>2592000,}}
{{ _aggregated_amount_OPERATION=>'>',}}
{{ _aggregated_amount_threshold_LIST=>'4000',}}
{{ _aggregated_amount_include_current=>TRUE}})","17/Jul/24 2:10 PM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] ,

Please find the initial testing results for the last suggested Rule Function : 


{{public.f_UniversalCheck3E(<CTP>,}}
{{ _c_DE3_1_PATTERN_STR=>'=;01',}}

{{_c_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',}}
{{ _h_DE3_1_PATTERN_STR=>'=;01',}}
{{ _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',}}
{{ _h_final_total_debit_PATTERN_STR=>'!=;0.00',}}
{{ _h_datepart_diff=>2592000,}}
{{ _aggregated_amount_OPERATION=>'>',}}
{{ _aggregated_amount_threshold_LIST=>'50000',}}
{{ _aggregated_amount_include_current=>TRUE}})

*Note : I increased the threshold limit to* {color:#bf2600}*50K* {color}*for testing purposes*

- TID = 2754430349701852967 - Declined Withdrawal Advice (DE39=05) with billing amount 14K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
- TID = 2754430209701852967 - Declined Withdrawal Advice (DE39=05) with billing amount 14K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
- TID = 2754430119701852967 - Declined Withdrawal Advice (DE39=05) with billing amount 14K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
- TID = 2754430089701852967 - Declined Withdrawal Advice (DE39=05) with billing amount 14K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
- TID = 2754430059701852967 - Declined Withdrawal Advice (DE39=05) with billing amount 14K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
- TID = 2754430909701852967 - Declined Withdrawal Advice (DE39=05) with billing amount {color:#bf2600}*51K*{color} >> {color:#bf2600}Triggered the rule{color} - *Not Expected*

More details about the TID = 2754430909701852967 >> {color:#bf2600}*51K*{color} >> {color:#bf2600}Triggered the rule{color}

*Incoming Declined advice Message from MasterCard* 


{noformat}0A030199001D01110B1019518AA31B13DF86DD894C0271784DA80C0230190903537312000A01124071711581065539

CustomHeader{arqc=9, cvv=0, aav=9, cvvType=1, mac=0, rid=1124071711581065539}

de2: 537312xxxxxxxxxx
de3: 010000
de4: 000001090020
de6: 000005100000
de7: 0717115810
de10: 64678813
de11: 852967
de12: 115810
de13: 0717
de14: xxxx
de15: 0717
de16: 0717
de18: 6011
de22: 900
de23: 000
de32: 999701
de35: 537312xxxxxxxxxxD27032210000000000xxx
de37: 080001000104
de39: 05
de41: 12345678
de42: 123456789012345
de43: Merchant name          Merchant city GBR
de48: Z
de49: 840
de51: 826
de60: 1010011
de61: 000000000120084090210-1234
de63: MCCMCCEWCKQW
de121: 000001{noformat}

*Rule Engine Call :* 


{noformat}HikariProxyCallableStatement@1197508563 wrapping call public.proc_ppwr_ruleengine_v10(('0120'),('464987469'::int8),('010000'),('000001090020'),(NULL),('000005100000'),('0717115810'),(NULL),(NULL),('64678813'),('852967'),('115810'),('0717'),('0717'),('0717'),('6011'::int4),(NULL),(NULL),(NULL),('900'),(NULL),(NULL),(NULL),(NULL),(NULL),(NULL),('999701'),(NULL),('080001000104'),(NULL),('12345678'),('123456789012345'),('Merchant name          Merchant city GBR'),(NULL),(NULL),(NULL),(NULL),('840'),(NULL),('826'),(NULL),(NULL),('1010011'),('000000000120084090210-1234'),(NULL),('MCCMCCEWCKQW'),(NULL),('216'),('-1'::int2),('537312'),('2579949'::int8),('2754430909701852967'::int8),('438126'::int8),('20240717115810'),('00'),('05'),('20240717115810'),('1005'::int2),('2378463587575280056'::int8),('8388608'::int8),('0'),(NULL),('1'::int2),('TRUE'),('5000'::int8),('2000'::int8),('0.01'::real),('SIMPLE'),('TRUE'),(NULL),('M'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?){noformat}","17/Jul/24 4:10 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , in any case, if the rule is triggered, then the current txn gets declined and then next time when the rule is checked, this declined txn will NOT be counted against the aggregated amount.","17/Jul/24 4:23 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , ticket is created to figure out why Rule Engine is receiving DE39 value NULL:

[https://paymentology.atlassian.net/browse/DEFECT-1419|https://paymentology.atlassian.net/browse/DEFECT-1419|smart-link] 

I looked at the transaction with TxnID = 2754430909701852967 and figured out the following: in the proc_ppwr_ruleengine_v10, the parameter *_de39_post_1stchecks* submitted had value ‘00’. I was wrong saying NULL. Sorry. I looked at a wrong parameter. So, now we know what had happened.","19/Jul/24 10:37 AM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] 

based on this [confirmation |https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=197973]we reserved the MAS simulator to resume testing today the other approved/declined cases to validate what’s exactly being counted and what’s not

Meanwhile , we should fix the DE39 parameter you opened a ticket for it’s wrong behavior. cc : [~accountid:6273fc10807e0000691d5dee] fyi","19/Jul/24 3:45 PM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] ,
We kept simulating the *Approved Withdrawal Advices* to make sure that the *Declined withdrawal Advice* hadn’t been counted towards the Rule , and YES it’s not counted as the *next Approved Withdrawal Advice* didn’t trigger the Rule.

- TID = 2756463589701898188 - Approved Withdrawal Advice (DE39 = 00) with billing amount 16K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*

- TID = 2756463629701898188 - Approved Withdrawal Advice (DE39 = 00) with billing amount 16K >> {color:#006644}*Trigger the Rule*{color} - *Expected*

So we have only one defect now which is the one you reported. [~accountid:6273fc10807e0000691d5dee] {color:#ff5630}we have only one scenario that may confuse Mettle which simply is when a declined advice transaction by an amount higher than the rule maximum limit amount they will see the Rule is triggered but in fact this declined advice transaction is not counting towards the rule.{color}

This applies to Withdrawals , purchases or any limit type regardless of the transaction type.

*Next steps should be :*

1- Advanced Support team should apply this Rule Function to the *Withdrawal Monthly Limit* : 
{{public.f_UniversalCheck3E(<CTP>,}}
{{ _c_DE3_1_PATTERN_STR=>'=;01',}}

{{_c_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',}}
{{ _h_DE3_1_PATTERN_STR=>'=;01',}}
{{ _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',}}
{{ _h_final_total_debit_PATTERN_STR=>'!=;0.00',}}
{{ _h_datepart_diff=>2592000,}}
{{ _aggregated_amount_OPERATION=>'>',}}
{{ _aggregated_amount_threshold_LIST=>'4000',}}
{{ _aggregated_amount_include_current=>TRUE}})

2- [~accountid:60fedcb88c15ca006ffc380f] to provide a rule function but for the POS [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] please share here the current Rule function running on Prod. for the POS so that Alex can adjust it to meet the client requirements

3- Mettle to confirm if the highlighted defect in red above doesn’t impact negatively on their analytics. and we should follow up for the defect closure.","20/Jul/24 12:42 AM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , it turned out that we are not using DE39 codes which are coming from the network at all. We are using DE39 codes coming from PayTok validation. As [~accountid:629a26eba0eafd0069ea2343] mentioned, for a declined advise, those can be different.

If we try to fix this, too many rules in different environment might be affected, so, let’s better avoid this.

So, let’s leave the rule as it is. In such a way, a declined advise (CURRENT transaction detail) might trigger the rule, but the transaction should anyhow be declined. So, I don’t see a problem. We don’t count declined advises in historical transactions anyhow.

I hope this will work well in production.","22/Jul/24 9:06 AM;6328729388ed2ebef978552f;Hi [~accountid:60fedcb88c15ca006ffc380f] 
It depends on the confirmation from Mettle as i mentioned in the point no.3 in my last comment.

[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] please share the POS monthly limit Rule Function on production which mettle need to adjust. also please find the Updated Rule Function call for the ATM monthly limit [here|https://paymentology.atlassian.net/browse/DEFECT-399?focusedCommentId=198433]

cc : [~accountid:6273fc10807e0000691d5dee] ","22/Jul/24 5:15 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , as suggested by [~accountid:5a4b476e2724d02a6fe27cfd] , please add this to the rule_function_call:

{{_c_final_total_debit_PATTERN_STR=>'!=;0.00',}}

I hope this will solve the problem. The rule won’t be triggered on any “pure” advise.","22/Jul/24 9:49 PM;60fedd0cc51f3a00697da234;[~accountid:60fedcb88c15ca006ffc380f] as per our chat,  once you've tested this function. Only then implementation will start looking into this.","23/Jul/24 9:53 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:60fedcb88c15ca006ffc380f] [~accountid:6328729388ed2ebef978552f] 

This is the rule function for rule id 6:

{quote}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'IN;01', _h_DE3_1_PATTERN_STR=>'IN;01', _h_DE39_PATTERN_STR=>'IN;00', _h_datepart_diff=>2592000, _aggregated_amount_OPERATION=>'>', _aggregated_amount_threshold_LIST=>'4000', _aggregated_amount_include_current=>TRUE){quote}



!image-20240723-195201.png|width=1704,height=831,alt=""image-20240723-195201.png""!



And this is the one for POS, rule ID 4:



!image-20240723-195225.png|width=1708,height=819,alt=""image-20240723-195225.png""!





!image-20240723-195253.png|width=1695,height=815,alt=""image-20240723-195253.png""!

{quote}public.f_UniversalCheck3E(<CTP>, _c_DE3_1_PATTERN_STR=>'IN;00', _h_DE3_1_PATTERN_STR=>'IN;00', _h_DE39_PATTERN_STR=>'IN;00', _h_datepart_diff=>2592000, _aggregated_amount_OPERATION=>'>', _aggregated_amount_threshold_LIST=>'50000', _aggregated_amount_include_current=>TRUE){quote}

CC: [~accountid:6273fc10807e0000691d5dee] ","23/Jul/24 10:34 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] , these are old ones I suspect. What you have to have for ATM is:

public.f_UniversalCheck3E(<CTP>,
	_c_DE3_1_PATTERN_STR=>'=;01',
	_c_final_total_debit_PATTERN_STR=>'!=;0.00',
	_c_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
	_h_DE3_1_PATTERN_STR=>'=;01',
	_h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
	_h_final_total_debit_PATTERN_STR=>'!=;0.00',
	_h_datepart_diff=>2592000,
	_aggregated_amount_OPERATION=>'>',
	_aggregated_amount_threshold_LIST=>'4000',
	_aggregated_amount_include_current=>TRUE);

The one for POS should look pretty similar.

I prepared unit tests for this one:

[^test_case_re_f_UniversalChec3E_advises.sql]
[^test_teardown_re_f_UniversalCheck3E_advises.sql]
[^test_setup_re_f_UniversalCheck3E_advises.sql]

Hi [~accountid:6328729388ed2ebef978552f] and [~accountid:5a4b476e2724d02a6fe27cfd] , I hope these tests will show that the function works as intended.","23/Jul/24 10:37 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , essentially, for the current transaction, we rely on final_total_debit to find out if it was already declined or not.","24/Jul/24 7:08 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , after further investigation…. please exclude _c_final_total_debit_PATTERN_STR=>'!=;0.00'.

So, the rule function call should be:

*public.f_UniversalCheck3E(<CTP>,*
*_c_DE3_1_PATTERN_STR=>'=;01',*
*_c_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',*
*_h_DE3_1_PATTERN_STR=>'=;01',*
*_h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',*
*_h_final_total_debit_PATTERN_STR=>'!=;0.00',*
*_h_datepart_diff=>2592000,*
*_aggregated_amount_OPERATION=>'>',*
*_aggregated_amount_threshold_LIST=>'4000',*
*_aggregated_amount_include_current=>TRUE)*

I prepared update unit tests and placed them in an MR for Master branch.

The tests are:

tests.test_setup_re_f_UniversalCheck3E_advises()

tests.test_case_re_f_UniversalCheck3E_advises()

tests.test_teardown_re_f_UniversalCheck3E_advises()

They should be executed in this order in case you will want to run them locally.","25/Jul/24 5:10 AM;60fedcb88c15ca006ffc380f;Hi [~accountid:6328729388ed2ebef978552f] , to make it clear, we cannot rely on the fact if the current transaction was already declined or not. And this is not important,

If it was already declined, it will stay declined no matter if the rule was triggered or not.

If it was not declined then the rule will correctly evaluate the limit and decline the txn if it’s over the limit.","26/Jul/24 4:39 PM;6328729388ed2ebef978552f;Hi [~accountid:5a4b476e2724d02a6fe27cfd] 

*Suggested POS Monthly function Call - Testing Results :* 

_POS Monthly - Function Call :_ 


{noformat}public.f_UniversalCheck3E(<CTP>,
  _c_DE3_1_PATTERN_STR=>'IN;00',
  _c_DE39_PATTERN_STR=>'SUCCESSFUL',
  _h_DE3_1_PATTERN_STR=>'IN;00',
  _h_DE39_PATTERN_STR=>'SUCCESSFUL',
  _h_final_total_debit_PATTERN_STR=>'!=;0.00',
  _h_datepart_diff=>2592000,
  _aggregated_amount_OPERATION=>'>',
  _aggregated_amount_threshold_LIST=>'50000',
  _aggregated_amount_include_current=>TRUE){noformat}

*Testing Results :* 


* TID = 2763471639701955473 - Declined Purchase Advice (DE39=05) with billing amount 26K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
* TID = 2763471669701955473 - Declined Purchase Advice (DE39=05) with billing amount 26K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
* TID = 2763473309701955473 - Declined Purchase Advice (DE39=05) with billing amount {color:#bf2600}*55K*{color} >> {color:#bf2600}Triggered the rule{color} - {color:#bf2600}*Not Expected (Same Defect)*{color}
* TID = 2763499409701811772 - Approved Purchase Advice (DE39 = 00) with billing amount 10K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
* TID = 2763499449701811772 - Approved Purchase Advice (DE39 = 00) with billing amount 10K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
* TID = 2763499489701811772 - Approved Purchase Advice (DE39 = 00) with billing amount 10K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
* TID = 2763499529701811772 - Approved Purchase Advice (DE39 = 00) with billing amount 10K >> {color:#006644}Didn’t Trigger the Rule{color} - *Expected*
* TID = 2763499599701811772 - Approved Purchase Advice (DE39 = 00) with billing amount 10K >> {color:#006644}*Trigger the Rule*{color} - *Expected*

[~accountid:5a4b476e2724d02a6fe27cfd]  please share if there will be any plan to fix the reported Defect. 

Hi [~accountid:6273fc10807e0000691d5dee] 
We have now both Monthly POS and Monthly ATM Rules are ready , pending action is : 
- Mettle to confirm if this scenario don’t impact negatively their analytics if we applied the new suggested Rule functions (ATM and POS). {color:#bf2600}*Defect Description :* {color}{color:#bf2600}we have only one scenario may confuse Mettle which simply is when a declined advice transaction ( by an amount higher than the rule maximum limit amount ) Mettle will see the Rule is triggered but in fact this declined advice transaction is not counting towards the rule{color}


Hi [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] 

The new functions that should be deployed once mettle confirm to proceed : 


{color:#403294}*_POS Monthly - Function Call :_* {color}

{noformat}public.f_UniversalCheck3E(<CTP>,
  _c_DE3_1_PATTERN_STR=>'IN;00',
  _c_DE39_PATTERN_STR=>'SUCCESSFUL',
  _h_DE3_1_PATTERN_STR=>'IN;00',
  _h_DE39_PATTERN_STR=>'SUCCESSFUL',
  _h_final_total_debit_PATTERN_STR=>'!=;0.00',
  _h_datepart_diff=>2592000,
  _aggregated_amount_OPERATION=>'>',
  _aggregated_amount_threshold_LIST=>'50000',
  _aggregated_amount_include_current=>TRUE){noformat}


{color:#403294}*_ATM Monthly - Function Call :_* {color}


{noformat}public.f_UniversalCheck3E(<CTP>,
 _c_DE3_1_PATTERN_STR=>'=;01',
 _c_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_DE3_1_PATTERN_STR=>'=;01',
 _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_final_total_debit_PATTERN_STR=>'!=;0.00',
 _h_datepart_diff=>2592000,
 _aggregated_amount_OPERATION=>'>',
 _aggregated_amount_threshold_LIST=>'4000',
 _aggregated_amount_include_current=>TRUE){noformat}","26/Jul/24 4:50 PM;5a4b476e2724d02a6fe27cfd;Hi[~accountid:6328729388ed2ebef978552f], as discussed on slack, that can hardly be considered as a DEFECT. It’s simply a complex behaviour of the system. I’ll paste my explanation here to keep everyone on the same page: 

{panel:bgColor=#deebff}
{{final_total_debit}}  is meant to tell us how a transaction affected our balance. So if it made any difference to the account or not. We have seen that the parameter {{_c_final_total_debit_PATTERN_STR}} isn’t reliable, because when rules are evaluated, that value is not known yet. Let’s quickly summarise the processing flow (this isn’t too accurate, just a short overview):

* Initial validations
* Rules evaluation
* FAST / ledger call
* Final total debit and response calculated
* Record added to the rule engine history
* Response sent to network

So we cannot know the {{final_total_debit}} , for the current transaction, but we know it for the transactions in the history.That means that adding that parameter isn’t too useful, and we should probably remove it from the documentation.Now why was final total debit important in the first place. Because we may receive multiple messages for the same transaction that will repeat the same information. For example, we could receive an advice for an authorisation we never received (and it shouldn’t make a difference to the balance), or we could receive multiple reversals for the same auth. So the only way to tell how a transaction affected the balance is with that amount. That is telling us the amount we have to remove from the limits for every message in the history.So what was the problem we identified (from the above scenario):3. Declined advice -> 20 (triggered - NOK)We are getting a negative advice that is telling our system, you got an authorisation and it was finally declined by the network. When we evaluate the transaction we don’t know yet how that advice is going to influence the balance, (did we really get the intial authorisation?), now whenever it is added to the history, the {{final_total_debit}} will be the right one:
0        -  if the negative advice didn’t make a difference (eg: the auth was never received, or it was reversed)
+ X    -  if the negative advice made a difference (we returned money back to the card)So after that, we will get the right info from that advice in the history.Now what happens with the advice itself. When we evaluate it, we cannot tell what difference it will make to the card, so the only possibility is taking the amount it brings. That means that it will trigger the rule because it will cross the limit. If we are using this rule to decline the transaction, the consequence is that rule engine will tell PayPower that the advice has to be declined. But that’s not going to happen anyway, it is an advice, so we our system cannot decline it. Long story short, triggering that makes no difference.
Of course, the original authorisation this advice links to, is not going to be affected by anything we do with this message [http://either.In|http://either.In|smart-link]  summary, it should work as expected, it’s just hard to tell why that triggers.One last remark, if we wanted to use that for anything else than declining (eg: charging a fee), that could be an issue, because that rule triggered by an advice would produce undesired effects. But at this point we would probably recommend not including advices in the rule.
{panel}

With that in mind, RE is working as designed and I would keep the same behaviour unless there is a strong requirement to change it. Let’s remember that changing that behaviour is an improvement, and that’s why I say that this shouldn’t be considered as a DEFECT. My main concern about the change and the main reason why I am trying to avoid it, is that it may introduce a lot of complexity and unclarity around the DE39 info available in RE, to cover a pretty concrete scenario that may not have any real impact. 

In summary, the plan on our side is waiting for Mettle’s feedback and analysing further if it was needed.","26/Jul/24 4:56 PM;6328729388ed2ebef978552f;Hi [~accountid:5a4b476e2724d02a6fe27cfd] Thanks for the explanation , so the action that should be taken now is to force the client to accept this behavior as we don’t have any other option right now.  If yes , so it’s up to Client Services team and Mettle.
The Monthly function calls for both POS and ATM that should be configured on production are mentioned in my last comment with the testing results.

Thank you.

cc : [~accountid:60fedd0cc51f3a00697da234]","26/Jul/24 5:09 PM;60fedd0cc51f3a00697da234;Hello [~accountid:6273fc10807e0000691d5dee] ,

Please have a look at Luis comment where it is suggested to inform client to accept this behavior or raise a new PRODUCT Request.",31/Jul/24 1:29 PM;6273fc10807e0000691d5dee;Hi [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] can you please confirm all of the transaction types that count towards this limit? This logic would apply to all transaction limits so need to be sure that this isn’t confined to just POS and ATM,"09/Aug/24 1:49 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Hello [~accountid:6273fc10807e0000691d5dee] , 

Apologies for the delay, I had to go thru all comments to try to understand your question.

Rules mentioned here use in their setup the *_processing codes_* (DE3_1) as *Purchase* (00) or *Withdrawal* (01), so those are all transaction types. 

For instance, Puchase with Cash Back (09), Deposit (21), and Payment (28) are excluded, i. e., rules do not apply to them, client would have to create or request us to created rules for those transactions.

As far I understood the problem, the behavior reported here happens regardless of the processing code (transaction).",16/Aug/24 11:08 AM;6273fc10807e0000691d5dee;Hi [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] [~accountid:6328729388ed2ebef978552f] has this been deployed to prod yet?,"19/Aug/24 11:38 AM;6273fc10807e0000691d5dee;After discussing with Mostafa there is more action on this to enabling this fix for daily rules:



1- [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955]  can you please share all the rules are running for Mettle on Production
2- [~accountid:60fedcb88c15ca006ffc380f]  can you please provide the new function call for the rest of the rules","21/Aug/24 1:59 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:6273fc10807e0000691d5dee] , attached you find the extract from t_fraud_rules.

So this is still handled as a bug or a change request will be placed?

As discussed, AS does not have feasibility of the changes nor access to UAT.



!image-20240820-235542.png|width=41.66666666666667%,alt=""image-20240820-235542.png""!



[^t_fraud_rules.csv]

","22/Aug/24 4:46 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;[~accountid:60fedcb88c15ca006ffc380f] , [~accountid:6328729388ed2ebef978552f] 



Data copied from PROD:



Single Contactless max value limit - Rule ID 7

**

public.f_UniversalCheck3E(<CTP>, _c_amount_OPERATION=>'>', _c_DE6_threshold_LIST=>'100.00', _c_DE22_1_PATTERN_STR=>'IN;07,91', _c_txn_check_results_bitmaps=>ARRAY[0,288230376151711744], _c_txn_check_results_LOGICs=>ARRAY['OR','AND'], _c_txn_checks_pattern_only=>TRUE, _adjust_for_reversals=>FALSE)



Single Contactless max value limit - Rule ID 13

**

public.f_UniversalCheck3E(<CTP>, _c_amount_OPERATION=>'>', _c_DE6_threshold_LIST=>'100', _c_DE22_1_PATTERN_STR=>'IN;07,91', _adjust_for_reversals=>FALSE)",24/Aug/24 10:56 PM;60fedd0cc51f3a00697da234;[~accountid:6273fc10807e0000691d5dee] have you raised Product request?,27/Aug/24 3:14 PM;6273fc10807e0000691d5dee;No need [~accountid:60fedd0cc51f3a00697da234] Mettle accepted the behaviour as is and product said to change this would be to re-write our entire rules engine. Next step is to extend this to all Mettle limits to production,"10/Sep/24 8:42 AM;60fedd388ad5b600707750e1;[~accountid:6328729388ed2ebef978552f] [~accountid:60fedcb88c15ca006ffc380f] ,

As per our call i have modified the below rules please review and confirm to apply in Production.

1.POS Monthly Copy from UAT

 public.f_UniversalCheck3E(<CTP>,
  _c_DE3_1_PATTERN_STR=>'=;00',
  _c_DE39_PATTERN_STR=>'SUCCESSFUL',
  _h_DE3_1_PATTERN_STR=>'=;00',
  _h_DE39_PATTERN_STR=>'SUCCESSFUL',
  _h_final_total_debit_PATTERN_STR=>'!=;0.00',
  _h_datepart_diff=>2592000,
  _aggregated_amount_OPERATION=>'>',
  _aggregated_amount_threshold_LIST=>'50000',
  _aggregated_amount_include_current=>TRUE)

 2.POS Weekly changed the h_datepart_diff=604800 and aggregated_amount_threshold_LIST=20000 in the Monthly function.

 public.f_UniversalCheck3E(<CTP>,
  _c_DE3_1_PATTERN_STR=>'=;00',
  _c_DE39_PATTERN_STR=>'SUCCESSFUL',
  _h_DE3_1_PATTERN_STR=>'=;00',
  _h_DE39_PATTERN_STR=>'SUCCESSFUL',
  _h_final_total_debit_PATTERN_STR=>'!=;0.00',
  _h_datepart_diff=>604800,
  _aggregated_amount_OPERATION=>'>',
  _aggregated_amount_threshold_LIST=>'20000',
  _aggregated_amount_include_current=>TRUE)

 3.ATM  Monthly Copy from UAT

 public.f_UniversalCheck3E(<CTP>,
 _c_DE3_1_PATTERN_STR=>'=;01',
 _c_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_DE3_1_PATTERN_STR=>'=;01',
 _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_final_total_debit_PATTERN_STR=>'!=;0.00',
 _h_datepart_diff=>2592000,
 _aggregated_amount_OPERATION=>'>',
 _aggregated_amount_threshold_LIST=>'4000',
 _aggregated_amount_include_current=>TRUE)

 4.ATM Daily changed the h_datepart_diff=86400 and aggregated_amount_threshold_LIST=500 in the Monthly function

 public.f_UniversalCheck3E(<CTP>,
 _c_DE3_1_PATTERN_STR=>'=;01',
 _c_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_DE3_1_PATTERN_STR=>'=;01',
 _h_DE39_PATTERN_STR=>'IN;00,08,10,11,85,87',
 _h_final_total_debit_PATTERN_STR=>'!=;0.00',
 _h_datepart_diff=>86400,
 _aggregated_amount_OPERATION=>'>',
 _aggregated_amount_threshold_LIST=>'500',
 _aggregated_amount_include_current=>TRUE)",10/Sep/24 9:49 AM;6328729388ed2ebef978552f;Confirmed from Impl. side.,"10/Sep/24 10:49 AM;60fedd388ad5b600707750e1;[~accountid:60fedcb88c15ca006ffc380f] , Request your confirmation so that we could apply this to Production.","10/Sep/24 5:10 PM;60fedcb88c15ca006ffc380f;Hi [~accountid:60fedd388ad5b600707750e1] , the rule function calls look good. Go ahead!",11/Sep/24 8:45 PM;6273fc10807e0000691d5dee;Hi [~accountid:60fedd388ad5b600707750e1] the client has been notified of tomorrow's release ,120698,DEC-112,V1 - BAU,Done,01/Oct/24 12:57 PM
Merchant saying AVS check result not being sent [Mettle],DEFECT-395,121789,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Normal,Done,Febby Oktaviani,629a26eba0eafd0069ea2343,kevin.valle,61d72768326554006c1a590a,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,22/Feb/24 6:44 PM,06/May/25 5:48 PM,,23/May/24 4:54 AM,PTDB-1.27.0,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,,,"Good day team, we have Mettle trying to make transactions with merchant RM ONLINE INVOICE PAYM

Merchant saying AVS check result not being sent [Mettle] since we are sending DE48_83 as S to mastercard

2559505815804208409
 
DE48:T420701032124328kBOmo0okSJPGih4p+40dvoJh3SQC6645010120236576bbaac-dcd6-4770-8799-c23834014e4e820252753201030010202940303018040294050200710418C 8301S8701M9203847
DE48_1:T
DE48_42:0103212
DE48_43:kBOmo0okSJPGih4p+40dvoJh3SQC
DE48_66:010120236576bbaac-dcd6-4770-8799-c23834014e4e
DE48_82:52
DE48_75:01030010202940303018040294050200
DE48_71:18C
DE48_83:S
DE48_87:M
DE48_92:847
 
2559516765804200852
 
DE48:T420701032124328kBM/o8z550/CNB4p+40dvoJhHr9o6645010120236519abca0-4324-4432-9483-f28be313ada2820252753201030010202940303034040294050200710418C 8301S8701M9203847
DE48_1:T
DE48_42:0103212
DE48_43:kBM/o8z550/CNB4p+40dvoJhHr9o
DE48_66:010120236519abca0-4324-4432-9483-f28be313ada2
DE48_82:52
DE48_75:01030010202940303034040294050200
DE48_71:18C
DE48_83:S
DE48_87:M
DE48_92:847
 
2581566425804489907
 
DE48:T420701032124328kBM8zqONUHL5BTur+40dvoJhavJf664501012023683936e3a-879d-41f9-a472-cb6fe35ef633820252753201030010202940303018040294050200710418C 8301S8701M9203847
DE48_1:T
DE48_42:0103212
DE48_43:kBM8zqONUHL5BTur+40dvoJhavJf
DE48_66:01012023683936e3a-879d-41f9-a472-cb6fe35ef633
DE48_82:52
DE48_75:01030010202940303018040294050200
DE48_71:18C
DE48_83:S
DE48_87:M
DE48_92:847

I can see that Function en DB is sending S since the card flag is 28

The reasons for the DE48_83 is related to the Paytok function ppwr_tok_pre18
 
RAISE INFO 'Valid notes point 1 514 %', pvalid_notes;
IF SUBSTRING( ptok_flags, 28, 1 ) = 1::BIT THEN
CASE prsn_cde
WHEN '231'
THEN prsn_cde = '511';
WHEN '232'
THEN prsn_cde = '512';
WHEN '233'
THEN prsn_cde = '513';
WHEN '234'
THEN prsn_cde = '514';
ELSE
END CASE;
_final_avs_response := 'S';
pvalid_notes = COALESCE( pvalid_notes, '' ) || ' and AVS check flag disabled.';
p39o := '00';
RAISE INFO 'Valid notes point 1 514 %', pvalid_notes;
ELSE
IF prsn_cde NOT IN ('233') THEN
p39o := '57';
p38o := NULL;
papprove_so_far := FALSE;
END IF;
END IF;
p48o := COALESCE( p48o, '' ) || '8301' || _final_avs_response;
ELSE
p48o := COALESCE( p48o, '' ) || '8301' || 'Z';
pvalid_notes = pvalid_notes || ': AVS check not supported by Processor';
            prsn_cde = '237';
            txn_checks_results := txn_checks_results | 2097152::BIGINT;
 
END IF; 

Can you please help us to identify why we are sending DE48_83 as S and if this is normal?

~* Please see Zendesk Support tab for further comments and attachments.~",,agung.setiawan,Febby Oktaviani,kevin.valle,michael.ellery,Prabin Shrestha,Savio,Shehroz Ahmed Siddiqui,Sonia Sonnekus,Zendesk Support for Jira,,,6273fbf86a38370069df0612,629a26eba0eafd0069ea2343,61d72768326554006c1a590a,6273fc10807e0000691d5dee,6195bb56ef18ca0071c7a9de,60fedd388ad5b600707750e1,632872d207a27ebeff12903b,70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,IMP_METTLE-34,,,,,,,,,,,,,AUTH-562,,,,,,,,,,,,,,,26/Feb/24 9:37 AM;ug:3e4f5544-8421-4a2a-884b-4704ced3f3b6;AVS scenarios.docx;https://paymentology.atlassian.net/rest/api/3/attachment/content/78376,26/Feb/24 9:37 AM;ug:3e4f5544-8421-4a2a-884b-4704ced3f3b6;AVS scenarios_table summary.docx;https://paymentology.atlassian.net/rest/api/3/attachment/content/78377,17/Apr/24 10:38 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;Screenshot 2024-04-17 at 15.36.17.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/81842,22/Apr/24 4:59 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;SharedUATAddressMismatch-paytok.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82160,22/Apr/24 3:09 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;SharedUATPostalCOdeMismatch-response.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82226,22/Apr/24 3:09 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;SharedUATPostalCodeMismatch-paytok.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82224,22/Apr/24 3:09 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;SharedUatFullMismatch-paytok.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82225,22/Apr/24 3:09 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;SharedUatFullMismatch-response.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82223,04/Mar/24 8:52 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;addrfail-product-flag-disabled.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/79009,04/Mar/24 8:52 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;addrfail-product-flag-enabled.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/79015,23/Feb/24 4:34 AM;ug:49341b23-9ec5-48d0-99f3-263f56fccc09;cd9bae3f-6ab8-43f0-b055-8d5b6ad2118f#media-blob-url=true&id=ca065c94-5630-4c18-9f78-242772cba17d&contextId=7338492057&collection=contentId-7338492057;https://paymentology.atlassian.net/rest/api/3/attachment/content/78288,22/Feb/24 6:44 PM;ug:066e087c-44d7-4e78-be8c-e2e12453264b;data-1708618487676.csv;https://paymentology.atlassian.net/rest/api/3/attachment/content/78267,17/Apr/24 12:04 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;defect-395-sharedUAT-paytokOutput.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/81856,17/Apr/24 12:04 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;defect-395-sharedUAT-response.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/81857,17/Apr/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;defect395-uat-partialmismatch-paytok.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/81858,17/Apr/24 12:10 PM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;defect395-uat-partialmismatch-response.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/81859,04/Mar/24 8:52 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;fullmatch-product-flag-disabled.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/79008,04/Mar/24 8:52 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;fullmatch-product-flag-enabledpng.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/79014,04/Mar/24 8:52 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;fullmismatch-product-flag-disabled.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/79010,04/Mar/24 8:52 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;fullmismatch-product-flag-enabled.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/79013,23/Feb/24 4:22 AM;ug:49341b23-9ec5-48d0-99f3-263f56fccc09;image-20240223-021356.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78287,23/Feb/24 4:34 AM;ug:49341b23-9ec5-48d0-99f3-263f56fccc09;image-20240223-023152.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78289,27/Feb/24 12:10 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20240227-100850.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78637,28/Feb/24 9:59 AM;632872d207a27ebeff12903b;image-20240228-075814.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78696,28/Feb/24 9:59 AM;632872d207a27ebeff12903b;image-20240228-075932.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78698,28/Feb/24 9:59 AM;632872d207a27ebeff12903b;image-20240228-075949.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78697,28/Feb/24 1:41 PM;632872d207a27ebeff12903b;image-20240228-113934.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/78740,08/Mar/24 12:47 PM;ug:3e4f5544-8421-4a2a-884b-4704ced3f3b6;image-20240308-104716.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/79411,04/Mar/24 8:52 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;postcode-fail-product-flag-disabled.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/79012,04/Mar/24 8:52 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;postcode-fail-product-flag-enabled.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/79011,22/Apr/24 4:59 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;sharedUATAddressMismatch-response.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82161,22/Apr/24 4:59 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;sharedUATFullMatch-response.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82158,22/Apr/24 4:59 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;sharedUatFullMatch-paytok.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/82159,,,,,,,,,,,,,,,,,,PE - Processing  - Authorisations,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@26bc7664,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2024-03-04T12:56:12.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":3,""name"":""GitLab""},""GitHub"":{""count"":2,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,Mettle,1|hzzbwn:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,Auth Sprint 2,AUTH Sprint 3,AUTH Sprint 4,AUTH Sprint 5,Sprint 7,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,"h1. Local Test Evidence

||*Case*||*Product flag* {{allow_avs_fail_as_avs_supported}} *enable.*||*Product flag* {{allow_avs_fail_as_avs_supported}} *disable.*||
|Full match
tok flag 28 (Set card to approve AVS match fail) enable|!fullmatch-product-flag-enabledpng.png|width=41.666666666666664%!
* Transaction is approved
* *DE48_83 = X*
* reason_code = 513|!fullmatch-product-flag-disabled.png|width=50%!
* Transaction is approved
* *DE48_83 = S*
* reason_code = 513|
|Partial match postal code mismatch
tok flag 28 (Set card to approve AVS match fail) enable|!postcode-fail-product-flag-enabled.png|width=50%!
* Transaction is approved.
* *DE48_83 = A*
* reason_code = 512|!postcode-fail-product-flag-disabled.png|width=50%!
* Transaction is approved.
* *DE48_83 = S*
* reason_code = 512|
|Partial match address mismatch
tok flag 28 (Set card to approve AVS match fail) enable|!addrfail-product-flag-enabled.png|width=50%!
* Transaction is approved.
* *DE48_83 = W*
* reason_code = 511|!addrfail-product-flag-disabled.png|width=50%!
* Transaction is approved.
* *DE48_83 = S*
* reason_code = 511|
|Full mismatch
tok flag 28 (Set card to approve AVS match fail) enable|!fullmismatch-product-flag-enabled.png|width=50%!
* Transaction is approved.
* *DE48_83 = N*
* reason_code = 514|!fullmismatch-product-flag-disabled.png|width=50%!
* Transaction is approved.
* *DE48_83 = S*
* reason_code = 514|",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-02-23 02:22:48.746,10306_*:*_1_*:*_33940072_*|*_3_*:*_2_*:*_3212594012_*|*_10001_*:*_1_*:*_0_*|*_10345_*:*_2_*:*_2590548351_*|*_10400_*:*_1_*:*_1975553843,,22/Feb/24 6:46 PM;61d72768326554006c1a590a;I have attached a list of TXN were sometimes we send DE48_83 and some others we do not. can you please help us understand why this is happening?,"23/Feb/24 4:22 AM;6273fbf86a38370069df0612;Hi [~accountid:61d72768326554006c1a590a] 

{{sometimes we send DE48_83 and some others we do not}}
It is because AVS check is optional. You can check MC documentation on DE-48_82.

!image-20240223-021356.png|width=833,height=942!

If it has a value of 52 it means AVS is requested and AVS response will be sent in DE-48_83, else we won’t send DE-48_83.  Technically speaking, this is the implementation in db function [https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2074-2085|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2074-2085|smart-link] 

{{pdo_avs_resp}} = TRUE means AVS check will be performed and response will be given in 48_83.

There’s another condition on when {{pdo_avs_resp}} is TRUE, that is when DE-120 contains address data as shown here [https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L1068-1069|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L1068-1069|smart-link] 


","23/Feb/24 4:34 AM;6273fbf86a38370069df0612;Hi [~accountid:61d72768326554006c1a590a] 
{{Can you please help us to identify why we are sending DE48_83 as S and if this is normal?}}

Based on my investigation, the only time we send {{S}} in DE-48_83 is when Tok Flags 28 is set as shown here [https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2150-2162|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2150-2162|smart-link] and [https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2173|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2173|smart-link] 

Based on this [https://paymentology.atlassian.net/wiki/spaces/TS/pages/6844481686/Tok+Flags|https://paymentology.atlassian.net/wiki/spaces/TS/pages/6844481686/Tok+Flags|smart-link] and [https://paymentology.atlassian.net/wiki/spaces/TS/pages/7338492057/TOKFLAG+check+for+AVS+transaction+VISA|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7338492057/TOKFLAG+check+for+AVS+transaction+VISA|smart-link] (tok flags applied to MC too) then it is a normal behavior intended to bypass AVS check

!image-20240223-023152.png|width=752,height=91!


Tok flags 28 can be disabled to not get an S response

!cd9bae3f-6ab8-43f0-b055-8d5b6ad2118f#media-blob-url=true&id=ca065c94-5630-4c18-9f78-242772cba17d&contextId=7338492057&collection=contentId-7338492057|width=1788,height=832!",23/Feb/24 4:35 AM;6273fbf86a38370069df0612;Moved ticket to “awaiting deployment” since “in review” not available,"23/Feb/24 9:00 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Hi [~accountid:6273fbf86a38370069df0612] [~accountid:61d72768326554006c1a590a] can we also involve someone from product here please?


Because we can’t send “S” for every requested AVS transaction as its not according to MC specifications. Our token flags cannot dictate this. The fact that the token flag is selected only means while we still do AVS we won’t decline it. 



It doesn’t mean we don’t support it.



We are sending through the incorrect response to MC. ","23/Feb/24 10:37 AM;6273fbf86a38370069df0612;Hi [~accountid:6297155ee76a9c00705e2b50] [~accountid:632872d207a27ebeff12903b] please check, thank you","26/Feb/24 9:39 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Please see attached Word document with below scenarios. Some of them are inconsistent. E.g. Scenario 3 & 4, why did we send “S” to scheme in one but not the other scenario? 



| |*Scenario*|*TID*|*Sent back to Scheme*|
|#|AVS requested, validation failed, Processor response is 57; responded to network with “S”.|2610320650779937109|de48: T420701032144328kXOJ0gZAB8/79yTihAFRTRwnKkrZ66450101202363fbf45ab-0f18-4fc5-ab15-3df10d369e7782025222140102010504M10275130103001020230710418C *8301S*|
|2|AVS requested, validation failed, processor response 00, AVS Response to network doesn’t contain DE48_83|2610308249517813254|de48: T42070103247710850C 18C|
|3|AVS requested, validation passed, Processor response is 00; AVS result not sent to scheme.|2610320060779931722|de48: T42070103247710850C 18C|
|4|AVS requested, validation passed, Processor response is 00; AVS result ”S” sent to scheme.|2610319774441351870|de48: T8202524207010321075130103001020230710418C *8301S*|
|5|AVS requested; validation failed; processor response 00; responded to network with AVS result “S”|2610337891590165713|de48: T4207010321082025222080504C10175130103001020292710418C *8301S*|
| | | | |","26/Feb/24 10:18 AM;629a26eba0eafd0069ea2343;[~accountid:632872d207a27ebeff12903b] [~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] 


I investigated the transactions with invalid reason code of AVS bypassed validation from attached file of {{data-1708618487676.csv}} in the ticket.TID: 2607745048505520000

* reason code: {{212}}
* auth note: : Token flags: Bypass PIN entry required(55_95) validation: {{AVS check req 48_82=52 :AVS check Postcode/zip and address match and AVS check flag disabled}}.Cvv Type:0 Rslt:9  ARQC:9: {{NO CVV,NOT Chip, Valid Expiry date => De39=00 }}: Mdes Transaction Client DE39=00default Acc used : FTS(1), FTSO(99) and FTD(-35.5000); File ID:4055 -- 1a ; match (1a) on tok+de38
* AVS result: {{AVS check req 48_82=52 :AVS check Postcode/zip and address match and AVS check flag disabled}}
* reason code was overridden by the next validation of E-commerce only based on valid expiry date logic [+here+|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2448-2451].

TID: 2606292916366440000

* reason code: 215
* auth note: : Token flags: Bypass PIN entry required(55_95) validation: Acc Enq no avs, no cvv req 00 : {{AVS check req 48_82=52 :AVS check Postcode/zip and address match and AVS check flag disabled}}.Cvv Type:0 Rslt:9  ARQC:9: {{NO CVV, NOT Chip, is 0 amt => De39=85 }}Client DE39=00default Acc used : FTS(1), FTSO(99) and FTD(0.0000)
* AVS result: {{AVS check req 48_82=52 :AVS check Postcode/zip and address match and AVS check flag disabled}}
* reason code was overridden by the next validation of No CVV and Not Chip zero amount transaction [+here+|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2402-2413].

TID: 2604614278505600000

* reason code: 212
* auth note: : Token flags: Bypass PIN entry required(55_95) validation: AVS check req 48_82=52 :{{AVS check - postcode matches, address does not and AVS check flag disabled.}}Cvv Type:0 Rslt:9  ARQC:9: {{NO CVV,NOT Chip, Valid Expiry date => De39=00}} : Mdes Transaction Client DE39=00default Acc used : FTS(1), FTSO(99) and FTD(-11.1300); File ID:4035 -- 1a ; match (1a) on tok+de38
* AVS result: {{AVS check - postcode matches, address does not and AVS check flag disabled.}}
*  reason code was overridden by the next validation of E-commerce only based on valid expiry date logic [+here+|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2448-2451].

TID: 2602779008505740000

* reason code: 212
* auth note: : Token flags: Bypass PIN entry required(55_95) validation: {{AVS check req 48_82=52 :AVS check - postcode matches, address does not and AVS check flag disabled}}.Cvv Type:0 Rslt:9  ARQC:9: {{NO CVV,NOT Chip, Valid Expiry date => De39=00}} : Mdes Transaction Client DE39=00default Acc used : FTS(1), FTSO(99) and FTD(-99.3000); File ID:4024 -- 1a ; match (1a) on tok+de38
* AVS result: {{AVS check req 48_82=52 :AVS check - postcode matches, address does not and AVS check flag disabled}}
* reason code was overridden by the next validation of E-commerce only based on valid expiry date logic [+here+|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2448-2451].

TID: 2571283832216340000

* reason code: 218
* auth note: : : Token flags: Bypass PIN entry required(55_95) validation: Acc Enq no avs, no cvv req 00 : AVS check req 48_82=52 :{{AVS check Postcode/zip and address match and AVS check flag disabled}}.Cvv Type:2 Rslt:1  ARQC:9: {{Acc Status Enq}} : CVV2 pass : AAV verification success: CVC check p48o= T420701032124328kANn8yngABNvFgYOzvJmiIJhN7376645010120236197b5b79-c95a-45c9-b680-70a26aeb14da82025222080504C101753201030010202940303006040294050200710418C 8301S8701M Client DE39=00default Acc used : FTS(1), FTSO(99)
* AVS result: {{AVS check Postcode/zip and address match and AVS check flag disabled}}
* reason code was overridden by the next validation of cvv2 result of ASI transaction [+here+|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql?ref_type=heads#L2390-2395].

Summary:

# We already set correct reason code for each AVS bypassed result, as we can see in the attached data there are some transaction with valid AVS reason codes (511, 513, etc)
# For above transaction with invalid reason code of AVS bypassed result, I found out that the reason code was overridden by the next validation after the AVS check.
# AVS result will be set to S in DE48 when card is set to allow AVS check fails.
# We can add additional condition to ignore the reason code assignment when it is already set before all the validation after the AVS.","26/Feb/24 1:39 PM;632872d207a27ebeff12903b;hi [~accountid:629a26eba0eafd0069ea2343] what is happening in the case when we are sending the AVS reason codes?
is bank declining those transaction or are they getting approved in fast response?","26/Feb/24 2:13 PM;629a26eba0eafd0069ea2343;[~accountid:632872d207a27ebeff12903b] 
There are 100 transactions with correct AVS response reason code of 511 ({{AVS check - postcode matches, address does not and AVS check flag disabled.}}) and 513 ({{AVS check Postcode/zip and address match and AVS check flag disabled}}).

* AVS with reason code {{511}} (28 transactions):
** DE39 from fast {{00}} -> 21 transactions
** DE39 from fast {{05}} -> 7 transactions
** DE39 from fast {{85}} -> 0 
* AVS with reason code {{513}} (72 transactions)
** DE39 from fast {{00}} -> 70 transactions
** DE39 from fast {{05}} -> 1 transaction
** DE39 from fast {{85}} -> 1 transaction","26/Feb/24 4:51 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;[~accountid:629a26eba0eafd0069ea2343] [~accountid:632872d207a27ebeff12903b] for cases like below when we send result code for AVS results, are we supposed to send DE83 with the result as well?
Because even for failures when response code is 511, we are sending “S” to mastercard saying the Issuer does not support AVS validation. ","27/Feb/24 5:51 AM;629a26eba0eafd0069ea2343;Hi,[~accountid:632872d207a27ebeff12903b] [~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] 

Looking at current behavior, when card tok flag 28 (Set card to approve if AVS match fails) is enabled it will be treated as AVS not supported and BL will approve any transactions even though the AVS match fails with AVS response DE48_83 set to S and set corresponding reason code to inform the client. 

Is this expected behavior of tok flag 28 purpose? 

* If yes, then we need to disable tok flag 28 when client needs to support the AVS. BL will decline AVS match fails with DE39 = 57 and set corresponding AVS response in DE48_83.
* If not, then what is the expected behavior of tok flag 28?","27/Feb/24 10:46 AM;632872d207a27ebeff12903b;Hi [~accountid:629a26eba0eafd0069ea2343] 
Looks like we have 2 issues here:
1 is we are sending S in de 48 SE 83 if we have AVS bypassed
2 we are overriding the reason code of AVS



for 1 , I have found the ticket in which this logic got implemented, maybe [~accountid:6195bb56ef18ca0071c7a9de] have some knowledge around about hardcoding “S”
[https://paymentology.atlassian.net/browse/DEV-11639177|https://paymentology.atlassian.net/browse/DEV-11639177|smart-link] 


for 2 we need to check if the overridden reason codes are of higher priority , on which client has to make decision and are more sensitive.



IF above  is not of high priority , we should implement logic : 


If AVS bypass enabled and AVS result code =! (is_address_match=y and is_postal_code_match=y) and de 39 ==00
then 
prioritize reason codes of AVS


But above logic only depends on if the reason code getting over ridden are not of higher priority  , like for example client has to make decision on no CVV and we have reason code for this , now this is more sensitive thn address verification and we can not over ride it","27/Feb/24 10:58 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;The major issue is we are always sending *S*

Infor from client:
_The correct behaviour is a solution where Paymentology perform the check, tell us the results but do not decline on our behalf (both of these happen today with the flag) but they still map the result of the check in the response to the scheme (i. DE48_83) rather than have this fixed to always send_ *_S_*


So we do the check, do not decline if AVS fails, but put correct code in SE83","27/Feb/24 11:51 AM;6195bb56ef18ca0071c7a9de;{color:#ff991f}1 is we are sending S in de 48 SE 83 if we have AVS bypassed{color}
{color:#ff991f}2 we are overriding the reason code of AVS{color}

1 → afaik If the transaction request is AVS, i.e., 48_82 = 52, we need to send 48_83 in response. Since we are bypassing AVS validation for the above case and not doing anything with AVS data, we are using *S* (AVS currently not supported) as the final AVS response.

2 → 511, 512, 513, and 514 are overridden reason codes (and approved reason codes) to tell the client what AVS failed condition was overridden.

[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] Is client raising why we are sending S value even though the address and postal codes match?","27/Feb/24 12:07 PM;632872d207a27ebeff12903b;[~accountid:6195bb56ef18ca0071c7a9de] 

But why are we sending “S”



”{color:#ff5630}afaik If the transaction request is AVS, i.e., 48_82 = 52, we need to send 48_83 in response. Since we are bypassing AVS validation for the above case and not doing anything with AVS data, we are using {color}{color:#ff5630}*S*{color}{color:#ff5630} (AVS currently not supported) as the final AVS response.”{color}","27/Feb/24 12:10 PM;6195bb56ef18ca0071c7a9de;no idea. *Maybe* from documents, only *S* sounds valid for bypass case 😀 

(those value were there from beginning.) BTW, what should we send for those cases?

!image-20240227-100850.png|width=491,height=659!","27/Feb/24 12:28 PM;632872d207a27ebeff12903b;[~accountid:6195bb56ef18ca0071c7a9de] [~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] [~accountid:629a26eba0eafd0069ea2343] 
I have emailed the scheme","27/Feb/24 12:48 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Hi all

[~accountid:6195bb56ef18ca0071c7a9de] to answer your question → _Is client raising why we are sending S value even though the address and postal codes match_? 

 ---> Yes we are sending “*S*” even when its a full match. E.g. TID 2610319774441351870. 

→ We are also sending “*S*” if AVS validation failed e.g. TID 2610320650779937109



By responding “S” to the scheme we are responding on behalf of Mettle indicating, not that Paymentology overrode the validation, but that the *Issuer - Mettle* - does NOT support AVS validation. This is incorrect behaviour for a UK client. 



Yes, the issue is that we are only supporting *“S”* in DE48SE83’s response to the Scheme which puts the liability on the Issuer → Mettle. While they might accept the liability, as they have the token-flag enabled, we can’t respond on their behalf with a hard-coded S to the scheme because Mettle DOES support AVS validation. Its mandated. 

(PS – we are probably doing this for all clients as its inherited old BL behaviour)","27/Feb/24 1:57 PM;6195bb56ef18ca0071c7a9de;[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] 

For full match case, I think we should send match 48_83 = {{X}} instead of {{S}}

But for other failed cases, what value should we use? afaik client doesn’t check AVS data and doesn’t respond with a DE48 response. and I think we doesn’t consider client DE48 response too.

So, the question is what value should we send for failed cases?

{color:#ff991f}By responding “S” to the scheme we are responding on behalf of Mettle indicating, not that Paymentology overrode the validation, but that the {color}{color:#ff991f}*Issuer - Mettle* {color}{color:#ff991f}- does NOT support AVS validation. This is incorrect behaviour for a UK client.{color}

→ TOKFLAG AVS bypass means bypassing AVS checks and not checking any AVS data. Doesn’t it mean that Issuer - Mettle does not support AVS? If support is needed, why is bypass needed? 🤔 ","28/Feb/24 9:59 AM;632872d207a27ebeff12903b;[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] [~accountid:629a26eba0eafd0069ea2343] 

I have emailed Mastercard about the scenario and got this reply:


!image-20240228-075814.png|width=58.333333333333336%!


then I challenged the answer:



!image-20240228-075932.png|width=911,height=502!

and got this reply:



!image-20240228-075949.png|width=914,height=633!","28/Feb/24 10:11 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Thank you [~accountid:632872d207a27ebeff12903b] 

Can we agree to at least send match 48_83 = {{X}} instead of {{S}}?","28/Feb/24 10:14 AM;632872d207a27ebeff12903b;yes no question in this one, THIs is how it should be , in Positive AVS case , we should send the appropriate value rather thn S","28/Feb/24 10:19 AM;6195bb56ef18ca0071c7a9de;but Shehroz, TOKFLAG AVS bypass means bypassing AVS checks and not checking any AVS data. Doesn’t it mean that Issuer - Mettle does not support AVS? If support is needed, why is bypass needed? What did we communicate with client for this tokflag?","28/Feb/24 10:22 AM;632872d207a27ebeff12903b;as far as I understand this token means “bypass rejecting transaction on the basis of AVS” not the whole AVS.

[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] can you confirm the understanding?","28/Feb/24 10:24 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;[~accountid:6195bb56ef18ca0071c7a9de] the point is Mettle DOES support AVS and it is mandated to support it in the UK.

Mettle has never found it acceptable that Paymentology declined on their behalf for AVS checks given that this is not a scheme requirement to do so. 
This behaviour effectively forces Mettle as a client to inherit Paymentology's assessment of risk appetite rather than have the ability to apply their own. 
And Paymentology's acceptance on AVS is extremely low - anything that is not a full match is declined. This is why Mettle had the flag enabled. --To allow Mettle to make the final decision. 

Because BL inherently will always do AVS validation, the token flag is needed in order to NOT decline the transaction outright but rather send it on to the client who makes the decision. 





_as far as I understand this token means “bypass rejecting transaction on the basis of AVS” not the whole AVS. →_ Yes it means, while PTY will always do the validation; do not decline the transaction; but rather bypass the RESULT of the validation; and pass on to client to make their own decision.","28/Feb/24 10:26 AM;6195bb56ef18ca0071c7a9de;Okay, got it. now makes sense to send X in full address and postal code match cases. and sending S in case of failed.","28/Feb/24 1:24 PM;629a26eba0eafd0069ea2343;[~accountid:632872d207a27ebeff12903b] we have 8 validation after AVS check that will override the response code in case of approved.

# Case No CVV, NOT Chip zero amount transaction -> reason_code: 215
# Case No CVV, Not Chip refund payment -> reason code: 228
# Case No CVV, Not Chip recurring/pre-auth -> reason code: 214
# Case No CVV, Not Chip valid expiry -> reason code 212
# Case cashback req at POS that does not support -> reason code: 219
# Case PIN change request with zero amount -> reason_code: 264, de39 = 85
# Case PIN change requested via ATM -> reason code 223
# PIN unblock request with zero amount -> reason code 265, de39 = 85","28/Feb/24 1:41 PM;632872d207a27ebeff12903b;!image-20240228-113934.png|width=1701,height=485!

[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] is right we have to send the correct AVs response with the liability on issuer (if you can confirm issuer takes liability [~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] )

[~accountid:629a26eba0eafd0069ea2343] [~accountid:6195bb56ef18ca0071c7a9de] need to check the priority mechanism too for this but we have an answer for AVS result atleast.

[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] do you know if any other clients are using this token flag?","28/Feb/24 1:59 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Pro clients in shared02 include UW, Nomo, ONMO, Rain and Xendit who have this flag enabled. We would need to check other implementations as well.

The major request from Mettle is to do what we are doing, but don’t always send “S” to the scheme…let it be based on the AVS validation result","04/Mar/24 8:52 AM;629a26eba0eafd0069ea2343;h1. Local Test Evidence

||*Case*||*Product flag* {{allow_avs_fail_as_avs_supported}} *enable.*||*Product flag* {{allow_avs_fail_as_avs_supported}} *disable.*||
|Full match
tok flag 28 (Set card to approve AVS match fail) enable|!fullmatch-product-flag-enabledpng.png|width=41.666666666666664%!
* Transaction is approved
* *DE48_83 = X*
* reason_code = 513|!fullmatch-product-flag-disabled.png|width=594,height=448!
* Transaction is approved
* *DE48_83 = S*
* reason_code = 513|
|Partial match postal code mismatch 
tok flag 28 (Set card to approve AVS match fail) enable|!postcode-fail-product-flag-enabled.png|width=594,height=448!
* Transaction is approved.
* *DE48_83 = A*
* reason_code = 512|!postcode-fail-product-flag-disabled.png|width=594,height=448!
* Transaction is approved.
* *DE48_83 = S*
* reason_code = 512|
|Partial match address mismatch
tok flag 28 (Set card to approve AVS match fail) enable|!addrfail-product-flag-enabled.png|width=594,height=448!
* Transaction is approved.
* *DE48_83 = W*
* reason_code = 511|!addrfail-product-flag-disabled.png|width=594,height=448!
* Transaction is approved.
* *DE48_83 = S*
* reason_code = 511|
|Full mismatch
tok flag 28 (Set card to approve AVS match fail) enable|!fullmismatch-product-flag-enabled.png|width=594,height=448!
* Transaction is approved.
* *DE48_83 = N*
* reason_code = 514|!fullmismatch-product-flag-disabled.png|width=594,height=448!
* Transaction is approved.
* *DE48_83 = S*
* reason_code = 514|



Query to be run to enable the product flag {{allow_avs_fail_as_avs_supported}}.

{code:sql}with rows as (
	INSERT INTO p_product_setting_key (description) 
		VALUES ('allow_avs_fail_as_avs_supported') RETURNING id
)
INSERT INTO p_product_setting (key_id, prod_id, client_id, value)
SELECT id, <product_id>, <client_id>, true 
FROM rows;{code}



[~accountid:632872d207a27ebeff12903b] please verify the local test evidence. If all good, I’ll process the MR. Thanks!","04/Mar/24 11:56 AM;632872d207a27ebeff12903b;[~accountid:629a26eba0eafd0069ea2343] test cases looks fine.
Thanks","08/Mar/24 12:47 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;[~accountid:632872d207a27ebeff12903b] we sent the changes to Mettle who approved the response codes.



!image-20240308-104716.png|width=605,height=136!","08/Mar/24 1:41 PM;632872d207a27ebeff12903b;[~accountid:629a26eba0eafd0069ea2343] we have confirmation, i think we can go ahead with feature flag",08/Mar/24 1:44 PM;629a26eba0eafd0069ea2343;[~accountid:60fedd388ad5b600707750e1] do we have hotfix branch for mettle?,08/Mar/24 1:51 PM;60fedd388ad5b600707750e1;[~accountid:629a26eba0eafd0069ea2343] Mettle has a scheduled release of BL2.6 on Thursday so i will create the hotfix branch on Monday and share with  ,08/Mar/24 2:10 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;[~accountid:60fedd388ad5b600707750e1] please hold off on hot fix branch we need to confirm with Mettle first.,"08/Mar/24 3:46 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;{color:#ff5630}*Mettle confirmed to NOT deploy this change as part of the 2.6 release due on Thursday.*{color}

*Please do not create any hot fixes for Mettle unless agreed with the client as we are trying to manage the stability of their environment better.* ",27/Mar/24 1:30 PM;629a26eba0eafd0069ea2343;[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1] any update on this?,05/Apr/24 12:10 PM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Have asked [~accountid:6273fc10807e0000691d5dee] to confirm once back from 8 April.,10/Apr/24 6:13 PM;6273fc10807e0000691d5dee;Hi [~accountid:629a26eba0eafd0069ea2343] is this now in UAT for Mettle to test?,"15/Apr/24 4:57 AM;629a26eba0eafd0069ea2343;[~accountid:6273fc10807e0000691d5dee] yes, this is included in BL 2.9 and deployed to sharedUAT on 10th April [https://paymentology.slack.com/archives/C04QN45A8KF/p1712726791488579|https://paymentology.slack.com/archives/C04QN45A8KF/p1712726791488579|smart-link] .","15/Apr/24 6:06 AM;629a26eba0eafd0069ea2343;[~accountid:6273fc10807e0000691d5dee] [~accountid:60fedd388ad5b600707750e1] We need to run below script in paytokDb

* {{s_prod_id}}: change {{NULL}} to client’s product id if the flag wants to apply for specific product.
* {{s_client_id}}: change {{460312}} to client’s id.

{code:sql}DO
$$
	DECLARE
		s_key CHARACTER VARYING DEFAULT 'allow_avs_fail_as_avs_supported'; -- KEY NAME
		s_value CHARACTER VARYING DEFAULT 'TRUE'; -- VALUE
		s_prod_id INTEGER DEFAULT NULL; -- PRODUCT ID
		s_client_id INTEGER DEFAULT 460312; -- CLIENT ID
		pkey_id INTEGER;
	BEGIN
		SELECT id INTO pkey_id FROM public.p_product_setting_key WHERE description = s_key;
		IF pkey_id IS NULL THEN
			INSERT INTO public.p_product_setting_key ( description )
				VALUES ( s_key ) RETURNING id INTO pkey_id;
			RAISE NOTICE 'Key not exist';
		END IF;
		IF NOT EXISTS ( SELECT 1 FROM public.p_product_setting WHERE
																   key_id = pkey_id AND
																   COALESCE(prod_id::VARCHAR, '') = COALESCE(s_prod_id::VARCHAR, '') AND
																   COALESCE(client_id::VARCHAR, '') = COALESCE(s_client_id::VARCHAR, '') ) THEN
			INSERT INTO public.p_product_setting ( key_id, value, prod_id, client_id )
				VALUES (pkey_id, s_value, s_prod_id, s_client_id);
			RAISE NOTICE 'KEY INSERTED SUCCESSFULLY';
		ELSE
			RAISE NOTICE 'Already Exist';
		END IF;
	END
$$;{code}","16/Apr/24 4:32 PM;6273fc10807e0000691d5dee;Hi [~accountid:629a26eba0eafd0069ea2343] the client is unable to test this in UAT on their side, is the testing provided on this ticket the best evidence to share with them to provide comfort testing has taken place?

[~accountid:60fedd388ad5b600707750e1] not sure on the script running part, are you able to assist?","17/Apr/24 6:02 AM;629a26eba0eafd0069ea2343;Hi [~accountid:6273fc10807e0000691d5dee], testing evidence is provided in the testing tab of this ticket and the script needs to be run to enable this change.","17/Apr/24 9:37 AM;70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1;Hi [~accountid:629a26eba0eafd0069ea2343] do you perhaps have any tests done against the Mettle client and tokens?
We are looking to provide test evidence to them but attached tests are done on client 123456",17/Apr/24 9:58 AM;60fedd388ad5b600707750e1;[~accountid:629a26eba0eafd0069ea2343] the Key is inserted in PayTok DB for Mettle Client ID:438126,"17/Apr/24 10:32 AM;629a26eba0eafd0069ea2343;[~accountid:60fedd388ad5b600707750e1], I created a card with token {{245890831}}  under client 438126 but couldn't test AVS cases in UAT since token has no address data in p_tok table. would you please help me to run this query in PayTokDb to set the addres for that token?

{code:sql}update p_tok set addr = '1219', pcode = '00000' where pb_tok = 245890831;{code}

Card created for test:

!Screenshot 2024-04-17 at 15.36.17.png|width=100%,alt=""Screenshot 2024-04-17 at 15.36.17.png""!","17/Apr/24 12:04 PM;629a26eba0eafd0069ea2343;[~accountid:70121:5e4cd415-f1d1-4f07-a0ff-5076651813d1], I tested on SharedUAT with token {{926194751}} under client id {{438126}}.

h2. Full Mismatch Case

TID: {{2663352790252000268}}
RID: {{2558565}}

*Paytok Output*

!defect-395-sharedUAT-paytokOutput.png|width=638,height=409,alt=""defect-395-sharedUAT-paytokOutput.png""!

*Response to Network*

!defect-395-sharedUAT-response.png|width=638,height=409,alt=""defect-395-sharedUAT-response.png""!

h2. Partial Match (Postal code mismatch)

TID: {{2663363130252000270}}
RID: {{2558568}}

*Paytok Output*

!defect395-uat-partialmismatch-paytok.png|width=638,height=409,alt=""defect395-uat-partialmismatch-paytok.png""!

*Response to Network*

!defect395-uat-partialmismatch-response.png|width=638,height=409,alt=""defect395-uat-partialmismatch-response.png""!","17/Apr/24 12:22 PM;6273fc10807e0000691d5dee;Thank you [~accountid:629a26eba0eafd0069ea2343] , will share with Mettle now",17/Apr/24 2:55 PM;60fedd388ad5b600707750e1;[~accountid:629a26eba0eafd0069ea2343] i have done the update you may test a positive case now.,"19/Apr/24 12:27 PM;6273fc10807e0000691d5dee;Hi [~accountid:629a26eba0eafd0069ea2343] 

I have received the below feedback from Mettle, can you please help and share the relevant testing?

 

There are 4 mappings as part of this work which are:

A - Partial - postal mismatch

N - Full mismatch

X - Full match

Z - Partial - address mismatch

 

We've only been sent examples for N and A. We'd appreciate a full set of test scenarios please.

 

Further, we were previously receiving the results of the check in the FAST message from Paymentology in the Processor Reason Code field. These were as such:

AVS_VALIDATION_ADDRESS_MATCH_FAILED(""511""),

AVS_VALIDATION_POSTCODE_MATCH_FAILED(""512""),

AVS_VALIDATION_ADDRESS_AND_POSTCODE_MATCH_SUCCESS(""513""),

AVS_VALIDATION_BOTH_ADDRESS_AND_POSTCODE_MATCH_FAILED(""514"")

 

For the 2 examples shared, I can't see that the results are being shared. I was very clear that in fixing the issue of the mapping to the scheme, nothing about the information that was being sent to us should be impacted. Can we get this looked into please as we now seemingly have the result going to the scheme but no longer being sent to the client.","19/Apr/24 12:34 PM;629a26eba0eafd0069ea2343;Hi [~accountid:6273fc10807e0000691d5dee], I can provide the rest of DE48_83 cases, but for reason code it is because overidden by NO CVV NO No chip case. I will back to you with the test result on Monday, is that okay? ","19/Apr/24 12:51 PM;6273fc10807e0000691d5dee;Thank you, sounds good [~accountid:629a26eba0eafd0069ea2343] ","22/Apr/24 4:59 AM;629a26eba0eafd0069ea2343;Hi [~accountid:6273fc10807e0000691d5dee], please find another 2 cases of UAT test evidence below.

Token: {{245890831}}

ClientID: {{438126}}

h2. *AVS Result Full Match Case (DE48_83 = X )*

RID: {{2559445}}
TID: {{2668094132216000165}}

*Paytok* 

!sharedUatFullMatch-paytok.png|width=638,height=409,alt=""sharedUatFullMatch-paytok.png""!

*Response to network*

!sharedUATFullMatch-response.png|width=638,height=409,alt=""sharedUATFullMatch-response.png""!

*Fast Active Feed*

{code:json}{
  ""MESSAGE_TYPE"" : {
    ""Message_Type"" : ""0100"",
    ""Message_Desc"" : ""Pre-Authorisation Request""
  },
  ""SUMMARY"" : {
    ""TID"" : ""2668094132216000165"",
    ""RID"" : ""2559445"",
    ""PID"" : ""1709"",
    ""Client_Id"" : ""438126"",
    ""Transaction_Date_Time"" : ""22-04-2024 02:36:54"",
    ""Network"" : ""MC"",
    ""Spend_Type"" : ""ECOM - Purchase"",
    ""Spend_Location"" : ""Blizzard Entertainment Velizy Vilaco FRA"",
    ""Transaction_Amount"" : ""1"",
    ""Transaction_Currency"" : ""GBP"",
    ""Billing_Amount"" : ""1"",
    ""Billing_Currency"" : ""GBP"",
    ""Card_Use_Type"" : ""Electronic commerce"",
    ""Customer_Validation"" : ""CVV2 "",
    ""Processor_Decision_Code"" : ""00"",
    ""Processor_Reason_Code"" : ""513"",
    ""Processor_Decision_Desc"" : ""Approve - Token Flag Bypass AVS validation enabled . Address and Postal Code match success."",
    ""Merchant_Category"" : ""7994 - Video Game Arcades and Establishments"",
    ""Account_Id"" : ""986112414"",
    ""Customer_Ac"" : ""NA"",
    ""Total_Fee_Bill"" : ""0.0""
  },
  ""PROCESSOR_VALIDATIONS"" : {
    ""Pan_Check"" : ""PASS"",
    ""Pin_Check"" : ""NA"",
    ""Expiry_Check"" : ""PASS"",
    ""Track_Check"" : ""PASS"",
    ""CVV_Type"" : ""2"",
    ""CVV_Check"" : ""PASS"",
    ""ARQC_Check"" : ""NA"",
    ""3DS_Check"" : ""NA"",
    ""Test_Matrix"" : ""2306406010731639288"",
    ""Test_Results"" : ""2305843009213693952"",
    ""Rules_Checked"" : ""67356"",
    ""Rules_Triggered"" : """",
    ""Rules_Decision"" : ""00""
  },
  ""ISO_MSG"" : {
    ""DE2"" : ""245890831"",
    ""DE3_1"" : ""00"",
    ""DE3_2"" : ""00"",
    ""DE3_3"" : ""00"",
    ""DE4"" : ""000000000100"",
    ""DE6"" : ""000000000100"",
    ""DE7"" : ""0422023653"",
    ""DE10"" : ""61000000"",
    ""DE11"" : ""000165"",
    ""DE12"" : ""022802"",
    ""DE13"" : ""0422"",
    ""DE14"" : ""2704"",
    ""DE15"" : ""0606"",
    ""DE16"" : ""0605"",
    ""DE18"" : ""7994"",
    ""DE22"" : ""812"",
    ""DE32"" : ""012216"",
    ""DE33"" : ""200179"",
    ""DE37"" : ""061406088942"",
    ""DE38"" : ""108849"",
    ""DE41"" : ""25930370"",
    ""DE42"" : ""4000065        "",
    ""DE43"" : ""Blizzard Entertainment Velizy Vilaco FRA"",
    ""DE48"" : {
      ""1"" : ""T"",
      ""42"" : ""0103210"",
      ""82"" : ""52"",
      ""92"" : ""***""
    },
    ""DE49"" : ""826"",
    ""DE51"" : ""826"",
    ""DE61"" : ""102510400660025078140     "",
    ""DE63"" : ""MCC522493"",
    ""DE120"" : ""042900000    1219                ""
  },
  ""RULES"" : [ {
    ""Rule_Id"" : 67356,
    ""Rule_Type"" : ""Au"",
    ""Rule_Check_Result"" : 0,
    ""Pattern_Result"" : false,
    ""Current_Txn_Amt_Deviation"" : 0.0,
    ""Aggregate_Deviation"" : 0.0,
    ""Count_Deviation"" : 0
  } ]
}{code}

h2. *AVS Result Partial Match Case (DE48_83 = W - Address Mismatch)*

RID: {{2559447}}
TID: {{2668101762216000166}}

*Paytok* 

!SharedUATAddressMismatch-paytok.png|width=638,height=409,alt=""SharedUATAddressMismatch-paytok.png""!

*Response to network*

!sharedUATAddressMismatch-response.png|width=638,height=409,alt=""sharedUATAddressMismatch-response.png""!

*Fast Active Feed*

{code:json}{
  ""MESSAGE_TYPE"" : {
    ""Message_Type"" : ""0100"",
    ""Message_Desc"" : ""Pre-Authorisation Request""
  },
  ""SUMMARY"" : {
    ""TID"" : ""2668101762216000166"",
    ""RID"" : ""2559447"",
    ""PID"" : ""1709"",
    ""Client_Id"" : ""438126"",
    ""Transaction_Date_Time"" : ""22-04-2024 02:49:36"",
    ""Network"" : ""MC"",
    ""Spend_Type"" : ""ECOM - Purchase"",
    ""Spend_Location"" : ""Blizzard Entertainment Velizy Vilaco FRA"",
    ""Transaction_Amount"" : ""1"",
    ""Transaction_Currency"" : ""GBP"",
    ""Billing_Amount"" : ""1"",
    ""Billing_Currency"" : ""GBP"",
    ""Card_Use_Type"" : ""Electronic commerce"",
    ""Customer_Validation"" : ""CVV2 "",
    ""Processor_Decision_Code"" : ""00"",
    ""Processor_Reason_Code"" : ""511"",
    ""Processor_Decision_Desc"" : ""Approve - Token Flag Bypass AVS validation enabled . Address match failed."",
    ""Merchant_Category"" : ""7994 - Video Game Arcades and Establishments"",
    ""Account_Id"" : ""986112414"",
    ""Customer_Ac"" : ""NA"",
    ""Total_Fee_Bill"" : ""0.0""
  },
  ""PROCESSOR_VALIDATIONS"" : {
    ""Pan_Check"" : ""PASS"",
    ""Pin_Check"" : ""NA"",
    ""Expiry_Check"" : ""PASS"",
    ""Track_Check"" : ""PASS"",
    ""CVV_Type"" : ""2"",
    ""CVV_Check"" : ""PASS"",
    ""ARQC_Check"" : ""NA"",
    ""3DS_Check"" : ""NA"",
    ""Test_Matrix"" : ""2306406010731639288"",
    ""Test_Results"" : ""2305843009214218240"",
    ""Rules_Checked"" : ""67356"",
    ""Rules_Triggered"" : """",
    ""Rules_Decision"" : ""00""
  },
  ""ISO_MSG"" : {
    ""DE2"" : ""245890831"",
    ""DE3_1"" : ""00"",
    ""DE3_2"" : ""00"",
    ""DE3_3"" : ""00"",
    ""DE4"" : ""000000000100"",
    ""DE6"" : ""000000000100"",
    ""DE7"" : ""0422024936"",
    ""DE10"" : ""61000000"",
    ""DE11"" : ""000166"",
    ""DE12"" : ""022802"",
    ""DE13"" : ""0422"",
    ""DE14"" : ""2704"",
    ""DE15"" : ""0606"",
    ""DE16"" : ""0605"",
    ""DE18"" : ""7994"",
    ""DE22"" : ""812"",
    ""DE32"" : ""012216"",
    ""DE33"" : ""200179"",
    ""DE37"" : ""061406088942"",
    ""DE38"" : ""108857"",
    ""DE41"" : ""25930370"",
    ""DE42"" : ""4000065        "",
    ""DE43"" : ""Blizzard Entertainment Velizy Vilaco FRA"",
    ""DE48"" : {
      ""1"" : ""T"",
      ""42"" : ""0103210"",
      ""82"" : ""52"",
      ""92"" : ""***""
    },
    ""DE49"" : ""826"",
    ""DE51"" : ""826"",
    ""DE61"" : ""102510400660025078140     "",
    ""DE63"" : ""MCC347822"",
    ""DE120"" : ""042900000    1129                ""
  },
  ""RULES"" : [ {
    ""Rule_Id"" : 67356,
    ""Rule_Type"" : ""Au"",
    ""Rule_Check_Result"" : 0,
    ""Pattern_Result"" : false,
    ""Current_Txn_Amt_Deviation"" : 0.0,
    ""Aggregate_Deviation"" : 0.0,
    ""Count_Deviation"" : 0
  } ]
}{code}","22/Apr/24 2:48 PM;6273fc10807e0000691d5dee;Hi [~accountid:629a26eba0eafd0069ea2343] 

thanks for this, please see Mettle response:



These cover off the 2 scenarios that I mentioned so I appreciate the chance to review these. However they actually behave differently to the first 2 examples that I commented on.

 

These latest 2 still send us the result of the checks in the way that we are used to i.e. they use processor reason code field and have used 511 and 513 which is great.

 

The first 2 examples however did not include the results of the checks to us as I mentioned in my reply to you. So now I'd like to understand the following:

* Why did the first 2 with results A and N not include processor reason codes to tell us about the result of the address check?
* Why is the behaviour different for A & N versus what you've shared for X & W?

I can't sign off test evidence where there is unexplained differences in behaviour and especially where those behaviours degrade the functionality that we currently receive today.","22/Apr/24 2:52 PM;629a26eba0eafd0069ea2343;Hi [~accountid:6273fc10807e0000691d5dee], the first 2 cases are NO CVV case then the reason code was overridden as NO CVV case has higher priority. I will provide the first 2 cases when CVV is provided so that the reason code not overridden by NO CVV case. ","22/Apr/24 2:54 PM;6273fc10807e0000691d5dee;Hi [~accountid:629a26eba0eafd0069ea2343] many thanks for the quick response, who needs to provide the CVV?","22/Apr/24 3:09 PM;629a26eba0eafd0069ea2343;[~accountid:6273fc10807e0000691d5dee] Please find below 2 AVS cases (A & N) with processor reason code of AVS check provided:

h2. *AVS Result Full Mismatch Case (DE48_83 = N )*

RID: {{2559559}}
TID: {{2668471042216000205}}

*Paytok*

!SharedUatFullMismatch-paytok.png|width=75%,alt=""SharedUatFullMismatch-paytok.png""!

*Response to Network*

!SharedUatFullMismatch-response.png|width=75%,alt=""SharedUatFullMismatch-response.png""!

*Fast Active Feed*

{code:json}{
  ""MESSAGE_TYPE"" : {
    ""Message_Type"" : ""0100"",
    ""Message_Desc"" : ""Pre-Authorisation Request""
  },
  ""SUMMARY"" : {
    ""TID"" : ""2668471042216000205"",
    ""RID"" : ""2559559"",
    ""PID"" : ""1709"",
    ""Client_Id"" : ""438126"",
    ""Transaction_Date_Time"" : ""22-04-2024 13:05:04"",
    ""Network"" : ""MC"",
    ""Spend_Type"" : ""ECOM - Purchase"",
    ""Spend_Location"" : ""Blizzard Entertainment Velizy Vilaco FRA"",
    ""Transaction_Amount"" : ""1"",
    ""Transaction_Currency"" : ""GBP"",
    ""Billing_Amount"" : ""1"",
    ""Billing_Currency"" : ""GBP"",
    ""Card_Use_Type"" : ""Electronic commerce"",
    ""Customer_Validation"" : ""CVV2 "",
    ""Processor_Decision_Code"" : ""00"",
    ""Processor_Reason_Code"" : ""514"",
    ""Processor_Decision_Desc"" : ""Approve - Token Flag Bypass AVS validation enabled . Both Address and Postal Code match failed."",
    ""Merchant_Category"" : ""7994 - Video Game Arcades and Establishments"",
    ""Account_Id"" : ""986112414"",
    ""Customer_Ac"" : ""NA"",
    ""Total_Fee_Bill"" : ""0.0""
  },
  ""PROCESSOR_VALIDATIONS"" : {
    ""Pan_Check"" : ""PASS"",
    ""Pin_Check"" : ""NA"",
    ""Expiry_Check"" : ""PASS"",
    ""Track_Check"" : ""PASS"",
    ""CVV_Type"" : ""2"",
    ""CVV_Check"" : ""PASS"",
    ""ARQC_Check"" : ""NA"",
    ""3DS_Check"" : ""NA"",
    ""Test_Matrix"" : ""2306406010731639288"",
    ""Test_Results"" : ""2305843009217888256"",
    ""Rules_Checked"" : ""67356"",
    ""Rules_Triggered"" : """",
    ""Rules_Decision"" : ""00""
  },
  ""ISO_MSG"" : {
    ""DE2"" : ""245890831"",
    ""DE3_1"" : ""00"",
    ""DE3_2"" : ""00"",
    ""DE3_3"" : ""00"",
    ""DE4"" : ""000000000100"",
    ""DE6"" : ""000000000100"",
    ""DE7"" : ""0422130504"",
    ""DE10"" : ""61000000"",
    ""DE11"" : ""000205"",
    ""DE12"" : ""125345"",
    ""DE13"" : ""0422"",
    ""DE14"" : ""2704"",
    ""DE15"" : ""0606"",
    ""DE16"" : ""0605"",
    ""DE18"" : ""7994"",
    ""DE22"" : ""812"",
    ""DE32"" : ""012216"",
    ""DE33"" : ""200179"",
    ""DE37"" : ""061406088942"",
    ""DE38"" : ""108862"",
    ""DE41"" : ""25930370"",
    ""DE42"" : ""4000065        "",
    ""DE43"" : ""Blizzard Entertainment Velizy Vilaco FRA"",
    ""DE48"" : {
      ""1"" : ""T"",
      ""42"" : ""0103210"",
      ""82"" : ""52"",
      ""92"" : ""***""
    },
    ""DE49"" : ""826"",
    ""DE51"" : ""826"",
    ""DE61"" : ""102510400660025078140     "",
    ""DE63"" : ""MCC909847"",
    ""DE120"" : ""04290001200001329""
  },
  ""RULES"" : [ {
    ""Rule_Id"" : 67356,
    ""Rule_Type"" : ""Au"",
    ""Rule_Check_Result"" : 0,
    ""Pattern_Result"" : false,
    ""Current_Txn_Amt_Deviation"" : 0.0,
    ""Aggregate_Deviation"" : 0.0,
    ""Count_Deviation"" : 0
  } ]
}{code}

----

h2. *AVS Result Partial Match Case (DE48_83 = A - Postal Code Mismatch )*

RID: {{2559558}}
TID: {{2668465012216000204}}

*Paytok*

!SharedUATPostalCodeMismatch-paytok.png|width=75%,alt=""SharedUATPostalCodeMismatch-paytok.png""!

*Response to Network*

!SharedUATPostalCOdeMismatch-response.png|width=75%,alt=""SharedUATPostalCOdeMismatch-response.png""!

*Fast Active Feed*

{code:json}{
  ""MESSAGE_TYPE"" : {
    ""Message_Type"" : ""0100"",
    ""Message_Desc"" : ""Pre-Authorisation Request""
  },
  ""SUMMARY"" : {
    ""TID"" : ""2668465012216000204"",
    ""RID"" : ""2559558"",
    ""PID"" : ""1709"",
    ""Client_Id"" : ""438126"",
    ""Transaction_Date_Time"" : ""22-04-2024 12:55:01"",
    ""Network"" : ""MC"",
    ""Spend_Type"" : ""ECOM - Purchase"",
    ""Spend_Location"" : ""Blizzard Entertainment Velizy Vilaco FRA"",
    ""Transaction_Amount"" : ""1"",
    ""Transaction_Currency"" : ""GBP"",
    ""Billing_Amount"" : ""1"",
    ""Billing_Currency"" : ""GBP"",
    ""Card_Use_Type"" : ""Electronic commerce"",
    ""Customer_Validation"" : ""CVV2 "",
    ""Processor_Decision_Code"" : ""00"",
    ""Processor_Reason_Code"" : ""512"",
    ""Processor_Decision_Desc"" : ""Approve - Token Flag Bypass AVS validation enabled . Postal Code match failed."",
    ""Merchant_Category"" : ""7994 - Video Game Arcades and Establishments"",
    ""Account_Id"" : ""986112414"",
    ""Customer_Ac"" : ""NA"",
    ""Total_Fee_Bill"" : ""0.0""
  },
  ""PROCESSOR_VALIDATIONS"" : {
    ""Pan_Check"" : ""PASS"",
    ""Pin_Check"" : ""NA"",
    ""Expiry_Check"" : ""PASS"",
    ""Track_Check"" : ""PASS"",
    ""CVV_Type"" : ""2"",
    ""CVV_Check"" : ""PASS"",
    ""ARQC_Check"" : ""NA"",
    ""3DS_Check"" : ""NA"",
    ""Test_Matrix"" : ""2306406010731639288"",
    ""Test_Results"" : ""2305843009214742528"",
    ""Rules_Checked"" : ""67356"",
    ""Rules_Triggered"" : """",
    ""Rules_Decision"" : ""00""
  },
  ""ISO_MSG"" : {
    ""DE2"" : ""245890831"",
    ""DE3_1"" : ""00"",
    ""DE3_2"" : ""00"",
    ""DE3_3"" : ""00"",
    ""DE4"" : ""000000000100"",
    ""DE6"" : ""000000000100"",
    ""DE7"" : ""0422125501"",
    ""DE10"" : ""61000000"",
    ""DE11"" : ""000204"",
    ""DE12"" : ""125345"",
    ""DE13"" : ""0422"",
    ""DE14"" : ""2704"",
    ""DE15"" : ""0606"",
    ""DE16"" : ""0605"",
    ""DE18"" : ""7994"",
    ""DE22"" : ""812"",
    ""DE32"" : ""012216"",
    ""DE33"" : ""200179"",
    ""DE37"" : ""061406088942"",
    ""DE38"" : ""108859"",
    ""DE41"" : ""25930370"",
    ""DE42"" : ""4000065        "",
    ""DE43"" : ""Blizzard Entertainment Velizy Vilaco FRA"",
    ""DE48"" : {
      ""1"" : ""T"",
      ""42"" : ""0103210"",
      ""82"" : ""52"",
      ""92"" : ""***""
    },
    ""DE49"" : ""826"",
    ""DE51"" : ""826"",
    ""DE61"" : ""102510400660025078140     "",
    ""DE63"" : ""MCC551377"",
    ""DE120"" : ""04290001200001219""
  },
  ""RULES"" : [ {
    ""Rule_Id"" : 67356,
    ""Rule_Type"" : ""Au"",
    ""Rule_Check_Result"" : 0,
    ""Pattern_Result"" : false,
    ""Current_Txn_Amt_Deviation"" : 0.0,
    ""Aggregate_Deviation"" : 0.0,
    ""Count_Deviation"" : 0
  } ]
}{code}",23/Apr/24 5:40 PM;6273fc10807e0000691d5dee;Hi [~accountid:629a26eba0eafd0069ea2343] Mettle are happy with the testing and would like us to proceed with deploying this to production. Will this be merged to their next release?,"24/Apr/24 4:04 AM;629a26eba0eafd0069ea2343;[~accountid:60fedd388ad5b600707750e1] , which paytokDb branch should I patch this to for Mettle?","25/Apr/24 10:42 AM;60fedd388ad5b600707750e1;[~accountid:629a26eba0eafd0069ea2343] , this is already part of BL 2.9 which is on UAT why do you need a PAYTOK branch.","25/Apr/24 10:44 AM;629a26eba0eafd0069ea2343;[~accountid:60fedd388ad5b600707750e1] so, Mettle will be upgraded to BL 2.9 in the next release?",25/Apr/24 10:45 AM;60fedd388ad5b600707750e1;Yes They will.,23/May/24 4:54 AM;629a26eba0eafd0069ea2343;Mettle is already in BL 2.9.10. Mark ticket as done.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147455,AUTH-1096,BAU Bug Fixes - PayPower,Done,23/May/24 4:54 AM
Long time to process authorization [METTLE],DEFECT-314,121398,Defect,Released,DEFECT,Production Defect ,software,Stuart Nelmes,712020:967b64b6-cf4c-4bcb-a081-78dce695db27,,,Major,Done,Prabin Shrestha,6195bb56ef18ca0071c7a9de,ramon.gouveia,6205526df38765006f676f67,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,15/Feb/24 7:25 PM,06/May/25 5:47 PM,,26/Feb/24 7:45 AM,PP-3.25.5,PP-3.26.0,PP-3.26.1,PP-3.26.2,,,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,,,"* *A summary of the request/issue*: Long time to process authorization [METTLE]
* *Platform:* Banking.Live
* *Environment:* PROD
* *Runbooks used*: if we have any existing runbook, please provide all the links. Please note that we can use this to enhance the runbook
* *Troubleshooting Steps Followed* (please try to list everything you have already verified )
** Client provide a list of transactions that were timing out.
** Checking those TID in Paycontrol, the time between message arrived and split components steps, thats usually is less then 0.01s, is take 10s or more, causing time-out in the transactions.
** It was checked in datadog, and this delay is present as well.
** !Screenshot 2024-02-15 at 15.07.19.png|width=92.94117647058823%!
Based on this, I check in Paypower logs and shared the nohup here for DEV analysis.
* *Bug Details:* only If we find it as a bug, add the details of your finding
** Paypower (or DB) is take to long to process the authorization, causing time-out in some transactions.
** Sample of todays transactions (available in nohup file.

2024-02-15T13:33:15.906Z - 2601483842216794789
2024-02-15T13:33:15.644Z - 2601483838505853985
2024-02-15T10:40:20.110Z - 2601382655909973372
2024-02-15T10:40:19.724Z - 2601382622216285712
2024-02-15T10:40:19.380Z - 2601382613113594654
2024-02-15T10:40:18.858Z - 2601382615804195620
2024-02-15T08:17:30.676Z - 2601297622319631082

[^nohup.rar]

{noformat}2024/02/15 10:37:41.520 INFO  [pool-1-thread-116] ->  [paypower_request_identifier-3005105]  [dd.trace_id-3448667380742807893]  [dd.span_id-3042177235806932300] Logics.RequestRouter - 0100 message arrived
2024/02/15 10:37:43.159 INFO  [pool-1-thread-120] ->  [paypower_request_identifier-3005107]  [dd.trace_id-1733823898146535381]  [dd.span_id-49597438797311119] Logics.RequestRouter - 0100 message arrived
2024/02/15 10:37:45.535 INFO  [pool-1-thread-119] ->  [paypower_request_identifier-3005108]  [dd.trace_id-7038264003890230978]  [dd.span_id-3016734107451923711] Logics.RequestRouter - 0100 message arrived
2024/02/15 10:37:50.486 INFO  [pool-1-thread-122] ->  [paypower_request_identifier-3005109]  [dd.trace_id-4713245019964528913]  [dd.span_id-4201088942824609774] Logics.RequestRouter - 0420 message arrived
2024/02/15 10:37:51.962 INFO  [pool-1-thread-121] ->  [paypower_request_identifier-3005111]  [dd.trace_id-5344761978493563017]  [dd.span_id-2938344457743541536] Logics.RequestRouter - 0100 message arrived
2024/02/15 10:37:52.073 INFO  [pool-1-thread-124] ->  [paypower_request_identifier-3005112]  [dd.trace_id-8469515388001496936]  [dd.span_id-2243525914870569405] Logics.RequestRouter - 0420 message arrived
2024/02/15 10:37:54.455 INFO  [pool-1-thread-123] ->  [paypower_request_identifier-3005116]  [dd.trace_id-8939862800529966417]  [dd.span_id-1048969779395055656] Logics.RequestRouter - 0420 message arrived
2024/02/15 10:37:54.744 INFO  [pool-1-thread-116] ->  [paypower_request_identifier-3005105]  [dd.trace_id-3448667380742807893]  [dd.span_id-3042177235806932300] Logics.RequestRouter - 0100 - message from PayRoute : 30313030767F4601A8E1A20A313635333733313230303030303030333830303030303030303030303030303031323439303030303030303031323439303231353130333734313631303030303030313935363230313033373431303231353239303130323135303231343539343030373130303030363031353830343036323030333635333735333733313230303030303030333830443239303132323630323137323038393731303030343034363130313935363230323837333734393639313039313032322020202020202048414C464F5244532030353736202020202020202020204C55544F4E20202020202020202047425230343152323330323030363130353030303031373531333031303330303130323032393137313034313843203832363832363131389F260835707A893C2AA4059F2701809F10140110A04303A200210000000000009747FFFF00009F370471F17FA79F36020005950500000080009A032402159C01009F02060000000012495F2A020826820219809F1A0208269F34031F03029F33030008089F3501228407A00000000410109F09020002303236303030303031303030303330303832364C553220305358202020303039425044424748543851{noformat}



* *Expected result*: no delay in authorization process.",,Florin Vistig,michael.ellery,muneer,Prabin Shrestha,Salik.hashmi,Savio,Zendesk Support for Jira,,,,,5a9e4751a00c7f2a80155fda,6273fc10807e0000691d5dee,63c1495f2341bff4fff70492,6195bb56ef18ca0071c7a9de,611a52967b538a006964a439,60fedd388ad5b600707750e1,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,16/Feb/24 11:45 AM;63c1495f2341bff4fff70492;Mettle_PP.zip;https://paymentology.atlassian.net/rest/api/3/attachment/content/77703,16/Feb/24 11:45 AM;63c1495f2341bff4fff70492;Mettle_log.rar;https://paymentology.atlassian.net/rest/api/3/attachment/content/77706,15/Feb/24 8:13 PM;ug:3be053c3-01f4-4781-82bb-7e1d33bac05f;Screenshot 2024-02-15 at 15.07.19.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/77667,16/Feb/24 11:45 AM;63c1495f2341bff4fff70492;image-20240216-093016.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/77704,16/Feb/24 11:45 AM;63c1495f2341bff4fff70492;image-20240216-093045.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/77705,16/Feb/24 11:40 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20240216-093810.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/77701,19/Feb/24 12:49 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20240219-104711.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/77820,19/Feb/24 4:46 PM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20240219-144358.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/77845,15/Feb/24 8:13 PM;ug:3be053c3-01f4-4781-82bb-7e1d33bac05f;nohup.rar;https://paymentology.atlassian.net/rest/api/3/attachment/content/77666,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PE - Processing  - Authorisations,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@7a82986d,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,Shared Production [BL],,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=14, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":14,""lastUpdated"":""2024-02-20T09:40:28.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":14,""name"":""GitLab""},""GitHub"":{""count"":10,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,Mettle,1|hzz9zj:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,Auth Sprint 1,Auth Sprint 2,,,,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-02-16 09:33:51.851,10306_*:*_1_*:*_58117795_*|*_3_*:*_1_*:*_2080643_*|*_10000_*:*_1_*:*_3144491_*|*_10001_*:*_1_*:*_0_*|*_10345_*:*_1_*:*_845053949,,16/Feb/24 11:33 AM;5a9e4751a00c7f2a80155fda;[~accountid:6205526df38765006f676f67] have you checked with the DBAs if there’s been any issues with the database on that environment during the time of those timeouts ?,"16/Feb/24 11:40 AM;6195bb56ef18ca0071c7a9de;[~accountid:5a9e4751a00c7f2a80155fda] [~accountid:6205526df38765006f676f67] Issue is while printing the raw ISO message of payroute. We need to add a message pack as a parameter in log.info. If the message pack is not present, a DB call for that log will be done immediately.

!image-20240216-093810.png|width=1303,height=212!

The question is: do we need those raw ISO logs on the split screen? If we add the messagepack now, it will be visible on the paycontrol split screen, which clients are not aware of.","16/Feb/24 11:45 AM;63c1495f2341bff4fff70492;Hi Team,



Slack Thread: [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1707983308068469|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1707983308068469|smart-link]  DB team confirmed there is no issue with DB.



Still, we can see that few transactions are taking time to process in Pay power (split into components). Kindly find the sample TID 2602190282637231573.Kidnly find the attached logs.



Paypower: In paypower we can see the transactions 100 message arrived but to split the message it is taking much time which causing the issue.



[^Mettle_PP.zip]
[^Mettle_log.rar]

 INFO  [pool-1-thread-98] ->  [paypower_request_identifier-3018719]  [dd.trace_id-583673138415690942]  [dd.span_id-322150073275547704] Logics.RequestRouter -  0100 message arrived
+*2024/02/16 05:17:15.657*+ INFO  [pool-1-thread-98] ->  [paypower_request_identifier-3018719]  [dd.trace_id-583673138415690942]  [dd.span_id-322150073275547704] Logics.RequestRouter -  0100 - message from PayRoute : 30313030F67F44018861A00E000000000000010031363533373331323030303030303737393330303030303030303030303030303134393030303030303030303134393030323136303531
3730383631303030303030323331353733303631373038303231363238313030323135303231353431313231303230363033323633373036323030333533343034373035323331353733373937393637303030333832343536477
2656174657220416E676C6961205261696C202020204C6F6E646F6E2020202020202020474252313538543232313430313032303230353034433130313432303730313033323136343332386B4E4D494259717076484C47707758
535452454672594A68644C427A3636343530313031323032333633666662393837312D306233332D343132612D383766382D636662613362653131343332383230323532393230333230353631303530303030313735313330313
0333030313032303239343731303431384320383236383236303234313032353130303030363030303832364543314E203254443031365852324A5A4E44324C534344504B35323030394250444F59434D50503031383034313439
30202020202020203832313439
+*2024/02/16 05:17:15.657*+ INFO  [pool-1-thread-98] ->  [paypower_request_identifier-3018719]  [dd.trace_id-583673138415690942]  [dd.span_id-8746439304521219203] Logics.Message0100Proc  essThread - Split into components - 

CustomHeader{arqc=9, cvv=1, aav=1, cvvType=2, mac=0, rid=1724021605170845569} 



!image-20240216-093016.png|width=2123,height=647!

!image-20240216-093045.png|width=2383,height=629!","16/Feb/24 11:46 AM;6195bb56ef18ca0071c7a9de;solution is to 

# Remove logs for raw ISO message
# If a raw ISO message is required, the client should be aware of new changes in the split screen.
# I think log.debug will not call DB (need to check)

AFAIK, those changes were done only for debug purposes to replicate the production scenario locally with RAW data.","16/Feb/24 11:47 AM;6195bb56ef18ca0071c7a9de;[~accountid:63c1495f2341bff4fff70492] check this response

[https://paymentology.atlassian.net/browse/DEFECT-314?focusedCommentId=170516|https://paymentology.atlassian.net/browse/DEFECT-314?focusedCommentId=170516|smart-link] ","16/Feb/24 1:01 PM;6195bb56ef18ca0071c7a9de;MR has been created to remove raw message logging

[https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/639|https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/639|smart-link] 



[~accountid:6205526df38765006f676f67] What is the BL version for a mettle environment? Please provide the HF branch if a patch is required.

Otherwise it’ll deploy with regular 3-week cycle deployment.","16/Feb/24 3:58 PM;63c1495f2341bff4fff70492;Hi [~accountid:611a52967b538a006964a439]/ [~accountid:61f80302845d670071f2138e] ,



Request you provide the HF branch details for Mettle? ","19/Feb/24 12:06 PM;611a52967b538a006964a439;Hello[~accountid:6195bb56ef18ca0071c7a9de] , Mettle is on BL 2.5.X,  Hotfix branch for PP is [/release/3.23|https://gitlab.com/paymento/source/bl2.0/paypower/-/commits/release/3.23].

For other components, please refer [https://paymentology.atlassian.net/wiki/spaces/TS/pages/6975914067/Banking.Live+Release+Management|https://paymentology.atlassian.net/wiki/spaces/TS/pages/6975914067/Banking.Live+Release+Management|smart-link] ","19/Feb/24 12:49 PM;6195bb56ef18ca0071c7a9de;[~accountid:611a52967b538a006964a439] HYG (waiting for MR approval). If HF, [~accountid:63c1495f2341bff4fff70492] can you please fill up the ECR (if needed)?

MR for 3.23 = [https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/640|https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/640|smart-link] 

3.24 = [https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/641|https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/641|smart-link] 

3.25 = [https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/642|https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/642|smart-link] 

3.26 = 

!image-20240219-104711.png|width=1142,height=440!

MR for the above change was created for higher branches. 

cc [~accountid:63c148ea94d18cbf6773411b] ",19/Feb/24 1:51 PM;6195bb56ef18ca0071c7a9de;[~accountid:611a52967b538a006964a439] merged now.,"19/Feb/24 3:29 PM;611a52967b538a006964a439;[~accountid:6195bb56ef18ca0071c7a9de] ,

Please also merge here on this branch - [/hotfix/3.23.6|https://gitlab.com/paymento/source/bl2.0/paypower/-/tree/hotfix/3.23.6?ref_type=heads]",19/Feb/24 4:33 PM;60fedd388ad5b600707750e1;[~accountid:6195bb56ef18ca0071c7a9de] Please confrim if the fix is merged to Hotfix branch,"19/Feb/24 4:35 PM;6195bb56ef18ca0071c7a9de;no, not merged in /hotfix/3.23.6 branch.

Change merged to only this branch [https://paymentology.atlassian.net/browse/DEFECT-314?focusedCommentId=170795|https://paymentology.atlassian.net/browse/DEFECT-314?focusedCommentId=170795|smart-link]  and higher branch.","19/Feb/24 4:41 PM;611a52967b538a006964a439;[~accountid:6195bb56ef18ca0071c7a9de] Please merge it to [/hotfix/3.23.6|https://gitlab.com/paymento/source/bl2.0/paypower/-/tree/hotfix/3.23.6?ref_type=heads].

Moving forward, kindly refer to the [*Confluence page*|https://paymentology.atlassian.net/wiki/spaces/TS/pages/6975914067/Banking.Live+Release+Management] for the latest hotfix branches to merge for any BL family. 
","19/Feb/24 4:46 PM;6195bb56ef18ca0071c7a9de;Sure [~accountid:611a52967b538a006964a439]. was following this previously

!image-20240219-144358.png|width=272,height=53!

Next time, will follow the confluence page. Do we need to provide this ticket for CCM?","20/Feb/24 8:24 AM;6195bb56ef18ca0071c7a9de;MR created for HF branch => [https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/643|https://gitlab.com/paymento/source/bl2.0/paypower/-/merge_requests/643|smart-link] 

Waiting for merge.

[~accountid:611a52967b538a006964a439] Let me know if we need to present this in today CCM?",20/Feb/24 9:39 AM;60fedd388ad5b600707750e1;[~accountid:6195bb56ef18ca0071c7a9de] please present this in CCM.,"20/Feb/24 1:10 PM;611a52967b538a006964a439;Following CCM 20/02

*Mettle* => 22/02 conditionally planned. TBD with [~accountid:6273fc10807e0000691d5dee].
BAE => 22/02 followed by notification as below:

*Activity Date:* 22/02
*Activity Time:* 0300 - 0500 UTC
*Risk time:* 2 Hrs
*Downtime:* 5 mins (PP will be restarted)","20/Feb/24 1:25 PM;611a52967b538a006964a439;[~accountid:6195bb56ef18ca0071c7a9de] ,

Can you please confirm if this issue/fix is specific to mastercard or for visa clients as well ?","20/Feb/24 1:35 PM;6195bb56ef18ca0071c7a9de;[~accountid:611a52967b538a006964a439] issue/fix is general i.e. network-independent. If possible, we need to roll it out in every environment.

btw, the issue is random, which means if connection between paylog db and ppwr does take time, then we see a delay there. But if the connection is fast, the issue is rare. (maybe mettle have low resources.)","22/Feb/24 1:07 PM;6273fc10807e0000691d5dee;Hi all, can somebody please help understand why this behaviour was changed in the version upgrade. [~accountid:611a52967b538a006964a439] can you please help fill this in? Was it communicated to Mettle?",22/Feb/24 1:53 PM;60fedd388ad5b600707750e1;[~accountid:6273fc10807e0000691d5dee] As per the comments from Prabin i don't think this is closely related to the release that was done. Prabin can you also please confirm the same.,"22/Feb/24 1:53 PM;60fedd388ad5b600707750e1;[~accountid:6195bb56ef18ca0071c7a9de] , verified this fix is merged to all relevant higher branches 🙂 ",22/Feb/24 1:58 PM;6273fc10807e0000691d5dee;Thanks Savio yes as we aren’t doing an RCA I need to communicate to the client why this has happened,"26/Feb/24 7:45 AM;6195bb56ef18ca0071c7a9de;Hi [~accountid:6273fc10807e0000691d5dee] [~accountid:60fedd388ad5b600707750e1] Here is timeline of that change

2023-11-28 → Change done to log raw message sent by payroute merged to master branch. Change present in ppwr tag 3.21+ (BL 2.3 I believe)

2024-02-02 → Mettle upgrade to BL 2.5.x

2024-02-16 → Change removed from master and all tags 3.23+ ( [https://paymentology.atlassian.net/browse/DEFECT-314?focusedCommentId=170818|https://paymentology.atlassian.net/browse/DEFECT-314?focusedCommentId=170818|smart-link] )



Hope this helps 🙂 ",26/Feb/24 7:45 AM;6195bb56ef18ca0071c7a9de;Closing this ticket.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147455,AUTH-1096,BAU Bug Fixes - PayPower,Done,26/Feb/24 7:45 AM
[DE Rollout: Mettle] PROD Active Mode Enablement,DEC-1081,185005,Epic,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,11/Nov/25 7:24 PM,10/Dec/25 10:21 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@65fa3c92,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,ghx-label-3,[DE Rollout: Mettle] PROD Active Mode Enablement,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,yellow,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06xej:wi,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,184957,TECH-834,[DE Rollout] Mettle,To Do,11/Nov/25 7:24 PM
[DE Rollout: Mettle] PROD Shadow Mode Enablement,DEC-1080,185003,Epic,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,11/Nov/25 7:24 PM,10/Dec/25 10:21 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6bc96437,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,ghx-label-2,[DE Rollout: Mettle] PROD Shadow Mode Enablement,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,dark_yellow,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06xej:si,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,184957,TECH-834,[DE Rollout] Mettle,To Do,11/Nov/25 7:24 PM
[DE Rollout: Mettle] UAT Shadow and Active Mode Enablement,DEC-1079,185001,Epic,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,11/Nov/25 7:23 PM,10/Dec/25 10:21 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@c1d2f69,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,ghx-label-7,[DE Rollout: Mettle] UAT Shadow and Active Mode Enablement,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,purple,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06xej:ji,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,184957,TECH-834,[DE Rollout] Mettle,To Do,11/Nov/25 7:23 PM
[DE Rollout: Mettle] Client Side Adjustments,DEC-1078,184998,Epic,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,11/Nov/25 7:23 PM,10/Dec/25 10:21 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@684ebec9,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,ghx-label-6,[DE Rollout: Mettle] Client Side Adjustments,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,green,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06xej:d,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,184957,TECH-834,[DE Rollout] Mettle,To Do,11/Nov/25 7:23 PM
[DE Rollout: Mettle] Migration Plan Preparation,DEC-1077,184996,Epic,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,11/Nov/25 7:23 PM,10/Dec/25 10:21 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@1471b0f1,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,ghx-label-9,[DE Rollout: Mettle] Migration Plan Preparation,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,orange,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06xei:d,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,184957,TECH-834,[DE Rollout] Mettle,To Do,11/Nov/25 7:23 PM
[DE Rollout: Mettle] Initiation,DEC-1076,184994,Epic,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,11/Nov/25 7:23 PM,10/Dec/25 10:21 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6e8124af,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,ghx-label-11,[DE Rollout: Mettle] Initiation,To Do,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,teal,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06xeg:r,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,184957,TECH-834,[DE Rollout] Mettle,To Do,11/Nov/25 7:23 PM
Prepare Roll Out/Migration Plan for Mettle,DEC-916,172204,Task,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,Sean Routledge,557058:4f540850-1319-42e3-9630-bc67cd95e8c2,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,19/Aug/25 12:09 PM,30/Jan/26 11:59 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@453fc88b,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07w2g:,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,DE - Sprint 14,DE - Sprint 30,DE - Sprint 31,DE - Sprint 32,DE - Sprint 33,DE - Sprint 34,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,184996,DEC-1077,[DE Rollout: Mettle] Migration Plan Preparation,To Do,15/Jan/26 1:12 PM
[UAT] Recreate Mettle Rules in UAT in DE,DEC-913,172198,Task,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,Sean Routledge,557058:4f540850-1319-42e3-9630-bc67cd95e8c2,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,19/Aug/25 12:09 PM,26/Jan/26 5:30 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,Sean Routledge,,,,,,,,,,62b2cab1cebad33432f75d77,557058:4f540850-1319-42e3-9630-bc67cd95e8c2,,,,,,,,,,,,,,,,,,AUTH-1788,DEC-1176,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6469e1fb,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07lbg:,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,DE - Sprint 30,DE - Sprint 31,DE - Sprint 32,DE - Sprint 33,DE - Sprint 34,,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-12-12 14:44:24.096,,,"12/Dec/25 4:44 PM;557058:4f540850-1319-42e3-9630-bc67cd95e8c2;CheckMerchantActivity rule is a tricky one which we cannot implement correctly right now:



{noformat}public.srf_CheckMerchantActivity(<CTP>, _h_DE39_PATTERN_STR=>'IN;14', _h_datepart_diff=>600::BIGINT, _N_LOGIC=>'AND', _N_PERC_PATTERN_STR=>'>=;70', _N_FIXED_PATTERN_STR=>'>;5', _check_current_txn=>FALSE){noformat}



h3. What {{public.srf_CheckMerchantActivity}} is meant to detect

* The function fires when the *number of declined transactions for the same merchant (DE42) made with distinct cards (DE2) exceeds configured thresholds within a lookback window*. Declines are identified by response codes matching {{_h_DE39_PATTERN_STR}}, and thresholds can be expressed both as an absolute count and as a percentage of total transactions in that window.

h3. How your specific call is evaluated

* {{_h_DE39_PATTERN_STR => 'IN;14'}}: count only historical transactions whose DE39 response code is in the set {{{14}}} (a decline code).

* {{_h_datepart_diff => 600::BIGINT}}: limit historical transactions to the last *600 seconds (10 minutes)*.
* {{_N_PERC_PATTERN_STR => '>=;70'}}: one threshold is met when *at least 70% of all transactions to that merchant in the window are declines*.
* {{_N_FIXED_PATTERN_STR => '>;5'}}: the second threshold is met when *more than 5 declining transactions* are found.
* {{_N_LOGIC => 'AND'}}: the rule only triggers if *both* the percentage and fixed-count thresholds are satisfied (i.e., ≥70% declines *and* >5 declining txns).
* {{_check_current_txn => FALSE}}: the current transaction is *not required to match the decline pattern*; the rule evaluates purely on historical data and does not return early just because the current transaction fails the pattern.

h3. Practical effect of the supplied invocation

With these parameters, the rule will trigger when, in the past 10 minutes for the same merchant, there are *more than five declining transactions (DE39=14) made with distinct cards, and those declines make up at least 70% of all transactions to the merchant*—regardless of whether the current transaction itself is a decline.



Created PB Idea for solving of this: [https://paymentology.productboard.com/detail/MTpQbUVudGl0eTpkZjk5YzIxMy0wMmY3LTRlZTMtYjE4Yy04OTc5ZjA5YWIwZDk=|https://paymentology.productboard.com/detail/MTpQbUVudGl0eTpkZjk5YzIxMy0wMmY3LTRlZTMtYjE4Yy04OTc5ZjA5YWIwZDk=|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,185001,DEC-1079,[DE Rollout: Mettle] UAT Shadow and Active Mode Enablement,To Do,26/Jan/26 5:30 PM
[PROD] Enable DE for Mettle in target PROD,DEC-909,172190,Task,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,19/Aug/25 12:08 PM,24/Dec/25 3:31 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@4611a7b,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06xej:ti,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,185003,DEC-1080,[DE Rollout: Mettle] PROD Shadow Mode Enablement,To Do,19/Aug/25 12:08 PM
[PROD] Recreate Mettle Rules in PROD in V3,DEC-908,172188,Task,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Mariia Mishenina,62b2cab1cebad33432f75d77,Mariia Mishenina,62b2cab1cebad33432f75d77,19/Aug/25 12:08 PM,24/Dec/25 3:31 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Mariia Mishenina,,,,,,,,,,,62b2cab1cebad33432f75d77,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@712b159,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i06xej:ui,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,185003,DEC-1080,[DE Rollout: Mettle] PROD Shadow Mode Enablement,To Do,19/Aug/25 12:08 PM
Preload test environment with Mettle setup,DEC-696,158585,Task,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Luis Diaz,5a4b476e2724d02a6fe27cfd,Luis Diaz,5a4b476e2724d02a6fe27cfd,01/May/25 1:24 PM,27/Aug/25 4:21 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,de-p1-dedicatedUAT,,,,,,Luis Diaz,,,,,,,,,,,5a4b476e2724d02a6fe27cfd,,,,,,,,,,,,,,,,,,,,,,DEC-575,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@754cb6d7,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i04ftk:,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,No,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2.0,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,138578,DEC-331,Performance testing,To Do,01/May/25 1:24 PM
Load the client feature dependent tables for Mettle,DEC-658,157324,Story,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Luis Diaz,5a4b476e2724d02a6fe27cfd,Luis Diaz,5a4b476e2724d02a6fe27cfd,21/Apr/25 1:54 PM,27/Aug/25 4:21 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,de-p1-dedicatedUAT,,,,"In order to test Constantinople, create a load pipeline and scripts to load the feature dependent tables for TymeBank in: [Performance testing load.xlsx|https://paymen.sharepoint.com/:x:/r/sites/Engineering/Engineering/Teams/Decision%20Engine/v3/Testing/Performance%20testing%20load.xlsx?d=w206754b61b17425cb2335693d4267ed1&csf=1&web=1&e=kCAFry]

This in principle means loading [their Rules|https://paymentology.atlassian.net/browse/DEC-574] in both v1 and v3 (and linking them to the test client), but the task should be extended to load other v1 tables that are relevant depending on the client rule scopes, actions, etc and whether that setup could have any performance impact. ",,Luis Diaz,,,,,,,,,,,5a4b476e2724d02a6fe27cfd,,,,,,,,,,,,,,,,,,,,,,,,,,,DEC-621,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@471f34a7,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i04bn4:,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,4.0,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,138578,DEC-331,Performance testing,To Do,21/Apr/25 1:54 PM
Performance testing on Mettle Ruleset,DEC-575,154107,Task,Backlog,DEC,PE - Processing - Rule Engine,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Sean Routledge,557058:4f540850-1319-42e3-9630-bc67cd95e8c2,Sean Routledge,557058:4f540850-1319-42e3-9630-bc67cd95e8c2,12/Mar/25 9:41 PM,27/Aug/25 4:21 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,de-p1-dedicatedUAT,,,,,,Sean Routledge,,,,,,,,,,,557058:4f540850-1319-42e3-9630-bc67cd95e8c2,,,,,,,,,,,,,,,,,,,DEC-696,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@525c13cd,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,"* TymeBank currently have [7 rules|https://paymen-my.sharepoint.com/:x:/g/personal/sean_paymentology_com/EcFkx1Mm-zNGlzOp751A_yEBaSJAikGNDokuZANBaN8XKQ?e=p9dvi9&nav=MTVfezk0ODgxNEZDLUYwRjUtNEEyQS04NzJDLUM0OTNGQzgyQjJEOX0] (Only 5 of them implementable on Decision Engine)
** Multi Country Check
** Multiple Failures - Same Card 5 Minutes
** Multiple Approvals - Same Card +  Merchant 24 hours
** Blocked Merchant IDs
** {color:#ff5630}BIN Attack Monitor{color}
** Merchant Block for Woods Supermarket
** {color:#ff5630}Bin Attack Monitor 2{color}
* The maximum lookback of the rules is 1 Day (ignoring the {color:#ff5630}BIN attack rules{color} which we cannot implement in Decision Engine as of yet)



Please use these to create a baseline for the performance testing

* We need to measure execution time so we get average latency, p95, p99 etc
* We need to simulate TPS loads
** So we can measure perf degradation
*** It would be good to run the rules on a card with increasing transaction history 10, 50, 100, 1000 etc
** Checking how the service performs with concurrent transactions",,,,,,,,,,,,,,,1|i04ftq:,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,No,,,,,,,,,,,,,,,,,,,,,,,,,,,,Sprint 23,Sprint 24,,,,,,,,,,,,,,3.0,,,,,,,,,,,,110e233c-4c14-471d-b1e2-dfbcfe063c41,PE - Processing - Decision Engine,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,138578,DEC-331,Performance testing,To Do,12/Mar/25 9:41 PM
B.L UAT - Mettle - Unthrottling Fast endpoint Feature - Error raised during job task processing,CLR-803,156951,Bug,Released,CLR,PE - Processing - Clearing,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,Released,Bimal Paudel,619a20dff2415000728442aa,Mostafa Elhoseiny,6328729388ed2ebef978552f,Mostafa Elhoseiny,6328729388ed2ebef978552f,15/Apr/25 5:14 PM,08/Jul/25 5:48 AM,,26/May/25 11:20 AM,BL-2.25.4,BL-2.26.1,BL-2.27.0,PCDB-1.140.6,PCDB-1.157.1,PCDB-1.160.2,,,,,,,,,,,,,,,,,0,,,,,"Hi [PE - Processing - Authorisations|https://paymentology.atlassian.net/people/team/ef96ef5c-c768-4bd0-8bc7-c179e9e5f299] ([~accountid:5a9e4751a00c7f2a80155fda] [~accountid:62c5616bb6357aecd7c70e56]) 
We are testing the Throttling and Un-throttling feature for Mettle , please find the testing result : 

- *Throttling* the fast endpoint done successfully when determined One transaction within 10 seconds , “Is_Throttling” changed from “False” to “True” - *Passed*

- *Un-Throttling* job task raised an error during processing , as per the documentation [here|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7891812384/STIP+Internal+Document#%5BinlineExtension%5DThrottling/un-throttling] that the scheduled time “Every 5 seconds” should try sending the first Advice transaction hasn’t been sent to the external system to determine if the endpoint is reachable or not.

!image-20250415-150717.png|width=1448,height=528,alt=""image-20250415-150717.png""!

*Payschduler logs :* 

{noformat}NA:NA 2025-04-15 14:36:45.005 [Scheduler_Worker-10] INFO  JobThrottleFastEndpoint - ...........................Job started..................................
Marcopolo_NL:V 2025-04-15 14:36:45.006 [Scheduler_Worker-1] INFO  JobSendFastNotifications - ...............................................Job started - id - 674...............................................674
NA:NA 2025-04-15 14:36:45.006 [Scheduler_Worker-6] INFO  JobUnThrottleFastEndpoint - ...........................Job started..................................
Marco Polo:V 2025-04-15 14:36:45.007 [Scheduler_Worker-5] INFO  JobSendFastNotifications - ...............................................Job started - id - 513...............................................513
Snappi:M 2025-04-15 14:36:45.007 [Scheduler_Worker-9] INFO  JobSendFastNotifications - ...............................................Job started - id - 737...............................................737
Marcopolo_NL:V 2025-04-15 14:36:45.008 [Scheduler_Worker-1] INFO  SendFastNotifications - Fast Config loaded from db
Marco Polo:V 2025-04-15 14:36:45.008 [Scheduler_Worker-5] INFO  SendFastNotifications - Fast Config loaded from db
Snappi:M 2025-04-15 14:36:45.009 [Scheduler_Worker-9] INFO  SendFastNotifications - Fast Config loaded from db
NA:NA 2025-04-15 14:36:45.011 [Scheduler_Worker-10] INFO  ThrottleFastEndpoint - Active: 0 & Passive: 0 fast endpoint throttled for: Client: Mettle, ICA: 21149

NA:NA 2025-04-15 14:36:45.019 [Scheduler_Worker-10] INFO  JobThrottleFastEndpoint - ...........................Job ended.................................
NA:NA 2025-04-15 14:36:45.033 [Scheduler_Worker-6] INFO  ThrottleFastEndpoint - Throttle time expired fast endpoint count: 1 for: Client: Mettle, ICA: 21149
NA:NA 2025-04-15 14:36:45.034 [Scheduler_Worker-6] ERROR  ThrottleFastEndpoint - Error during fast endpoints un-throttling for: Client: Mettle, ICA: 21149
java.lang.NullPointerException: Cannot invoke ""java.lang.Boolean.booleanValue()"" because the return value of ""java.util.Map.get(Object)"" is null
        at com.paymentology.payscheduler.modules.clearing.fastapi.services.FastService.prepareFastAdvice(FastService.java:18)
        at com.paymentology.payscheduler.modules.clearing.fastapi.ThrottleFastEndpoint.tryMendFastEndpoint(ThrottleFastEndpoint.java:73)
        at com.paymentology.payscheduler.schedulerjobs.JobUnThrottleFastEndpoint.execute(JobUnThrottleFastEndpoint.java:34)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:203)
        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:570)
NA:NA 2025-04-15 14:36:45.047 [Scheduler_Worker-6] INFO  JobUnThrottleFastEndpoint - ...........................Job ended.................................

{noformat}

*Conditions in Conf_pauth Table*

!image-20250415-145444.png|width=1208,height=290,alt=""image-20250415-145444.png""!

* Is there something missing in the configuration ?
* Why this error raised and the advice message couldn’t be sent to check the reachability ?",*Shared Azure UAT*,Bimal Paudel,Mostafa Elhoseiny,Savio,William Dunne,,,,,,,,619a20dff2415000728442aa,6328729388ed2ebef978552f,60fedd388ad5b600707750e1,557058:5363d7a1-da13-4012-8609-f44e54c1d062,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,15/Apr/25 5:14 PM;6328729388ed2ebef978552f;image-20250415-145444.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/110236,15/Apr/25 5:14 PM;6328729388ed2ebef978552f;image-20250415-150717.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/110235,23/Apr/25 7:46 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;image-20250423-054635.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/110802,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5aa84781,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,prod/bae,prod/boj,prod/isb,prod/mox,prod/om,prod/shared,prod/shared02,uat/aws,uat/isb,uat/om,uat/shared,,,,,,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=3}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":3,""lastUpdated"":""2025-04-25T15:39:46.000+0200"",""stateCount"":3,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitHub"":{""count"":3,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i049t8:,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,CLR Sprint 23,,,,,,,,,,,,,,,,,,,,,,,,,,,a8693810-01fb-4d1c-8714-51e4229f5c10,PE - Processing - Clearing,"h3. Successfully task execution logs for UnThrottleFastEndpoint task after implementing fixes.

!image-20250423-054635.png|width=1117,height=362,alt=""image-20250423-054635.png""!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-04-15 17:41:48.669,10306_*:*_1_*:*_67208903_*|*_3_*:*_1_*:*_428641581_*|*_10000_*:*_1_*:*_4020_*|*_10001_*:*_1_*:*_0_*|*_10400_*:*_1_*:*_362786388,,15/Apr/25 5:14 PM;6328729388ed2ebef978552f;cc : [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] ,15/Apr/25 7:41 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6328729388ed2ebef978552f] this task is actually currently handled by clearing team cc/ [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] / [~accountid:627e6181f29dcb0068fa4152] ,"16/Apr/25 11:54 AM;619a20dff2415000728442aa;Hello [~accountid:6328729388ed2ebef978552f], 
It seems that a bug was introduced by some changes in the related function, will provide a fix soon.","16/Apr/25 11:58 AM;6328729388ed2ebef978552f;Thanks [~accountid:619a20dff2415000728442aa] for your reply , waiting the fix deployment..","23/Apr/25 12:00 PM;6328729388ed2ebef978552f;Hi [~accountid:619a20dff2415000728442aa] 

Is this issue fixed ? i see you attached an evidence in the testing section. 
But i still see a null pointer exception raised in the payscheduler logs related to the job task : 


{noformat}NA:NA 2025-04-23 09:56:15.040 [Scheduler_Worker-9] INFO  ThrottleFastEndpoint - Throttle time expired fast endpoint count: 1 for: Client: Mettle, ICA: 21149
NA:NA 2025-04-23 09:56:15.041 [Scheduler_Worker-9] ERROR  ThrottleFastEndpoint - Error during fast endpoints un-throttling for: Client: Mettle, ICA: 21149
java.lang.NullPointerException
NA:NA 2025-04-23 09:56:15.054 [Scheduler_Worker-9] INFO  JobUnThrottleFastEndpoint - ...........................Job ended.................................{noformat}


*Environment : Azure Shared UAT*","23/Apr/25 3:28 PM;619a20dff2415000728442aa;Hello [~accountid:6328729388ed2ebef978552f],
Fix has been applied to master branch and pull request for QA: [paycoredb-590|https://github.com/Paymentology/paycoredb/pull/590] and UAT: [paycoredb-591|https://github.com/Paymentology/paycoredb/pull/591], however the pipelines are failing due to unexpected error getting help from DevSecOps [here|https://paymentology.slack.com/archives/C07627AHT9C/p1745414850966529] for resolution, once the build is successful fix can be deployed to the necessary environment.","23/Apr/25 4:03 PM;6328729388ed2ebef978552f;Thanks [~accountid:619a20dff2415000728442aa] for your clarification , waiting the UAT deployment.","25/Apr/25 3:42 PM;619a20dff2415000728442aa;Hello Team,
Necessary fixes are patched in both QA *[BL-2.26]* and UAT *[BL-2.25]*.
Please proceed with test after deploying necessary component *[PCDB-1.140.6]* in SharedUAT.
cc. [~accountid:6328729388ed2ebef978552f] [~accountid:60fedd388ad5b600707750e1] 
Thank you.","28/Apr/25 12:39 PM;6328729388ed2ebef978552f;Thanks [~accountid:619a20dff2415000728442aa] 

Hi [~accountid:60fedd388ad5b600707750e1] 
When will this component be deployed in Azure Sh-UAT ?","28/Apr/25 1:05 PM;60fedd388ad5b600707750e1;[~accountid:6328729388ed2ebef978552f] , This will be deployed to shared UAT tomorrow morning.",28/Apr/25 1:06 PM;6328729388ed2ebef978552f;Thank you [~accountid:60fedd388ad5b600707750e1] appreciated,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147662,CLR-714,Defects,Done,25/Apr/25 3:44 PM
BL | METTLE | PROD | Change to refund presentment processing post Production env upgrade | ZD-649169,CLR-45,117749,Bug,Released,CLR,PE - Processing - Clearing,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,Done,Bimal Paudel,619a20dff2415000728442aa,Juliano Polican Ciena,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,08/Dec/23 3:13 AM,21/Apr/25 7:36 PM,,12/Feb/24 11:45 AM,,,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,,,,"*A summary of the request/issue*:
Since the Production upgrade to environment on 8th Nov, client is receiving refund presentments linked with the same TID as the authorization. See examples:

* 2514579852637608120
* 2514468752637148344

Prior to the upgrade, all refund presentments were sent with their own distinct TID, i.e., not linked to authorisations, debit presentments etc.

Client says it's unexpected functionality and their platform cannot adequately handle this processing.

They found in our documentation that should be the case: [https://developer.paymentology.com/docs/mapping-of-ids:|https://developer.paymentology.com/docs/mapping-of-ids:]

!image-20231208-011504.png|width=827,height=664!

Please let us know whether it's a bug or change in processing after the upgrade. If new behavior, can that be reverted back to the previous behavior where all refund presentments are not linked to an existing TID?

*Platform:* Banking.Live

*Environment* PROD - METTLE

*Runbooks used*: N/A

*Troubleshooting Steps Followed* (please try to list everything you have already verified )

AS checked the transactions in PC and each refund has same TID (attached)

*Bug Details:* only If we find it as a bug, add the details of your finding

Described above.

*Expected result*: all refund presentments with their own distinct TID

* Please see Zendesk Support tab for further comments and attachments.

[^Transaction - 08-Dec-2023 00_19_40.xlsx]
[^Transaction - 08-Dec-2023 00_19_58.xlsx]

",,Bimal Paudel,Florin Vistig,Juliano Polican Ciena,Lukasz Gawronski,michael.ellery,Prabin Shrestha,Salik.hashmi,Savio,Suganya.Eswaran,upendra gautam,Zendesk Support for Jira,619a20dff2415000728442aa,5a9e4751a00c7f2a80155fda,712020:451c3a5b-a404-4cb0-99f0-1c72489bd955,63c148ea94d18cbf6773411b,6273fc10807e0000691d5dee,6195bb56ef18ca0071c7a9de,611a52967b538a006964a439,60fedd388ad5b600707750e1,63c149612a526608c55073dd,60fedd46b704b400688a8e79,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,17/Jan/24 9:29 AM;63c148ea94d18cbf6773411b;Screenshot 2024-01-17 at 08.25.02.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/75314,20/Dec/23 11:11 AM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;Settlement Matching Change Log 2022_10_12 (58efc6d4-cb8a-4a76-b48f-83ed49847454).pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/73843,08/Dec/23 3:16 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Transaction - 08-Dec-2023 00_19_40.xlsx;https://paymentology.atlassian.net/rest/api/3/attachment/content/73061,08/Dec/23 3:16 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Transaction - 08-Dec-2023 00_19_58.xlsx;https://paymentology.atlassian.net/rest/api/3/attachment/content/73062,08/Dec/23 3:16 AM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;image-20231208-011504.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73063,13/Dec/23 10:26 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20231213-082139.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73419,13/Dec/23 10:26 AM;ug:0edc743e-448d-410f-a258-2eb07b2378b7;image-20231213-082526.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73418,13/Dec/23 12:29 PM;63c149612a526608c55073dd;image-20231213-102806.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73440,13/Dec/23 12:29 PM;63c149612a526608c55073dd;image-20231213-102936.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73441,28/Dec/23 3:19 PM;ug:2b225acf-b6c1-4a71-b953-c168f52939b6;image-20231228-131927.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/74163,17/Jan/24 9:50 AM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;image-20240117-075008.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/75317,22/Jan/24 5:44 AM;ug:6f3ccec2-08b8-448b-b43b-9b4c7c31fe92;image-20240122-034401.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/75507,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@375156b5,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=11, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":11,""lastUpdated"":""2024-01-17T13:07:08.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":11,""name"":""GitLab""},""GitHub"":{""count"":8,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzyp1r:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,P/CLR - Sprint 11,P/CLR - Sprint 12,P/CLR - Sprint 13,CLR Sprint 1,,,,,,,,,,,,,,,,,,,,,,,,a8693810-01fb-4d1c-8714-51e4229f5c10,PE - Processing - Clearing,"Prior to upgrade {{psrv_matching}} function was used, post upgrade {{psrv_matching_v3}} is used. The latest function contains the logic to match _refund settlement_ with _original authorization_ when _refund authorization_ is absent. Attached here is the document for settlement matching change post upgrade.

[^Settlement Matching Change Log 2022_10_12 (58efc6d4-cb8a-4a76-b48f-83ed49847454).pdf]

New function {{psrv_matching_v3_mettle}} created, following integration test results show the refund settlement assigned with the txn_id of refund authorization only having *settle_note* with step *3(a)* and *3(b)*, settlements in step *5(a)* shows new txn_id assigned to refund settlement if refund authorization is absent.

{noformat}select y.settle_note, x.de2 as auth_tok, x.de38 as auth_code, x.de4 as auth_amt,
y.token as set_tok, y.de38 as set_auth_code, y.de4 as set_amt, y.txn_id as txn_id
from t_set y
left join t_auth x on y.txn_id = x.txn_id
where y.ps_id > 1080{noformat}

!image-20231228-131927.png|width=1370,height=270!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-12-08 06:29:08.53,10205_*:*_1_*:*_1450133822_*|*_10306_*:*_1_*:*_456917319_*|*_3_*:*_1_*:*_1380878481_*|*_10000_*:*_1_*:*_15189376_*|*_10001_*:*_1_*:*_0_*|*_10345_*:*_1_*:*_2429957847,,"08/Dec/23 8:29 AM;5a9e4751a00c7f2a80155fda;[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] are you sure it’s presentment refunds and not authorizaitons? Because what you highlighted are authorization refunds (MTI 100 and DE-3-1 = 20), while presentment refunds are coming in from settlement files.","12/Dec/23 11:37 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;{quote}[~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955] are you sure it’s presentment refunds and not authorizaitons? Because what you highlighted are authorization refunds (MTI 100 and DE-3-1 = 20), while presentment refunds are coming in from settlement files.{quote}

Hi [~accountid:5a9e4751a00c7f2a80155fda] , indeed, just noticed the details about Presentment refund below in [Mapping record IDs to transaction IDs (paymentology.com)|https://developer.paymentology.com/docs/mapping-of-ids]:

Presentment Refund	1240	T2	R4	R8	Same TID and RID_auth as Refund Auth ( if any) but new RID Settlement

According to client, they had different TIDs for authorization and settlement when Refunds before the upgrade.

Is it possible to revert back to that behavior? Is it code or config?

Thank you in advance.","12/Dec/23 11:38 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;-- This notification was sent from JIRA DEV-11645964 to Zendesk Support ticket #649169 by Juliano Ciena. --

are you sure it’s presentment refunds and not authorizaitons? Because what you highlighted are authorization refunds (MTI 100 and DE-3-1 = 20), while presentment refunds are coming in from settlement files.

Hi @Florin Vistig , indeed, just noticed the details about Presentment refund below in Mapping record IDs to transaction IDs (paymentology.com):

Presentment Refund	1240	T2	R4	R8	Same TID and RID_auth as Refund Auth ( if any) but new RID Settlement

According to client, they had different TIDs for authorization and settlement when Refunds before the upgrade.

Is it possible to revert back to that behavior? Is it code or config?

Thank you in advance.","13/Dec/23 10:10 AM;5a9e4751a00c7f2a80155fda;[~accountid:6195bb56ef18ca0071c7a9de] I don’t think I understand what Juliano is saying… hope you understand better.

iirc, there was a recent request for a client (was it MOX?) to try and match refunds with authorizations… Not sure if it’s related","13/Dec/23 10:26 AM;6195bb56ef18ca0071c7a9de;{color:#ff991f}Since the Production upgrade to environment on 8th Nov, client is receiving refund presentments linked with the same TID as the authorization. See examples:{color}

* {color:#ff991f}2514579852637608120{color}
* {color:#ff991f}2514468752637148344{color}

{color:#ff991f}Prior to the upgrade, all refund presentments were sent with their own distinct TID, i.e., not linked to authorisations, debit presentments etc.{color}

From provided txn_ids, I don’t think those are refund authorizations.

!image-20231213-082526.png|width=1317,height=828!



Also from PayCore DB, I can see the {{force_match_refund }}flag is off for mettle env.

!image-20231213-082139.png|width=1407,height=809!



But [~accountid:712020:451c3a5b-a404-4cb0-99f0-1c72489bd955]can you confirm by executing this query in production? {{select force_match_refund, * from p_product}} in both PayTok and PayCore.

*PayTok for Auth*

*PayCore for Settlement*

Here is confluence page for that change[https://paymentology.atlassian.net/wiki/spaces/TS/pages/7477035109/Refund+matching+with+preceding+AUTH|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7477035109/Refund+matching+with+preceding+AUTH|smart-link] 



{color:#ff991f}According to client, they had different TIDs for authorization and settlement when Refunds before the upgrade.{color}

{color:#006644}*If settlement is linking refund TIDs, then this ticket belongs to the settlement team.*{color}



{color:#ff991f}Is it possible to revert back to that behavior? Is it code or config?{color}

[https://paymentology.atlassian.net/wiki/spaces/TS/pages/7477035109/Refund+matching+with+preceding+AUTH|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7477035109/Refund+matching+with+preceding+AUTH|smart-link] 

It is a configuration change in the {{p_product }}table, column {{force_match_refund }}. If it is true, than we need to make it FALSE

{{UPDATE p_product set force_match_refund = FALSE WHERE prod_id = ?}}



cc  [~accountid:619a20dff2415000728442aa] [~accountid:5a9e4751a00c7f2a80155fda] ","13/Dec/23 12:29 PM;63c149612a526608c55073dd;Hello [~accountid:6195bb56ef18ca0071c7a9de] ,

Please find the output for the below query.We could see the 

*PayTok for Auth* - {{force_match_refund}} is *FALSE*

!image-20231213-102806.png|width=720,height=166!

*PayCore for Settlement*  {{force_match_refund}} is *FALSE*

!image-20231213-102936.png|width=1524,height=261!","13/Dec/23 2:22 PM;619a20dff2415000728442aa;This seems like a case of offline refund where no refund authorization message is present but refund settlement exists with {{de38}} value of the purchase auth. In this scenario settlement refund will match with the purchase authorization and the same {{txn_id}} will be assigned else these settlements will remain unmatched. {{DE38}} is populated during authorization.
Here is more explanation of this scenario for different client: [https://paymentology.atlassian.net/browse/DEV-10639?focusedCommentId=93203|https://paymentology.atlassian.net/browse/DEV-10639?focusedCommentId=93203|smart-link] 
CC. [~accountid:6273fc10807e0000691d5dee] [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] ","18/Dec/23 5:10 PM;712020:451c3a5b-a404-4cb0-99f0-1c72489bd955;Thank you [~accountid:619a20dff2415000728442aa] , [~accountid:6195bb56ef18ca0071c7a9de] [~accountid:63c149612a526608c55073dd] 

Client answered, let’s see if they have more questions.","20/Dec/23 1:00 PM;60fedd46b704b400688a8e79;*Summary from the call*

* Creating a new custom version for mettle , psrv_matching_v3_mettle
This will be a temporary solution until Mettle accomodates itself to the new version.
* Restricting refund settlements matching in step 1 and 2.
* Use the step 3 to match the refund settlements with the refund auth
* 3a - for matching refund settlements with refund auth based on de38/token, where the refund auth should not have refund settlement linked.
* 3b - for matching refund settlements with refund auth based on de42,token, de4 , where the refund auth should not have refund settlement linked.

cc: [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] [~accountid:619a20dff2415000728442aa] ","17/Jan/24 8:51 AM;611a52967b538a006964a439;Hi [~accountid:60fedd46b704b400688a8e79] [~accountid:619a20dff2415000728442aa]  

Can you guys please confirm if this change can be merge into [BL 2.2.9.13|https://gitlab.com/paymento/source/bl2.0/bl-environments/-/blob/2.2.9.13/versions/release/versions.yaml?ref_type=tags] tags as Mettle asked to not upgrade their env but also mentioned that they need this change on existing running BL version. 

CC: [~accountid:6273fc10807e0000691d5dee] [~accountid:63c148ea94d18cbf6773411b] [~accountid:60fedcdc627b5600689cd1a0] ","17/Jan/24 9:07 AM;619a20dff2415000728442aa;Hello [~accountid:611a52967b538a006964a439], 
Yes this can be patched to *BL 2.2.9.13*, 
Changes are in the *Paycore* database only,
Please confirm that the branch {{release/1.20.41}} in the *Paycore* repository is the correct branch.

CC. [~accountid:6205526c9493720070b93fd4] ","17/Jan/24 9:29 AM;63c148ea94d18cbf6773411b;FYI, it is against release strategy. 
If customer wants the fixes, it should upgrade to latest version with the fixes, i.e. 2.4.4-HF1.

In practice, yes, you can patch existing HF branches:

!Screenshot 2024-01-17 at 08.25.02.png|width=1597,height=143!","17/Jan/24 9:44 AM;611a52967b538a006964a439;[~accountid:63c148ea94d18cbf6773411b] Agreed to your point, in first place we established the same that we cant back port to changes/fix instead upgrade but certainly got feedback that we have todo this.



!image-20240117-075008.png|width=1481,height=43!",17/Jan/24 10:55 AM;611a52967b538a006964a439;[~accountid:619a20dff2415000728442aa]  May I please get the ETA ? This is to be classified as hot fix on top of existing running BL version.,17/Jan/24 11:12 AM;6273fc10807e0000691d5dee;Hi [~accountid:611a52967b538a006964a439] [~accountid:619a20dff2415000728442aa] please ensure once hot fix is ready that you notify me so that I can agree a date with Mettle for this to go into their production. Mettle likes to approve times/dates rather than receive the notification from us telling them,"17/Jan/24 11:45 AM;6273fc10807e0000691d5dee;Have just got off a call with Mettle, they are very happy about this news, can you please let me know what downtime/risk time is expected once known [~accountid:619a20dff2415000728442aa] [~accountid:611a52967b538a006964a439] ?

Once that is provided I will ask Mettle to provide a date/time they are satisfied with and then feed back","17/Jan/24 12:03 PM;619a20dff2415000728442aa;[This |https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/merge_requests/2256]merge request is created to patch changes to *PayCoreDB: release/1.20.41* for *BL: 2.2.9.x*. 
Please, proceed with merging the changes and creating the necessary tags.

CC. [~accountid:63c148ea94d18cbf6773411b] [~accountid:611a52967b538a006964a439] [~accountid:6273fc10807e0000691d5dee] [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] ","17/Jan/24 12:28 PM;611a52967b538a006964a439;[~accountid:6273fc10807e0000691d5dee]  there will be now downtime as the change is in DB Paycore only. Further regarding date/time I can confirm once tag is ready. 

[~accountid:63c148ea94d18cbf6773411b]  can you please check last comment and share the paycore tag. ","17/Jan/24 12:32 PM;557058:a4bced0a-e933-4a8a-9216-49655949788e;[~accountid:6273fc10807e0000691d5dee] , just a reminder that Mettle does need to understand that this is custom and will not carry through to future versions of Banking.Live.  This is a short term workaround to support them in the short term.","17/Jan/24 1:01 PM;63c148ea94d18cbf6773411b;[~accountid:619a20dff2415000728442aa] 
[https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/merge_requests/2256|https://gitlab.com/paymento/source/bl2.0/paydb/paycoredb/-/merge_requests/2256] requires code owners approval.
Than I will merge and create the tag.","17/Jan/24 1:09 PM;619a20dff2415000728442aa;Hello [~accountid:63c148ea94d18cbf6773411b] ,
Merge Request has been merged, please proceed with creating necessary tag.
CC. [~accountid:611a52967b538a006964a439] ","17/Jan/24 1:57 PM;63c148ea94d18cbf6773411b;Tags created: pcdb 1.20.41.7 → BL 2.2.9.14
[~accountid:60fedd388ad5b600707750e1] / [~accountid:611a52967b538a006964a439] , please plan the next steps.","17/Jan/24 2:35 PM;6273fc10807e0000691d5dee;Hi [~accountid:557058:a4bced0a-e933-4a8a-9216-49655949788e] they need more than 3 weeks to the next sprint to build this into their systems, they told me on a call today they would need at least 6 months!

[~accountid:611a52967b538a006964a439] Mettle will need to confirm date/time before we go forward. When you know the exact downtime implications, please let me know and I will pass this onto them and get an agreed date/time to deploy this","18/Jan/24 10:11 AM;611a52967b538a006964a439;thanks [~accountid:63c148ea94d18cbf6773411b] .

[~accountid:6273fc10807e0000691d5dee] We are ready to deploy anytime, Please ask client their preferred date/time, we will deploy accordingly. there is no downtime required. Only Risk Time 2 Hrs standard window. ",18/Jan/24 2:02 PM;60fedd388ad5b600707750e1;[~accountid:619a20dff2415000728442aa]  can you please confirm the custom function need to attach to matching after the release. cc [~accountid:611a52967b538a006964a439] ,"18/Jan/24 2:10 PM;619a20dff2415000728442aa;Hello [~accountid:60fedd388ad5b600707750e1], 
Actions to be taken post deployment to enable custom matching for Mettle are as follow:

* Update the *data_function* to *paycore/psrv_matching_v3_mettle* for the task *MCSettlementMatching*,
* Perform *MCSettlementMatching* task.

To rollback: update *data_function* for the task back to *paycore/psrv_matching_v3*.","22/Jan/24 5:44 AM;60fedd388ad5b600707750e1;[~accountid:619a20dff2415000728442aa] The deployment to Production is completed. Also run a matching function task.

!image-20240122-034401.png|width=1077,height=482!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done,12/Feb/24 11:45 AM
Batch Enrolment of Cards to Apata ACS -- Mettle,CEM-110,127746,Story,Backlog,CEM,CE - Migrations,software,Kit Yeung,61d7273d7c6f98007065e9d7,,,Normal,,Kit Yeung,61d7273d7c6f98007065e9d7,Christien Ackroyd,60fedcf83900e60070792cfe,Christien Ackroyd,60fedcf83900e60070792cfe,27/May/24 12:47 PM,11/Apr/25 1:27 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,business-form,jira_automation_tag,jira_escalated,jira-zd-escalation,"----------------------------------------------

Olufemi Adetiwa, May 24, 2024, 10:57

Existing solution used for Card migration from FSS to Apata. All issues previously on FSS, except Apata has been successfully migrated.",,Christien Ackroyd,,,,,,,,,,,60fedcf83900e60070792cfe,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PR-1887,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@7f046f27,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i008q7:,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Customer*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA]


*6. Reference Material/Links to documentation*: 
[TBA]
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,72c8f68e-f0e8-4dad-9eda-3b70a9658991,PLT - Migrations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"27/May/24 12:47 PM;60fedcf83900e60070792cfe;Processed and assigned to [~accountid:61d7273d7c6f98007065e9d7] , fyi [~accountid:61e885fc9d17400069e6d5e8] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,27/May/24 12:47 PM
PROD - Mettle - BASIC STIP (Throttling & Un-throttling) Feature - Enablement,CCM-2388,195993,Change Request,Approved,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,High,,,,Mostafa Elhoseiny,6328729388ed2ebef978552f,Mostafa Elhoseiny,6328729388ed2ebef978552f,02/Feb/26 1:13 PM,03/Feb/26 2:52 PM,,,,,,,,,,,,,,bankingLive,,,,,,,,,,04/Feb/26 12:00 AM,0,imps_escalated,,,,"Hi ITSM team ,

Based on the db query results of SAF records [here |https://paymentology.atlassian.net/browse/ESRM-1651?focusedCommentId=302754], and as per the product team [recommendation |https://paymentology.slack.com/archives/C0311J0K146/p1770020732888739?thread_ts=1743774568.648689&cid=C0311J0K146]we should proceed with the following : 


1- Full backup _t_processor_msgs_

2- Updating _t_processor_msgs_ with flag = 3 so messages will not be retransmitted.

3- Activate the job tasks including *SendAdviceMessage*

Important Note : we must update the flag to 3 before enabling SendAdviceMessage job task to avoid sending all thousands history records.



Linked CCM ticket : [https://paymentology.atlassian.net/browse/CCM-2297|https://paymentology.atlassian.net/browse/CCM-2297|smart-link] 



*Target Date : Client is notified to activate the feature in production by the end of week. so we suggest Wednesday 04-February please confirm to notify the client about the date and time.*

cc : [~accountid:6273fc10807e0000691d5dee] ",Mettle Dedicated Production Environment,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@50aa7961,,,,,,,,,,,,,,,,Salik.hashmi,611a52967b538a006964a439,Standard,Yes,Application,,,[04-09] - Medium,,,,,0.0,,,Mettle,,,,,,,,,,,Yes,,,,Signed off testing the feature,,,,,,,,,,,,,PayControl,PayCore Database,PayScheduler,,,,,,,,,,,,,,,,,,,,{},,,,0.0,,,,,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,review the job tasks activity logs.,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07xoc:,,,,,,,,,,,Yes,,,,,,,0.0,to disable the job tasks and just update the flag to 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Genevieve Mattheus ,557058:337aa529-c7df-4ad6-9c4f-ed7cc3b75b74,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2026-02-03 12:38:48.327,,,"03/Feb/26 2:38 PM;611a52967b538a006964a439;Following CCM 03/02

Approved - 11:00 UTC (04 Feb 2026)
DOwntime: 0 mins
Risktime: 2HRs.

[~accountid:6328729388ed2ebef978552f]  informing client. 
","03/Feb/26 2:52 PM;6328729388ed2ebef978552f;Confirmed

Client informed.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,195293,CCM-2340,2026-02-03,In Progress,03/Feb/26 2:38 PM
BL 3.5 Release for Production - Mettle,CCM-2371,195537,Change Request,Backlog,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,Savio,60fedd388ad5b600707750e1,Savio,60fedd388ad5b600707750e1,Savio,60fedd388ad5b600707750e1,30/Jan/26 4:38 PM,03/Feb/26 2:09 PM,02/Feb/26 5:37 PM,,,,,,,,,,,,,PayApi,PayControl,PayCore Database,PayKey Database,PayKeyService,PayLog Database,PayPower,PayRoute,PayScheduler,PayTok Database,,0,,,,,"Change Request for BL 3.4 Release on Mettle Env

QA Testing has been done

Release Notes Attached",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,03/Feb/26 2:09 PM;ug:6f3ccec2-08b8-448b-b43b-9b4c7c31fe92;QA Report BL 3.5 (1aed9e0c-a7ca-4d4c-b382-431ac77ca75f).pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/138792,03/Feb/26 1:45 PM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;QA Report BL 3.5.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/138780,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@16636706,,,,,,,,,,,,,,,,,,Normal,Yes,Application,,,[04-09] - Medium,,,,,0.0,,,Mettle,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,No Dependency,,,,,,,,,,,,,,,,,,,,,,{},,,,20.0,,,,,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07wno:,,,,,,,,,,,Yes,,,,,,,180.0,This is a fix forward release,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,195293,CCM-2340,2026-02-03,To Do,30/Jan/26 4:38 PM
CLONE - CLONE - Test Jira 2,CCM-2357,195447,Change Request,Backlog,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Major,,Shubham G,61f80302845d670071f2138e,Shubham G,61f80302845d670071f2138e,Shubham G,61f80302845d670071f2138e,30/Jan/26 10:57 AM,30/Jan/26 10:57 AM,,,,,,,,,,,,,,PayCore Database,,,,,,,,,,,0,,,,,"We have notified all clients to migrate to version 2 for settlement reports by 1 November; otherwise, the settlement service will be discontinued. Consequently, Mettle and Snappi requested a change from settlement report version v1 to v2.

After the change, the fee report generated by version 2 does not populate the account external reference value, leading to an escalation from the client. We have raised the issue with the clearing team, and the fix is now ready. We also need to apply the patch in production.  
[https://paymentology.atlassian.net/browse/DEFECT-4296|https://paymentology.atlassian.net/browse/DEFECT-4296|smart-link]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-2355,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5a4ab7cf,,,,,,,,,,,,,,,,,,Emergency - Expedited,No,Application,,,[03-04] - Low,,,,,0.0,,,All Pro Clients,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,No Dependency,,,,,,,,,,,,,,,,,,,,,,{},,,,0.0,,,,,shared02,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07wck:,,,,,,,,,,,Yes,,,,,,,0.0,No Rollback,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,a8693810-01fb-4d1c-8714-51e4229f5c10,PE - Processing - Clearing,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,182869,CCM-1833,2025-11-11,To Do,30/Jan/26 10:57 AM
Removal Of Obsolete Params From Payroute + Paykeyserv-  Alignment | Mettle,CCM-2319,194897,Sub-task,Backlog,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,Savio,60fedd388ad5b600707750e1,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,27/Jan/26 12:53 PM,30/Jan/26 2:21 PM,,,,,,,,,,,,,,PayRoute,,,,,,,,,,,0,,,,,"As per the [*development team’s feedback*|https://paymentology.atlassian.net/wiki/spaces/TS/pages/9245065225/Platform+Alignment+App+configs+report], below params are concluded to remove as they are no more in use. {color:#bf2600}*Please proceed with the change with BL 3.5 Deployment*{color}


!image-20251204-054129.png|width=676,alt=""image-20251204-054129.png""!

!image-20260127-105246.png|width=1210,alt=""image-20260127-105246.png""!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-2318,,,,,,,,,,,,CCM-2031,,,,,,,,,,,27/Jan/26 12:53 PM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;image-20251204-054129.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/138031,27/Jan/26 12:53 PM;ug:74117ebd-38df-48e1-93fa-43e0b8219901;image-20260127-105246.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/138032,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3084553,,,,,,,,,,,,,,,,,,Normal,Yes,Application,,,[04-09] - Medium,,,,,0.0,,,BOJ,,,,,,,,,,,Not Required,,,,,,,,,,,,,,,,,PayRoute,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,boj,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07txw:,,,,,,,,,,,Yes,,,,,,,,Revert changes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,188653,CCM-2031,[Platform Alignment] Need To Remove Params That Are not In Used in Payroute Config,To Do,27/Jan/26 12:53 PM
ppwr_thread_pool_size + validateWithAuthEngine  Alignment | Mettle,CCM-2310,194886,Sub-task,Backlog,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,Savio,60fedd388ad5b600707750e1,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,27/Jan/26 12:41 PM,30/Jan/26 2:18 PM,,,,,,,,,,,,,,PayPower,,,,,,,,,,,0,,,,,"Following CCM 2032 changes approved, *ONLY IF* below mentioned variable not defined, please set value as mentioned and deliver it along with BL 3.5 Deployment on Mettle

{{ppwr_thread_pool_size}} *= 200* 
{{validateWithAuthEngine }} = {{0}}
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-2305,,,,,,,,,,,,CCM-2032,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5d65eb74,,,,,,,,,,,,,,,,,,Normal,Yes,Application,,,[04-09] - Medium,,,,,0.0,,,Mettle,,,,,,,,,,,Not Required,,,,,,,,,,,,,,,,,PayPower,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,boj,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07tvw:,,,,,,,,,,,Yes,,,,,,,,Revert changes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,188654,CCM-2032,[Platform Alignment] Set ppwr_thread_pool_size Value as 200 + validateWithAuthEngine = 0 on All PP where said tags are missing,To Do,27/Jan/26 12:41 PM
PROD - Mettle - BASIC STIP (Throttling & Un-throttling) Feature - Configuration,CCM-2297,194777,Change Request,Approved,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,High,,Savio,60fedd388ad5b600707750e1,Mostafa Elhoseiny,6328729388ed2ebef978552f,Mostafa Elhoseiny,6328729388ed2ebef978552f,26/Jan/26 2:52 PM,02/Feb/26 1:02 PM,,,,,,,,,,,,,,bankingLive,,,,,,,,,,28/Feb/26 12:00 AM,0,imps_escalated,,,,"Hi ITSM team ,



Mettle signed off testing the throttling and un-throttling feature (Basic STIP) in UAT and they are asking about *the timescale to get this into Production.*



*The Pre-requisites for enabling this feature in Mettle dedicated production environment are the (*Fix Deployments , Feature deployment - Database Columns and the count of SAF records stored in t_processor_msgs table*)*

 

*1- Fix Deployments* :

* Ensure BL version 3.2.0 is available in the dedicated Mettle production environment where the non-success status code fix is existing [https://paymentology.atlassian.net/browse/AUTH-1781|https://paymentology.atlassian.net/browse/AUTH-1781|smart-link]

 

*2- Feature deployment - Database Columns :*

* Table Conf_Pauth ( Paycore DB ) should be altered for adding new columns :

+_Changes in conf_pauth for Throttling :_+

* *_Is_throttling_* { Type =boolean, Default = False}: To mark the FAST client is/isn't throttling.
* *_Threshold_count_to_throttle_*{Type = integer, Default = 100}: Threshold count out of the total count to determine throttling(Value of Y in above example). 
p.s These value will be configurable as per the FAST client requirement.
* *Throttle_time_window*{Type = integer, Default = 10000 ): Time period to be taken into consideration for the transactions within this period to determine if the client endpoint has been throttled. The value of it should be in milliseconds.

 

+_Changes in conf_pauth for un-throttling :_+

* *Time_before_unthrottle* {Type = integer, Default = 10000): Time period to be taken into consideration before attempting to unthrottle the already throttled end points. The value of it would be in milliseconds.
* New column *last_throttle_time* is introduced in the conf_pauth table and is populated during throttling and we are using this value to compare with Time_before_unthrottle.

Ref. [https://paymentology.atlassian.net/wiki/spaces/TS/pages/7891812384/STIP+Internal+Document#%5BinlineExtension%5DThrottling/un-throttling|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7891812384/STIP+Internal+Document#%5BinlineExtension%5DThrottling/un-throttling|smart-link]

 

*3- Count of SAF Records in t_processor_msgs in Mettle dedicated production environment :*

* Query on the SAF records to study in case we need to clear some of them to avoid sending all SAF records once SendAdviceMessage job is configured as part of the feature enablement


----

----

*The Feature configuration for enabling BASIC STIP as per Mettle requirements :*

{color:#bf2600}*Client Requirements :*{color}

* Threshold count (transactions): 10 – Backend Database
* Throttle check frequency: ≥ 5 s  - Scheduler
* Time window (ms): 10,000 – Backend Database
* Grace period before un-throttle (ms): 10,000
* Unthrottle check frequency = Every 5 s
* *Job Scheduler*:
** Throttling : Every 5 Seconds
** Unthrottling : Every 5 Seconds
** SendAdviceMessage : Every Hour

 

{color:#bf2600}*Database and Jobs Configuration :*{color}

* Table : conf_pauth
** Record : Mettle Client Fast record
** Column : Threshold_count_to_throttle = 10 (10 txns) (The Criteria triggers throttling )
** Column : throttle_time_window = 10000 (10 seconds ) (The Criteria triggers throttling )
** Column : time_before_unthrottle = 10000 (10 seconds ) (Grace period before un-throttle )
* Jobs :
** Throttling : Every 5 Seconds - Email recipient : [+genie-cards-engineering@mettle.co.uk+|mailto:genie-cards-engineering@mettle.co.uk]
** Unthrottling : Every 5 Seconds - Email recipient : [+genie-cards-engineering@mettle.co.uk+|mailto:genie-cards-engineering@mettle.co.uk]
** SendAdviceMessage : Every Hour
* Reference is UAT

 
Ref. [https://paymentology.atlassian.net/browse/ESRM-1651|https://paymentology.atlassian.net/browse/ESRM-1651|smart-link] 

*Environment : Mettle Dedicated Production*

cc : [~accountid:6273fc10807e0000691d5dee]",Mettle Dedicated Production Environment,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@9c126d2,,,,,,,,,,,,,,,,Salik.hashmi,611a52967b538a006964a439,Standard,Yes,Application,,,[04-09] - Medium,,,,,0.0,,,Mettle,,,,,,,,,,,Yes,,,,Client signed off testing the feature in UAT.,,,,,,,,,,,,,PayControl,PayCore Database,PayScheduler,,,,,,,,,,,,,,,,,,,,{},,,,0.0,,,,,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,"* Reviewing Transactions
* Reviewing the job tasks activity",,,,,,,,,,,,,,,,,,,,,,,,,,1|i07ti4:,,,,,,,,,,,Yes,,,,,,,0.0,"* Disable job tasks

* Update the record with the old values.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Genevieve Mattheus ,557058:337aa529-c7df-4ad6-9c4f-ed7cc3b75b74,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2026-01-26 14:03:16.585,,,26/Jan/26 4:03 PM;557058:337aa529-c7df-4ad6-9c4f-ed7cc3b75b74;Hi. Approved based on client tested in UAT and asked for it to be moved to prod. Mettle also is on their own instance too.,"27/Jan/26 2:00 PM;611a52967b538a006964a439;Following CCM 27/01

Approved for job configuration with inactive mode - based on testing results. 

",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,190800,CCM-2102,2026-01-27,In Progress,27/Jan/26 2:00 PM
UAT testing failing with new error code (original: Failed to decrypt session ID vs. new: Session not valid),CCM-2246,193910,Change Request,On Hold,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,,,bogdan.stefoni,712020:a057e150-5f9d-4105-85f2-578b128cf7be,bogdan.stefoni,712020:a057e150-5f9d-4105-85f2-578b128cf7be,20/Jan/26 11:49 AM,20/Jan/26 2:26 PM,,,,,,,,,,,,,,bankingLive,,,,,,,,,,23/Jan/26 12:00 AM,0,,,,,"The client: Mettle raised a concern that while doing testing observed that 9403 error code instead of 1307 for the following API's.

v2_sc_get_cvv2
v2_sc_get_pan
v2_sc_set_pin

Since the 23rd of December these tests have consistently failed because the error code 9403 is un-expected and these tests remain to expect the 1307 error code.

There is a small fix only. Basically, just updating the error code to the according one:


!DEFECT-4621-after-fix.png|width=330,alt=""DEFECT-4621-after-fix.png""!

No any extra configurations needs to be done.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEFECT-4621,,,,,,,,,,,,,,20/Jan/26 11:49 AM;f72d04e0-88b1-4efd-8a98-66f020cf7cc7;DEFECT-4621-after-fix.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/137276,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@1dececdc,,,,,,,,,,,,,,,,,,Normal,Not Required,Application,,,[04-09] - Medium,,,,,0.0,,,Mettle,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,PayApi,,,,,,,,,,,,,,,,,,,,,,{},,,,0.0,,,,,sharedUAT,UAT,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07qlg:,,,,,,,,,,,Yes,,,,,,,0.0,Revert the commit if any issues arrive.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,,,,,,7b08db5f-ae7a-4912-8c53-a918d97163b3,PE - Core - API,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,190799,CCM-2101,2026-01-20,In Progress,20/Jan/26 2:26 PM
BL 3.4 Release for Production - Mettle,CCM-2155,192012,Change Request,Backlog,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,Savio,60fedd388ad5b600707750e1,Savio,60fedd388ad5b600707750e1,Shubham G,61f80302845d670071f2138e,07/Jan/26 10:14 AM,03/Feb/26 2:09 PM,02/Feb/26 12:14 PM,,,,,,,,,,,,,PayApi,PayControl,PayCore Database,PayKey Database,PayKeyService,PayLog Database,PayPower,PayRoute,PayScheduler,PayTok Database,31/Jan/26 12:00 AM,0,,,,,"Change Request for BL 3.4 Release on Mettle Env

QA Testing has been done

[^QA Report BL 3.3.pdf]
[^QA Report BL 3.4.pdf]

Release Notes Attached

[^Release_Notes_BL3.3.pdf]
[^Release_Notes_BL3.4.pdf]

",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-2150,,,,,,,,,,,,,,,,,,,,,,,07/Jan/26 10:14 AM;ug:1a9120e1-f5b7-4c6a-9db7-fbcba0526638;QA Report BL 3.3.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/135815,07/Jan/26 10:14 AM;ug:1a9120e1-f5b7-4c6a-9db7-fbcba0526638;QA Report BL 3.3.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/135819,07/Jan/26 10:14 AM;ug:1a9120e1-f5b7-4c6a-9db7-fbcba0526638;QA Report BL 3.4.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/135813,07/Jan/26 10:14 AM;ug:1a9120e1-f5b7-4c6a-9db7-fbcba0526638;QA Report BL 3.4.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/135817,07/Jan/26 10:14 AM;ug:1a9120e1-f5b7-4c6a-9db7-fbcba0526638;Release_Notes_BL3.3.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/135812,07/Jan/26 10:14 AM;ug:1a9120e1-f5b7-4c6a-9db7-fbcba0526638;Release_Notes_BL3.3.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/135816,07/Jan/26 10:14 AM;ug:1a9120e1-f5b7-4c6a-9db7-fbcba0526638;Release_Notes_BL3.4.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/135814,07/Jan/26 10:14 AM;ug:1a9120e1-f5b7-4c6a-9db7-fbcba0526638;Release_Notes_BL3.4.pdf;https://paymentology.atlassian.net/rest/api/3/attachment/content/135818,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@489ef88e,,,,,,,,,,,,,,,,Shubham G,61f80302845d670071f2138e,Normal,Yes,Application,,,[04-09] - Medium,,,,,0.0,,,Mettle,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,No Dependency,,,,,,,,,,,,,,,,,,,,,,{},,,,20.0,,,,,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07jtg:,,,,,,,,,,,Yes,,,,,,,180.0,This is a fix forward release,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,190798,CCM-2100,2026-01-13,To Do,07/Jan/26 10:14 AM
PostgreSQL Parameter Updates for Client Databases,CCM-2118,191384,Change Request,Approved,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,naveen.mallela,712020:acd921e1-3afc-4c58-802a-1b1e0077d97c,naveen.mallela,712020:acd921e1-3afc-4c58-802a-1b1e0077d97c,banu.akkus,632872d27f85f167779c13ed,31/Dec/25 1:09 PM,02/Feb/26 1:08 PM,,,,,,,,,,,,,,PayCore Database,PayKey Database,PayLog Database,PayTok Database,,,,,,,31/Jan/26 12:00 AM,0,,,,,"As a result of client-based capacity and performance assessments, it has been identified that certain PostgreSQL configuration parameters are not optimally set on some instances.
This change aims to update the parameters highlighted in yellow to ensure better resource utilization and improved database performance.

!image-20251231-110355.png|width=671,alt=""image-20251231-110355.png""!



h3. *Scope of Change*

PostgreSQL instances belonging to the following clients will be updated. *Only the parameters highlighted in yellow will be changed*:

* MOX
* ISB
* Derayah
* SharedUAE
* ADQ
* SHO2
* BAE
* BOJ
* Mettle

h3. *Change Description*

For the relevant PostgreSQL instances per client, the following parameters will be updated according to the agreed values:

* {{shared_buffers}}
* {{work_mem}}
* {{effective_cache_size}}
* {{maintenance_work_mem}}

A controlled PostgreSQL restart will be performed where required.

h3. *Implementation Plan*

# Capture and document the current PostgreSQL parameter values before the change
# Update the highlighted parameters on a client-by-client basis
# Restart PostgreSQL services where required
# Verify that services are up and accepting connections
# Perform basic performance and connectivity checks

h3. *Impact Assessment*

* A short service interruption may occur on instances requiring a PostgreSQL restart
* No data loss is expected
* The change is low risk and limited to configuration updates",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,31/Dec/25 1:09 PM;632872d27f85f167779c13ed;image-20251231-110355.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/135334,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@63b6080a,,,,,,,,,,,,,,,,Salik.hashmi,611a52967b538a006964a439,Normal,Not Required,Infrastructure,,,[03-04] - Low,,,,,0.0,,,ADQ (WIO),BAE,BOJ,Derayah (D360),ISB,Mettle,MOX,,,,,Yes,,,,,,,,,,,,,,,,,PayCore Database,PayKey Database,PayLog Database,PayTok Database,,,,,,,,,,,,,,,,,,,{},,,,5.0,,,,,shared02,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07i18:,,,,,,,,,,,Yes,,,,,,,60.0,"* Reapply the previously recorded PostgreSQL parameter values
* Restart PostgreSQL services
* Validate service availability after rollback",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,banu.akkus,632872d27f85f167779c13ed,,,,,,978465e5-b4b6-4d4b-8ca9-20bf44d754d5,PLT - DBA,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2026-01-06 11:17:25.781,,,"06/Jan/26 1:17 PM;611a52967b538a006964a439;Following CCM {{2026-06-01}}.

The action is scaling up only.
This is DBA initiative. 
The change is approved relying DBA recommendation for each envs. 
DBA to share current and desired specs. 
*Shared02 - Please plan it on 14 Jan 2026 with BL 2.34 (Downtime 5 mins specifically for this activity)*
*For other, we can plan along with next upcoming OS Patching.* 

CC: [~accountid:60fedd388ad5b600707750e1] ","02/Feb/26 12:08 PM;61f80302845d670071f2138e;Hi [~accountid:712020:acd921e1-3afc-4c58-802a-1b1e0077d97c] [~accountid:632872d27f85f167779c13ed] 

This change was done for SH02 only, correct?

Is there a plan for other envs?, if not, I would suggest to close this Jira and open when required","02/Feb/26 1:08 PM;632872d27f85f167779c13ed;[~accountid:61f80302845d670071f2138e] yes. for other servers SD team suggested us to club with OS patching since these changes requires service restart. When we receive os patching dates, we will create new tickets. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,190797,CCM-2099,2026-01-06,In Progress,06/Jan/26 1:17 PM
[Platform Alignment - PROD METTLE] Request To Remove Depreciated Tags In Paykeyserv,CCM-1985,187022,Change Request,Approved,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Low,,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,26/Nov/25 10:59 AM,18/Dec/25 3:08 PM,,,,,,,,,,,,,,PayKeyService,,,,,,,,,,31/Jan/26 12:00 AM,0,i704-appconfig,initiaitive-704-platform-alignment,,,"As per the [*development team’s feedback*|https://paymentology.atlassian.net/wiki/spaces/TS/pages/9245065225/Platform+Alignment+App+configs+report], the following tags are not being used in the Paykeyserv configuration. Based on the alignment team’s guidance, its been advised for removal of below params to maintain consistency across all environment configurations:

|paycore_user|
|paykey_user|
|paytok_user
magicHex|",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-1986,CCM-1987,CCM-2030,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@2b01b3e0,,,,,,,,,,,,,,,,Savio,60fedd388ad5b600707750e1,Normal,Yes,Application,,,[04-09] - Medium,,,,,0.0,,,Mettle,,,,,,,,,,,No,,,,,,,,,,,,,,,,,PayKeyService,,,,,,,,,,,,,,,,,,,,,,{},,,,5.0,,,,,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i073r8:,,,,,,,,,,,Yes,,,,,,,120.0,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,26/Nov/25 12:00 AM,,,,,,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-12-09 12:06:48.879,,,"09/Dec/25 2:06 PM;60fedd388ad5b600707750e1;[~accountid:611a52967b538a006964a439] , Approved to be done with BL 3.4 Release.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,187423,CCM-1991,2025-12-09,In Progress,09/Dec/25 2:06 PM
Mettle - Enabling PS Jobs to run on PayCore Slave DB,CCM-1598,177406,Sub-task,On Hold,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,Normal,,Savio,60fedd388ad5b600707750e1,Shubham G,61f80302845d670071f2138e,Shubham G,61f80302845d670071f2138e,26/Sep/25 2:10 PM,24/Nov/25 4:15 PM,,,,,,,,,,,,,,PayScheduler,,,,,,,,,,,0,,,,,"As part of BL 2.31 we have the capability to run PS Jobs especially the reports on PAYCORE SLAVE DB depending on the connection string used in the Job. As part of Initial Run we will apply this for JobClearingLogicTests . We also have a confirmation from Database team that all slave DBs have been configured to handle reporting/readonly jobs.

Note: For Clients where SSL is enabled, certs for paycore slave db has to be requested from DBA",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CCM-1589,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5e7a948,,,,,,,,,,,,,,,,,,Normal,Yes,Application,,,[03-04] - Low,,,,,0.0,,,BOJ,,,,,,,,,,,Not Required,,,,,,,,,,,,,,,,,No Dependency,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,mettle,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i069as:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,cd86b830-b546-4e7c-86b1-6b1354026d3e,ITSM - Release Management,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"15/Oct/25 1:28 PM;61f80302845d670071f2138e;Certs not Required
cc: [~accountid:60fedd388ad5b600707750e1] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,175613,CCM-1508,Enabling PS Jobs to run on PayCore Slave DB,In Progress,26/Sep/25 2:21 PM
Fix for long running query on prod paylog servers,CCM-1468,174736,Change Request,On Hold,CCM,Technology - Change Management,software,Bilal Hashmi,60fedcdc627b5600689cd1a0,,,High,,Samir Aghayarov,712020:4bb673e6-b220-422e-9aa9-53782ad29eb5,Samir Aghayarov,712020:4bb673e6-b220-422e-9aa9-53782ad29eb5,Samir Aghayarov,712020:4bb673e6-b220-422e-9aa9-53782ad29eb5,08/Sep/25 12:15 PM,10/Sep/25 9:31 AM,,,,,,,,,,,,,,PayLog Database,,,,,,,,,,10/Sep/25 12:00 AM,0,,,,,"I added a database index to speed up a long running query. The issue only affected database logging, while console logging worked fine. With the new index, performance should be much better.So it is just about adding an index.","[https://paymentology.slack.com/archives/C02CA1QPG5Q/p1756911955245289?thread_ts=1756865899.998629&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1756911955245289?thread_ts=1756865899.998629&cid=C02CA1QPG5Q|smart-link] 



Server	Environment
[pt-borgun-paylog-db01.paymentology.org|http://pt-borgun-paylog-db01.paymentology.org]	ISB
[pt-adq-paylog-db03.paymentology.org|http://pt-adq-paylog-db03.paymentology.org]	ADQ
[pt-prod-paylog-db01.paymentology.org|http://pt-prod-paylog-db01.paymentology.org]	MOX
[pt-prod-paylog-db02.paymentology.org|http://pt-prod-paylog-db02.paymentology.org]	Shared02
[pt-adq-paylog-db01.paymentology.org|http://pt-adq-paylog-db01.paymentology.org]	ADQ
[bae-prod-paylog-db01.paymentology.org|http://bae-prod-paylog-db01.paymentology.org]	BAE
[pt-boj-paylog-db01.paymentology.org|http://pt-boj-paylog-db01.paymentology.org]	BOJ
dh-prod-paylog-db01.paymentology.sys	D360
sh-frk-prd-plog-db1.paymentology.local	SharedEU
[bae-prod-paylog-db01.paymentology.org|http://bae-prod-paylog-db01.paymentology.org]	BAE
[pt-mettle-paylog-db01.paymentology.org|http://pt-mettle-paylog-db01.paymentology.org]	mettle
[pt-adq-paylog-db02.paymentology.org|http://pt-adq-paylog-db02.paymentology.org]	ADQ

",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEFECT-3980,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3c0cc293,,,,,,,,,,,,,,,,,,Emergency,Yes,Infrastructure,,,[03-04] - Low,,,,,0.0,,,ADQ (WIO),,,,,,,,,,,Not Required,,,,,,,,,,,,,,,,,PayLog Database,,,,,,,,,,,,,,,,,,,,,,{},,,,0.0,,,,,adq,PROD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i060jc:,,,,,,,,,,,Yes,,,,,,,0.0,Liquibase has the rollback script in place to rollback the created index,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Cagdas Evren Gerede,5a246636e7a1121a1ecce06d,,,,,,7b08db5f-ae7a-4912-8c53-a918d97163b3,PE - Core - API,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-09-09 11:33:55.358,,,"09/Sep/25 1:33 PM;611a52967b538a006964a439;Following CCM 09/09

The ticket is to be placed on hold until the following actions are completed and approved:

# Publish a list identifying which production environments have partitions and which do not for the table that is going to be indexed.
# Partition the environments where partitions are not yet in place.
# After completing step 2, perform a rehearsal on the major environments (Shared02, Shared-EU, MOX, and ISB), and then proceed with merging into the BL release branches.

{color:#bf2600}*Until then we need to remove the change we introduce that cuase this index requirement.* {color}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,173334,CCM-1423,2025-09-09,In Progress,09/Sep/25 1:33 PM
Installer For Framework 11a to 12a,BIS_INCIDENT-505,91582,Task,Open,BIS_INCIDENT,BIS: Incidents,software,Rohan Ale,5bd70c398995b717bb1b846f,,,Normal,,Alexander V Tovstolis,60fedcb88c15ca006ffc380f,Salik.hashmi,611a52967b538a006964a439,Salik.hashmi,611a52967b538a006964a439,30/Aug/22 3:56 PM,30/Aug/22 3:56 PM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,Subjected ticket created to get installer in account of framework (11a to 12a). This installer may use in BAE and Mettle. ,,Salik.hashmi,,,,,,,,,,,611a52967b538a006964a439,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3b5bbd71,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzuxs7:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,30/Aug/22 3:56 PM
Could not connect to MC,BIS_INCIDENT-503,90730,Bug,Open,BIS_INCIDENT,BIS: Incidents,software,Rohan Ale,5bd70c398995b717bb1b846f,,,Lowest,,Rohan Ale,5bd70c398995b717bb1b846f,Krishna Adhikari,61262c82d7cac6006969f99a,Krishna Adhikari,61262c82d7cac6006969f99a,04/Aug/22 11:20 AM,04/Aug/22 11:21 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Client Mettle


|*Instance Name*|:|*METTLE_PP_02*|
|*Log Id*|:|*2261381*|
|*Rid*|:|*0*|
|*Txn Id*|:|*0*|
|*Time*|:|*04 Aug 2022 08:37:51*|
|*Description*|:|*Could not connect to MC Network at( 10.155.100.249:7101 ) from PP ip (10.23.2.8)*|
|*Detail*| | |



java.net.SocketException: Socket closed at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.socketRead(SocketInputStream.java:116) at java.net.SocketInputStream.read(SocketInputStream.java:171) at java.net.SocketInputStream.read(SocketInputStream.java:141) at java.io.DataInputStream.read(DataInputStream.java:149) at Logics.SessionManagement.start(SessionManagement.java:237) at Logics.Paymentology.main(Paymentology.java:108) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.springframework.boot.loader.MainMethodRunner.run(MainMethodRunner.java:49) at org.springframework.boot.loader.Launcher.launch(Launcher.java:108) at org.springframework.boot.loader.Launcher.launch(Launcher.java:58) at org.springfra",,Krishna Adhikari,,,,,,,,,,,61262c82d7cac6006969f99a,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@7e805861,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzuu9j:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,04/Aug/22 11:21 AM;61262c82d7cac6006969f99a;Slack thread: [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1659602830634089|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1659602830634089|smart-link] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,04/Aug/22 11:20 AM
UAT Issue - Mettle ,BIS_INCIDENT-423,51709,Task,Open,BIS_INCIDENT,BIS: Incidents,software,Rohan Ale,5bd70c398995b717bb1b846f,,,Lowest,,Bil Gurung,60fedcdc75ad960069b85175,Hira Siddiqui,60fedd0deb7aef006977e66d,Hira Siddiqui,60fedd0deb7aef006977e66d,11/Feb/22 2:34 PM,26/Sep/22 8:23 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Hi all,
now that the FAST connectivity issue on UAT has been resolved (thanks to everyone), we can see messages hitting our service, however the DE3 element in the ISO_MSG  from the FAST message has a different format to the one we expect.
We expect it to be a single field (like ""DE3"":""000000"") but instead it comes a 3 subfields
""DE3_1"" : ""00"",
""DE3_2"" : ""00"",
""DE3_3"" : ""00"",
Is this expected?
Thanks
This is only happening in UAT at the moment, in production we still get it as a single field
CC: @Hassan Ahmad (Paymentology)",,Abdul Rasheed Khan,Hira Siddiqui,Jagadish Shrestha,,,,,,,,,60fedd214e8d8d00690fa883,60fedd0deb7aef006977e66d,60fedd0d7ab143006ea59f36,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@22ffa65a,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzu6dj:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2022-02-12 22:27:04.017,,,"26/Sep/22 8:23 AM;60fedd0d7ab143006ea59f36;Hi [~accountid:60fedcdc75ad960069b85175] , in UAT the Fast version 3 is set for this client. For fast version 3 the above format is the expected format.
Thank You.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do,11/Feb/22 2:34 PM
Monitor shadow mode discrepancies for Mettle UAT environment,AUTH-2071,195248,Task,Backlog,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,Prabin Shrestha,6195bb56ef18ca0071c7a9de,Shoaib Iqbal,6297155ee76a9c00705e2b50,Shoaib Iqbal,6297155ee76a9c00705e2b50,29/Jan/26 10:47 AM,29/Jan/26 11:33 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Please report all the discrepancies related to the Mettle UAT environment over here. 

[~accountid:5a9e4751a00c7f2a80155fda] [~accountid:632872d207a27ebeff12903b] [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] ",,Prabin Shrestha,Shoaib Iqbal,,,,,,,,,,6195bb56ef18ca0071c7a9de,6297155ee76a9c00705e2b50,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5c4f5bd3,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,MasterCard,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07vfg:,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,No,,,,,,,,,,,,,,,,,,,,,,,,,,,,AUTH Sprint 37,,,,,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2026-01-29 09:33:01.562,,,29/Jan/26 11:33 AM;6195bb56ef18ca0071c7a9de;Moving this to next sprint,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147455,AUTH-1096,BAU Bug Fixes - PayPower,To Do,29/Jan/26 10:47 AM
Enable Processing on Mettle Production Environment in shadow mode,AUTH-2010,192128,Task,Backlog,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Shoaib Iqbal,6297155ee76a9c00705e2b50,Thomas Benjaminsen Normann,63320891409249995ee98762,08/Jan/26 5:29 AM,28/Jan/26 10:16 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,,,Thomas Benjaminsen Normann,,,,,,,,,,,63320891409249995ee98762,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3e813492,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07kb8:,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,https://paymentology.productboard.com/entity-detail/features/0ad60246-1f8b-4dc3-9feb-3a159f41011c,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,192113,AUTH-1997,Rollout Authorisation Engine Processing to MC Clients,To Do,08/Jan/26 5:29 AM
Enable Processing on Mettle Production Environment in active mode,AUTH-2009,192127,Task,Backlog,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Shoaib Iqbal,6297155ee76a9c00705e2b50,Thomas Benjaminsen Normann,63320891409249995ee98762,08/Jan/26 5:29 AM,28/Jan/26 10:15 AM,,,,,,,,,,,,,,,,,,,,,,,,31/Mar/26 12:00 AM,0,,,,,,,Thomas Benjaminsen Normann,,,,,,,,,,,63320891409249995ee98762,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6c4a71ba,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i07kb0:,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,01/Jan/26 12:00 AM,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,https://paymentology.productboard.com/entity-detail/features/1113e7e4-8d6d-47d5-8955-449ac39439f6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,192113,AUTH-1997,Rollout Authorisation Engine Processing to MC Clients,To Do,08/Jan/26 5:29 AM
Removal of Flag That Skips AAV Validation for Mastercard AAV Without OBS 05,AUTH-1840,186033,Task,Backlog,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,,,,Febby Oktaviani,629a26eba0eafd0069ea2343,Febby Oktaviani,629a26eba0eafd0069ea2343,19/Nov/25 1:09 PM,24/Nov/25 10:47 AM,,,,,,,,,,,,,,,,,,,,,,,,,0,,,,,"[https://paymentology.atlassian.net/browse/AUTH-347|https://paymentology.atlassian.net/browse/AUTH-347|smart-link]

In the above mentioned ticket, we implemented a *temporary* solution

* Created a feature flag ‘Skip AAV Validation Without OBS’
* Implemented a logic
** if (flag is enabled AND OBS != ‘05’ AND (SLI = 212 AND AAV_INDICATOR IN (kD, kC, kJ))
*** then skip AAV validation

And in this ticket [https://paymentology.atlassian.net/browse/AUTH-1684|https://paymentology.atlassian.net/browse/AUTH-1684|smart-link], Investigation has done across all MC environments with below result.

{adf:display=block}
{""type"":""table"",""attrs"":{""isNumberColumnEnabled"":false,""layout"":""align-start"",""localId"":""d259cf56-4509-45c4-9988-e1b831da82cf""},""content"":[{""type"":""tableRow"",""content"":[{""type"":""tableHeader"",""attrs"":{""colwidth"":[153],""rowspan"":2,""background"":""#f0f1f2""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Client/Environment"",""marks"":[{""type"":""strong""}]}]}]},{""type"":""tableHeader"",""attrs"":{""colwidth"":[300,320],""colspan"":2,""background"":""#f0f1f2""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Count of SLI 212 & UCAF leading indicator in (kC, kD, kJ)  - past 12 months"",""marks"":[{""type"":""strong""}]}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""colwidth"":[300],""background"":""#f4f5f7""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Without OBS 05"",""marks"":[{""type"":""strong""}]}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[320],""background"":""#f4f5f7""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""With OBS 05"",""marks"":[{""type"":""strong""}]}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""colwidth"":[153],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""ISB""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[300],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[320],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""519""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""colwidth"":[153],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""ADQ""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[300],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[320],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""47""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""colwidth"":[153],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""BOJ""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[300],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[320],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""103""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""colwidth"":[153],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""MOX""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[300],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[320],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""96""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""colwidth"":[153],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""METTLE""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[300],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[320],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""232""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""colwidth"":[153],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Shared 02""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[300],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[320],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""3777""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""colwidth"":[153],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Shared UAE""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[300],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[320],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""14""}]}]}]},{""type"":""tableRow"",""content"":[{""type"":""tableCell"",""attrs"":{""colwidth"":[153],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""Shared EU""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[300],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""0""}]}]},{""type"":""tableCell"",""attrs"":{""colwidth"":[320],""background"":""#ffffff""},""content"":[{""type"":""paragraph"",""content"":[{""type"":""text"",""text"":""5690""}]}]}]}]}
{adf}

According to the above results for the past year across all environments, we did not find any production transactions from any client that match the condition *SLI 212 with UCAF kD/kC/kJ without OBS 05*. 

This ticket is to remove product flag {{skip_aav_validation_mc_generated}} and its usage to skip AAV validation in ppwr_tok_pre18.sql function as well as authorisation engine.

Paytok MC function usage:

* product setting flag {{skip_aav_validation_mc_generated}}  definition:
** [ppwr_tok_pre18.sql#L453|https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql#L453] 
**  [ppwr_tok_pre18.sql#L1336-L1338|https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql#L1336-L1338]
* skip aav validation:
** [ppwr_tok_pre18.sql#L2819-L2820|https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql#L2819-L2820]
** [ppwr_tok_pre18.sql#L2877-L2878|https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql#L2877-L2878]
** [ppwr_tok_pre18.sql#L2904 |https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql#L2904] 
** [ppwr_tok_pre18.sql#L3008|https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_tok_pre18.sql#L3008]

Authorisation-engine usage:

* authorisation-engine
** [ProductOption.kt#L33|https://github.com/Paymentology/authorisation-engine/blob/master/src/main/kotlin/com/paymentology/authorisationengine/domain/model/transaction/ProductOption.kt#L33]
** [MasterCardTransactionMapper.kt#L332-L340 |https://github.com/Paymentology/authorisation-engine/blob/master/src/main/kotlin/com/paymentology/authorisationengine/domain/model/transaction/mapper/mastercard/MasterCardTransactionMapper.kt#L332-L340]
** [MasterCardTransactionMapper.kt#L352|https://github.com/Paymentology/authorisation-engine/blob/master/src/main/kotlin/com/paymentology/authorisationengine/domain/model/transaction/mapper/mastercard/MasterCardTransactionMapper.kt#L352] 
** [NoCryptoCheckValidatorMC.kt#L61  |https://github.com/Paymentology/authorisation-engine/blob/master/src/main/kotlin/com/paymentology/authorisationengine/validation/validator/mastercard/NoCryptoCheckValidatorMC.kt#L61]  
** [NoCryptoCheckValidatorMC.kt#L71-L73 |https://github.com/Paymentology/authorisation-engine/blob/master/src/main/kotlin/com/paymentology/authorisationengine/validation/validator/mastercard/NoCryptoCheckValidatorMC.kt#L71-L73] 
** [SCAValidatorMC.kt#L112|https://github.com/Paymentology/authorisation-engine/blob/master/src/main/kotlin/com/paymentology/authorisationengine/validation/validator/mastercard/sca/SCAValidatorMC.kt#L112]  
* PayPower
** [ProductSetting.java#L41 |https://github.com/Paymentology/paypower/blob/master/src/main/java/com/paymentology/paypower/model/enums/product/ProductSetting.java#L41] 

cc: [~accountid:6297155ee76a9c00705e2b50] ",,Automation for Jira,Febby Oktaviani,,,,,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,629a26eba0eafd0069ea2343,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,AUTH-1684,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5786697a,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i070do:,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-11-24 08:47:24.53,,,"19/Nov/25 1:10 PM;629a26eba0eafd0069ea2343;[~accountid:6297155ee76a9c00705e2b50] please review this ticket, please feel free to edit in case i miss something. Thank you!",24/Nov/25 10:47 AM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - AUTH-1684 has got status Done,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,127736,AUTH-624,Authorisations - BAU,To Do,19/Nov/25 1:09 PM
PayPower should generate a new TID for a recurring transaction if the previous transaction is settled,AUTH-1196,150852,Task,Released,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,Done,Prabin Shrestha,6195bb56ef18ca0071c7a9de,Florin Vistig,5a9e4751a00c7f2a80155fda,Florin Vistig,5a9e4751a00c7f2a80155fda,28/Feb/25 11:37 AM,26/May/25 7:44 AM,,11/Apr/25 7:39 AM,BL-2.26.0,PP-3.188.0,PTDB-1.116.0,,,,,,,,,,,,,,,,,,,,0,,,,,"*Context:*

We generate TIDs for customers. If you look carefully in our documentation, it defines this as a “thread ID”, though customers seem to believe that it’s a transaction ID. 

The way the logic initially worked, it was truly more of a transaction ID, where one payment would have a single TID, but recurring payments were not tied together (as you may expect from a thread ID)

The issue however, is that with SCA and other related mandates, issuers started providing trace IDs to show previous authentications. This is most prevalent in Mastercard, but seems to also be happening with Mada in Saudi Arabia with major international merchants such as Amazon.

*Task:*

The default behaviour for new customers should be that we do not reuse a TID for a transaction that has already been settled or reversed, or received a decline advice. It should only be reused for payments which are still “open”, in other words.

For existing customers, we should have the option of enabling this new default behaviour - but we should not change it. We will want to enable this new behaviour for C24, and eventually for Mettle, but this will need to be coordinated. It is a highly sensitive change.

*Note:*

There are inconsistencies in how we generate TIDs between card schemes, we should not suddenly enforce new behaviour on existing customers or schemes.

Product will be coming out with a proposal for a new, more coherent structure of identifiers for transactions at some point this year with a clear segregation of purposes for the identifiers",,Automation for Jira,Florin Vistig,Lucy Simpson,Prabin Shrestha,Rohith Rajan,William Dunne,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,5a9e4751a00c7f2a80155fda,5f623946b9fcc1007734b378,6195bb56ef18ca0071c7a9de,5abca82e3cde3440ff0056b1,557058:5363d7a1-da13-4012-8609-f44e54c1d062,,,,,,,,,,,,,,AUTH-1195,,,,,,,,,,,,,,,,,,,,DEFECT-2827,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5c31fb72,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,uat/aws,uat/shared,,,,,,,,,,,,,,,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=3}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":3,""lastUpdated"":""2025-04-03T11:03:45.000+0200"",""stateCount"":3,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitHub"":{""count"":3,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzn8a5:zzzzzzzzzzzzzzzzzzzzzz,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,Sprint 21,Sprint 22,,,,,,,,,,,,,,3.0,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-03-18 13:04:35.052,10306_*:*_1_*:*_1565589588_*|*_3_*:*_2_*:*_956945826_*|*_10000_*:*_1_*:*_161407320_*|*_10400_*:*_1_*:*_9526592_*|*_10345_*:*_1_*:*_0,,"18/Mar/25 3:04 PM;6195bb56ef18ca0071c7a9de;+_The default behaviour for new customers should be that we do not reuse a TID for a transaction that has already been settled or reversed, or received a decline advice. It should only be reused for payments which are still “open”, in other words._+

Hi [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] I have few questions.

* Is this applicable only to recurring transactions, or does it also include all transactions having a trace ID, such as pre-authorizations and incrementals?
* We should continue reusing the TID in the following case, correct? That is, if *Txn B* is still “open”:
** Txn A = txn_id = AAA settled
** Txn B = txn_id = BBB (not settled)
** Txn C = linking back to Txn B, so, txn_id = BBB or new TID CCC
* How should we handle partial reversed cases? or we should generate new TID if transaction is fully or partially reversed. If a transaction linked via a trace ID has been partially reversed, do we need to generate a new TID?
* How does settlement work if we receive a settlement with an accumulated amount? 
** if we reach the following scenario(assumption) :
** *Txn A* (txn_id = AAA) with an amount of *4*
** *Txn B* (txn_id = BBB) with an amount of *6*
** Settlement received = *10* (covering *AAA* as well)
* Is this in any way related to the previous ASI and its preauth related change, or does it have any impact on it? (Mettle)
* Can you please review this ticket too? If we create different TID, how single presentment for multiple authorization works? [https://paymentology.atlassian.net/browse/DEFECT-2827?focusedCommentId=240417|https://paymentology.atlassian.net/browse/DEFECT-2827?focusedCommentId=240417|smart-link] ","20/Mar/25 4:51 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] [~accountid:5a9e4751a00c7f2a80155fda] 

* Is this applicable only to recurring transactions, or does it also include all transactions having a trace ID, such as pre-authorizations and incrementals?

All of them, there’s no way to separate out pre-authorizations and incrementals as best we (me, Shoaib, C24, Mettle) can tell
* We should continue reusing the TID in the following case, correct? That is, if *Txn B* is still “open”:
** Txn A = txn_id = AAA settled
** Txn B = txn_id = BBB (not settled)
** Txn C = linking back to Txn B, so, txn_id = BBB or new TID CCC

New TID
* How should we handle partial reversed cases? or we should generate new TID if transaction is fully or partially reversed. If a transaction linked via a trace ID has been partially reversed, do we need to generate a new TID?

By new default for partially settled/reversed cases (/partially settled where rest of auth hasn’t expired), we should not generate a new TID, I would suggest that we could have a separate flag(s) to make it stricter and generate a new TID even in these partial cases



* How does settlement work if we receive a settlement with an accumulated amount?

In the case demonstrated they would have the same TID as there wasn’t a settlement between the two, would you mind clarifying the concern?

If it was 

auth 6
settle 5
auth 4
settle 5 I suppose that’s a more complicated case, but not sure how often it will happen? What would you suggest?
* Is this in any way related to the previous ASI and its preauth related change, or does it have any impact on it? (Mettle)

ASI and auth should still be separate using the “Mettle” flag. That’s obviously a lot simpler given that ASI has 0 value 

* 
Can you please review this ticket too? If we create different TID, how single presentment for multiple authorization works?

Also not sure of question, for recurring payments will always be separate settlements","21/Mar/25 10:02 AM;6195bb56ef18ca0071c7a9de;* We should continue reusing the TID in the following case, correct? That is, if *Txn B* is still “open”:
** Txn A = txn_id = AAA settled
** Txn B = txn_id = BBB (not settled)
** Txn C = linking back to Txn B, so, txn_id = BBB or new TID CCC
New TID

→ Txn B was still not settled, and Txn C is linking back to Txn B through traced id. I believe for this we need to reuse same TID? Or have flag to handle both cases i.e. either reuse or generate new one.



If it was 

auth 6
settle 5
auth 4
settle 5 I suppose that’s a more complicated case, but not sure how often it will happen? What would you suggest?

→ yeah, not sure how often this will happen. If we saw some cases, I believe we can think for it later ","25/Mar/25 12:29 PM;6195bb56ef18ca0071c7a9de;Hi [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] 

What should be the logic for reusing a TID if we receive advisement for the original transaction (which hasn't settled yet)?

There are multiple scenarios where advisement can happen:

* The authorization was declined, but scheme performed STIP.
* The authorization was approved, but scheme still performed STIP (maybe timeout).
* The authorization was approved, followed by a completion advisement (191).
* No prior authorization, just a direct advisement.

Should these cases be considered as ""open"" transactions?

If we later receive another transaction with a trace ID linking back to one of these cases, should we reuse the existing TID or generate a new one?

and please note, we don’t have different indicator for completion or advisement. So, if we need to have different logic for these 0120 cases, we need to check original transaction data, which I believe add additional query time.","26/Mar/25 9:35 AM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Hey [~accountid:6195bb56ef18ca0071c7a9de] 

In the first three scenarios, we definitely still want to share the TID, obviously in the fourth there’s nothing to share the TID with so that’s easy

I would also advise thinking about if there’s a way how we can more intelligently track the status of payments… might be a bigger task to complete, but when I looked at the txn_status table (I think that’s what it is called) it was a bit of a mess ","26/Mar/25 9:44 AM;6195bb56ef18ca0071c7a9de;I am using {{txn_status}} to track status of authorization, and we're also using these statuses for internal ledger handling. So, I believe it's safe and won't cause any issues with the TID logic.

Change is ready. I’ll attach local test result soon.",26/Mar/25 2:25 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - DEFECT-2827 has got status Rejected,"11/Apr/25 7:38 AM;6195bb56ef18ca0071c7a9de;The changes have already been merged into master branch, and IT test is in place to verify them.

Closing this ticket","29/Apr/25 5:04 AM;5f623946b9fcc1007734b378;Hi [~accountid:6195bb56ef18ca0071c7a9de] / [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] - having a look at the comments and the user story, I have a few questions and requests:

* will this be behind a product flag? So if an existing client is wanting to enable this behaviour they can.
* could you please bullet point existing TID logic VS new logic - that way we can show a clear comparison.
* Asking all of this as i’ll include in the release notes. Therefore, please include anything else you find relevant in your comments.

I’m compining the release notes for BL-2.26 now, so needing asap please.","29/Apr/25 6:45 AM;6195bb56ef18ca0071c7a9de;Hi,

* will this be behind a product flag? So if an existing client is wanting to enable this behavior they can.

→ Yes, the feature is controlled by a product flag({{enable_trace_id_constraints_for_tid}}), and we have already included a Liquibase script to disable it for existing clients. This ensures that there is no disruption to the current flow without prior communication with the client. If an existing client wants to use this feature, they can choose to enable it. For new clients, the feature will be enabled by default.

* could you please bullet point existing TID logic VS new logic - that way we can show a clear comparison.

→ *Old logic:*

* The same TID will be reused if the trace ID ({{DE48_63}}) matches the original transaction.

→ *New logic:*

* A new TID will be generated if the trace ID ({{DE48_63}}) matches an original transaction that was settled, reversed, or decline-advised. 
* The flag supports three modes:
** *0*: For existing clients
** *1* (default): For new clients

{noformat}0 = Disabled 

1 = Light mode 
In this mode, we do not reuse a TID for a transaction that has already been settled or 
reversed, or received a decline advice. It should only be reused for payments which are 
still “open”, in other words. Partially settled or Partially reversed transaction are 
considered open in this mode.

2 = Strict mode

When this flag is set, reuse is permitted only for payments that remain ""open"".
Partially settled or Partially reversed transaction are considered closed in this 
mode and new TID will be created for new transaction instead of reusing from original.{noformat}



_Please notes, this requires another flag(_{{skip_paytok_tid_logic_if_generated_by_ppwr}}_) to be enabled, which will use already generate transaction ID outside of SQL._

[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] Would you like to add anything further here?","29/Apr/25 8:35 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] what you wrote here makes sense, though a bit too detailed for the release notes

What card schemes does this apply for? I believe it’s Mastercard only

Also, to what extent do they need to have AuthorisationEngine enabled? Does it simply have to be enabled without any validators?

I think the important thing to highlight [~accountid:5f623946b9fcc1007734b378] is the point about three modes of operation, and the default for existing clients being the pre-existing behaviour (TIDs are shared in recurring payments) ","30/Apr/25 5:41 AM;6195bb56ef18ca0071c7a9de;+what you wrote here makes sense, though a bit too detailed for the release notes+

→ I thought so 😅 

+What card schemes does this apply for? I believe it’s Mastercard only+

→ Yes, correct. Only Mastercard.

+Also, to what extent do they need to have AuthorisationEngine enabled? Does it simply have to be enabled without any validators?+

→ Previously, this feature required Authorization Engine, but good news is that from BL 2.26 onward, it no longer needs Authorisation Engine to be enabled.","30/Apr/25 5:45 AM;6195bb56ef18ca0071c7a9de;[~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] What should be the next step for this ticket? Specifically for C24, since they initially raised it for recurring transactions. Should we enable it for them in UAT? Based on the shadow mode result comparison, both Paytok and the new logic in PayPower are generating the same TID. I believe there shouldn't be any issues, even if the new logic fails to generate a TID, we have fallback logic in PayTok to handle it.",30/Apr/25 5:47 AM;6195bb56ef18ca0071c7a9de;[https://paymentology.atlassian.net/browse/DEFECT-2258|https://paymentology.atlassian.net/browse/DEFECT-2258|smart-link] ,20/May/25 2:57 PM;6195bb56ef18ca0071c7a9de;Hi [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] Do we have any estimated timeline for this change for C24?,"21/May/25 5:35 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:6195bb56ef18ca0071c7a9de] Thanks Prabin, let me follow up with Maris and the C24 team",21/May/25 5:39 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:5abca82e3cde3440ff0056b1] Maris suggested I speak to you?,"23/May/25 9:35 AM;5abca82e3cde3440ff0056b1;[~accountid:6195bb56ef18ca0071c7a9de] [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062]  Client agreed with this release. Also,Please include below details in the communication 

- what is that we are changing and what would be the effect on the client side 
-  if there are any edge cases on this , last time we found out that 1000s of affected transactions ( More details are shared in this ticket [Ticket: Replaced Card token state is shown as… – Paymentology – Zendesk|https://paymentology.zendesk.com/agent/tickets/959236],exceprts from the ticket )



{noformat}The team conducted extensive testing across various scenarios and identified edge cases in transactions that we had initially discussed. Since these edge cases could cause issues on the settlement side, the release process has been temporarily postponed.  Below are the details:
 
Using Field 61, Subfield 4 = 4 to identify recurring transactions, during our analysis, we observed that DE 61_4 = 4 is also present in incremental transactions, not only in recurring ones. This indicates that relying solely on this field may lead to inconsistent behavior in certain scenarios. For example, please consider the following case:
TID: 2991757501319613575
Transaction 1: Amount = 11.94, DE 61_4 = 5, DE 61_7 = 4
Transaction 2 (Incremental): Amount = 2.00, DE 61_4 = 4, DE 61_7 = 4 (Note: under the proposed logic, this would be treated as a new TID)
Settlement: Total = 13.94
In this case, our system would match the settlement amount to only one authorization transaction and pass its TID to your system. As a result, the other authorization hold would remain pending in your system, creating a mismatch.
This behavior will directly affect cases where multiple preauthorizations with a single settlement occur, as described in the documentation you provided. https://developer.paymentology.com/docs/data-tid-and-rid#multiple-pre-auth-single-presentment
 {noformat}","26/May/25 7:44 AM;6195bb56ef18ca0071c7a9de;[~accountid:5abca82e3cde3440ff0056b1] 

ticket changes explained here

[https://paymentology.atlassian.net/browse/AUTH-1196?focusedCommentId=249978|https://paymentology.atlassian.net/browse/AUTH-1196?focusedCommentId=249978]

----

{noformat}The team conducted extensive testing across various scenarios and identified edge cases in transactions that we had initially discussed. Since these edge cases could cause issues on the settlement side, the release process has been temporarily postponed.  Below are the details:
 
Using Field 61, Subfield 4 = 4 to identify recurring transactions, during our analysis, we observed that DE 61_4 = 4 is also present in incremental transactions, not only in recurring ones. This indicates that relying solely on this field may lead to inconsistent behavior in certain scenarios. For example, please consider the following case:
TID: 2991757501319613575
Transaction 1: Amount = 11.94, DE 61_4 = 5, DE 61_7 = 4
Transaction 2 (Incremental): Amount = 2.00, DE 61_4 = 4, DE 61_7 = 4 (Note: under the proposed logic, this would be treated as a new TID)
Settlement: Total = 13.94
In this case, our system would match the settlement amount to only one authorization transaction and pass its TID to your system. As a result, the other authorization hold would remain pending in your system, creating a mismatch.
This behavior will directly affect cases where multiple preauthorizations with a single settlement occur, as described in the documentation you provided. https://developer.paymentology.com/docs/data-tid-and-rid#multiple-pre-auth-single-presentment
 {noformat}

→ Previously, proposed logic was based solely on DE61_4 indicator. However, now we are considering the transaction status, whether it's settled, reversed, or declined advice. If the original transaction meets any of these conditions, we generate a new transaction thread ID and continue processing with that. During settlement, the matching will use relevant data elements and will assign the same TID as used in the original authorisation.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,105940,AUTH-72,MC Authorisation engine validator,Done,11/Apr/25 7:39 AM
"BL Mettle - PP version paypower:v3.90.6-hf.1 , the traces are getting written in PayLog DB however instance id is going as 0",AUTH-1135,148881,Bug,Released,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,Done,Afsun Khammadli,61d7273c567cb70070f0f9a5,Jenifer Cachero,61d7273c125b120071fe08fa,Zendesk Support for Jira,557058:a01b4872-0086-4bc3-903e-23f26637afa2,04/Feb/25 7:03 AM,21/Apr/25 7:37 PM,,01/Apr/25 7:58 AM,BL-2.23.0,PP-3.144.1,,,,,,,,,,,,,,,,,,,,,0,jira_escalated,jira_update,,,"Hi auth team, We have observed that with PP version paypower:v3.90.6-hf.1 , the traces are getting written in PayLog DB however instance id is going as 0  hence filter of instance id not displayed on PayControl -->Application Logs . If we remove the filter of Instance we can see the traces on PC.

!image (124).png|width=1216,height=710,alt=""image (124).png""!

!image (123).png|width=1901,height=909,alt=""image (123).png""!



This is not a blocker . Also observed the same issue in other environments as well.

Slack thread: [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1738643658444179?thread_ts=1738637150.792819&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1738643658444179?thread_ts=1738637150.792819&cid=C02CA1QPG5Q]

* Please see Zendesk Support tab for further comments and attachments.",,Afsun Khammadli,Jenifer Cachero,Zendesk Support for Jira,,,,,,,,,61d7273c567cb70070f0f9a5,61d7273c125b120071fe08fa,557058:a01b4872-0086-4bc3-903e-23f26637afa2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,04/Feb/25 7:05 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;image (123).png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104837,04/Feb/25 7:05 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;image (124).png;https://paymentology.atlassian.net/rest/api/3/attachment/content/104838,12/Apr/25 4:55 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;image-20250412-025408.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/110044,12/Apr/25 4:55 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;image-20250412-025428.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/110045,12/Apr/25 4:55 AM;ug:713d2be0-bbc1-4aaa-b4ce-3a758ffb17ea;image-20250412-025449.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/110046,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@5edd992d,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2025-02-05T09:13:27.000+0200"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitHub"":{""count"":1,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzn8a5:zzzzzzzzzzzzzzzzz,,,,,"*1. Title*:
[TBA - Name of the Feature]


*2. Description*:
[TBA - Provide a brief summary of the change/feature.]


*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]


*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]


*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]


*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]
",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,Sprint 19,Sprint 20,Sprint 21,Sprint 22,,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-03-27 06:10:37.374,10306_*:*_1_*:*_5868817_*|*_3_*:*_1_*:*_69084340_*|*_10000_*:*_1_*:*_19261483_*|*_10345_*:*_1_*:*_0,,"22/Mar/25 1:33 AM;61d7273c125b120071fe08fa;Hi [~accountid:61d7273c567cb70070f0f9a5] , do we have any updates on this?","27/Mar/25 8:10 AM;61d7273c567cb70070f0f9a5;Hi [~accountid:61d7273c125b120071fe08fa] , what kind of updates? It is part of BL-2.23. It will be deployed soon. You can follow this page
[https://paymentology.atlassian.net/wiki/spaces/TS/pages/7824244738/Banking+Live+Release+Cycle|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7824244738/Banking+Live+Release+Cycle|smart-link] 
",12/Apr/25 4:52 AM;61d7273c125b120071fe08fa;Thanks [~accountid:61d7273c567cb70070f0f9a5] . The  BL-2.23 for Mettle was deployed last March 25.,"12/Apr/25 4:55 AM;61d7273c125b120071fe08fa;Paypower logs in Paycontrol is showing latest logs and it is not Instance ID 0 anymore.

!image-20250412-025408.png|width=867,height=369,alt=""image-20250412-025408.png""!

!image-20250412-025428.png|width=864,height=348,alt=""image-20250412-025428.png""!

!image-20250412-025449.png|width=864,height=376,alt=""image-20250412-025449.png""!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147455,AUTH-1096,BAU Bug Fixes - PayPower,Done,01/Apr/25 7:58 AM
Mettle: Update Reason codes and change response codes for ATC declines,AUTH-1126,148427,Story,Released,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Highest,Released,Afsun Khammadli,61d7273c567cb70070f0f9a5,Shoaib Iqbal,6297155ee76a9c00705e2b50,Shoaib Iqbal,6297155ee76a9c00705e2b50,28/Jan/25 12:48 PM,26/May/25 11:14 AM,,26/May/25 11:14 AM,BL-2.24.0,PP-3.159.0,PP-3.163.0,PTDB-1.107.0,,,,,,,,,,,,,,,,,,,0,,,,,"*Problem*

Currently when the pretok process declines payments because of the ATC check failure, there is no dedicated processor reason code - in fact we send “000” success while declining the payment.

We should also move away from 05 codes.

Further more, where (Mastercard) DE 61-7 = 1 (deferred auth) we probably shouldn’t be failing transactions on ATC failure",,Afsun Khammadli,Lucy Simpson,Shehroz Ahmed Siddiqui,Shoaib Iqbal,William Dunne,,,,,,,61d7273c567cb70070f0f9a5,5f623946b9fcc1007734b378,632872d207a27ebeff12903b,6297155ee76a9c00705e2b50,557058:5363d7a1-da13-4012-8609-f44e54c1d062,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,PR-1995,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@2f3bf55,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,{},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,MasterCard,VISA,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,"*Solution*

# Update response code from 05 to 63 for MC & Visa 
## [https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_check_atc_status.sql#L59|https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_check_atc_status.sql#L59] 
# Update the reason code from 000 to 199 as we do for Visa
## [https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_check_atc_status.sql#L61|https://github.com/Paymentology/paytokdb/blob/master/src/main/sql/replace/functions/public/ppwr_check_atc_status.sql#L61] 
# Furthermore, where (Mastercard) DE 61-7 = 1 (deferred auth) we need to exempt such transaction from ATC validation.
## It should be under a featured flag.",,,,,,,,,,,,,,,1|hzn8a5:zzzzzzzzzzzzzzzzi,,,,,"*1. Title*:
Updating reason and response codes for ATC declines

*2. Description*:
The reason code for ATC declines has changed from 05 to 63. Additionally, we have introduced a feature that prevents ATC declines for deferred authorization transactions on MasterCard when the feature flag is enabled.

*3. Value for Client/Cardholder*:
Code 05 is a general response code, while code 63 provides a more specific reason. This change allows clients to access more accurate data when investigating reasons for decline.

*4. Impact on Users*:
No impact on Users, in PayControl they will have new reasons and response codes for ATC declines. No functional changes.

*5. Additional Information*:
Nothing required to start to use. 

*6. Reference Material/Links to documentation*: 
[https://paymentology.atlassian.net/wiki/spaces/TS/pages/7517274378/BL+PayPower+Settings+through+Product+ID+or+Client+ID|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7517274378/BL+PayPower+Settings+through+Product+ID+or+Client+ID|smart-link] 

The feature flag is {{exempt_deferred_auth_from_atc_validation}}",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,Sprint 20,Sprint 21,Sprint 22,,,,,,,,,,,,,4.0,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2025-02-06 05:42:07.597,10306_*:*_1_*:*_1893047624_*|*_3_*:*_1_*:*_182219729_*|*_10001_*:*_1_*:*_0_*|*_10345_*:*_1_*:*_4498789545,,"06/Feb/25 7:42 AM;632872d207a27ebeff12903b;Hi [~accountid:6297155ee76a9c00705e2b50] please update the priority of this client request and add the right epic/ parent of initiative.
The ticket is orphan right now","20/Feb/25 10:18 AM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:61d7273c567cb70070f0f9a5] for the feature flag, please change the default behaviour to exemption, but for all clients insert the setting for behaviour to remain as-is","20/Feb/25 2:17 PM;61d7273c567cb70070f0f9a5;Hi [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] , Is it better to have this flag in the product settings rather than as a feature flag in the config XML? Having it at the product level would give us more granular control. What do you think?","21/Feb/25 1:56 PM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;[~accountid:61d7273c567cb70070f0f9a5] I agree, definitely a product setting - but the default behaviour for new clients, should be the new behaviour. But we shouldn’t roll that (specifically the deferred auth bypass) for all preexisting clients","19/Mar/25 5:27 AM;5f623946b9fcc1007734b378;Hi [~accountid:632872d207a27ebeff12903b] [~accountid:6297155ee76a9c00705e2b50] - this ones in BL2.24.
Re the Release Notes:
1. What will be default for new clients?
2. Are we rolling this out to existing clients? If so how do they go about implementing it?
3. Do implementations need to do anything?
4. Basically i need what you want to include in the release notes",19/Mar/25 8:53 AM;6297155ee76a9c00705e2b50;[~accountid:61d7273c567cb70070f0f9a5] Could you please provide the release notes for this ticket?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147455,AUTH-1096,BAU Bug Fixes - PayPower,Done,19/Feb/25 10:39 AM
Ability to enable AuthEngine on a subset of transactions on Banking.Live,AUTH-784,133421,Story,Released,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,Done,Afsun Khammadli,61d7273c567cb70070f0f9a5,William Dunne,557058:5363d7a1-da13-4012-8609-f44e54c1d062,William Dunne,557058:5363d7a1-da13-4012-8609-f44e54c1d062,13/Aug/24 12:53 PM,21/Apr/25 7:41 PM,,20/Jan/25 12:36 PM,BL-2.20.0,PP-3.70.0,,,,,,,,,,,,,,,,,,,,,0,,,,,"My understanding is that currently we have the ability to enable/disable the AuthorisationEngine, and individual validations performed within the RuleEngine, which is fantastic, and will enable us to roll this out slowly to customers and perform testing.

One point of concern I have, is that we have a number of customers that are either incredibly sensitive to downtime or to changes in how processing is performed.

Even once we have this rolled out for a few existing customers, or for new certifications, clients like ISB and Mettle will both be very difficult.



What I would propose we need to have is the ability to gradually roll it out on an incremental basis to a subset of transactions - i.e 100% of validation will be performed on AuthorisationEngine, but only on 1% of transactions.

This would need to be done on a configuration basis, so it can be done without code change (i.e to rollback or increase)

On a technical level, from my perspective, this could be as low tech as having a configuration number, where you input a value where if (timestamp % configvalue == 0) we use rule engine. We could then start off with it operating on 1 in a 1000 transactions for ISB, and slowly incrementing towards 1 in 1 as we gain confidence that nothing has fundamentally broken/changed

I have discussed this with Florin, and he requested creating ticket - this ticket can initially be for investigation but so long as it’s not a large project, I would propose using the same ticket for development (please discuss with Shehroz/Florin/Wil when you have determined what is possible)",,Afsun Khammadli,William Dunne,,,,,,,,,,61d7273c567cb70070f0f9a5,557058:5363d7a1-da13-4012-8609-f44e54c1d062,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@6f286c4f,,,,,,,,,,,,,,,,,,Normal,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=2}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":2,""lastUpdated"":""2024-11-11T11:38:13.000+0200"",""stateCount"":2,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""GitHub"":{""count"":2,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|i012m9:,,,,,"*1. Title*:
[TBA - Name of the Feature]

*2. Description*:
[TBA - Provide a brief summary of the change/feature.]

*3. Value for Client/Cardholder*:
[TBA - The Why/Purpose]

*4. Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]

*5. Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]

*6. Reference Material/Links to documentation*: 
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,Sprint 14,Sprint 15,Sprint 16,Sprint 17,Sprint 18,,,,,,,,,,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-11-07 08:14:13.099,10306_*:*_1_*:*_3626695339_*|*_3_*:*_2_*:*_636016012_*|*_10000_*:*_2_*:*_3505693682_*|*_10400_*:*_1_*:*_3102922_*|*_10345_*:*_1_*:*_0,,"07/Nov/24 10:12 AM;557058:5363d7a1-da13-4012-8609-f44e54c1d062;Hey [~accountid:61d7273c567cb70070f0f9a5] - guessing Florin already spoke to you about it, but one thing that has been mentioned by Florin is that he would like to be able to apply this subset logic on a per-validation basis ","07/Nov/24 10:14 AM;61d7273c567cb70070f0f9a5;Hi [~accountid:557058:5363d7a1-da13-4012-8609-f44e54c1d062] . Yes, we discussed it with him and this was my first question.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,105940,AUTH-72,MC Authorisation engine validator,Done,20/Jan/25 12:36 PM
[PayPower] Should send actual AVS result code on AVS NOT SUPPORTED when product flag allow_avs_fail_as_avs_supported enabled ,AUTH-562,125846,Task,Released,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,Done,Febby Oktaviani,629a26eba0eafd0069ea2343,Febby Oktaviani,629a26eba0eafd0069ea2343,Febby Oktaviani,629a26eba0eafd0069ea2343,25/Apr/24 9:07 AM,21/Apr/25 7:41 PM,,10/May/24 1:33 PM,PP-3.30.0,,,,,,,,,,,,,,,,,,,,,,0,,,,,"Implements fix for [https://paymentology.atlassian.net/browse/DEFECT-395|https://paymentology.atlassian.net/browse/DEFECT-395|smart-link] in PayPower using authorisation-engine.



Spec 1: Should allow the transaction with AVS check and set AVS response according to the AVS check result if there’s a product setting to approve transaction even if AVS check fails and allow AVS check fails as AVS supported enabled.



Spec 1.1: Should set DE48_83 = “W” for {{AVS_NOT_SUPPORTED_POSTAL_CODE_MATCH_ADDRESS_MISMATCH}}

Given a MC transaction

* auth-engine has returned a warning that AVS check is not supported {{AVS_NOT_SUPPORTED_POSTAL_CODE_MATCH_ADDRESS_MISMATCH}}
* product setting to allow avs check fails as avs supported is enabled.

When checking the validity of the transaction

Then

* DE48_83 is set to “W“



Spec 1.2: Should set DE48_83 = “A“ for {{AVS_NOT_SUPPORTED_POSTAL_CODE_MISMATCH_ADDRESS_MATCH}}

Given a MC transaction

* auth-engine has returned a warning that AVS check is not supported {{AVS_NOT_SUPPORTED_POSTAL_CODE_MISMATCH_ADDRESS_MATCH}}
* product setting to allow avs check fails as avs supported is enabled.

When checking the validity of the transaction

Then

* DE48_83 is set to “A“



Spec 1.3: Should set DE48_83 = “N“ {{AVS_NOT_SUPPORTED_POSTAL_CODE_MISMATCH_ADDRESS_MISMATCH}}

Given a MC transaction

* auth-engine has returned a warning that AVS check is not supported {{AVS_NOT_SUPPORTED_POSTAL_CODE_MISMATCH_ADDRESS_MISMATCH}}
* product setting to allow avs check fails as avs supported is enabled.

When checking the validity of the transaction

Then

* DE48_83 is set to “N“



Spec 1.4: Should set DE48_83 = “X“ {{AVS_NOT_SUPPORTED_POSTAL_CODE_MISMATCH_ADDRESS_MISMATCH}}

Given a MC transaction

* auth-engine has returned a warning that AVS check is not supported {{AVS_NOT_SUPPORTED_POSTAL_CODE_MISMATCH_ADDRESS_MISMATCH}}
* product setting to allow avs check fails as avs supported is enabled.
* product id is one of {{114, 112, 116, 120, 118, 122, 183}}

When checking the validity of the transaction

Then

* DE48_83 is set to “X“



Spec 1.5: Should set DE48_83 = “X“ for  {{AVS_NOT_SUPPORTED_POSTAL_CODE_MATCH_ADDRESS_MATCH}}

Given a MC transaction

* auth-engine has returned a warning that AVS check is not supported {{AVS_NOT_SUPPORTED_POSTAL_CODE_MATCH_ADDRESS_MATCH}}
* product setting to allow avs check fails as avs supported is enabled.

When checking the validity of the transaction

Then

* DE48_83 is set to “X“



Spec 1.6: Should set DE48_83 = “U“ for  {{AVS_NOT_SUPPORTED}}

Given a MC transaction

* auth-engine has returned a warning that AVS check is not supported AVS_NOT_SUPPORTED
* product setting to allow avs check fails as avs supported is enabled.

When checking the validity of the transaction

Then

* DE48_83 is set to “U“",,Automation for Jira,Elisha Tavagadza,Febby Oktaviani,,,,,,,,,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,712020:64580c54-e845-4cad-8527-822d7a6e6fee,629a26eba0eafd0069ea2343,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,DEFECT-395,,AUTH-336,AUTH-326,,,,,,,,,,,,,20/Jun/24 1:07 PM;712020:64580c54-e845-4cad-8527-822d7a6e6fee;AUTH-562-Should send actual AVS result code on AVS NOT SUPPORTED when product flag allow_avs_fail_as_avs_supported enabled.docx;https://paymentology.atlassian.net/rest/api/3/attachment/content/86748,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;allow_avs_fail_as_avs_supported_enabled.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83649,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;full_match_paytokCall.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83654,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;full_matchpng.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83646,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;full_mismatch.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83655,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;full_mismatch_paytokCall.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83650,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;no_data.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83647,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;no_data_patokCall.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83653,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;partial_match_addr_paytokCall.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83645,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;partial_match_address.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83652,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;partial_match_poscode_paytokCall.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83648,09/May/24 7:31 AM;ug:14f4ec95-a99c-4943-8fc5-4d3685a60ade;partial_match_postcode.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/83651,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@384c140b,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2024-05-09T09:05:00.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":4,""name"":""GitLab""},""GitHub"":{""count"":2,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzzy9z:,,,,,"# *Title:*
[allow avs fail as avs supported with flag in authorisation-engine]
# *Description*:
[Implement the solution on this ticket [https://paymentology.atlassian.net/browse/DEFECT-395|https://paymentology.atlassian.net/browse/DEFECT-395] in authorisation-engine ]
# *Value for Client/Cardholder*:
[When avs_fail_as_avs_supported product settings flag and token flag allow avs fail enabled paypower will approve the transaction even if the avs check fail and send the correct avs result code to scheme (MC) as this feature is requested by client (Mettle). This feature already implemented in BL with paytok validation and should be implemented in authorisation-engine as well]
# *Impact on Users*:
[TBA - Describe how the feature will impact users, including any changes to functionality, user interface, or workflow.]
# *Additional Information*:
[TBA – Note: Provide information on how a client can integrate/begin to use this]
# *Reference Material/Links to documentation*:
[TBA – Note: Any changes to FAST messages, FAST notifications, reports or API's need to include a sample.]",,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,AUTH Sprint 5,Sprint 7,Sprint 8,Sprint 9,Sprint 10,Sprint 11,Sprint 12,Sprint 13,Sprint 14,Sprint 15,Sprint 16,Sprint 17,Sprint 18,Sprint 19,,,,,,,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,"When product setting to allow AVS check fail as AVS Supported enabled (currently for MasterCard only), then:

!allow_avs_fail_as_avs_supported_enabled.png|width=66.67%,alt=""allow_avs_fail_as_avs_supported_enabled.png""!

* When auth engine return AVS_NOT_SUPPORTED -> DE48_83 = U
** *Auth-engine validation result*
!no_data.png|width=53.897104128157736%,alt=""no_data.png""!
** *Paytok call - de48_83 set to U*
!no_data_patokCall.png|width=53.897104128157736%,alt=""no_data_patokCall.png""!
* When auth engine return AVS_NOT_SUPPORTED_POSTAL_CODE_MATCH_ADDRESS_MISMATCH -> DE48_83 = W
** *Auth-engine validation result*
!partial_match_postcode.png|width=53.897104128157736%,alt=""partial_match_postcode.png""!
** *Paytok Call - DE48_83 set to W*
!partial_match_poscode_paytokCall.png|width=53.897104128157736%,alt=""partial_match_poscode_paytokCall.png""!
* When auth engine return AVS_NOT_SUPPORTED_POSTAL_CODE_MISMATCH_ADDRESS_MATCH -> DE48_83 = A
** *Auth-engine validation result*
!partial_match_address.png|width=53.897104128157736%,alt=""partial_match_address.png""!
** *Paytok Call - DE48_83 set to A*
!partial_match_addr_paytokCall.png|width=53.897104128157736%,alt=""partial_match_addr_paytokCall.png""!
* When auth engine return AVS_NOT_SUPPORTED_POSTAL_CODE_MATCH_ADDRESS_MATCH -> DE48_83 = X
** *Auth-engine validation result*
!full_matchpng.png|width=53.897104128157736%,alt=""full_matchpng.png""!
** *Paytok Call - DE48_83 set to X*
!full_match_paytokCall.png|width=53.897104128157736%,alt=""full_match_paytokCall.png""!
* When auth engine return AVS_NOT_SUPPORTED_POSTAL_CODE_MISMATCH_ADDRESS_MISMATCH -> DE48_83 = N
** *Auth-engine validation result*
!full_mismatch.png|width=53.897104128157736%,alt=""full_mismatch.png""!
** *Paytok call - DE48_83 set to N*
!full_mismatch_paytokCall.png|width=53.897104128157736%,alt=""full_mismatch_paytokCall.png""!
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Modernization,,,,2024-06-20 11:08:34.433,10306_*:*_1_*:*_365090067_*|*_3_*:*_1_*:*_508163236_*|*_10000_*:*_1_*:*_330653025_*|*_10001_*:*_1_*:*_0_*|*_10400_*:*_1_*:*_108047722,,"14/Jun/24 4:39 AM;629a26eba0eafd0069ea2343;Hi [~accountid:62e001238cc02d0b34bd4bb0], would you please list this ticket to the list as well? this is part of AVS with auth-engine feature and its ready in BL 2.12. Thanks! ",20/Jun/24 1:08 PM;712020:64580c54-e845-4cad-8527-822d7a6e6fee;QA1 testing completed. please find attached,22/Jan/25 10:12 AM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - AUTH-336 has got status Done,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,105940,AUTH-72,MC Authorisation engine validator,Done,22/Jan/25 10:13 AM
3DS checks for leading indicator kX ,AUTH-150,117839,Story,Released,AUTH,PE - Processing  - Authorisations,software,Stephen Kerin,62c5616bb6357aecd7c70e56,,,Normal,Done,agung.setiawan,6273fbf86a38370069df0612,Anne Marie Tovey,5f05939fd68032002142c1f3,Anne Marie Tovey,5f05939fd68032002142c1f3,11/Dec/23 12:41 PM,21/Apr/25 7:40 PM,,16/Feb/24 12:38 PM,PTDB-,PTDB-1.25.0,PTDB-1.26.0,,,,,,,,,,,,,,,,,,,,0,3DS,jira_escalated,,,"Background:

Currently BL declines all kX SLI 214 transactions because the AAV/IAV cannot be validated as it is not created by our ACS.

MC published a new mandate AN 7112 which states that ALL AAVs must be validated by either the Issuer or MC will validate. and if it is validated by MC the result will be shared in DE48 SE 71 SF01 = 05/06 SF02= V  (DEV-11639099 caters for AN 7112 requirement) [https://paymentology.atlassian.net/browse/DEV-11639099|https://paymentology.atlassian.net/browse/DEV-11639099|smart-link] 

However, MC has so far failed to pass the OBS data to the Issuer and hence the problem still continues.

In the case of kX SLI 214, the Mastercard Insights, the merchants use data to make a decision to process without fully authenticating the transaction. If they do so, then the liability of the transaction in case of fraud remains with the merchant. Therefore what this story is about is:

If DE48 SE 71 SF01 = 05/06 SF02= V  is not provided, then we must continue processing. Only in the case of leading indicator = kX (also kY and kZ new values not in use)

Leading Indicator is in DE48 SE43 Positions 1 and 2 

Note: This has been raised as a problem by both Mettle and ISB 

[https://paymentology.atlassian.net/browse/DEV-11645689|https://paymentology.atlassian.net/browse/DEV-11645689|smart-link] 

!image-20231211-104628.png|width=684,height=404!



!image-20231211-104534.png|width=514,height=702!",,agung.setiawan,Anne Marie Tovey,Automation for Jira,Florin Vistig,Marcin Świerczyński,Savio,Shoaib Iqbal,Shubham G,,,,6273fbf86a38370069df0612,5f05939fd68032002142c1f3,557058:f58131cb-b67d-43c7-b30d-6b58d40bd077,5a9e4751a00c7f2a80155fda,712020:c085ef23-abfd-4a85-beab-72e584c439eb,60fedd388ad5b600707750e1,6297155ee76a9c00705e2b50,61f80302845d670071f2138e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,AUTH-157,,,AUTH-239,,,,,,,,,,,28/Dec/23 11:35 AM;rk:adf5233f-de64-4d7e-a8b8-095fd70c965d;Zrzut ekranu 2023-12-28 o 10.32.20.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/74145,28/Dec/23 11:38 AM;rk:adf5233f-de64-4d7e-a8b8-095fd70c965d;Zrzut ekranu 2023-12-28 o 10.38.11.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/74146,22/Jan/24 1:58 PM;rk:adf5233f-de64-4d7e-a8b8-095fd70c965d;Zrzut ekranu 2024-01-22 o 12.53.23.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/75557,11/Dec/23 12:46 PM;annemarie;image-20231211-104534.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73199,11/Dec/23 12:46 PM;annemarie;image-20231211-104628.png;https://paymentology.atlassian.net/rest/api/3/attachment/content/73198,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,com.atlassian.servicedesk.plugins.approvals.internal.customfield.ApprovalsCFValue@3ac43854,,,,,,,,,,,,,,,,,,,,,,,,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"{repository={count=60, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":60,""lastUpdated"":""2024-02-22T15:09:59.000+0200"",""dataType"":""repository""},""byInstanceType"":{""GitLab"":{""count"":60,""name"":""GitLab""},""GitHub"":{""count"":26,""name"":""GitHub""}}}}},""isStale"":true}}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Banking.live,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1|hzyoaf:,,,,,,,,,,,Yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,P/AUTH - Sprint 12,P/AUTH - Sprint 13,Auth Sprint 1,,,,,,,,,,,,,,,,M (2-5bd),,,,,,,,,ef96ef5c-c768-4bd0-8bc7-c179e9e5f299,PE - Processing - Authorisations,"h2. Function call

{code:sql}begin;
select *
from ppwr_tok_pre18('0100', '\x1d1e35e132c6554e593c64cb09b86732', '\x0000000200000000', '\x1d1e35e132c6554e593c64cb09b86732', '000000',
					100, '1206124224', NULL, NULL, '61000000', '000013', '114902', '1206', '2612', '0612', '0612', NULL,
					'5499', NULL, NULL, NULL, '052', '00', NULL, NULL, NULL, NULL, NULL, NULL, '012345', NULL,
					'2D2608221', '085000100002', NULL, NULL, '12345678', '123456789123456',
					'W.H.Smith Signature    Edinburgh     GBR', NULL, NULL, 'T4207010321492035224306kX1234', '826',
					NULL, '826', NULL, NULL, NULL, '\x001C', '\x0000000000', '\x1E0300', '\xE0E8E8', '\x80',
					'\x010100A0030000C1', NULL, '0000000000800826902101234', NULL, 'MCS0110QI', NULL, NULL,
					'000000000000000000000000000000000000001000', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
					NULL, NULL, NULL, NULL, NULL, 1, 1, 4, '234564', 3019, NULL, 'M', -83571, 0, 10,
					'2023-12-06 12:42:24.879+00', 1023120612422487211, 'TRUE', 'FALSE');
rollback;{code}

h2. Before

!Zrzut ekranu 2023-12-28 o 10.38.11.png|width=1669,height=603!

h2. After

!Zrzut ekranu 2023-12-28 o 10.32.20.png|width=2514,height=655!

h2. After the improvement

[https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/merge_requests/1178|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/merge_requests/1178|smart-link] 

!Zrzut ekranu 2024-01-22 o 12.53.23.png|width=1484,height=944!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-12-18 11:45:45.744,10315_*:*_1_*:*_1632826498_*|*_10306_*:*_1_*:*_10278550_*|*_3_*:*_1_*:*_699382635_*|*_10000_*:*_1_*:*_761258963_*|*_10001_*:*_1_*:*_0_*|*_10345_*:*_1_*:*_2684878396,,18/Dec/23 1:45 PM;5a9e4751a00c7f2a80155fda;Some discussion on Slack related to this: [https://paymentology.slack.com/archives/C02CA1QPG5Q/p1702375162421599?thread_ts=1699539775.896259&cid=C02CA1QPG5Q|https://paymentology.slack.com/archives/C02CA1QPG5Q/p1702375162421599?thread_ts=1699539775.896259&cid=C02CA1QPG5Q|smart-link] ,"18/Dec/23 2:20 PM;6297155ee76a9c00705e2b50;A similar logic was implemented in the Voucher Engine ticket [https://paymentology.atlassian.net/browse/DEV-11637557|https://paymentology.atlassian.net/browse/DEV-11637557|smart-link] 



{noformat}  if (SLI = 214 AND Indicator In kX,kY,kZ )
  then Skip AAV validation
{noformat}

CC [~accountid:5a9e4751a00c7f2a80155fda] ","19/Dec/23 2:03 PM;5f05939fd68032002142c1f3;[~accountid:6297155ee76a9c00705e2b50] [~accountid:5a9e4751a00c7f2a80155fda] we must only skip the AAV validation for kX SLI 214 if there is no OBS 05/06 = V available. This is due to the new requirement from MC that ALL AAVs must be validated by either the Issuer or MC as stipulated in AN 7112. 

The reason for the story is because MC is not sending the Validation result in OBS 05/06 at the moment. On-going email investigation.","28/Dec/23 2:40 PM;712020:c085ef23-abfd-4a85-beab-72e584c439eb;It’s merged to master.

h2. ISB

[The cherry-pick|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/merge_requests/1140] is created but not merged due to the code freeze. When it’s merged, I will present it on the next CCM.

h2. Mettle

According to [this page|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7519764481/Banking+Live+Release+Version+2.2.9] it should be merged to [this branch|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/commits/release%2F1.20.23?ref_type=heads] but… should it? Or we should rather wait for the new process to complete? It’d take around 6 weeks. ",16/Jan/24 10:08 AM;5f05939fd68032002142c1f3;Hi [~accountid:712020:c085ef23-abfd-4a85-beab-72e584c439eb] could you please confirm if this is still blocked please? ,"16/Jan/24 10:48 AM;712020:c085ef23-abfd-4a85-beab-72e584c439eb;Hi [~accountid:5f05939fd68032002142c1f3]!

For ISB, I will present it at today CCM.

For Mettle, I guess it follows the “new process”.

So I guess it’s not blocked.",16/Jan/24 10:49 AM;712020:c085ef23-abfd-4a85-beab-72e584c439eb;PayTok DB: [1.8.85|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/commits/1.8.85?ref_type=tags],"16/Jan/24 4:04 PM;61f80302845d670071f2138e;CCM 16/01 === ISB
Date: Jan 23, 2023
Downtime: 15 mins
Risk Window: 04:00 - 05:30 Utc
Tags:
Pre-Installer: No
Member of any other Team Required: None

CCM 16/01 === BOJ
Date: Feb 13, 2023
Downtime: 30 mins
Risk Window: 04:00 - 05:30 Utc
Tags:
Pre-Installer: No
Member of any other Team Required: None",23/Jan/24 6:20 AM;61f80302845d670071f2138e;Deployed in ISB,23/Jan/24 10:52 AM;712020:c085ef23-abfd-4a85-beab-72e584c439eb;PayTok DB: [1.8.86|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/commits/1.8.86?ref_type=tags],"23/Jan/24 2:57 PM;61f80302845d670071f2138e;CCM 23/01 === ISB
Date: Jan 30, 2023
Downtime: 15 mins
Risk Window: 04:00 - 05:30 Utc
Tags:
Pre-Installer: No
Member of any other Team Required: None
Note: *NO* Impact as 1.8.85 was deployed today morning

CCM 23/01 === BOJ
Date: Feb 13, 2023
Downtime: 30 mins
Risk Window: 04:00 - 05:30 Utc
Tags:
Pre-Installer: No
Member of any other Team Required: None","23/Jan/24 4:24 PM;60fedd388ad5b600707750e1;[~accountid:712020:c085ef23-abfd-4a85-beab-72e584c439eb] ,

This change is expected to go to other environments as well as per [~accountid:6297155ee76a9c00705e2b50] .

Please use the below branches to merge into below PayTok branches.

 [https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/commits/release%2F1.20.23?ref_type=heads|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/commits/release%2F1.20.23?ref_type=heads|smart-link] Mettle 

[https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/commits/hotfix/1.22.18|https://gitlab.com/paymento/source/bl2.0/paydb/paytokdb/-/commits/hotfix/1.22.18|smart-link]  Shared02",25/Jan/24 6:26 AM;61f80302845d670071f2138e;Deployed in ISB,16/Feb/24 12:50 PM;60fedd388ad5b600707750e1;[~accountid:6273fbf86a38370069df0612] can you please put the feature  flag name  for this functionality.,"16/Feb/24 1:25 PM;6273fbf86a38370069df0612;[~accountid:60fedd388ad5b600707750e1] sure
It’s {{bypass_aav_on_merchant_risk}}

For [https://paymentology.atlassian.net/browse/AUTH-157|https://paymentology.atlassian.net/browse/AUTH-157|smart-link] it’s {{on_behalf_service_mastercard_aav_verification}}","16/Feb/24 1:30 PM;60fedd388ad5b600707750e1;[~accountid:6273fbf86a38370069df0612] , Please update this page as well , very thanks in advance.

[BL : PayPower Settings through Product ID or Client ID - Team Hubs - Confluence (atlassian.net)|https://paymentology.atlassian.net/wiki/spaces/TS/pages/7517274378/BL+PayPower+Settings+through+Product+ID+or+Client+ID]","21/Feb/24 5:29 AM;60fedd388ad5b600707750e1;These features are applied to Shared UAT Products 251,216.",22/Jan/25 2:43 PM;557058:f58131cb-b67d-43c7-b30d-6b58d40bd077;The linked related issue - AUTH-239 has got status Done,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done,16/Feb/24 12:38 PM
